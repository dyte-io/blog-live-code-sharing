/*! For license information please see main.9e63d8b2.js.LICENSE.txt */
!function(){var e={8654:function(e,t,n){var r={"./dyte-audio-visualizer_2.entry.js":[9244,9244],"./dyte-avatar_5.entry.js":[9139,2858,9139],"./dyte-breakout-room-grid.entry.js":[1076,1076],"./dyte-breakout-room-manager_3.entry.js":[475,475],"./dyte-breakout-room-tile.entry.js":[5196,5196],"./dyte-breakout-rooms-manager.entry.js":[4307,4307],"./dyte-breakout-rooms-toggle.entry.js":[9281,9281],"./dyte-broadcast-message-modal.entry.js":[5677,5677],"./dyte-button.entry.js":[6200,6200],"./dyte-camera-toggle.entry.js":[1678,1678],"./dyte-chat-composer-ui_3.entry.js":[5134,5134],"./dyte-chat-toggle.entry.js":[8675,8675],"./dyte-chat.entry.js":[1817,1817],"./dyte-clock.entry.js":[2793,2793],"./dyte-confirmation-modal.entry.js":[7298,7298],"./dyte-controlbar-button.entry.js":[2427,2427],"./dyte-controlbar.entry.js":[4815,4815],"./dyte-dialog-manager.entry.js":[7999,7999],"./dyte-dialog.entry.js":[8967,8967],"./dyte-emoji-picker.entry.js":[9808,9808],"./dyte-ended-screen.entry.js":[9434,9434],"./dyte-file-message_3.entry.js":[3718,3718],"./dyte-fullscreen-toggle.entry.js":[1068,1068],"./dyte-grid-pagination.entry.js":[8719,8719],"./dyte-grid.entry.js":[1485,1485],"./dyte-header.entry.js":[6301,6301],"./dyte-icon.entry.js":[2072,2072],"./dyte-idle-screen.entry.js":[1941,1941],"./dyte-image-viewer.entry.js":[35,35],"./dyte-join-stage.entry.js":[2946,2946],"./dyte-leave-button.entry.js":[8053,8053],"./dyte-leave-meeting.entry.js":[8521,8521],"./dyte-logo.entry.js":[6275,6275],"./dyte-meeting-title.entry.js":[2401,2401],"./dyte-meeting.entry.js":[2046,6588,2046],"./dyte-mic-toggle.entry.js":[9546,9546],"./dyte-mixed-grid.entry.js":[5288,5288],"./dyte-more-toggle.entry.js":[7403,7403],"./dyte-mute-all-button.entry.js":[3555,3555],"./dyte-mute-all-confirmation.entry.js":[8684,8684],"./dyte-name-tag.entry.js":[7181,7181],"./dyte-notification.entry.js":[6324,6324],"./dyte-notifications.entry.js":[7766,7766],"./dyte-overlay-modal.entry.js":[8212,8212],"./dyte-participant-count.entry.js":[937,937],"./dyte-participant-setup.entry.js":[8555,8555],"./dyte-participant-tile.entry.js":[9361,9361],"./dyte-participants-audio.entry.js":[7133,7133],"./dyte-participants-toggle.entry.js":[5181,5181],"./dyte-permissions-message.entry.js":[290,290],"./dyte-pip-toggle.entry.js":[6967,6967],"./dyte-plugin-main.entry.js":[1862,1862],"./dyte-plugins-toggle.entry.js":[2332,2332],"./dyte-plugins.entry.js":[7205,7205],"./dyte-poll_2.entry.js":[2027,2027],"./dyte-polls-toggle.entry.js":[2996,2996],"./dyte-polls.entry.js":[1408,1408],"./dyte-recording-indicator.entry.js":[1771,1771],"./dyte-recording-toggle.entry.js":[6769,6769],"./dyte-remote-access-manager.entry.js":[3353,3353],"./dyte-screen-share-toggle.entry.js":[9091,9091],"./dyte-screenshare-view.entry.js":[874,874],"./dyte-settings-audio_2.entry.js":[5729,5729],"./dyte-settings-toggle.entry.js":[1376,1376],"./dyte-settings.entry.js":[3012,3012],"./dyte-setup-screen.entry.js":[1901,1901],"./dyte-sidebar.entry.js":[1421,1421],"./dyte-simple-grid.entry.js":[2249,6588,2249],"./dyte-spinner.entry.js":[9716,9716],"./dyte-spotlight-grid.entry.js":[7770,7770],"./dyte-spotlight-indicator.entry.js":[296,296],"./dyte-stage.entry.js":[4701,4701],"./dyte-text-field.entry.js":[3642,3642],"./dyte-tooltip.entry.js":[4673,2858,4673],"./dyte-waiting-screen.entry.js":[424,424],"./dyte-webinar-stage-toggle.entry.js":[8785,8785]};function a(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],a=t[0];return Promise.all(t.slice(1).map(n.e)).then((function(){return n(a)}))}a.keys=function(){return Object.keys(r)},a.id=8654,e.exports=a},9666:function(e,t,n){"use strict";n.d(t,{g:function(){return i},h:function(){return o},p:function(){return a}});var r=n(7762),a=(n(4153),function(e){var t=null;try{var n=JSON.parse(e.message),r=n.target,a=n.message;t=void 0===r||void 0===a?e:Object.assign(Object.assign({},e),{targetUserIds:r,message:a})}catch(i){t=e}return t});function i(e){return e.sort((function(e,t){return e.localeCompare(t)})).join("_")}function o(e,t){if(null!=e){var n,a=(0,r.Z)(e);try{for(a.s();!(n=a.n()).done;){var i=n.value;if("file"===i.kind){var o=i.getAsFile();i.type.startsWith("image/")?t("image",o):t("file",o)}}}catch(s){a.e(s)}finally{a.f()}}}},9442:function(e,t,n){"use strict";n.d(t,{g:function(){return Pt},m:function(){return Ct},p:function(){return w}});var r=n(2982),a=n(7762),i=n(885),o=n(1654);e=n.hmd(e);var s=[0,.5,1,1.5,2,3,4,5,6,7,8,9,10,12,14,16,20,24,28,32,36,40,44,48,52,56,60,64,72,80,96],c={darkest:{background:{1e3:"#080808",900:"#1A1A1A",800:"#1E1E1E",700:"#2C2C2C",600:"#393939"},text:"#FFFFFF"},dark:{background:{1e3:"#252525",900:"#2F2F2F",800:"#323232",700:"#3E3E3E",600:"#4A4A4A"},text:"#F5F5F5","video-bg":"#1C1C1C"},light:{background:{1e3:"#FFFFFF",900:"#F5F5F5",800:"#EBEBEB",700:"#E0E0E0",600:"#D6D6D6"},text:"#111111","text-on-brand":"#ffffff","video-bg":"#DADADA"}},u={none:{none:0,sm:0,md:0,lg:0},thin:{none:0,sm:1,md:2,lg:4},fat:{none:0,sm:2,md:4,lg:8}},l={sharp:{none:0,sm:0,md:0,lg:0},rounded:{none:0,sm:4,md:8,lg:12},"extra-rounded":{none:0,sm:8,md:16,lg:24},circular:{none:9999,sm:9999,md:9999,lg:9999}},d=[-2,-1,0,1,2];function p(e){var t="0",n="0",r="0";return 4==(e=e.trim()).length?(t="0x"+e[1]+e[1],n="0x"+e[2]+e[2],r="0x"+e[3]+e[3]):e.length>6&&(t="0x"+e[1]+e[2],n="0x"+e[3]+e[4],r="0x"+e[5]+e[6]),[+t,+n,+r]}var f=function(e,t,n){var r,a,i;if(0==t)r=a=i=n;else{var o=function(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e},s=n<.5?n*(1+t):n+t-n*t,c=2*n-s;r=o(c,s,e+1/3),a=o(c,s,e),i=o(c,s,e-1/3)}return[Math.round(255*r),Math.round(255*a),Math.round(255*i)]},h=function(e,t,n){e/=255,t/=255,n/=255;var r,a,i=Math.max(e,t,n),o=Math.min(e,t,n),s=(i+o)/2;if(i==o)r=a=0;else{var c=i-o;switch(a=s>.5?c/(2-i-o):c/(i+o),i){case e:r=(t-n)/c+(t<n?6:0);break;case t:r=(n-e)/c+2;break;case n:r=(e-t)/c+4}r/=6}return[r,a,s]},v=function(e,t,n){var r=function(e){return e.toString(16).padStart(2,"0")};return"#".concat(r(e)).concat(r(t)).concat(r(n))},m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.4,r=[],o=p(e),s=(0,i.Z)(o,3),c=s[0],u=s[1],l=s[2],m=h(c,u,l),g=(0,i.Z)(m,3),y=g[0],k=g[1],b=g[2],w=Math.round(100*b);w>70?n=.8:w>60?n=.9:w<10?n=.075:w<42&&(n=.3);var _=t.findIndex((function(e){return 0===e}));if(-1===_)throw new Error("Invalid reducer provided, it must contain atleast one zero");var S,E=(100-w)/(5-_),T=w/(_+1),x=(0,a.Z)(t);try{for(x.s();!(S=x.n()).done;){var Z=S.value,C=f(y,k,(Z<0?w+Z*T*n:Z>0?w+Z*E*n:w)/100),R=(0,i.Z)(C,3),P=R[0],I=R[1],O=R[2];r.push(v(P,I,O))}}catch(D){x.e(D)}finally{x.f()}return r},g=function(e){return"string"===typeof e&&7===e.length&&e.startsWith("#")},y=function(e){var t=m(e,d),n=(0,i.Z)(t,5);return{300:n[0],400:n[1],500:n[2],600:n[3],700:n[4]}},k=function(e){var t=m(e,d),n=(0,i.Z)(t,5);return{1e3:n[0],900:n[1],800:n[2],700:n[3],600:n[4]}},b=function(e,t){Object.keys(t).forEach((function(n){var r=t[n];if("string"===typeof r)if("text"===n||"text-on-brand"===n){var a=p(r).join(" ");e.style.setProperty("--dyte-colors-".concat(n,"-1000"),"".concat(a)),e.style.setProperty("--dyte-colors-".concat(n,"-900"),"".concat(a," / 0.88")),e.style.setProperty("--dyte-colors-".concat(n,"-800"),"".concat(a," / 0.76")),e.style.setProperty("--dyte-colors-".concat(n,"-700"),"".concat(a," / 0.64")),e.style.setProperty("--dyte-colors-".concat(n,"-600"),"".concat(a," / 0.52"))}else{var i=p(r).join(" ");e.style.setProperty("--dyte-colors-".concat(n),i)}else"object"===typeof r&&Object.keys(r).forEach((function(t){var a=p(r[t]).join(" ");e.style.setProperty("--dyte-colors-".concat(n,"-").concat(t),a)}))}))},w=function(e,t){var n=t.spacingBase,r=t.borderRadius,a=t.borderWidth,i=t.colors,o=t.fontFamily,d=t.googleFont,p=t.theme;if("object"!==typeof e)throw new Error("[dyte-ui-kit] (provideDyteDesignSystem): Passed element is not a valid HTML Element");if("string"===typeof d&&(!function(e){var t,n=[];if(null==document.querySelector("link[data-dyte-font]")){var r=document.createElement("link");r.rel="preconnect",r.setAttribute("data-dyte-font","true"),r.href="https://fonts.googleapis.com";var a=r.cloneNode(!0);a.href="https://fonts.gstatic.com",a.crossOrigin="",n.push(r,a)}var i=document.createElement("link");i.rel="stylesheet",i.setAttribute("data-dyte-font",e),i.href=encodeURI("https://fonts.googleapis.com/css2?family=".concat(e,":wght@").concat([400,500,700].join(";"),"&display=swap")),n.push(i),(t=document.head).append.apply(t,n)}(d),e.style.setProperty("--dyte-font-family",d)),"string"===typeof o&&e.style.setProperty("--dyte-font-family",o),"number"===typeof n&&function(e,t){s.forEach((function(n){e.style.setProperty("--dyte-space-".concat(n),"".concat(n*t,"px"))}))}(e,n),"string"===typeof a&&function(e,t){if(t in u){var n=u[t];Object.keys(n).forEach((function(t){e.style.setProperty("--dyte-border-width-".concat(t),"".concat(n[t],"px"))}))}}(e,a),"string"===typeof r&&function(e,t){if(t in l){var n=l[t];Object.keys(n).forEach((function(t){e.style.setProperty("--dyte-border-radius-".concat(t),"".concat(n[t],"px"))}))}}(e,r),"string"===typeof p){var f=c[p];null!=f&&b(e,f)}"object"===typeof i&&b(e,i)};function _(e,t){return e===t||e!==e&&t!==t}function S(e,t){for(var n=e.length;n--;)if(_(e[n][0],t))return n;return-1}var E=Array.prototype.splice;function T(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}T.prototype.clear=function(){this.__data__=[],this.size=0},T.prototype.delete=function(e){var t=this.__data__,n=S(t,e);return!(n<0)&&(n==t.length-1?t.pop():E.call(t,n,1),--this.size,!0)},T.prototype.get=function(e){var t=this.__data__,n=S(t,e);return n<0?void 0:t[n][1]},T.prototype.has=function(e){return S(this.__data__,e)>-1},T.prototype.set=function(e,t){var n=this.__data__,r=S(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};var x="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,Z="object"==typeof self&&self&&self.Object===Object&&self,C=x||Z||Function("return this")(),R=C.Symbol,P=Object.prototype,I=P.hasOwnProperty,O=P.toString,D=R?R.toStringTag:void 0;var M=Object.prototype.toString;var A="[object Null]",N="[object Undefined]",L=R?R.toStringTag:void 0;function j(e){return null==e?void 0===e?N:A:L&&L in Object(e)?function(e){var t=I.call(e,D),n=e[D];try{e[D]=void 0;var r=!0}catch(i){}var a=O.call(e);return r&&(t?e[D]=n:delete e[D]),a}(e):function(e){return M.call(e)}(e)}function F(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var U="[object AsyncFunction]",B="[object Function]",V="[object GeneratorFunction]",H="[object Proxy]";function z(e){if(!F(e))return!1;var t=j(e);return t==B||t==V||t==U||t==H}var W=C["__core-js_shared__"],G=function(){var e=/[^.]+$/.exec(W&&W.keys&&W.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var q=Function.prototype.toString;var $=/^\[object .+?Constructor\]$/,K=Function.prototype,J=Object.prototype,Q=K.toString,X=J.hasOwnProperty,Y=RegExp("^"+Q.call(X).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ee(e){return!(!F(e)||(t=e,G&&G in t))&&(z(e)?Y:$).test(function(e){if(null!=e){try{return q.call(e)}catch(t){}try{return e+""}catch(t){}}return""}(e));var t}function te(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return ee(n)?n:void 0}var ne=te(C,"Map"),re=te(Object,"create");var ae="__lodash_hash_undefined__",ie=Object.prototype.hasOwnProperty;var oe=Object.prototype.hasOwnProperty;var se="__lodash_hash_undefined__";function ce(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function ue(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function le(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ce.prototype.clear=function(){this.__data__=re?re(null):{},this.size=0},ce.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ce.prototype.get=function(e){var t=this.__data__;if(re){var n=t[e];return n===ae?void 0:n}return ie.call(t,e)?t[e]:void 0},ce.prototype.has=function(e){var t=this.__data__;return re?void 0!==t[e]:oe.call(t,e)},ce.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=re&&void 0===t?se:t,this},le.prototype.clear=function(){this.size=0,this.__data__={hash:new ce,map:new(ne||T),string:new ce}},le.prototype.delete=function(e){var t=ue(this,e).delete(e);return this.size-=t?1:0,t},le.prototype.get=function(e){return ue(this,e).get(e)},le.prototype.has=function(e){return ue(this,e).has(e)},le.prototype.set=function(e,t){var n=ue(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};var de=200;function pe(e){var t=this.__data__=new T(e);this.size=t.size}pe.prototype.clear=function(){this.__data__=new T,this.size=0},pe.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},pe.prototype.get=function(e){return this.__data__.get(e)},pe.prototype.has=function(e){return this.__data__.has(e)},pe.prototype.set=function(e,t){var n=this.__data__;if(n instanceof T){var r=n.__data__;if(!ne||r.length<de-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new le(r)}return n.set(e,t),this.size=n.size,this};var fe=function(){try{var e=te(Object,"defineProperty");return e({},"",{}),e}catch(t){}}();function he(e,t,n){"__proto__"==t&&fe?fe(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function ve(e,t,n){(void 0!==n&&!_(e[t],n)||void 0===n&&!(t in e))&&he(e,t,n)}var me,ge=function(e,t,n){for(var r=-1,a=Object(e),i=n(e),o=i.length;o--;){var s=i[me?o:++r];if(!1===t(a[s],s,a))break}return e},ye="object"==typeof exports&&exports&&!exports.nodeType&&exports,ke=ye&&e&&!e.nodeType&&e,be=ke&&ke.exports===ye?C.Buffer:void 0,we=be?be.allocUnsafe:void 0;var _e=C.Uint8Array;function Se(e,t){var n=t?function(e){var t=new e.constructor(e.byteLength);return new _e(t).set(new _e(e)),t}(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var Ee=Object.create,Te=function(){function e(){}return function(t){if(!F(t))return{};if(Ee)return Ee(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();var xe,Ze,Ce=(xe=Object.getPrototypeOf,Ze=Object,function(e){return xe(Ze(e))}),Re=Object.prototype;function Pe(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Re)}function Ie(e){return null!=e&&"object"==typeof e}var Oe="[object Arguments]";function De(e){return Ie(e)&&j(e)==Oe}var Me=Object.prototype,Ae=Me.hasOwnProperty,Ne=Me.propertyIsEnumerable,Le=De(function(){return arguments}())?De:function(e){return Ie(e)&&Ae.call(e,"callee")&&!Ne.call(e,"callee")},je=Array.isArray,Fe=9007199254740991;function Ue(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Fe}function Be(e){return null!=e&&Ue(e.length)&&!z(e)}var Ve="object"==typeof exports&&exports&&!exports.nodeType&&exports,He=Ve&&e&&!e.nodeType&&e,ze=He&&He.exports===Ve?C.Buffer:void 0,We=(ze?ze.isBuffer:void 0)||function(){return!1},Ge="[object Object]",qe=Function.prototype,$e=Object.prototype,Ke=qe.toString,Je=$e.hasOwnProperty,Qe=Ke.call(Object);var Xe={};Xe["[object Float32Array]"]=Xe["[object Float64Array]"]=Xe["[object Int8Array]"]=Xe["[object Int16Array]"]=Xe["[object Int32Array]"]=Xe["[object Uint8Array]"]=Xe["[object Uint8ClampedArray]"]=Xe["[object Uint16Array]"]=Xe["[object Uint32Array]"]=!0,Xe["[object Arguments]"]=Xe["[object Array]"]=Xe["[object ArrayBuffer]"]=Xe["[object Boolean]"]=Xe["[object DataView]"]=Xe["[object Date]"]=Xe["[object Error]"]=Xe["[object Function]"]=Xe["[object Map]"]=Xe["[object Number]"]=Xe["[object Object]"]=Xe["[object RegExp]"]=Xe["[object Set]"]=Xe["[object String]"]=Xe["[object WeakMap]"]=!1;var Ye="object"==typeof exports&&exports&&!exports.nodeType&&exports,et=Ye&&e&&!e.nodeType&&e,tt=et&&et.exports===Ye&&x.process,nt=function(){try{var e=et&&et.require&&et.require("util").types;return e||tt&&tt.binding&&tt.binding("util")}catch(t){}}(),rt=nt&&nt.isTypedArray,at=rt?function(e){return function(t){return e(t)}}(rt):function(e){return Ie(e)&&Ue(e.length)&&!!Xe[j(e)]};function it(e,t){if(("constructor"!==t||"function"!==typeof e[t])&&"__proto__"!=t)return e[t]}var ot=Object.prototype.hasOwnProperty;function st(e,t,n){var r=e[t];ot.call(e,t)&&_(r,n)&&(void 0!==n||t in e)||he(e,t,n)}var ct=9007199254740991,ut=/^(?:0|[1-9]\d*)$/;function lt(e,t){var n=typeof e;return!!(t=null==t?ct:t)&&("number"==n||"symbol"!=n&&ut.test(e))&&e>-1&&e%1==0&&e<t}var dt=Object.prototype.hasOwnProperty;function pt(e,t){var n=je(e),r=!n&&Le(e),a=!n&&!r&&We(e),i=!n&&!r&&!a&&at(e),o=n||r||a||i,s=o?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],c=s.length;for(var u in e)!t&&!dt.call(e,u)||o&&("length"==u||a&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||lt(u,c))||s.push(u);return s}var ft=Object.prototype.hasOwnProperty;function ht(e){if(!F(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=Pe(e),n=[];for(var r in e)("constructor"!=r||!t&&ft.call(e,r))&&n.push(r);return n}function vt(e){return Be(e)?pt(e,!0):ht(e)}function mt(e){return function(e,t,n,r){var a=!n;n||(n={});for(var i=-1,o=t.length;++i<o;){var s=t[i],c=r?r(n[s],e[s],s,n,e):void 0;void 0===c&&(c=e[s]),a?he(n,s,c):st(n,s,c)}return n}(e,vt(e))}function gt(e,t,n,r,a,i,o){var s=it(e,n),c=it(t,n),u=o.get(c);if(u)ve(e,n,u);else{var l,d=i?i(s,c,n+"",e,t,o):void 0,p=void 0===d;if(p){var f=je(c),h=!f&&We(c),v=!f&&!h&&at(c);d=c,f||h||v?je(s)?d=s:Ie(l=s)&&Be(l)?d=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}(s):h?(p=!1,d=function(e,t){if(t)return e.slice();var n=e.length,r=we?we(n):new e.constructor(n);return e.copy(r),r}(c,!0)):v?(p=!1,d=Se(c,!0)):d=[]:function(e){if(!Ie(e)||j(e)!=Ge)return!1;var t=Ce(e);if(null===t)return!0;var n=Je.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Ke.call(n)==Qe}(c)||Le(c)?(d=s,Le(s)?d=mt(s):F(s)&&!z(s)||(d=function(e){return"function"!=typeof e.constructor||Pe(e)?{}:Te(Ce(e))}(c))):p=!1}p&&(o.set(c,d),a(d,c,r,i,o),o.delete(c)),ve(e,n,d)}}function yt(e,t,n,r,a){e!==t&&ge(t,(function(i,o){if(a||(a=new pe),F(i))gt(e,t,o,n,yt,r,a);else{var s=r?r(it(e,o),i,o+"",e,t,a):void 0;void 0===s&&(s=i),ve(e,o,s)}}),vt)}function kt(e){return e}var bt=Math.max;var wt=fe?function(e,t){return fe(e,"toString",{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0});var n}:kt,_t=800,St=16,Et=Date.now;var Tt=function(e){var t=0,n=0;return function(){var r=Et(),a=St-(r-n);if(n=r,a>0){if(++t>=_t)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(wt);function xt(e,t){return Tt(function(e,t,n){return t=bt(void 0===t?e.length-1:t,0),function(){for(var r=arguments,a=-1,i=bt(r.length-t,0),o=Array(i);++a<i;)o[a]=r[t+a];a=-1;for(var s=Array(t+1);++a<t;)s[a]=r[a];return s[t]=n(o),function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}(e,this,s)}}(e,t,kt),e+"")}var Zt,Ct=(Zt=function(e,t,n){yt(e,t,n)},xt((function(e,t){var n=-1,r=t.length,a=r>1?t[r-1]:void 0,i=r>2?t[2]:void 0;for(a=Zt.length>3&&"function"==typeof a?(r--,a):void 0,i&&function(e,t,n){if(!F(n))return!1;var r=typeof t;return!!("number"==r?Be(n)&&lt(t,n.length):"string"==r&&t in n)&&_(n[t],e)}(t[0],t[1],i)&&(a=r<3?void 0:a,r=1),e=Object(e);++n<r;){var o=t[n];o&&Zt(e,o,n,a)}return e}))),Rt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.d,n=Object.assign({},t);return Ct(n,e),n},Pt=function(e){var t,n,a,i,o,s,c,u,l,d,p,f,h,v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{grid_pagination:!0,settings_toggle:!0},b={showSetupScreen:!0},w=["dyte-stage"],_={},S={},E=!1!==(null===m||void 0===m?void 0:m.settings_toggle),T=!1!==(null===m||void 0===m?void 0:m.grid_pagination);if(null===(t=e.controlBar)||void 0===t?void 0:t.isEnabled){w.push("dyte-controlbar");var x=e.controlBar.elements,Z=["dyte-breakout-rooms-toggle"],C=[],R=["dyte-mic-toggle","dyte-camera-toggle","dyte-webinar-stage-toggle","dyte-mute-all-button"].concat((0,r.Z)(E?["dyte-settings-toggle"]:[]),["dyte-leave-button"]);x.fullscreen&&Z.push("dyte-fullscreen-toggle"),x.screenshare&&Z.push("dyte-screen-share-toggle"),Z.push("dyte-recording-toggle"),Z.push("dyte-pip-toggle"),x.chat&&C.push("dyte-chat-toggle"),x.polls&&C.push("dyte-polls-toggle"),x.participants&&C.push("dyte-participants-toggle"),x.plugins&&C.push("dyte-plugins-toggle");var P=Z.concat(["dyte-mute-all-button"]).concat(C);E&&P.push("dyte-settings-toggle");var I=!1;P.length>0&&(I=!0),S={"dyte-controlbar":{states:["activeMoreMenu"],children:["div#controlbar-left","div#controlbar-center","div#controlbar-right"]},"div#controlbar-left":Z,"div#controlbar-center":R,"div#controlbar-right":C,"dyte-controlbar.sm":["div#controlbar-mobile"],"dyte-controlbar.md":["div#controlbar-mobile"],"dyte-controlbar.activeMoreMenu.sm":["div#controlbar-mobile","div#more-menu"],"dyte-controlbar.activeMoreMenu.md":["div#controlbar-mobile","div#more-menu"],"div#controlbar-mobile":["dyte-mic-toggle","dyte-camera-toggle","dyte-webinar-stage-toggle","dyte-leave-button"].concat([I&&"dyte-more-toggle"]),"div#more-menu":P.map((function(e){return[e,{variant:"horizontal"}]}))}}if(null===(n=e.header)||void 0===n?void 0:n.isEnabled){w.unshift("dyte-header");var O=e.header.elements,D=["dyte-recording-indicator"],M=[],A=[];T&&A.push("dyte-grid-pagination"),O.title&&M.push("dyte-meeting-title"),"string"===typeof O.logo&&O.logo.length>0&&(h=O.logo,D.unshift("dyte-logo")),O.participantCount&&A.push("dyte-participant-count"),O.timer&&A.push("dyte-clock"),_={"dyte-header":["div#header-left","div#header-center","div#header-right"],"dyte-header.sm":["div#header-left","div#header-right"],"div#header-left":D,"div#header-center":M,"div#header-right":A,"div#header-left.sm":D.slice(1).concat(["dyte-meeting-title"])}}w.push("dyte-participants-audio","dyte-dialog-manager");var N={logo:h};!0===e.isV2?(N=e.designTokens,g(null===(i=null===(a=null===e||void 0===e?void 0:e.designTokens)||void 0===a?void 0:a.colors)||void 0===i?void 0:i.textOnBrand)&&(N.colors["text-on-brand"]=null===(s=null===(o=null===e||void 0===e?void 0:e.designTokens)||void 0===o?void 0:o.colors)||void 0===s?void 0:s.textOnBrand),g(null===(u=null===(c=null===e||void 0===e?void 0:e.designTokens)||void 0===c?void 0:c.colors)||void 0===u?void 0:u.videoBg)&&(N.colors["video-bg"]=null===(d=null===(l=null===e||void 0===e?void 0:e.designTokens)||void 0===l?void 0:l.colors)||void 0===d?void 0:d.videoBg)):null!=e.colors&&(N.colors={},g(e.colors.primary)?N.colors.brand=y(e.colors.primary):"object"===typeof e.colors.primary&&(N.colors.brand=e.colors.primary),g(e.colors.secondary)?N.colors.background=k(e.colors.secondary):"object"===typeof e.colors.secondary&&(N.colors.background=e.colors.secondary),g(e.colors.text)&&(N.colors.text=e.colors.text),g(e.colors.textPrimary)&&(N.colors["text-on-brand"]=e.colors.textPrimary),g(e.colors.videoBackground)&&(N.colors["video-bg"]=e.colors.videoBackground));var L={designTokens:N,styles:{"dyte-header":{display:"grid",height:"48px",gridTemplateColumns:"repeat(3, 1fr)",gridTemplateRows:"1fr",alignItems:"center"},"dyte-header.sm":{display:"grid",gridArea:"header",gridTemplateColumns:"repeat(2, 1fr)",gridTemplateRows:"1fr",alignItems:"center"},"div#header-left":{display:"flex",alignItems:"center",height:"48px"},"dyte-logo":{height:"26px"},"div#header-center":{display:"flex",alignItems:"center",justifyContent:"center"},"div#header-right":{display:"flex",alignItems:"center",justifyContent:"flex-end"},"dyte-stage":{display:"flex",flex:"1"},"dyte-grid":{flex:"1",height:"auto"},"dyte-controlbar":{display:"grid",height:"76px",gridTemplateColumns:"repeat(3,1fr)",gridTemplateRows:"1fr",alignItems:"center",padding:"8px"},"dyte-controlbar.sm":{display:"flex",position:"relative",backgroundColor:"var(--dyte-colors-background-1000, #000)"},"dyte-controlbar.md":{display:"flex",position:"relative",backgroundColor:"var(--dyte-colors-background-1000, #000)"},"div#controlbar-left":{display:"flex",alignItems:"center"},"div#controlbar-center":{display:"flex",alignItems:"center",justifyContent:"center"},"div#controlbar-mobile":{display:"flex",flex:"1",alignItems:"center",justifyContent:"center",zIndex:"10000"},"div#controlbar-right":{display:"flex",alignItems:"center",justifyContent:"flex-end"},"dyte-settings":{width:"720px",height:"480px"},"div#more-menu":{position:"absolute",boxSizing:"border-box",top:"0",left:"0",width:"100%",transform:"translateY(-100%)",backgroundColor:"rgb(var(--dyte-colors-background-1000, 0 0 0))",padding:"16px 12px",borderRadius:"18px 18px 0 0",zIndex:"400"},"div#setupcontrols-media":{position:"absolute",bottom:"8px",right:"8px",display:"flex"},"div#setupcontrols-settings":{position:"absolute",top:"8px",right:"8px"},"dyte-meeting-title.sm":{marginLeft:"0"},"dyte-clock":{marginRight:"0"}},root:Object.assign(Object.assign(Object.assign({"dyte-meeting":{state:"meeting",states:["activeSidebar"]},"dyte-meeting[meeting=idle]":["dyte-idle-screen"],"dyte-meeting[meeting=waiting]":["dyte-waiting-screen"],"dyte-meeting[meeting=setup]":["dyte-setup-screen","dyte-dialog-manager"],"dyte-meeting[meeting=joined]":w,"dyte-meeting[meeting=joined].activeSidebar.sm":[].concat(w,[["dyte-sidebar",{view:"full-screen"}]]),"dyte-meeting[meeting=joined].activeSidebar.md":[].concat(w,[["dyte-sidebar",{view:"full-screen"}]]),"dyte-meeting[meeting=ended]":["dyte-ended-screen"]},_),S),{"dyte-stage":{states:["activeSidebar","activeBreakoutRoomGrid"],children:["dyte-grid","dyte-notifications"]},"dyte-stage.activeBreakoutRoomGrid":["dyte-breakout-room-grid","dyte-notifications","dyte-sidebar"],"dyte-stage.activeBreakoutRoomGrid.activeSidebar":["dyte-breakout-room-grid","dyte-notifications",["dyte-sidebar",{view:"sidebar"}]],"dyte-stage.activeSidebar":["dyte-grid","dyte-notifications",["dyte-sidebar",{view:"sidebar"}]],"dyte-stage.activeSidebar.sm":["dyte-grid","dyte-notifications"],"dyte-grid":{states:["activeScreenShare","activePlugin","activeSpotlight"],children:["dyte-simple-grid"]},"dyte-grid.activeSpotlight":["dyte-spotlight-grid"],"dyte-grid.activeScreenShare":["dyte-mixed-grid"],"dyte-grid.activePlugin":["dyte-mixed-grid"],"dyte-grid.activeScreenShare.activeSpotlight":["dyte-mixed-grid"],"dyte-grid.activePlugin.activeSpotlight":["dyte-mixed-grid"],"dyte-grid.activePlugin.activeScreenShare.activeSpotlight":["dyte-mixed-grid"],"dyte-mixed-grid":{states:["activeSpotlight"],children:["dyte-simple-grid"]},"dyte-mixed-grid.activeSpotlight":["dyte-spotlight-grid"],"dyte-participant-tile":{state:"meeting",children:["dyte-name-tag","dyte-avatar"]},"dyte-participant-setup":{children:["dyte-avatar","div#setupcontrols-media"]},"dyte-participant-tile[meeting=setup]":{children:["dyte-avatar","div#setupcontrols-media"].concat((0,r.Z)(E?["div#setupcontrols-settings"]:[]))},"div#setupcontrols-media":[["dyte-mic-toggle",{size:"sm"}],["dyte-camera-toggle",{size:"sm"}]],"div#setupcontrols-settings":[["dyte-settings-toggle",{size:"sm"}]],"dyte-screenshare-view":{children:["dyte-name-tag"]},"dyte-name-tag":[["dyte-audio-visualizer",{slot:"start"}]]}),config:{notification_sounds:{participant_left:!1},participant_joined_sound_notification_limit:3,participant_chat_message_sound_notification_limit:10,videoFit:"cover"}};return L=Rt(v,L),b.showSetupScreen=null===(f=null===(p=e.setupScreen)||void 0===p?void 0:p.isEnabled)||void 0===f||f,{config:L,data:b}}},7239:function(e,t,n){"use strict";n.d(t,{a:function(){return a},d:function(){return r}});var r={people:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 13.999 13 14a2 2 0 0 1 1.995 1.85L15 16v1.5C14.999 21 11.284 22 8.5 22c-2.722 0-6.335-.956-6.495-4.27L2 17.5v-1.501c0-1.054.816-1.918 1.85-1.995L4 14ZM15.22 14H20c1.054 0 1.918.816 1.994 1.85L22 16v1c-.001 3.062-2.858 4-5 4a7.16 7.16 0 0 1-2.14-.322c.336-.386.607-.827.802-1.327A6.19 6.19 0 0 0 17 19.5l.267-.006c.985-.043 3.086-.363 3.226-2.289L20.5 17v-1a.501.501 0 0 0-.41-.492L20 15.5h-4.051a2.957 2.957 0 0 0-.595-1.34L15.22 14H20h-4.78ZM4 15.499l-.1.01a.51.51 0 0 0-.254.136.506.506 0 0 0-.136.253l-.01.101V17.5c0 1.009.45 1.722 1.417 2.242.826.445 2.003.714 3.266.753l.317.005.317-.005c1.263-.039 2.439-.308 3.266-.753.906-.488 1.359-1.145 1.412-2.057l.005-.186V16a.501.501 0 0 0-.41-.492L13 15.5l-9-.001ZM8.5 3a4.5 4.5 0 1 1 0 9 4.5 4.5 0 0 1 0-9Zm9 2a3.5 3.5 0 1 1 0 7 3.5 3.5 0 0 1 0-7Zm-9-.5c-1.654 0-3 1.346-3 3s1.346 3 3 3 3-1.346 3-3-1.346-3-3-3Zm9 2c-1.103 0-2 .897-2 2s.897 2 2 2 2-.897 2-2-.897-2-2-2Z" fill="currentColor"/></svg>',chat:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2c5.523 0 10 4.477 10 10s-4.477 10-10 10a9.96 9.96 0 0 1-4.587-1.112l-3.826 1.067a1.25 1.25 0 0 1-1.54-1.54l1.068-3.823A9.96 9.96 0 0 1 2 12C2 6.477 6.477 2 12 2Zm0 1.5A8.5 8.5 0 0 0 3.5 12c0 1.47.373 2.883 1.073 4.137l.15.27-1.112 3.984 3.987-1.112.27.15A8.5 8.5 0 1 0 12 3.5ZM8.75 13h4.498a.75.75 0 0 1 .102 1.493l-.102.007H8.75a.75.75 0 0 1-.102-1.493L8.75 13h4.498H8.75Zm0-3.5h6.505a.75.75 0 0 1 .101 1.493l-.101.007H8.75a.75.75 0 0 1-.102-1.493L8.75 9.5h6.505H8.75Z" fill="currentColor"/></svg>',poll:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M11.752 2a2.752 2.752 0 0 1 2.752 2.751V19.25a2.752 2.752 0 1 1-5.504 0V4.75A2.752 2.752 0 0 1 11.752 2Zm7 5a2.752 2.752 0 0 1 2.752 2.751v9.499a2.752 2.752 0 1 1-5.504 0V9.75A2.752 2.752 0 0 1 18.752 7Zm-14 5a2.752 2.752 0 0 1 2.752 2.751v4.499a2.752 2.752 0 0 1-5.504 0V14.75A2.752 2.752 0 0 1 4.752 12Zm7-8.5c-.692 0-1.252.56-1.252 1.251V19.25a1.252 1.252 0 0 0 2.504 0V4.75c0-.691-.56-1.251-1.252-1.251Zm7 5c-.691 0-1.252.56-1.252 1.251v9.499a1.252 1.252 0 0 0 2.504 0V9.75c0-.691-.56-1.251-1.252-1.251Zm-14 5c-.692 0-1.252.56-1.252 1.251v4.499a1.252 1.252 0 1 0 2.504 0V14.75c0-.691-.56-1.252-1.252-1.252Z" fill="currentColor"/></svg>',participants:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.754 10c.966 0 1.75.784 1.75 1.75v4.749a4.501 4.501 0 0 1-9.002 0V11.75c0-.966.783-1.75 1.75-1.75h5.502Zm0 1.5H9.252a.25.25 0 0 0-.25.25v4.749a3.001 3.001 0 0 0 6.002 0V11.75a.25.25 0 0 0-.25-.25ZM3.75 10h3.381a2.738 2.738 0 0 0-.618 1.5H3.75a.25.25 0 0 0-.25.25v3.249a2.501 2.501 0 0 0 3.082 2.433c.085.504.24.985.453 1.432A4.001 4.001 0 0 1 2 14.999V11.75c0-.966.784-1.75 1.75-1.75Zm13.125 0h3.375c.966 0 1.75.784 1.75 1.75V15a4 4 0 0 1-5.03 3.866c.214-.448.369-.929.455-1.433A2.5 2.5 0 0 0 20.5 15v-3.25a.25.25 0 0 0-.25-.25h-2.757a2.738 2.738 0 0 0-.618-1.5ZM12 3a3 3 0 1 1 0 6 3 3 0 0 1 0-6Zm6.5 1a2.5 2.5 0 1 1 0 5 2.5 2.5 0 0 1 0-5Zm-13 0a2.5 2.5 0 1 1 0 5 2.5 2.5 0 0 1 0-5Zm6.5.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3Zm6.5 1a1 1 0 1 0 0 2 1 1 0 0 0 0-2Zm-13 0a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z" fill="currentColor"/></svg>',rocket:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M9.35 20.45 14.65 22.7Q15.55 20.9 16.575 19.15Q17.6 17.4 18.75 15.8L14.8 15Q14.8 15 14.8 15Q14.8 15 14.8 15ZM17.05 24.5 23.7 31.15Q26.55 29.85 29.05 28.2Q31.55 26.55 33.1 25Q37.15 20.95 39.05 16.7Q40.95 12.45 41.1 7.1Q35.75 7.25 31.5 9.15Q27.25 11.05 23.2 15.1Q21.65 16.65 20 19.15Q18.35 21.65 17.05 24.5ZM28.5 19.7Q27.5 18.7 27.5 17.225Q27.5 15.75 28.5 14.75Q29.5 13.75 30.975 13.75Q32.45 13.75 33.45 14.75Q34.45 15.75 34.45 17.225Q34.45 18.7 33.45 19.7Q32.45 20.7 30.975 20.7Q29.5 20.7 28.5 19.7ZM27.75 38.85 33.2 33.4Q33.2 33.4 33.2 33.4Q33.2 33.4 33.2 33.4L32.4 29.45Q30.8 30.6 29.05 31.625Q27.3 32.65 25.5 33.55ZM44.05 4.15Q44.5 10.95 42.35 16.55Q40.2 22.15 35.25 27.1Q35.2 27.15 35.15 27.2Q35.1 27.25 35.05 27.3L36.15 32.8Q36.3 33.55 36.075 34.25Q35.85 34.95 35.3 35.5L26.75 44.1L22.5 34.2L14 25.7L4.1 21.45L12.7 12.9Q13.25 12.35 13.95 12.125Q14.65 11.9 15.4 12.05L20.9 13.15Q20.95 13.1 21 13.075Q21.05 13.05 21.1 13Q26.05 8.05 31.65 5.875Q37.25 3.7 44.05 4.15ZM7.45 31.75Q9.2 30 11.725 29.975Q14.25 29.95 16 31.7Q17.75 33.45 17.725 35.975Q17.7 38.5 15.95 40.25Q14.65 41.55 11.925 42.4Q9.2 43.25 3.75 44Q4.5 38.55 5.325 35.8Q6.15 33.05 7.45 31.75ZM9.55 33.9Q8.85 34.65 8.3 36.25Q7.75 37.85 7.35 40.35Q9.85 39.95 11.45 39.4Q13.05 38.85 13.8 38.15Q14.75 37.3 14.775 36.025Q14.8 34.75 13.9 33.8Q12.95 32.9 11.675 32.925Q10.4 32.95 9.55 33.9Z" fill="currentColor" /></svg>',call_end:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m21.903 13.202-.191.816a2.75 2.75 0 0 1-2.955 2.107l-1.755-.178A2.75 2.75 0 0 1 14.6 13.83l-.389-1.686a.25.25 0 0 0-.113-.157c-.321-.197-1.034-.32-2.098-.32-.786 0-1.386.067-1.786.189-.14.043-.238.085-.301.116l-.09.048-.015.04-.409 1.77A2.75 2.75 0 0 1 7 15.948l-1.746.177A2.75 2.75 0 0 1 2.3 14.03l-.196-.817a3.75 3.75 0 0 1 1.13-3.651C5.134 7.839 8.064 7 12 7c3.943 0 6.875.842 8.776 2.57a3.75 3.75 0 0 1 1.172 3.41l-.045.222Zm-1.426-.514a2.25 2.25 0 0 0-.71-2.009C18.184 9.241 15.602 8.5 12 8.5c-3.598 0-6.177.739-7.76 2.172a2.25 2.25 0 0 0-.677 2.19l.196.818a1.25 1.25 0 0 0 1.342.953l1.746-.178a1.25 1.25 0 0 0 1.09-.962l.423-1.82.043-.136c.376-.998 1.591-1.37 3.597-1.37 1.318 0 2.265.164 2.88.54.401.245.687.642.793 1.1l.389 1.685c.12.522.56.909 1.092.963l1.754.178a1.25 1.25 0 0 0 1.343-.958l.192-.816.034-.171Z" fill="currentColor"/></svg>',share:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 2.498a3.502 3.502 0 1 1-2.597 5.851l-4.558 2.604a3.5 3.5 0 0 1 0 2.093l4.557 2.606a3.502 3.502 0 1 1-.745 1.302L9.1 14.347a3.502 3.502 0 1 1 0-4.698l4.557-2.604A3.502 3.502 0 0 1 17 2.498Zm0 13.5a2.002 2.002 0 1 0 0 4.004 2.002 2.002 0 0 0 0-4.004Zm-10.498-6a2.002 2.002 0 1 0 0 4.004 2.002 2.002 0 0 0 0-4.004Zm10.498-6a2.002 2.002 0 1 0 0 4.004 2.002 2.002 0 0 0 0-4.004Z" fill="currentColor"/></svg>',mic_on:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.25 11a.75.75 0 0 1 .743.648l.007.102v.5a6.75 6.75 0 0 1-6.249 6.732l-.001 2.268a.75.75 0 0 1-1.493.102l-.007-.102v-2.268a6.75 6.75 0 0 1-6.246-6.496L5 12.25v-.5a.75.75 0 0 1 1.493-.102l.007.102v.5a5.25 5.25 0 0 0 5.034 5.246l.216.004h.5a5.25 5.25 0 0 0 5.246-5.034l.004-.216v-.5a.75.75 0 0 1 .75-.75ZM12 2a4 4 0 0 1 4 4v6a4 4 0 0 1-8 0V6a4 4 0 0 1 4-4Zm0 1.5A2.5 2.5 0 0 0 9.5 6v6a2.5 2.5 0 0 0 5 0V6A2.5 2.5 0 0 0 12 3.5Z" fill="currentColor"/></svg>',mic_off:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.28 2.22a.75.75 0 1 0-1.06 1.06L8 9.06V12a4 4 0 0 0 6.248 3.309l1.146 1.146A5.227 5.227 0 0 1 12.25 17.5h-.5l-.216-.004A5.25 5.25 0 0 1 6.5 12.25v-.5l-.007-.102A.75.75 0 0 0 5 11.75v.5l.004.236a6.75 6.75 0 0 0 6.246 6.496v2.268l.007.102a.75.75 0 0 0 1.493-.102l.001-2.268a6.718 6.718 0 0 0 3.712-1.458l4.256 4.256a.75.75 0 0 0 1.061-1.06L3.28 2.22Zm9.876 11.997A2.5 2.5 0 0 1 9.5 12v-1.44l3.656 3.657ZM14.5 6v5.318l1.43 1.43c.046-.242.07-.492.07-.748V6a4 4 0 0 0-7.862-1.044L9.5 6.318V6a2.5 2.5 0 0 1 5 0ZM17.196 14.014l1.146 1.146A6.725 6.725 0 0 0 19 12.25v-.5l-.007-.102a.75.75 0 0 0-1.493.102v.5l-.004.216a5.233 5.233 0 0 1-.3 1.548Z" fill="currentColor"/></svg>',video_on:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.75 4.5A3.25 3.25 0 0 1 17 7.75v.173l3.864-2.318A.75.75 0 0 1 22 6.248V17.75a.75.75 0 0 1-1.136.643L17 16.075v.175a3.25 3.25 0 0 1-3.25 3.25h-8.5A3.25 3.25 0 0 1 2 16.25v-8.5A3.25 3.25 0 0 1 5.25 4.5h8.5Zm0 1.5h-8.5A1.75 1.75 0 0 0 3.5 7.75v8.5c0 .966.784 1.75 1.75 1.75h8.5a1.75 1.75 0 0 0 1.75-1.75v-8.5A1.75 1.75 0 0 0 13.75 6Zm6.75 1.573L17 9.674v4.651l3.5 2.1V7.573Z" fill="currentColor"/></svg>',video_off:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.28 2.22a.75.75 0 1 0-1.06 1.06l1.567 1.567A3.25 3.25 0 0 0 2 7.75v8.5a3.25 3.25 0 0 0 3.25 3.25h8.5a3.25 3.25 0 0 0 2.903-1.786l4.066 4.067a.75.75 0 0 0 1.061-1.061L3.28 2.22Zm12.196 14.317A1.75 1.75 0 0 1 13.75 18h-8.5a1.75 1.75 0 0 1-1.75-1.75v-8.5c0-.869.633-1.59 1.463-1.727l10.514 10.514ZM15.5 12.318V7.75A1.75 1.75 0 0 0 13.75 6H9.182l-1.5-1.5h6.068A3.25 3.25 0 0 1 17 7.75v.173l3.864-2.318A.75.75 0 0 1 22 6.248V17.75c0 .301-.17.543-.403.665L20.5 17.318V7.573L17 9.674v4.144l-1.5-1.5Z" fill="currentColor"/></svg>',share_screen_start:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M2 6.25A2.25 2.25 0 0 1 4.25 4h15.5A2.25 2.25 0 0 1 22 6.25v11.5A2.25 2.25 0 0 1 19.75 20H4.25A2.25 2.25 0 0 1 2 17.75V6.25Zm2.25-.75a.75.75 0 0 0-.75.75v11.5c0 .414.336.75.75.75h15.5a.75.75 0 0 0 .75-.75V6.25a.75.75 0 0 0-.75-.75H4.25Z"/><path d="M12 7.245a.75.75 0 0 1 .53.22l3.255 3.255a.75.75 0 1 1-1.06 1.06L12.75 9.806v6.447a.75.75 0 0 1-1.5 0V9.808L9.28 11.78a.75.75 0 1 1-1.06-1.06l3.25-3.254a.75.75 0 0 1 .53-.22Z"/></svg>',share_screen_stop:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M2 6.25A2.25 2.25 0 0 1 4.25 4h15.5A2.25 2.25 0 0 1 22 6.25v11.5A2.25 2.25 0 0 1 19.75 20H4.25A2.25 2.25 0 0 1 2 17.75V6.25Zm2.25-.75a.75.75 0 0 0-.75.75v11.5c0 .414.336.75.75.75h15.5a.75.75 0 0 0 .75-.75V6.25a.75.75 0 0 0-.75-.75H4.25Z"/><path d="M8.22 8.215a.75.75 0 0 1 1.06 0l2.72 2.72 2.725-2.716a.75.75 0 0 1 1.06 1.062l-2.724 2.715 2.724 2.724a.75.75 0 1 1-1.06 1.06L12 13.057 9.28 15.78a.75.75 0 0 1-1.06-1.06l2.72-2.724-2.72-2.72a.75.75 0 0 1 0-1.06Z"/></svg>',share_screen_person:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M2 7.25A3.25 3.25 0 0 1 5.25 4h13.5A3.25 3.25 0 0 1 22 7.25V13h-.258a3.74 3.74 0 0 0-1.242-2.545V7.25a1.75 1.75 0 0 0-1.75-1.75H5.25A1.75 1.75 0 0 0 3.5 7.25v9.5c0 .966.784 1.75 1.75 1.75H12v.5c0 .34.04.674.118 1H5.25A3.25 3.25 0 0 1 2 16.75v-9.5ZM21.5 17a1.5 1.5 0 0 1 1.5 1.5v.5c0 1.971-1.86 4-5 4-3.14 0-5-2.029-5-4v-.5a1.5 1.5 0 0 1 1.5-1.5h7ZM18 10.5a2.75 2.75 0 1 1 0 5.5 2.75 2.75 0 0 1 0-5.5Z" fill="currentColor"/></svg>',clock:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2c5.523 0 10 4.478 10 10s-4.477 10-10 10S2 17.522 2 12 6.477 2 12 2Zm0 1.667c-4.595 0-8.333 3.738-8.333 8.333 0 4.595 3.738 8.333 8.333 8.333 4.595 0 8.333-3.738 8.333-8.333 0-4.595-3.738-8.333-8.333-8.333ZM11.25 6a.75.75 0 0 1 .743.648L12 6.75V12h3.25a.75.75 0 0 1 .102 1.493l-.102.007h-4a.75.75 0 0 1-.743-.648l-.007-.102v-6a.75.75 0 0 1 .75-.75Z" fill="currentColor"/></svg>',dismiss:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m4.397 4.554.073-.084a.75.75 0 0 1 .976-.073l.084.073L12 10.939l6.47-6.47a.75.75 0 1 1 1.06 1.061L13.061 12l6.47 6.47a.75.75 0 0 1 .072.976l-.073.084a.75.75 0 0 1-.976.073l-.084-.073L12 13.061l-6.47 6.47a.75.75 0 0 1-1.06-1.061L10.939 12l-6.47-6.47a.75.75 0 0 1-.072-.976l.073-.084-.073.084Z" fill="currentColor"/></svg>',send:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5.694 12 2.299 3.272c-.236-.607.356-1.188.942-.982l.093.04 18 9a.75.75 0 0 1 .097 1.283l-.097.058-18 9a.75.75 0 0 1-1.065-.847l.03-.096L5.694 12 2.299 3.272 5.694 12ZM4.402 4.54l2.61 6.71h6.627a.75.75 0 0 1 .743.648l.007.102a.75.75 0 0 1-.649.743l-.101.007H7.01l-2.609 6.71L19.322 12 4.401 4.54Z" fill="currentColor"/></svg>',search:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 2.75a7.25 7.25 0 0 1 5.63 11.819l4.9 4.9a.75.75 0 0 1-.976 1.134l-.084-.073-4.901-4.9A7.25 7.25 0 1 1 10 2.75Zm0 1.5a5.75 5.75 0 1 0 0 11.5 5.75 5.75 0 0 0 0-11.5Z" fill="currentColor"/</svg>',more_vertical:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7.75a1.75 1.75 0 1 1 0-3.5 1.75 1.75 0 0 1 0 3.5ZM12 13.75a1.75 1.75 0 1 1 0-3.5 1.75 1.75 0 0 1 0 3.5ZM10.25 18a1.75 1.75 0 1 0 3.5 0 1.75 1.75 0 0 0-3.5 0Z" fill="currentColor"/></svg>',chevron_down:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.22 8.47a.75.75 0 0 1 1.06 0L12 15.19l6.72-6.72a.75.75 0 1 1 1.06 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L4.22 9.53a.75.75 0 0 1 0-1.06Z" fill="currentColor"/></svg>',chevron_up:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.22 15.53a.75.75 0 0 0 1.06 0L12 8.81l6.72 6.72a.75.75 0 1 0 1.06-1.06l-7.25-7.25a.75.75 0 0 0-1.06 0l-7.25 7.25a.75.75 0 0 0 0 1.06Z" fill="currentColor"/></svg>',chevron_left:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15.53 4.22a.75.75 0 0 1 0 1.06L8.81 12l6.72 6.72a.75.75 0 1 1-1.06 1.06l-7.25-7.25a.75.75 0 0 1 0-1.06l7.25-7.25a.75.75 0 0 1 1.06 0Z" fill="currentColor"/></svg>',chevron_right:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.47 4.22a.75.75 0 0 0 0 1.06L15.19 12l-6.72 6.72a.75.75 0 1 0 1.06 1.06l7.25-7.25a.75.75 0 0 0 0-1.06L9.53 4.22a.75.75 0 0 0-1.06 0Z" fill="currentColor"/></svg>',settings:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12.012 2.25c.734.008 1.465.093 2.182.253a.75.75 0 0 1 .582.649l.17 1.527a1.384 1.384 0 0 0 1.927 1.116l1.401-.615a.75.75 0 0 1 .85.174 9.792 9.792 0 0 1 2.204 3.792.75.75 0 0 1-.271.825l-1.242.916a1.381 1.381 0 0 0 0 2.226l1.243.915a.75.75 0 0 1 .272.826 9.797 9.797 0 0 1-2.204 3.792.75.75 0 0 1-.848.175l-1.407-.617a1.38 1.38 0 0 0-1.926 1.114l-.169 1.526a.75.75 0 0 1-.572.647 9.518 9.518 0 0 1-4.406 0 .75.75 0 0 1-.572-.647l-.168-1.524a1.382 1.382 0 0 0-1.926-1.11l-1.406.616a.75.75 0 0 1-.849-.175 9.798 9.798 0 0 1-2.204-3.796.75.75 0 0 1 .272-.826l1.243-.916a1.38 1.38 0 0 0 0-2.226l-1.243-.914a.75.75 0 0 1-.271-.826 9.793 9.793 0 0 1 2.204-3.792.75.75 0 0 1 .85-.174l1.4.615a1.387 1.387 0 0 0 1.93-1.118l.17-1.526a.75.75 0 0 1 .583-.65c.717-.159 1.45-.243 2.201-.252Zm0 1.5a9.135 9.135 0 0 0-1.354.117l-.109.977A2.886 2.886 0 0 1 6.525 7.17l-.898-.394a8.293 8.293 0 0 0-1.348 2.317l.798.587a2.881 2.881 0 0 1 0 4.643l-.799.588c.32.842.776 1.626 1.348 2.322l.905-.397a2.882 2.882 0 0 1 4.017 2.318l.11.984c.889.15 1.798.15 2.687 0l.11-.984a2.881 2.881 0 0 1 4.018-2.322l.905.396a8.296 8.296 0 0 0 1.347-2.318l-.798-.588a2.881 2.881 0 0 1 0-4.643l.796-.587a8.293 8.293 0 0 0-1.348-2.317l-.896.393a2.884 2.884 0 0 1-4.023-2.324l-.11-.976a8.988 8.988 0 0 0-1.333-.117ZM12 8.25a3.75 3.75 0 1 1 0 7.5 3.75 3.75 0 0 1 0-7.5Zm0 1.5a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z" fill="currentColor"/></svg>',wifi:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17.745 10.75a8.291 8.291 0 0 1 1.492 2.07.75.75 0 1 1-1.335.683 6.798 6.798 0 0 0-1.218-1.692 6.562 6.562 0 0 0-10.493 1.673.75.75 0 1 1-1.339-.677 8.062 8.062 0 0 1 12.893-2.057Zm-2.102 3.07c.448.447.816.997 1.072 1.582a.75.75 0 1 1-1.373.602 3.72 3.72 0 0 0-.76-1.124 3.592 3.592 0 0 0-5.08 0c-.31.31-.562.689-.746 1.11a.75.75 0 1 1-1.375-.6 5.11 5.11 0 0 1 1.061-1.57 5.092 5.092 0 0 1 7.201 0Zm4.805-5.541c.51.509.99 1.09 1.409 1.697a.75.75 0 0 1-1.235.852 10.822 10.822 0 0 0-1.234-1.489c-4.08-4.08-10.695-4.08-14.776 0-.421.422-.84.934-1.222 1.484a.75.75 0 0 1-1.232-.855c.43-.62.905-1.2 1.394-1.69 4.666-4.665 12.23-4.665 16.896 0Zm-7.387 8.16a1.5 1.5 0 1 1-2.122 2.122 1.5 1.5 0 0 1 2.122-2.122Z" fill="currentColor"/></svg>',speaker:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M15 4.25c0-1.079-1.274-1.65-2.08-.934L8.427 7.309a.75.75 0 0 1-.498.19H4.25A2.25 2.25 0 0 0 2 9.749v4.497a2.25 2.25 0 0 0 2.25 2.25h3.68a.75.75 0 0 1 .498.19l4.491 3.994c.806.716 2.081.144 2.081-.934V4.25ZM9.425 8.43 13.5 4.807v14.382l-4.075-3.624a2.25 2.25 0 0 0-1.495-.569H4.25a.75.75 0 0 1-.75-.75V9.75a.75.75 0 0 1 .75-.75h3.68a2.25 2.25 0 0 0 1.495-.569ZM18.992 5.897a.75.75 0 0 1 1.049.157A9.959 9.959 0 0 1 22 12a9.96 9.96 0 0 1-1.96 5.946.75.75 0 0 1-1.205-.892A8.459 8.459 0 0 0 20.5 12a8.459 8.459 0 0 0-1.665-5.054.75.75 0 0 1 .157-1.049Z" /><path d="M17.143 8.37a.75.75 0 0 1 1.017.302c.536.99.84 2.125.84 3.328a6.973 6.973 0 0 1-.84 3.328.75.75 0 0 1-1.32-.714c.42-.777.66-1.666.66-2.614s-.24-1.837-.66-2.614a.75.75 0 0 1 .303-1.017Z"/></svg>',speaker_off:'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><path d="M3.28 2.22a.75.75 0 1 0-1.06 1.06L6.438 7.5H4.25A2.25 2.25 0 0 0 2 9.749v4.497a2.25 2.25 0 0 0 2.25 2.25h3.68a.75.75 0 0 1 .498.19l4.491 3.994c.806.716 2.081.144 2.081-.934V16.06l5.72 5.72a.75.75 0 0 0 1.06-1.061L3.28 2.22ZM13.5 14.56v4.629l-4.075-3.624a2.25 2.25 0 0 0-1.495-.569H4.25a.75.75 0 0 1-.75-.75V9.75a.75.75 0 0 1 .75-.75h3.688L13.5 14.56ZM13.5 4.807v5.511l1.5 1.5V4.25c0-1.079-1.274-1.65-2.08-.934l-3.4 3.022 1.063 1.063L13.5 4.807ZM17.141 13.96l1.138 1.137A6.974 6.974 0 0 0 19 12a6.973 6.973 0 0 0-.84-3.328.75.75 0 0 0-1.32.714c.42.777.66 1.666.66 2.614 0 .691-.127 1.351-.359 1.96ZM19.388 16.206l1.093 1.094A9.955 9.955 0 0 0 22 12a9.959 9.959 0 0 0-1.96-5.946.75.75 0 0 0-1.205.892A8.46 8.46 0 0 1 20.5 12a8.458 8.458 0 0 1-1.112 4.206Z"/></svg>',download:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.25 20.5a.75.75 0 1 1 0 1.5l-13 .004a.75.75 0 1 1 0-1.5l13-.004ZM11.648 2.012l.102-.007a.75.75 0 0 1 .743.648l.007.102-.001 13.685 3.722-3.72a.75.75 0 0 1 .976-.073l.085.073a.75.75 0 0 1 .072.976l-.073.084-4.997 4.997a.75.75 0 0 1-.976.073l-.085-.073-5.003-4.996a.75.75 0 0 1 .976-1.134l.084.072 3.719 3.714L11 2.755a.75.75 0 0 1 .648-.743l.102-.007-.102.007Z" fill="currentColor"/></svg>',full_screen_maximize:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.5 5.75c0-.69.56-1.25 1.25-1.25h2a.75.75 0 0 0 0-1.5h-2A2.75 2.75 0 0 0 3 5.75v2a.75.75 0 0 0 1.5 0v-2ZM4.5 18.25c0 .69.56 1.25 1.25 1.25h2a.75.75 0 0 1 0 1.5h-2A2.75 2.75 0 0 1 3 18.25v-2a.75.75 0 0 1 1.5 0v2ZM18.25 4.5c.69 0 1.25.56 1.25 1.25v2a.75.75 0 0 0 1.5 0v-2A2.75 2.75 0 0 0 18.25 3h-2a.75.75 0 0 0 0 1.5h2ZM19.5 18.25c0 .69-.56 1.25-1.25 1.25h-2a.75.75 0 0 0 0 1.5h2A2.75 2.75 0 0 0 21 18.25v-2a.75.75 0 0 0-1.5 0v2Z" fill="currentColor"/></svg>',full_screen_minimize:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.5 3.75a.75.75 0 0 0-1.5 0v2.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 0 0 1.5h2.5A2.25 2.25 0 0 0 8.5 6.25v-2.5ZM8.5 20.25a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 0-.75-.75h-2.5a.75.75 0 0 1 0-1.5h2.5a2.25 2.25 0 0 1 2.25 2.25v2.5ZM16.25 3a.75.75 0 0 0-.75.75v2.5a2.25 2.25 0 0 0 2.25 2.25h2.5a.75.75 0 0 0 0-1.5h-2.5a.75.75 0 0 1-.75-.75v-2.5a.75.75 0 0 0-.75-.75ZM15.5 20.25a.75.75 0 0 0 1.5 0v-2.5a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 0 0-1.5h-2.5a2.25 2.25 0 0 0-2.25 2.25v2.5Z" fill="currentColor"/></svg>',copy:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5.503 4.627 5.5 6.75v10.504a3.25 3.25 0 0 0 3.25 3.25h8.616a2.251 2.251 0 0 1-2.122 1.5H8.75A4.75 4.75 0 0 1 4 17.254V6.75c0-.98.627-1.815 1.503-2.123ZM17.75 2A2.25 2.25 0 0 1 20 4.25v13a2.25 2.25 0 0 1-2.25 2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-13A2.25 2.25 0 0 1 8.75 2h9Zm0 1.5h-9a.75.75 0 0 0-.75.75v13c0 .414.336.75.75.75h9a.75.75 0 0 0 .75-.75v-13a.75.75 0 0 0-.75-.75Z" fill="currentColor"/></svg>',attach:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M11.772 3.743a6 6 0 0 1 8.66 8.302l-.19.197-8.8 8.798-.036.03a3.723 3.723 0 0 1-5.489-4.973.764.764 0 0 1 .085-.13l.054-.06.086-.088.142-.148.002.003 7.436-7.454a.75.75 0 0 1 .977-.074l.084.073a.75.75 0 0 1 .074.976l-.073.084-7.594 7.613a2.23 2.23 0 0 0 3.174 3.106l8.832-8.83A4.502 4.502 0 0 0 13 4.644l-.168.16-.013.014-9.536 9.536a.75.75 0 0 1-1.133-.977l.072-.084 9.549-9.55h.002Z" fill="currentColor"/></svg>',image:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17.75 3A3.25 3.25 0 0 1 21 6.25v11.5A3.25 3.25 0 0 1 17.75 21H6.25A3.25 3.25 0 0 1 3 17.75V6.25A3.25 3.25 0 0 1 6.25 3h11.5Zm.58 16.401-5.805-5.686a.75.75 0 0 0-.966-.071l-.084.07-5.807 5.687c.182.064.378.099.582.099h11.5c.203 0 .399-.035.58-.099l-5.805-5.686L18.33 19.4ZM17.75 4.5H6.25A1.75 1.75 0 0 0 4.5 6.25v11.5c0 .208.036.408.103.594l5.823-5.701a2.25 2.25 0 0 1 3.02-.116l.128.116 5.822 5.702c.067-.186.104-.386.104-.595V6.25a1.75 1.75 0 0 0-1.75-1.75Zm-2.498 2a2.252 2.252 0 1 1 0 4.504 2.252 2.252 0 0 1 0-4.504Zm0 1.5a.752.752 0 1 0 0 1.504.752.752 0 0 0 0-1.504Z" fill="currentColor"/></svg>',emoji_multiple:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.5 2a6.503 6.503 0 0 1 6.312 4.943c-.515.01-1.02.068-1.506.171a5 5 0 1 0-6.191 6.191 8.053 8.053 0 0 0-.172 1.507A6.5 6.5 0 0 1 8.5 2Zm.16 8.006c.355-.451.759-.864 1.202-1.23a3.5 3.5 0 0 0-4.022.95.75.75 0 1 0 1.14.974 2 2 0 0 1 1.68-.694ZM7.5 6.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0Zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0Zm1 8a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm5.458 2.042a.75.75 0 0 1 .082 1.058 4 4 0 0 1-6.075.005.75.75 0 0 1 1.138-.977 2.499 2.499 0 0 0 3.797-.003.75.75 0 0 1 1.058-.083ZM17.5 14.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2ZM15 22a7 7 0 1 0 0-14 7 7 0 0 0 0 14Zm0-1.5a5.5 5.5 0 1 1 0-11 5.5 5.5 0 0 1 0 11Z" fill="currentColor"/></svg>',image_off:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.28 2.22a.75.75 0 1 0-1.06 1.06l1.263 1.264A3.235 3.235 0 0 0 3 6.25v11.5A3.25 3.25 0 0 0 6.25 21h11.5c.626 0 1.21-.177 1.706-.483l1.263 1.264a.75.75 0 0 0 1.061-1.061L3.28 2.22Zm8.788 10.909 6.206 6.206.056.066a1.746 1.746 0 0 1-.58.099H6.25c-.204 0-.4-.035-.582-.099l5.807-5.686.593-.586Zm-.95-.95a2.245 2.245 0 0 0-.692.464l-5.823 5.7a1.747 1.747 0 0 1-.103-.593V6.25c0-.206.036-.404.101-.588l6.518 6.518ZM19.5 16.318V6.25a1.75 1.75 0 0 0-1.75-1.75H7.682L6.182 3H17.75A3.25 3.25 0 0 1 21 6.25v11.568l-1.5-1.5Z" fill="currentColor"/><path d="M15.252 6.5a2.252 2.252 0 1 1 0 4.504 2.252 2.252 0 0 1 0-4.504Zm0 1.5a.752.752 0 1 0 0 1.504.752.752 0 0 0 0-1.504Z" fill="currentColor"/></svg>',disconnected:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.28 2.22a.75.75 0 0 0-1.06 1.06l3.364 3.365a11.99 11.99 0 0 0-2.033 1.634c-.49.489-.964 1.069-1.394 1.689a.75.75 0 1 0 1.233.855c.381-.55.8-1.062 1.222-1.484a10.468 10.468 0 0 1 2.063-1.604l1.591 1.592a8.062 8.062 0 0 0-1.923 1.424c-.61.61-1.109 1.3-1.491 2.056a.75.75 0 1 0 1.338.677 6.51 6.51 0 0 1 1.214-1.673 6.546 6.546 0 0 1 1.984-1.362l1.93 1.93a5.07 5.07 0 0 0-2.876 1.44 5.11 5.11 0 0 0-1.061 1.57.75.75 0 0 0 1.374.602c.185-.422.437-.8.747-1.111a3.59 3.59 0 0 1 3.36-.958l7.858 7.858a.75.75 0 0 0 1.06-1.06L3.28 2.22Zm8.304 6.182 1.584 1.584a6.532 6.532 0 0 1 3.516 1.825 6.798 6.798 0 0 1 1.217 1.692.75.75 0 1 0 1.336-.683 8.292 8.292 0 0 0-1.492-2.07 8.042 8.042 0 0 0-6.16-2.348ZM8.487 5.305 9.713 6.53a10.44 10.44 0 0 1 10.908 4.297.75.75 0 1 0 1.235-.852 11.946 11.946 0 0 0-13.369-4.67Zm4.573 11.134a1.5 1.5 0 1 1-2.121 2.122 1.5 1.5 0 0 1 2.121-2.122Z" fill="currentColor"/></svg>',wand:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m13.314 7.565-.136.126-10.48 10.488a2.27 2.27 0 0 0 3.211 3.208L16.388 10.9a2.251 2.251 0 0 0-.001-3.182l-.157-.146a2.25 2.25 0 0 0-2.916-.007Zm-.848 2.961 1.088 1.088-8.706 8.713a.77.77 0 1 1-1.089-1.088l8.707-8.713Zm4.386 4.48L16.75 15a.75.75 0 0 0-.743.648L16 15.75v.75h-.75a.75.75 0 0 0-.743.648l-.007.102c0 .38.282.694.648.743l.102.007H16v.75c0 .38.282.694.648.743l.102.007a.75.75 0 0 0 .743-.648l.007-.102V18h.75a.75.75 0 0 0 .743-.648L19 17.25a.75.75 0 0 0-.648-.743l-.102-.007h-.75v-.75a.75.75 0 0 0-.648-.743L16.75 15l.102.007Zm-1.553-6.254.027.027a.751.751 0 0 1 0 1.061l-.711.713-1.089-1.089.73-.73a.75.75 0 0 1 1.043.018ZM6.852 5.007 6.75 5a.75.75 0 0 0-.743.648L6 5.75v.75h-.75a.75.75 0 0 0-.743.648L4.5 7.25c0 .38.282.693.648.743L5.25 8H6v.75c0 .38.282.693.648.743l.102.007a.75.75 0 0 0 .743-.648L7.5 8.75V8h.75a.75.75 0 0 0 .743-.648L9 7.25a.75.75 0 0 0-.648-.743L8.25 6.5H7.5v-.75a.75.75 0 0 0-.648-.743L6.75 5l.102.007Zm12-2L18.75 3a.75.75 0 0 0-.743.648L18 3.75v.75h-.75a.75.75 0 0 0-.743.648l-.007.102c0 .38.282.693.648.743L17.25 6H18v.75c0 .38.282.693.648.743l.102.007a.75.75 0 0 0 .743-.648l.007-.102V6h.75a.75.75 0 0 0 .743-.648L21 5.25a.75.75 0 0 0-.648-.743L20.25 4.5h-.75v-.75a.75.75 0 0 0-.648-.743L18.75 3l.102.007Z" fill="currentColor"/></svg>',recording:'<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24"><path d="M12 18a6 6 0 1 0 0-12 6 6 0 0 0 0 12Z"/><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2ZM3.5 12a8.5 8.5 0 1 1 17 0 8.5 8.5 0 0 1-17 0Z"/></svg>',subtract:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.755 12.5h16.492a.75.75 0 0 0 0-1.5H3.755a.75.75 0 0 0 0 1.5Z" fill="currentColor"/></svg>',stop_recording:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3.5C9.74566 3.5 7.58365 4.39553 5.98959 5.98959C4.39553 7.58365 3.5 9.74566 3.5 12C3.5 14.2543 4.39553 16.4163 5.98959 18.0104C7.58365 19.6045 9.74566 20.5 12 20.5C14.2543 20.5 16.4163 19.6045 18.0104 18.0104C19.6045 16.4163 20.5 14.2543 20.5 12C20.5 9.74566 19.6045 7.58365 18.0104 5.98959C16.4163 4.39553 14.2543 3.5 12 3.5ZM2 12C2 6.477 6.477 2 12 2C17.523 2 22 6.477 22 12C22 17.523 17.523 22 12 22C6.477 22 2 17.523 2 12ZM8 9.5C8 9.10218 8.15804 8.72064 8.43934 8.43934C8.72064 8.15804 9.10218 8 9.5 8H14.5C14.8978 8 15.2794 8.15804 15.5607 8.43934C15.842 8.72064 16 9.10218 16 9.5V14.5C16 14.8978 15.842 15.2794 15.5607 15.5607C15.2794 15.842 14.8978 16 14.5 16H9.5C9.10218 16 8.72064 15.842 8.43934 15.5607C8.15804 15.2794 8 14.8978 8 14.5V9.5Z" fill="currentColor"/></svg>',warning:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10.91 2.782a2.25 2.25 0 0 1 2.975.74l.083.138 7.759 14.009a2.25 2.25 0 0 1-1.814 3.334l-.154.006H4.243a2.25 2.25 0 0 1-2.041-3.197l.072-.143L10.031 3.66a2.25 2.25 0 0 1 .878-.878Zm9.505 15.613-7.76-14.008a.75.75 0 0 0-1.254-.088l-.057.088-7.757 14.008a.75.75 0 0 0 .561 1.108l.095.006h15.516a.75.75 0 0 0 .696-1.028l-.04-.086-7.76-14.008 7.76 14.008ZM12 16.002a.999.999 0 1 1 0 1.997.999.999 0 0 1 0-1.997ZM11.995 8.5a.75.75 0 0 1 .744.647l.007.102.004 4.502a.75.75 0 0 1-1.494.103l-.006-.102-.004-4.502a.75.75 0 0 1 .75-.75Z" fill="currentColor"/></svg>',pin:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m16.242 2.932 4.826 4.826a2.75 2.75 0 0 1-.715 4.404l-4.87 2.435a.75.75 0 0 0-.374.426l-1.44 4.166a1.25 1.25 0 0 1-2.065.476L8.5 16.561 4.06 21H3v-1.06l4.44-4.44-3.105-3.104a1.25 1.25 0 0 1 .476-2.066l4.166-1.44a.75.75 0 0 0 .426-.373l2.435-4.87a2.75 2.75 0 0 1 4.405-.715Zm3.766 5.886-4.826-4.826a1.25 1.25 0 0 0-2.002.325l-2.435 4.871a2.25 2.25 0 0 1-1.278 1.12l-3.789 1.31 6.705 6.704 1.308-3.789a2.25 2.25 0 0 1 1.12-1.277l4.872-2.436a1.25 1.25 0 0 0 .325-2.002Z" fill="currentColor"/></svg>',pin_off:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.28 2.22a.75.75 0 0 0-1.06 1.06l5.905 5.905L4.81 10.33a1.25 1.25 0 0 0-.476 2.065L7.439 15.5 3 19.94V21h1.06l4.44-4.44 3.105 3.105a1.25 1.25 0 0 0 2.065-.476l1.145-3.313 5.905 5.904a.75.75 0 0 0 1.06-1.06L3.28 2.22Zm10.355 12.476-1.252 3.626-6.705-6.705 3.626-1.252 4.331 4.331Zm6.048-3.876-3.787 1.894 1.118 1.118 3.34-1.67a2.75 2.75 0 0 0 .714-4.404l-4.825-4.826a2.75 2.75 0 0 0-4.405.715l-1.67 3.34 1.118 1.117 1.894-3.787a1.25 1.25 0 0 1 2.002-.325l4.826 4.826a1.25 1.25 0 0 1-.325 2.002Z" fill="currentColor"/></svg>',spinner:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="10" stroke-width="2" stroke="currentColor" stroke-opacity="0.2" vector-effect="non-scaling-stroke"/><path d="M22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7362 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2" stroke="currentColor" stroke-width="2" stroke-linecap="round" vector-effect="non-scaling-stroke"/></svg>',breakout_rooms:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10.5 3a2.25 2.25 0 0 1 2.25 2.25v6h6A2.25 2.25 0 0 1 21 13.5v5.25A2.25 2.25 0 0 1 18.75 21H5.25A2.25 2.25 0 0 1 3 18.75V5.25A2.25 2.25 0 0 1 5.25 3h5.25Zm.75 9.75H4.5v6c0 .414.336.75.75.75h5.999l.001-6.75Zm7.5 0h-6.001v6.75h6.001a.75.75 0 0 0 .75-.75V13.5a.75.75 0 0 0-.75-.75ZM10.5 4.5H5.25a.75.75 0 0 0-.75.75v6h6.75v-6a.75.75 0 0 0-.75-.75Zm7.398-2.493L18 2a.75.75 0 0 1 .743.648l.007.102v2.5h2.5a.75.75 0 0 1 .743.648L22 6a.75.75 0 0 1-.648.743l-.102.007h-2.5v2.5a.75.75 0 0 1-.648.743L18 10a.75.75 0 0 1-.743-.648l-.007-.102v-2.5h-2.5a.75.75 0 0 1-.743-.648L14 6a.75.75 0 0 1 .648-.743l.102-.007h2.5v-2.5a.75.75 0 0 1 .648-.743Z" fill="currentColor"/></svg>',add:'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M11.75 3a.75.75 0 0 1 .743.648l.007.102.001 7.25h7.253a.75.75 0 0 1 .102 1.493l-.102.007h-7.253l.002 7.25a.75.75 0 0 1-1.493.101l-.007-.102-.002-7.249H3.752a.75.75 0 0 1-.102-1.493L3.752 11h7.25L11 3.75a.75.75 0 0 1 .75-.75Z" fill="currentColor"/></svg>',shuffle:'<svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M14.0058 8.11111H18.7947L16.9613 9.94444C16.9095 9.99587 16.8684 10.057 16.8402 10.1243C16.812 10.1917 16.7974 10.2639 16.7971 10.3369C16.7966 10.4843 16.8547 10.6259 16.9586 10.7306C17.01 10.7823 17.0711 10.8235 17.1385 10.8517C17.2058 10.8799 17.278 10.8945 17.351 10.8947C17.4985 10.8953 17.64 10.8372 17.7447 10.7333L20.8891 7.59999L20.4947 7.20555L17.7447 4.46111C17.64 4.35723 17.4985 4.29917 17.351 4.29969C17.2036 4.30021 17.0624 4.35927 16.9586 4.46388C16.8547 4.5685 16.7966 4.71009 16.7971 4.85751C16.7977 5.00494 16.8567 5.14612 16.9613 5.24999L18.728 6.99999H13.6669C13.5699 7.00058 13.4748 7.02653 13.391 7.07526C13.3072 7.12399 13.2376 7.19381 13.1891 7.27777L11.7224 9.82777L12.3669 10.9389L14.0058 8.11111Z" fill="currentColor"/><path d="M8.15022 15.9278H3.66688C3.51954 15.9278 3.37823 15.9863 3.27405 16.0905C3.16986 16.1947 3.11133 16.336 3.11133 16.4833C3.11133 16.6307 3.16986 16.772 3.27405 16.8762C3.37823 16.9804 3.51954 17.0389 3.66688 17.0389H8.47244C8.56939 17.0383 8.6645 17.0124 8.74832 16.9636C8.83214 16.9149 8.90174 16.8451 8.95022 16.7611L10.4335 14.2222L9.77799 13.1111L8.15022 15.9278Z"/><path d="M17.7447 13.2056C17.64 13.1017 17.4985 13.0436 17.351 13.0441C17.2036 13.0447 17.0624 13.1037 16.9586 13.2083C16.8547 13.3129 16.7966 13.4545 16.7971 13.602C16.7977 13.7494 16.8567 13.8906 16.9613 13.9944L18.9058 15.9389H14.0058L8.95022 7.29444C8.90174 7.21047 8.83214 7.14066 8.74832 7.09193C8.6645 7.04319 8.56939 7.01725 8.47244 7.01666H3.66688C3.51954 7.01666 3.37823 7.07519 3.27405 7.17938C3.16986 7.28357 3.11133 7.42487 3.11133 7.57222C3.11133 7.71956 3.16986 7.86087 3.27405 7.96505C3.37823 8.06924 3.51954 8.12777 3.66688 8.12777H8.15022L13.2058 16.7667C13.2542 16.8506 13.3239 16.9204 13.4077 16.9692C13.4915 17.0179 13.5866 17.0439 13.6836 17.0444H18.6113L16.9447 18.7111C16.8929 18.7625 16.8517 18.8237 16.8235 18.891C16.7954 18.9584 16.7807 19.0306 16.7805 19.1036C16.7802 19.1766 16.7943 19.2489 16.822 19.3165C16.8497 19.384 16.8905 19.4454 16.9419 19.4972C16.9933 19.549 17.0545 19.5902 17.1218 19.6184C17.1891 19.6465 17.2614 19.6612 17.3344 19.6614C17.4074 19.6617 17.4797 19.6476 17.5472 19.6199C17.6148 19.5922 17.6762 19.5514 17.728 19.5L20.478 16.7556L20.8724 16.3611L17.7447 13.2056Z"/></svg>',edit:'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21.03 2.97a3.578 3.578 0 0 1 0 5.06L9.062 20a2.25 2.25 0 0 1-.999.58l-5.116 1.395a.75.75 0 0 1-.92-.921l1.395-5.116a2.25 2.25 0 0 1 .58-.999L15.97 2.97a3.578 3.578 0 0 1 5.06 0ZM15 6.06 5.062 16a.75.75 0 0 0-.193.333l-1.05 3.85 3.85-1.05A.75.75 0 0 0 8 18.938L17.94 9 15 6.06Zm2.03-2.03-.97.97L19 7.94l.97-.97a2.079 2.079 0 0 0-2.94-2.94Z" fill="currentColor"/></svg>',delete:'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 1.75a3.25 3.25 0 0 1 3.245 3.066L15.25 5h5.25a.75.75 0 0 1 .102 1.493L20.5 6.5h-.796l-1.28 13.02a2.75 2.75 0 0 1-2.561 2.474l-.176.006H8.313a2.75 2.75 0 0 1-2.714-2.307l-.023-.174L4.295 6.5H3.5a.75.75 0 0 1-.743-.648L2.75 5.75a.75.75 0 0 1 .648-.743L3.5 5h5.25A3.25 3.25 0 0 1 12 1.75Zm6.197 4.75H5.802l1.267 12.872a1.25 1.25 0 0 0 1.117 1.122l.127.006h7.374c.6 0 1.109-.425 1.225-1.002l.02-.126L18.196 6.5ZM13.75 9.25a.75.75 0 0 1 .743.648L14.5 10v7a.75.75 0 0 1-1.493.102L13 17v-7a.75.75 0 0 1 .75-.75Zm-3.5 0a.75.75 0 0 1 .743.648L11 10v7a.75.75 0 0 1-1.493.102L9.5 17v-7a.75.75 0 0 1 .75-.75Zm1.75-6a1.75 1.75 0 0 0-1.744 1.606L10.25 5h3.5A1.75 1.75 0 0 0 12 3.25Z" fill="currentColor"/></svg>',back:'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4.75 2a.75.75 0 0 1 .743.648l.007.102v5.69l4.574-4.56a6.41 6.41 0 0 1 8.879-.179l.186.18a6.41 6.41 0 0 1 0 9.063l-8.846 8.84a.75.75 0 0 1-1.06-1.062l8.845-8.838a4.91 4.91 0 0 0-6.766-7.112l-.178.17L6.562 9.5h5.688a.75.75 0 0 1 .743.648l.007.102a.75.75 0 0 1-.648.743L12.25 11h-7.5a.75.75 0 0 1-.743-.648L4 10.25v-7.5A.75.75 0 0 1 4.75 2Z" fill="currentColor"/></svg>',save:'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 5.75A2.75 2.75 0 0 1 5.75 3h9.964a3.25 3.25 0 0 1 2.299.952l2.035 2.035c.61.61.952 1.437.952 2.299v9.964A2.75 2.75 0 0 1 18.25 21H5.75A2.75 2.75 0 0 1 3 18.25V5.75ZM5.75 4.5c-.69 0-1.25.56-1.25 1.25v12.5c0 .69.56 1.25 1.25 1.25H6v-5.25A2.25 2.25 0 0 1 8.25 12h7.5A2.25 2.25 0 0 1 18 14.25v5.25h.25c.69 0 1.25-.56 1.25-1.25V8.286c0-.465-.184-.91-.513-1.238l-2.035-2.035a1.75 1.75 0 0 0-.952-.49V7.25a2.25 2.25 0 0 1-2.25 2.25h-4.5A2.25 2.25 0 0 1 7 7.25V4.5H5.75Zm10.75 15v-5.25a.75.75 0 0 0-.75-.75h-7.5a.75.75 0 0 0-.75.75v5.25h9Zm-8-15v2.75c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75V4.5h-6Z" fill="currentColor"/></svg>',web:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M9.99906 2.16577C14.6024 2.16577 18.3341 5.89744 18.3341 10.5008C18.3341 15.1033 14.6024 18.8349 9.99906 18.8349C5.39573 18.8349 1.66406 15.1033 1.66406 10.5008C1.66406 5.89744 5.39573 2.16577 9.99906 2.16577ZM12.4482 14.2499H7.54906C8.0924 16.2616 9.0374 17.5849 9.99823 17.5849C10.9591 17.5849 11.9041 16.2616 12.4474 14.2499H12.4482ZM6.25656 14.2499H3.98656C4.79114 15.5374 5.9867 16.5335 7.39823 17.0924C6.96323 16.4091 6.60406 15.5541 6.3399 14.5799L6.2549 14.2508L6.25656 14.2499ZM16.0107 14.2499H13.7424C13.4724 15.3624 13.0824 16.3333 12.5982 17.0924C13.9206 16.5694 15.0556 15.6617 15.8566 14.4866L16.0107 14.2508V14.2499ZM5.91073 8.83327H3.11156L3.1074 8.84744C2.9781 9.38904 2.91293 9.94396 2.91323 10.5008C2.91323 11.3808 3.07406 12.2233 3.3674 13.0008H6.01156C5.81031 11.621 5.77589 10.2221 5.90906 8.83411L5.91073 8.83327ZM12.8299 8.83327H7.16823C7.02162 10.221 7.05945 11.6221 7.28073 12.9999H12.7174C12.9386 11.6221 12.9764 10.221 12.8299 8.83327ZM16.8866 8.83327H14.0882C14.1399 9.37244 14.1674 9.93077 14.1674 10.4999C14.1687 11.3366 14.108 12.1722 13.9857 12.9999H16.6299C16.9308 12.2008 17.0844 11.3538 17.0832 10.4999C17.0832 9.92577 17.0149 9.3666 16.8866 8.83327ZM7.39906 3.90827L7.3799 3.91494C5.67441 4.59596 4.29862 5.91053 3.54073 7.58327H6.08073C6.3424 6.12327 6.7974 4.8516 7.3999 3.90827H7.39906ZM9.99906 3.41577L9.9024 3.41994C8.84906 3.5166 7.82906 5.18494 7.3574 7.58327H12.6424C12.1707 5.1916 11.1566 3.52577 10.1049 3.42077L9.99906 3.4166V3.41577ZM12.5991 3.90744L12.6882 4.05327C13.2457 4.97994 13.6691 6.19661 13.9174 7.58411H16.4574C15.7339 5.98751 14.4463 4.71438 12.8416 4.0091L12.5991 3.90827V3.90744Z"/></svg>',checkmark:'<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="m18 6.7-8.48 8.48-3.54-3.54a.996.996 0 1 0-1.41 1.41l4.24 4.24c.39.39 1.02.39 1.41 0l9.18-9.18a.999.999 0 0 0-.01-1.42c-.37-.38-1-.38-1.39.01z"/></svg>',spotlight:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M19.745 4C20.3417 4 20.914 4.23705 21.336 4.65901C21.7579 5.08097 21.995 5.65326 21.995 6.25V12.805C21.5485 12.3774 21.0434 12.0154 20.495 11.73V6.25C20.495 6.05109 20.416 5.86032 20.2753 5.71967C20.1347 5.57902 19.9439 5.5 19.745 5.5H4.25C4.05109 5.5 3.86032 5.57902 3.71967 5.71967C3.57902 5.86032 3.5 6.05109 3.5 6.25V17.755C3.5 18.169 3.836 18.505 4.25 18.505L6.999 18.504L7 15.75C7.00002 15.3108 7.16517 14.8877 7.46268 14.5646C7.76019 14.2415 8.1683 14.0421 8.606 14.006L8.75 14H12.022C11.7223 14.4675 11.484 14.9716 11.313 15.5H8.75C8.69368 15.5001 8.63904 15.5192 8.59493 15.5542C8.55083 15.5893 8.51984 15.6382 8.507 15.693L8.5 15.75L8.499 18.504H11.077C11.1569 19.0193 11.2989 19.5229 11.5 20.004H4.25C3.65344 20.004 3.08129 19.7671 2.65936 19.3453C2.23744 18.9236 2.00027 18.3516 2 17.755V6.25C2 5.65326 2.23705 5.08097 2.65901 4.65901C3.08097 4.23705 3.65326 4 4.25 4H19.745Z"/><path d="M12 7C12.7956 7 13.5587 7.31607 14.1213 7.87868C14.6839 8.44129 15 9.20435 15 10C15 10.7956 14.6839 11.5587 14.1213 12.1213C13.5587 12.6839 12.7956 13 12 13C11.2044 13 10.4413 12.6839 9.87868 12.1213C9.31607 11.5587 9 10.7956 9 10C9 9.20435 9.31607 8.44129 9.87868 7.87868C10.4413 7.31607 11.2044 7 12 7ZM12 8.5C11.6022 8.5 11.2206 8.65804 10.9393 8.93934C10.658 9.22064 10.5 9.60218 10.5 10C10.5 10.3978 10.658 10.7794 10.9393 11.0607C11.2206 11.342 11.6022 11.5 12 11.5C12.3978 11.5 12.7794 11.342 13.0607 11.0607C13.342 10.7794 13.5 10.3978 13.5 10C13.5 9.60218 13.342 9.22064 13.0607 8.93934C12.7794 8.65804 12.3978 8.5 12 8.5Z"/><path d="M23 17.5C23 18.9587 22.4205 20.3576 21.3891 21.3891C20.3576 22.4205 18.9587 23 17.5 23C16.0413 23 14.6424 22.4205 13.6109 21.3891C12.5795 20.3576 12 18.9587 12 17.5C12 16.0413 12.5795 14.6424 13.6109 13.6109C14.6424 12.5795 16.0413 12 17.5 12C18.9587 12 20.3576 12.5795 21.3891 13.6109C22.4205 14.6424 23 16.0413 23 17.5ZM18.055 14.42C18.0207 14.2993 17.9479 14.193 17.8478 14.1174C17.7476 14.0417 17.6255 14.0008 17.5 14.0008C17.3745 14.0008 17.2524 14.0417 17.1522 14.1174C17.0521 14.193 16.9793 14.2993 16.945 14.42L16.388 16.208H14.585C14.019 16.208 13.785 16.962 14.242 17.308L15.7 18.413L15.143 20.2C14.968 20.761 15.584 21.228 16.042 20.881L17.5 19.777L18.958 20.881C19.416 21.228 20.032 20.761 19.857 20.201L19.3 18.413L20.758 17.309C21.216 16.962 20.981 16.208 20.415 16.208H18.612L18.055 14.421V14.42Z"/></svg>',join_stage:'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><path d="M17.5 22C14.4618 22 12 19.5376 12 16.5C12 13.4623 14.4618 11 17.5 11C20.5371 11 23 13.4624 23 16.5C23 19.5376 20.5371 22 17.5 22ZM17.0704 18.992L17.1167 19.0322C17.1868 19.0841 17.2716 19.1125 17.3588 19.1132C17.4461 19.1139 17.5314 19.0869 17.6023 19.036L17.654 18.992L17.6936 18.9458C17.7455 18.8757 17.7739 18.7909 17.7746 18.7037C17.7753 18.6164 17.7483 18.5311 17.6975 18.4602L17.6535 18.4085L16.158 16.9125H19.8375L19.8936 16.9092C19.9829 16.8969 20.0657 16.8558 20.1293 16.792C20.193 16.7282 20.234 16.6454 20.2462 16.5561L20.25 16.5005L20.2462 16.4444C20.2339 16.3553 20.1928 16.2725 20.1292 16.2089C20.0655 16.1452 19.9828 16.1041 19.8936 16.0919L19.8375 16.088H16.158L17.654 14.592L17.6941 14.5453C17.7537 14.4659 17.7827 14.3676 17.7756 14.2686C17.7686 14.1695 17.726 14.0763 17.6558 14.0061C17.5856 13.9359 17.4924 13.8934 17.3934 13.8863C17.2943 13.8793 17.1961 13.9082 17.1167 13.9678L17.071 14.0079L14.8699 16.2079L14.8303 16.2547C14.7784 16.3247 14.75 16.4094 14.7493 16.4965C14.7485 16.5837 14.7753 16.6688 14.8259 16.7398L14.8699 16.7915L17.0704 18.992Z"/><path d="M2.80546 3.80546C2.28973 4.32118 2 5.02065 2 5.75V16.25C2 16.6111 2.07113 16.9687 2.20933 17.3024C2.34753 17.636 2.5501 17.9392 2.80546 18.1945C3.06082 18.4499 3.36398 18.6525 3.69762 18.7907C4.03127 18.9289 4.38886 19 4.75 19H11.498C11.3 18.526 11.157 18.023 11.076 17.5H9.002V14.75C9.002 14.6837 9.02834 14.6201 9.07522 14.5732C9.12211 14.5263 9.1857 14.5 9.252 14.5H11.3135C11.4858 13.9665 11.7253 13.4632 12.0218 13H9.252C8.285 13 7.502 13.784 7.502 14.75V16H7.5V17.5H4.75C4.06 17.5 3.5 16.94 3.5 16.25V5.75C3.5 5.06 4.06 4.5 4.75 4.5H19.25C19.94 4.5 20.5 5.06 20.5 5.75V10.732C20.6457 10.808 20.7884 10.8895 20.9277 10.9762C20.9687 11.0017 21.0093 11.0276 21.0497 11.054C21.3899 11.2762 21.708 11.5294 22 11.8096V5.75C22 5.02065 21.7103 4.32118 21.1945 3.80546C20.6788 3.28973 19.9793 3 19.25 3H4.75C4.02065 3 3.32118 3.28973 2.80546 3.80546Z"/><path fill-rule="evenodd" clip-rule="evenodd" d="M14.4181 10.7757C14.7938 10.264 15 9.64262 15 9C15 8.20435 14.6839 7.44129 14.1213 6.87868C13.5587 6.31607 12.7956 6 12 6C11.2044 6 10.4413 6.31607 9.87868 6.87868C9.31607 7.44129 9 8.20435 9 9C9 9.79565 9.31607 10.5587 9.87868 11.1213C10.4413 11.6839 11.2044 12 12 12C12.333 12 12.6602 11.9446 12.9695 11.839C13.3992 11.4213 13.8864 11.0625 14.4181 10.7757ZM10.9393 7.93934C11.2206 7.65804 11.6022 7.5 12 7.5C12.3978 7.5 12.7794 7.65804 13.0607 7.93934C13.342 8.22064 13.5 8.60218 13.5 9C13.5 9.39782 13.342 9.77936 13.0607 10.0607C12.7794 10.342 12.3978 10.5 12 10.5C11.6022 10.5 11.2206 10.342 10.9393 10.0607C10.658 9.77936 10.5 9.39782 10.5 9C10.5 8.60218 10.658 8.22064 10.9393 7.93934Z"></svg>',leave_stage:'<svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M2.80546 3.80546C2.28973 4.32118 2 5.02065 2 5.75V16.25C2 16.6111 2.07113 16.9687 2.20933 17.3024C2.34753 17.636 2.5501 17.9392 2.80546 18.1945C3.06082 18.4499 3.36398 18.6525 3.69762 18.7907C4.03127 18.9289 4.38886 19 4.75 19H11.498C11.3 18.526 11.157 18.023 11.076 17.5H9.002V14.75C9.002 14.6837 9.02834 14.6201 9.07522 14.5732C9.12211 14.5263 9.1857 14.5 9.252 14.5H11.3135C11.4858 13.9665 11.7253 13.4632 12.0218 13H9.252C8.285 13 7.502 13.784 7.502 14.75V16H7.5V17.5H4.75C4.06 17.5 3.5 16.94 3.5 16.25V5.75C3.5 5.06 4.06 4.5 4.75 4.5H19.25C19.94 4.5 20.5 5.06 20.5 5.75V10.732C20.6457 10.808 20.7884 10.8895 20.9277 10.9762C20.9687 11.0017 21.0093 11.0276 21.0497 11.054C21.3899 11.2762 21.708 11.5294 22 11.8096V5.75C22 5.02065 21.7103 4.32118 21.1945 3.80546C20.6788 3.28973 19.9793 3 19.25 3H4.75C4.02065 3 3.32118 3.28973 2.80546 3.80546Z"/><path fill-rule="evenodd" clip-rule="evenodd" d="M14.4181 10.7757C14.7938 10.264 15 9.64262 15 9C15 8.20435 14.6839 7.44129 14.1213 6.87868C13.5587 6.31607 12.7956 6 12 6C11.2044 6 10.4413 6.31607 9.87868 6.87868C9.31607 7.44129 9 8.20435 9 9C9 9.79565 9.31607 10.5587 9.87868 11.1213C10.4413 11.6839 11.2044 12 12 12C12.333 12 12.6602 11.9446 12.9695 11.839C13.3992 11.4213 13.8864 11.0625 14.4181 10.7757ZM10.9393 7.93934C11.2206 7.65804 11.6022 7.5 12 7.5C12.3978 7.5 12.7794 7.65804 13.0607 7.93934C13.342 8.22064 13.5 8.60218 13.5 9C13.5 9.39782 13.342 9.77936 13.0607 10.0607C12.7794 10.342 12.3978 10.5 12 10.5C11.6022 10.5 11.2206 10.342 10.9393 10.0607C10.658 9.77936 10.5 9.39782 10.5 9C10.5 8.60218 10.658 8.22064 10.9393 7.93934Z"/><path d="M17.5 11C20.5382 11 23 13.4624 23 16.5C23 19.5377 20.5382 22 17.5 22C14.4629 22 12 19.5377 12 16.5C12 13.4624 14.4629 11 17.5 11V11ZM17.9296 14.0079L17.8833 13.9678C17.8132 13.9159 17.7284 13.8875 17.6412 13.8868C17.5539 13.8861 17.4686 13.9131 17.3977 13.964L17.346 14.0079L17.3064 14.0542C17.2545 14.1243 17.2261 14.2091 17.2254 14.2963C17.2247 14.3836 17.2517 14.4689 17.3026 14.5398L17.3465 14.5915L18.842 16.0875H15.1625L15.1064 16.0908C15.0171 16.1031 14.9343 16.1442 14.8707 16.208C14.807 16.2718 14.766 16.3546 14.7539 16.4439L14.75 16.4995L14.7539 16.5556C14.7661 16.6447 14.8072 16.7275 14.8708 16.7911C14.9345 16.8548 15.0172 16.8959 15.1064 16.9081L15.1625 16.912H18.842L17.346 18.408L17.3059 18.4547C17.2463 18.5341 17.2173 18.6324 17.2244 18.7314C17.2314 18.8305 17.274 18.9237 17.3442 18.9939C17.4144 19.0641 17.5076 19.1066 17.6066 19.1137C17.7057 19.1207 17.8039 19.0918 17.8833 19.0322L17.929 18.9921L20.1301 16.7921L20.1697 16.7453C20.2216 16.6753 20.25 16.5906 20.2507 16.5035C20.2515 16.4163 20.2247 16.3312 20.1741 16.2602L20.1301 16.2085L17.9301 14.0079L17.8833 13.9678L17.9296 14.0079V14.0079Z"/></svg>',pip_off:'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.8666 12.3058C11.0731 12.3058 11.2404 12.1385 11.2404 11.932V8.56753C11.2404 8.36107 11.0731 8.1937 10.8666 8.1937C10.6601 8.1937 10.4928 8.36107 10.4928 8.56753V11.0295L6.45393 6.99066C6.30794 6.84467 6.07124 6.84467 5.92525 6.99066C5.77926 7.13665 5.77926 7.37335 5.92525 7.51934L9.9641 11.5582L7.50212 11.5582C7.29566 11.5582 7.12829 11.7256 7.12829 11.932C7.12829 12.1385 7.29566 12.3058 7.50212 12.3058L10.8666 12.3058ZM5.73832 19.8879C3.6737 19.8879 2 18.2141 2 16.1495V7.73832C2 5.6737 3.6737 4 5.73832 4H18.2617C20.3263 4 22 5.6737 22 7.73832L22 13.0269C22 12.2687 21.6002 11.6038 21 11.2316C20.8468 11.1366 20.6806 11.0607 20.5047 11.0071V7.73832C20.5047 6.49955 19.5005 5.49533 18.2617 5.49533H5.73832C4.49955 5.49533 3.49533 6.49955 3.49533 7.73832V16.1495C3.49533 17.3883 4.49955 18.3925 5.73832 18.3925H10.7971C10.8506 18.5685 10.9266 18.7347 11.0216 18.8879C11.3938 19.4881 12.0587 19.8879 12.8169 19.8879H5.73832Z"/><path fill-rule="evenodd" clip-rule="evenodd" d="M19.7265 12.5H13.3911C12.899 12.5 12.5 12.899 12.5 13.3911V17.6462C12.5 18.1384 12.899 18.5374 13.3911 18.5374H19.7265C20.2187 18.5374 20.6176 18.1384 20.6176 17.6462V13.3911C20.6176 12.899 20.2187 12.5 19.7265 12.5ZM13.3911 11.5C12.3467 11.5 11.5 12.3467 11.5 13.3911V17.6462C11.5 18.6907 12.3467 19.5374 13.3911 19.5374H19.7265C20.771 19.5374 21.6176 18.6907 21.6176 17.6462V13.3911C21.6176 12.3467 20.771 11.5 19.7265 11.5H13.3911Z"/></svg>',pip_on:'<svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M5.73832 19.8879C3.6737 19.8879 2 18.2141 2 16.1495V7.73832C2 5.6737 3.6737 4 5.73832 4H18.2617C20.3263 4 22 5.6737 22 7.73832L22 13.0269C22 12.2687 21.6002 11.6038 21 11.2316C20.8468 11.1366 20.6806 11.0607 20.5047 11.0071V7.73832C20.5047 6.49955 19.5005 5.49533 18.2617 5.49533H5.73832C4.49955 5.49533 3.49533 6.49955 3.49533 7.73832V16.1495C3.49533 17.3883 4.49955 18.3925 5.73832 18.3925H10.7971C10.8506 18.5685 10.9266 18.7347 11.0216 18.8879C11.3938 19.4881 12.0587 19.8879 12.8169 19.8879H5.73832Z"/><path fill-rule="evenodd" clip-rule="evenodd" d="M19.7265 12.5H13.3911C12.899 12.5 12.5 12.899 12.5 13.3911V17.6462C12.5 18.1384 12.899 18.5374 13.3911 18.5374H19.7265C20.2187 18.5374 20.6176 18.1384 20.6176 17.6462V13.3911C20.6176 12.899 20.2187 12.5 19.7265 12.5ZM13.3911 11.5C12.3467 11.5 11.5 12.3467 11.5 13.3911V17.6462C11.5 18.6907 12.3467 19.5374 13.3911 19.5374H19.7265C20.771 19.5374 21.6176 18.6907 21.6176 17.6462V13.3911C21.6176 12.3467 20.771 11.5 19.7265 11.5H13.3911Z"/><path d="M6.18951 6.88123C5.98304 6.88123 5.81567 7.0486 5.81567 7.25506V10.6195C5.81567 10.826 5.98304 10.9934 6.18951 10.9934C6.39597 10.9934 6.56334 10.826 6.56334 10.6195V8.15757L10.6022 12.1964C10.7482 12.3424 10.9849 12.3424 11.1309 12.1964C11.2769 12.0504 11.2769 11.8137 11.1309 11.6677L7.09202 7.62889L9.55399 7.62889C9.76045 7.62889 9.92782 7.46152 9.92782 7.25506C9.92782 7.0486 9.76045 6.88123 9.55399 6.88123L6.18951 6.88123Z"/></svg>'},a={chat:"Chat","chat.new":"New",participants:"Participants",polls:"Polls",plugins:"Plugins",mic_off:"Mic Off",mic_on:"Mic On",video_off:"Video Off",video_on:"Video On",left_meeting:"You left the meeting",share_screen_start:"Share Screen",share_screen_stop:"Stop Sharing",leave:"Leave",dismiss:"Dismiss",page:"Page",settings:"Settings",audio:"Audio",video:"Video",connection:"Connection",leave_confirmation:"Are you sure you want to leave the call?",end_meeting_for_all:"End meeting for all",cancel:"Cancel",mute:"Mute",kick:"Kick","participant.turn_off_video":"Turn off video",perm_browser_denied:"Permission denied by browser","perm.sys_denied.message":"To enable system permission, go to Mac's System Preferences -> Security & Privacy ->  Privacy -> Select Microphone, Camera or 'Screen Recording' and allow permission for your specific browser",perm_sys_denied:"Permission denied by system",perm_denied_title:"Camera and mic permissions denied",perm_denied_text:"It seems like your browser or system has blocked permissions for us to access camera, microphone. Please allow these permissions and reload for a smoother experience.",full_screen:"Full Screen","full_screen.exit":"Exit Full Screen","waitlist.header_title":"Waiting","waitlist.body_text":"You are in the waiting room, the host will let you in soon.","waitlist.deny_request":"Deny request","waitlist.accept_request":"Accept request","waitlist.accept_all":"Accept all","stage_request.header_title":"Join Stage Requests","stage_request.deny_request":"Deny request","stage_request.accept_request":"Accept request","stage_request.accept_all":"Accept all","stage_request.deny_all":"Deny all","stage_request.approval_pending":"Pending","stage_request.denied":"Denied","stage_request.request":"Join stage","stage_request.leave_stage":"Leave stage","stage_request.request_tip":"Request to join the discussion","stage_request.leave_tip":"Leave the stage","stage_request.pending_tip":"Request pending","stage_request.denied_tip":"Rejected request","stage.empty_host":"The stage is empty","stage.empty_host_summary":"To begin the webinar, please join the stage or accept a join stage request from the participants tab.","stage.empty_viewer":"Webinar has not yet been started","stage.remove_from_stage":"Remove from stage","stage.add_to_stage":"Add to stage","stage.join_title":"Joining webinar stage","stage.join_summary":"Upon joining the stage, your video & audio as shown above will be visible to all participants.","stage.join_cancel":"Cancel","stage.join_confirm":"Confirm & Join stage","setup_screen.join_in_as":"Join in as","setup_screen.joining_as":"Joining as","setup_screen.your_name":"Your name","stage.reconnecting":"Reconnecting...",pip_on:"Show PiP",pip_off:"Hide PiP","recording.started":"This meeting is being recorded.","recording.stopped":"Recording for this meeting has been stopped.",mute_all:"Mute all","mute_all.description":"Everyone in the meeting will be muted","mute_all.header":"Are you sure?","mute_all.allow_unmute":"Allow others to unmute"}},1654:function(e,t,n){"use strict";n.d(t,{d:function(){return r}});var r={designTokens:{spacingBase:4,googleFont:"Inter"},styles:{"dyte-header":{display:"grid",height:"48px",gridTemplateColumns:"repeat(3, 1fr)",gridTemplateRows:"1fr",alignItems:"center"},"dyte-header.sm":{display:"grid",gridArea:"header",gridTemplateColumns:"repeat(2, 1fr)",gridTemplateRows:"1fr",alignItems:"center"},"div#header-left":{display:"flex",alignItems:"center",height:"48px"},"dyte-logo":{height:"26px"},"div#header-center":{display:"flex",alignItems:"center",justifyContent:"center"},"div#header-right":{display:"flex",alignItems:"center",justifyContent:"flex-end"},"dyte-stage":{display:"flex",flex:"1"},"dyte-grid":{flex:"1",height:"auto"},"dyte-controlbar":{display:"grid",height:"76px",gridTemplateColumns:"repeat(3,1fr)",gridTemplateRows:"1fr",alignItems:"center",padding:"8px"},"dyte-controlbar.sm":{display:"flex",position:"relative",backgroundColor:"rgb(var(--dyte-colors-background-1000, 0 0 0))"},"dyte-controlbar.md":{display:"flex",position:"relative",backgroundColor:"rgb(var(--dyte-colors-background-1000, 0 0 0))"},"div#controlbar-left":{display:"flex",alignItems:"center"},"div#controlbar-center":{display:"flex",alignItems:"center",justifyContent:"center"},"div#controlbar-mobile":{display:"flex",flex:"1",alignItems:"center",justifyContent:"center"},"div#controlbar-right":{display:"flex",alignItems:"center",justifyContent:"flex-end"},"dyte-settings":{width:"720px",height:"480px"},"dyte-breakout-rooms-manager":{minHeight:"400px",minWidth:"500px",maxWidth:"80%",maxHeight:"480px"},"div#more-menu":{position:"absolute",boxSizing:"border-box",top:"0",left:"0",width:"100%",transform:"translateY(-100%)",backgroundColor:"rgb(var(--dyte-colors-background-1000, 0 0 0))",padding:"16px 12px",borderRadius:"18px 18px 0 0"},"div#setupcontrols-media":{position:"absolute",bottom:"8px",right:"8px",display:"flex"},"div#setupcontrols-settings":{position:"absolute",top:"8px",right:"8px"},"dyte-meeting-title.sm":{marginLeft:"0"},"dyte-clock":{marginRight:"0"}},root:{"dyte-meeting":{state:"meeting",states:["activeSidebar"]},"dyte-meeting[meeting=waiting]":["dyte-waiting-screen"],"dyte-meeting[meeting=idle]":["dyte-idle-screen"],"dyte-meeting[meeting=setup]":["dyte-setup-screen","dyte-dialog-manager"],"dyte-meeting[meeting=joined]":["dyte-header","dyte-stage","dyte-controlbar","dyte-participants-audio","dyte-dialog-manager"],"dyte-meeting[meeting=joined].activeSidebar.sm":["dyte-header","dyte-stage","dyte-controlbar","dyte-participants-audio","dyte-dialog-manager",["dyte-sidebar",{view:"full-screen"}]],"dyte-meeting[meeting=joined].activeSidebar.md":["dyte-header","dyte-stage","dyte-controlbar","dyte-participants-audio","dyte-dialog-manager",["dyte-sidebar",{view:"full-screen"}]],"dyte-meeting[meeting=ended]":["dyte-ended-screen"],"dyte-header":{children:["div#header-left","div#header-center","div#header-right"]},"dyte-header.sm":["div#header-left","div#header-right"],"div#header-left":["dyte-logo","dyte-recording-indicator"],"div#header-center":["dyte-meeting-title"],"div#header-right":["dyte-grid-pagination","dyte-clock","dyte-participant-count"],"div#header-left.sm":["dyte-recording-indicator","dyte-meeting-title"],"dyte-stage":{states:["activeSidebar","activeBreakoutRoomGrid"],children:["dyte-grid","dyte-notifications"]},"dyte-stage.activeBreakoutRoomGrid":["dyte-breakout-room-grid","dyte-notifications"],"dyte-stage.activeBreakoutRoomGrid.activeSidebar":["dyte-breakout-room-grid","dyte-notifications",["dyte-sidebar",{view:"sidebar"}]],"dyte-stage.activeSidebar":["dyte-grid","dyte-notifications",["dyte-sidebar",{view:"sidebar"}]],"dyte-stage.activeSidebar.sm":["dyte-grid","dyte-notifications"],"dyte-grid":{states:["activeScreenShare","activePlugin","activeSpotlight"],children:["dyte-simple-grid"]},"dyte-grid.activeSpotlight":["dyte-spotlight-grid"],"dyte-grid.activeScreenShare":["dyte-mixed-grid"],"dyte-grid.activePlugin":["dyte-mixed-grid"],"dyte-grid.activeScreenShare.activeSpotlight":["dyte-mixed-grid"],"dyte-grid.activePlugin.activeSpotlight":["dyte-mixed-grid"],"dyte-grid.activePlugin.activeScreenShare.activeSpotlight":["dyte-mixed-grid"],"dyte-mixed-grid":{states:["activeSpotlight"],children:["dyte-simple-grid"]},"dyte-mixed-grid.activeSpotlight":["dyte-spotlight-grid"],"dyte-participant-tile":{state:"meeting",children:["dyte-name-tag","dyte-avatar"]},"dyte-participant-setup":{children:["dyte-avatar","div#setupcontrols-media"]},"dyte-participant-tile[meeting=setup]":{children:["dyte-avatar","div#setupcontrols-settings","div#setupcontrols-media"]},"div#setupcontrols-media":[["dyte-mic-toggle",{size:"sm"}],["dyte-camera-toggle",{size:"sm"}]],"div#setupcontrols-settings":[["dyte-settings-toggle",{size:"sm"}]],"dyte-screenshare-view":{children:["dyte-name-tag"]},"dyte-name-tag":[["dyte-audio-visualizer",{slot:"start"}]],"dyte-controlbar":{states:["activeMoreMenu"],props:{variant:"solid"},children:["div#controlbar-left","div#controlbar-center","div#controlbar-right"]},"dyte-controlbar.sm":["div#controlbar-mobile"],"dyte-controlbar.md":["div#controlbar-mobile"],"dyte-controlbar.activeMoreMenu.sm":["div#controlbar-mobile","div#more-menu"],"dyte-controlbar.activeMoreMenu.md":["div#controlbar-mobile","div#more-menu"],"div#controlbar-mobile":["dyte-mic-toggle","dyte-camera-toggle","dyte-webinar-stage-toggle","dyte-leave-button","dyte-more-toggle"],"div#more-menu":[["dyte-chat-toggle",{variant:"horizontal"}],["dyte-participants-toggle",{variant:"horizontal"}],["dyte-polls-toggle",{variant:"horizontal"}],["dyte-plugins-toggle",{variant:"horizontal"}],["dyte-fullscreen-toggle",{variant:"horizontal"}],["dyte-screen-share-toggle",{variant:"horizontal"}],["dyte-pip-toggle",{variant:"horizontal"}],["dyte-mute-all-button",{variant:"horizontal"}],["dyte-breakout-rooms-toggle",{variant:"horizontal"}],["dyte-settings-toggle",{variant:"horizontal"}]],"div#controlbar-left":["dyte-screen-share-toggle","dyte-fullscreen-toggle","dyte-pip-toggle","dyte-recording-toggle","dyte-breakout-rooms-toggle"],"div#controlbar-center":["dyte-webinar-stage-toggle","dyte-mic-toggle","dyte-camera-toggle","dyte-mute-all-button","dyte-settings-toggle","dyte-leave-button"],"div#controlbar-right":["dyte-chat-toggle","dyte-polls-toggle","dyte-participants-toggle","dyte-plugins-toggle"]},config:{notification_sounds:{participant_left:!1},participant_joined_sound_notification_limit:10,participant_chat_message_sound_notification_limit:10,videoFit:"cover"}}},4130:function(e,t,n){"use strict";n.d(t,{g:function(){return i}});var r,a={get:function(e,t,n){return function(){try{for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return Reflect.get(e,t,n).apply(e,a)}catch(o){return null}}}};try{r=new Proxy(localStorage,a)}catch(o){r=new Proxy({},a)}var i=r},325:function(e,t,n){"use strict";n.d(t,{H:function(){return E},a:function(){return X},b:function(){return de},c:function(){return R},f:function(){return ee},g:function(){return C},h:function(){return _},p:function(){return Ze},r:function(){return ge},w:function(){return Ae}});var r,a,i=n(5671),o=n(3144),s=n(7326),c=n(136),u=n(7277),l=n(8664),d=n(4165),p=n(5861),f=n(885),h=n(2982),v=null,m=!1,g=function(e){return function(){}},y="{visibility:hidden}.hydrated{visibility:inherit}",k="http://www.w3.org/1999/xlink",b={},w=function(e){return"object"===(e=typeof e)||"function"===e},_=function(e,t){for(var n=null,r=null,a=!1,i=!1,o=[],s=arguments.length,c=new Array(s>2?s-2:0),u=2;u<s;u++)c[u-2]=arguments[u];if(function t(r){for(var s=0;s<r.length;s++)n=r[s],Array.isArray(n)?t(n):null!=n&&"boolean"!==typeof n&&((a="function"!==typeof e&&!w(n))&&(n=String(n)),a&&i?o[o.length-1].$text$+=n:o.push(a?S(null,n):n),i=a)}(c),t){t.key&&(r=t.key);var l=t.className||t.class;l&&(t.class="object"!==typeof l?l:Object.keys(l).filter((function(e){return l[e]})).join(" "))}if("function"===typeof e)return e(null===t?{}:t,o,T);var d=S(e,null);return d.$attrs$=t,o.length>0&&(d.$children$=o),d.$key$=r,d},S=function(e,t){var n={$flags$:0,$tag$:e,$text$:t,$elm$:null,$children$:null,$attrs$:null,$key$:null};return n},E={},T={forEach:function(e,t){return e.map(x).forEach(t)},map:function(e,t){return e.map(x).map(t).map(Z)}},x=function(e){return{vattrs:e.$attrs$,vchildren:e.$children$,vkey:e.$key$,vname:e.$name$,vtag:e.$tag$,vtext:e.$text$}},Z=function(e){if("function"===typeof e.vtag){var t=Object.assign({},e.vattrs);return e.vkey&&(t.key=e.vkey),e.vname&&(t.name=e.vname),_.apply(void 0,[e.vtag,t].concat((0,h.Z)(e.vchildren||[])))}var n=S(e.vtag,e.vtext);return n.$attrs$=e.vattrs,n.$children$=e.vchildren,n.$key$=e.vkey,n.$name$=e.vname,n},C=function(e){return me(e).$hostElement$},R=function(e,t,n){var r=C(e);return{emit:function(e){return P(r,t,{bubbles:!!(4&n),composed:!!(2&n),cancelable:!!(1&n),detail:e})}}},P=function(e,t,n){var r=xe.ce(t,n);return e.dispatchEvent(r),r},I=new WeakMap,O=function(e,t,n){var r=Se.get(e);Ce&&n?"string"===typeof(r=r||new CSSStyleSheet)?r=t:r.replaceSync(t):r=t,Se.set(e,r)},D=function(e){var t=e.$cmpMeta$,n=e.$hostElement$,r=t.$flags$,a=g("attachStyles",t.$tagName$),i=function(e,t,n,r){var a=M(t),i=Se.get(a);if(e=11===e.nodeType?e:Te,i)if("string"===typeof i){e=e.head||e;var o,s=I.get(e);s||I.set(e,s=new Set),s.has(a)||((o=Te.createElement("style")).innerHTML=i,e.insertBefore(o,e.querySelector("link")),s&&s.add(a))}else e.adoptedStyleSheets.includes(i)||(e.adoptedStyleSheets=[].concat((0,h.Z)(e.adoptedStyleSheets),[i]));return a}(n.shadowRoot?n.shadowRoot:n.getRootNode(),t);10&r&&(n["s-sc"]=i,n.classList.add(i+"-h")),a()},M=function(e,t){return"sc-"+e.$tagName$},A=function(e,t,n,r,a,i){if(n!==r){var o=ke(e,t),s=t.toLowerCase();if("class"===t){var c=e.classList,u=L(n),l=L(r);c.remove.apply(c,(0,h.Z)(u.filter((function(e){return e&&!l.includes(e)})))),c.add.apply(c,(0,h.Z)(l.filter((function(e){return e&&!u.includes(e)}))))}else if("style"===t){for(var d in n)r&&null!=r[d]||(d.includes("-")?e.style.removeProperty(d):e.style[d]="");for(var p in r)n&&r[p]===n[p]||(p.includes("-")?e.style.setProperty(p,r[p]):e.style[p]=r[p])}else if("key"===t);else if("ref"===t)r&&r(e);else if(o||"o"!==t[0]||"n"!==t[1]){var f=w(r);if((o||f&&null!==r)&&!a)try{if(e.tagName.includes("-"))e[t]=r;else{var v=null==r?"":r;"list"===t?o=!1:null!=n&&e[t]==v||(e[t]=v)}}catch(g){}var m=!1;s!==(s=s.replace(/^xlink\:?/,""))&&(t=s,m=!0),null==r||!1===r?!1===r&&""!==e.getAttribute(t)||(m?e.removeAttributeNS(k,t):e.removeAttribute(t)):(!o||4&i||a)&&!f&&(r=!0===r?"":r,m?e.setAttributeNS(k,t,r):e.setAttribute(t,r))}else t="-"===t[2]?t.slice(3):ke(Ee,s)?s.slice(2):s[2]+t.slice(3),n&&xe.rel(e,t,n,!1),r&&xe.ael(e,t,r,!1)}},N=/\s/,L=function(e){return e?e.split(N):[]},j=function(e,t,n,r){var a=11===t.$elm$.nodeType&&t.$elm$.host?t.$elm$.host:t.$elm$,i=e&&e.$attrs$||b,o=t.$attrs$||b;for(r in i)r in o||A(a,r,i[r],void 0,n,t.$flags$);for(r in o)A(a,r,i[r],o[r],n,t.$flags$)},F=function e(t,n,a,i){var o,s,c=n.$children$[a],u=0;if(null!==c.$text$)o=c.$elm$=Te.createTextNode(c.$text$);else if(o=c.$elm$=Te.createElement(c.$tag$),j(null,c,false),null!=r&&o["s-si"]!==r&&o.classList.add(o["s-si"]=r),c.$children$)for(u=0;u<c.$children$.length;++u)(s=e(t,c,u))&&o.appendChild(s);return o},U=function(e,t,n,r,i,o){var s,c=e;for(c.shadowRoot&&c.tagName===a&&(c=c.shadowRoot);i<=o;++i)r[i]&&(s=F(null,n,i))&&(r[i].$elm$=s,c.insertBefore(s,t))},B=function(e,t,n,r,a){for(;t<=n;++t)(r=e[t])&&(a=r.$elm$,W(r),a.remove())},V=function(e,t,n,r){for(var a,i,o=0,s=0,c=0,u=0,l=t.length-1,d=t[0],p=t[l],f=r.length-1,h=r[0],v=r[f];o<=l&&s<=f;)if(null==d)d=t[++o];else if(null==p)p=t[--l];else if(null==h)h=r[++s];else if(null==v)v=r[--f];else if(H(d,h))z(d,h),d=t[++o],h=r[++s];else if(H(p,v))z(p,v),p=t[--l],v=r[--f];else if(H(d,v))z(d,v),e.insertBefore(d.$elm$,p.$elm$.nextSibling),d=t[++o],v=r[--f];else if(H(p,h))z(p,h),e.insertBefore(p.$elm$,d.$elm$),p=t[--l],h=r[++s];else{for(c=-1,u=o;u<=l;++u)if(t[u]&&null!==t[u].$key$&&t[u].$key$===h.$key$){c=u;break}c>=0?((i=t[c]).$tag$!==h.$tag$?a=F(t&&t[s],n,c):(z(i,h),t[c]=void 0,a=i.$elm$),h=r[++s]):(a=F(t&&t[s],n,s),h=r[++s]),a&&d.$elm$.parentNode.insertBefore(a,d.$elm$)}o>l?U(e,null==r[f+1]?null:r[f+1].$elm$,n,r,s,f):s>f&&B(t,o,l)},H=function(e,t){return e.$tag$===t.$tag$&&e.$key$===t.$key$},z=function(e,t){var n=t.$elm$=e.$elm$,r=e.$children$,a=t.$children$,i=t.$tag$,o=t.$text$;null===o?("slot"===i||j(e,t,false),null!==r&&null!==a?V(n,r,t,a):null!==a?(null!==e.$text$&&(n.textContent=""),U(n,null,t,a,0,a.length-1)):null!==r&&B(r,0,r.length-1)):e.$text$!==o&&(n.data=o)},W=function e(t){t.$attrs$&&t.$attrs$.ref&&t.$attrs$.ref(null),t.$children$&&t.$children$.map(e)},G=function(e,t){var n,i=e.$hostElement$,o=e.$cmpMeta$,s=e.$vnode$||S(null,null),c=(n=t)&&n.$tag$===E?t:_(null,null,t);a=i.tagName,o.$attrsToReflect$&&(c.$attrs$=c.$attrs$||{},o.$attrsToReflect$.map((function(e){var t=(0,f.Z)(e,2),n=t[0],r=t[1];return c.$attrs$[r]=i[n]}))),c.$tag$=null,c.$flags$|=4,e.$vnode$=c,c.$elm$=s.$elm$=i.shadowRoot||i,r=i["s-sc"],z(s,c)},q=function(e,t){t&&!e.$onRenderResolve$&&t["s-p"]&&t["s-p"].push(new Promise((function(t){return e.$onRenderResolve$=t})))},$=function(e,t){if(e.$flags$|=16,!(4&e.$flags$)){q(e,e.$ancestorComponent$);return Ae((function(){return K(e,t)}))}e.$flags$|=512},K=function(e,t){var n,r=g("scheduleUpdate",e.$cmpMeta$.$tagName$),a=e.$lazyInstance$;return t&&(e.$flags$|=256,e.$queuedListeners$&&(e.$queuedListeners$.map((function(e){var t=(0,f.Z)(e,2),n=t[0],r=t[1];return ne(a,n,r)})),e.$queuedListeners$=null),n=ne(a,"componentWillLoad")),r(),re(n,(function(){return J(e,a,t)}))},J=function(){var e=(0,p.Z)((0,d.Z)().mark((function e(t,n,r){var a,i,o,s,c,u;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.$hostElement$,i=g("update",t.$cmpMeta$.$tagName$),o=a["s-rc"],r&&D(t),s=g("render",t.$cmpMeta$.$tagName$),Q(t,n),o&&(o.map((function(e){return e()})),a["s-rc"]=void 0),s(),i(),c=a["s-p"],u=function(){return Y(t)},0===c.length?u():(Promise.all(c).then(u),t.$flags$|=4,c.length=0);case 12:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),Q=function(e,t,n){try{v=t,t=t.render(),e.$flags$&=-17,e.$flags$|=2,G(e,t)}catch(r){be(r,e.$hostElement$)}return v=null,null},X=function(){return v},Y=function(e){var t=e.$cmpMeta$.$tagName$,n=e.$hostElement$,r=g("postUpdate",t),a=e.$lazyInstance$,i=e.$ancestorComponent$;ne(a,"componentDidRender"),64&e.$flags$?r():(e.$flags$|=64,ae(n),ne(a,"componentDidLoad"),r(),e.$onReadyResolve$(n),i||te()),e.$onRenderResolve$&&(e.$onRenderResolve$(),e.$onRenderResolve$=void 0),512&e.$flags$&&Me((function(){return $(e,!1)})),e.$flags$&=-517},ee=function(e){var t=me(e),n=t.$hostElement$.isConnected;return n&&2===(18&t.$flags$)&&$(t,!1),n},te=function(e){ae(Te.documentElement),Me((function(){return P(Ee,"appload",{detail:{namespace:"dyte-ui-kit"}})}))},ne=function(e,t,n){if(e&&e[t])try{return e[t](n)}catch(r){be(r)}},re=function(e,t){return e&&e.then?e.then(t):t()},ae=function(e){return e.classList.add("hydrated")},ie=function(e,t,n,r){var a,i,o=me(e),s=o.$hostElement$,c=o.$instanceValues$.get(t),u=o.$flags$,l=o.$lazyInstance$;a=n,i=r.$members$[t][0],n=null==a||w(a)?a:4&i?"false"!==a&&(""===a||!!a):2&i?parseFloat(a):1&i?String(a):a;var d=Number.isNaN(c)&&Number.isNaN(n);if((!(8&u)||void 0===c)&&(n!==c&&!d)&&(o.$instanceValues$.set(t,n),l)){if(r.$watchers$&&128&u){var p=r.$watchers$[t];p&&p.map((function(e){try{l[e](n,c,t)}catch(r){be(r,s)}}))}2===(18&u)&&$(o,!1)}},oe=function(e,t,n){if(t.$members$){e.watchers&&(t.$watchers$=e.watchers);var r=Object.entries(t.$members$),a=e.prototype;if(r.map((function(e){var r=(0,f.Z)(e,2),i=r[0],o=(0,f.Z)(r[1],1)[0];(31&o||2&n&&32&o)&&Object.defineProperty(a,i,{get:function(){return e=i,me(this).$instanceValues$.get(e);var e},set:function(e){ie(this,i,e,t)},configurable:!0,enumerable:!0})})),1&n){var i=new Map;a.attributeChangedCallback=function(e,t,n){var r=this;xe.jmp((function(){var t=i.get(e);if(r.hasOwnProperty(t))n=r[t],delete r[t];else if(a.hasOwnProperty(t)&&"number"===typeof r[t]&&r[t]==n)return;r[t]=(null!==n||"boolean"!==typeof r[t])&&n}))},e.observedAttributes=r.filter((function(e){var t=(0,f.Z)(e,2);t[0];return 15&t[1][0]})).map((function(e){var n=(0,f.Z)(e,2),r=n[0],a=n[1],o=a[1]||r;return i.set(o,r),512&a[0]&&t.$attrsToReflect$.push([r,o]),o}))}}return e},se=function(){var e=(0,p.Z)((0,d.Z)().mark((function e(t,n,r,a,i){var o,s,c,u,l,p,f;return(0,d.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(32&n.$flags$)){e.next=18;break}if(n.$flags$|=32,!(i=_e(r)).then){e.next=9;break}return o=function(){},e.next=7,i;case 7:i=e.sent,o();case 9:i.isProxied||(r.$watchers$=i.watchers,oe(i,r,2),i.isProxied=!0),s=g("createInstance",r.$tagName$),n.$flags$|=8;try{new i(n)}catch(t){be(t)}n.$flags$&=-9,n.$flags$|=128,s(),ce(n.$lazyInstance$),i.style&&(c=i.style,u=M(r),Se.has(u)||(l=g("registerStyles",r.$tagName$),O(u,c,!!(1&r.$flags$)),l()));case 18:p=n.$ancestorComponent$,f=function(){return $(n,!0)},p&&p["s-rc"]?p["s-rc"].push(f):f();case 21:case"end":return e.stop()}}),e)})));return function(t,n,r,a,i){return e.apply(this,arguments)}}(),ce=function(e){ne(e,"connectedCallback")},ue=function(e){if(0===(1&xe.$flags$)){var t=me(e),n=t.$cmpMeta$,r=g("connectedCallback",n.$tagName$);if(1&t.$flags$)pe(e,t,n.$listeners$),ce(t.$lazyInstance$);else{t.$flags$|=1;for(var a=e;a=a.parentNode||a.host;)if(a["s-p"]){q(t,t.$ancestorComponent$=a);break}n.$members$&&Object.entries(n.$members$).map((function(t){var n=(0,f.Z)(t,2),r=n[0];if(31&(0,f.Z)(n[1],1)[0]&&e.hasOwnProperty(r)){var a=e[r];delete e[r],e[r]=a}})),se(e,t,n)}r()}},le=function(e){if(0===(1&xe.$flags$)){var t=me(e),n=t.$lazyInstance$;t.$rmListeners$&&(t.$rmListeners$.map((function(e){return e()})),t.$rmListeners$=void 0),ne(n,"disconnectedCallback")}},de=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=g(),a=[],d=n.exclude||[],p=Ee.customElements,f=Te.head,h=f.querySelector("meta[charset]"),v=Te.createElement("style"),m=[],k=!0;Object.assign(xe,n),xe.$resourcesUrl$=new URL(n.resourcesUrl||"./",Te.baseURI).href,e.map((function(e){e[1].map((function(n){var r={$flags$:n[0],$tagName$:n[1],$members$:n[2],$listeners$:n[3]};r.$members$=n[2],r.$listeners$=n[3],r.$attrsToReflect$=[],r.$watchers$={};var f=r.$tagName$,h=function(e){(0,c.Z)(a,e);var n=(0,u.Z)(a);function a(e){var t;return(0,i.Z)(this,a),t=n.call(this,e),e=(0,s.Z)(t),ye(e,r),1&r.$flags$&&e.attachShadow({mode:"open"}),t}return(0,o.Z)(a,[{key:"connectedCallback",value:function(){var e=this;t&&(clearTimeout(t),t=null),k?m.push(this):xe.jmp((function(){return ue(e)}))}},{key:"disconnectedCallback",value:function(){var e=this;xe.jmp((function(){return le(e)}))}},{key:"componentOnReady",value:function(){return me(this).$onReadyPromise$}}]),a}((0,l.Z)(HTMLElement));r.$lazyBundleId$=e[0],d.includes(f)||p.get(f)||(a.push(f),p.define(f,oe(h,r,1)))}))})),v.innerHTML=a+y,v.setAttribute("data-styles",""),f.insertBefore(v,h?h.nextSibling:f.firstChild),k=!1,m.length?m.map((function(e){return e.connectedCallback()})):xe.jmp((function(){return t=setTimeout(te,30)})),r()},pe=function(e,t,n,r){n&&n.map((function(n){var r=(0,f.Z)(n,3),a=r[0],i=r[1],o=r[2],s=e,c=fe(t,o),u=he(a);xe.ael(s,i,c,u),(t.$rmListeners$=t.$rmListeners$||[]).push((function(){return xe.rel(s,i,c,u)}))}))},fe=function(e,t){return function(n){try{256&e.$flags$?e.$lazyInstance$[t](n):(e.$queuedListeners$=e.$queuedListeners$||[]).push([t,n])}catch(r){be(r)}}},he=function(e){return 0!==(2&e)},ve=new WeakMap,me=function(e){return ve.get(e)},ge=function(e,t){return ve.set(t.$lazyInstance$=e,t)},ye=function(e,t){var n={$flags$:0,$hostElement$:e,$cmpMeta$:t,$instanceValues$:new Map};return n.$onReadyPromise$=new Promise((function(e){return n.$onReadyResolve$=e})),e["s-p"]=[],e["s-rc"]=[],pe(e,n,t.$listeners$),ve.set(e,n)},ke=function(e,t){return t in e},be=function(e,t){return(0,console.error)(e,t)},we=new Map,_e=function(e,t,r){var a=e.$tagName$.replace(/-/g,"_"),i=e.$lazyBundleId$,o=we.get(i);if(o)return o[a];if(!r||!BUILD.hotModuleReplacement){var s=function(e){return we.set(i,e),e[a]};switch(i){case"dyte-meeting":return Promise.all([n.e(6588),n.e(2046)]).then(n.bind(n,2046)).then(s,be);case"dyte-breakout-room-grid":return n.e(1076).then(n.bind(n,1076)).then(s,be);case"dyte-breakout-rooms-manager":return n.e(4307).then(n.bind(n,4307)).then(s,be);case"dyte-breakout-rooms-toggle":return n.e(9281).then(n.bind(n,9281)).then(s,be);case"dyte-broadcast-message-modal":return n.e(5677).then(n.bind(n,5677)).then(s,be);case"dyte-camera-toggle":return n.e(1678).then(n.bind(n,1678)).then(s,be);case"dyte-chat":return n.e(1817).then(n.bind(n,1817)).then(s,be);case"dyte-chat-toggle":return n.e(8675).then(n.bind(n,8675)).then(s,be);case"dyte-clock":return n.e(2793).then(n.bind(n,2793)).then(s,be);case"dyte-confirmation-modal":return n.e(7298).then(n.bind(n,7298)).then(s,be);case"dyte-controlbar":return n.e(4815).then(n.bind(n,4815)).then(s,be);case"dyte-dialog-manager":return n.e(7999).then(n.bind(n,7999)).then(s,be);case"dyte-ended-screen":return n.e(9434).then(n.bind(n,9434)).then(s,be);case"dyte-fullscreen-toggle":return n.e(1068).then(n.bind(n,1068)).then(s,be);case"dyte-grid":return n.e(1485).then(n.bind(n,1485)).then(s,be);case"dyte-grid-pagination":return n.e(8719).then(n.bind(n,8719)).then(s,be);case"dyte-header":return n.e(6301).then(n.bind(n,6301)).then(s,be);case"dyte-idle-screen":return n.e(1941).then(n.bind(n,1941)).then(s,be);case"dyte-image-viewer":return n.e(35).then(n.bind(n,35)).then(s,be);case"dyte-join-stage":return n.e(2946).then(n.bind(n,2946)).then(s,be);case"dyte-leave-button":return n.e(8053).then(n.bind(n,8053)).then(s,be);case"dyte-leave-meeting":return n.e(8521).then(n.bind(n,8521)).then(s,be);case"dyte-meeting-title":return n.e(2401).then(n.bind(n,2401)).then(s,be);case"dyte-mic-toggle":return n.e(9546).then(n.bind(n,9546)).then(s,be);case"dyte-mixed-grid":return n.e(5288).then(n.bind(n,5288)).then(s,be);case"dyte-more-toggle":return n.e(7403).then(n.bind(n,7403)).then(s,be);case"dyte-mute-all-button":return n.e(3555).then(n.bind(n,3555)).then(s,be);case"dyte-mute-all-confirmation":return n.e(8684).then(n.bind(n,8684)).then(s,be);case"dyte-name-tag":return n.e(7181).then(n.bind(n,7181)).then(s,be);case"dyte-notifications":return n.e(7766).then(n.bind(n,7766)).then(s,be);case"dyte-participant-count":return n.e(937).then(n.bind(n,937)).then(s,be);case"dyte-participant-setup":return n.e(8555).then(n.bind(n,8555)).then(s,be);case"dyte-participants-audio":return n.e(7133).then(n.bind(n,7133)).then(s,be);case"dyte-participants-toggle":return n.e(5181).then(n.bind(n,5181)).then(s,be);case"dyte-permissions-message":return n.e(290).then(n.bind(n,290)).then(s,be);case"dyte-pip-toggle":return n.e(6967).then(n.bind(n,6967)).then(s,be);case"dyte-plugin-main":return n.e(1862).then(n.bind(n,1862)).then(s,be);case"dyte-plugins":return n.e(7205).then(n.bind(n,7205)).then(s,be);case"dyte-plugins-toggle":return n.e(2332).then(n.bind(n,2332)).then(s,be);case"dyte-polls":return n.e(1408).then(n.bind(n,1408)).then(s,be);case"dyte-polls-toggle":return n.e(2996).then(n.bind(n,2996)).then(s,be);case"dyte-recording-indicator":return n.e(1771).then(n.bind(n,1771)).then(s,be);case"dyte-recording-toggle":return n.e(6769).then(n.bind(n,6769)).then(s,be);case"dyte-remote-access-manager":return n.e(3353).then(n.bind(n,3353)).then(s,be);case"dyte-screen-share-toggle":return n.e(9091).then(n.bind(n,9091)).then(s,be);case"dyte-screenshare-view":return n.e(874).then(n.bind(n,874)).then(s,be);case"dyte-settings":return n.e(3012).then(n.bind(n,3012)).then(s,be);case"dyte-settings-toggle":return n.e(1376).then(n.bind(n,1376)).then(s,be);case"dyte-setup-screen":return n.e(1901).then(n.bind(n,1901)).then(s,be);case"dyte-sidebar":return n.e(1421).then(n.bind(n,1421)).then(s,be);case"dyte-simple-grid":return Promise.all([n.e(6588),n.e(2249)]).then(n.bind(n,2249)).then(s,be);case"dyte-spotlight-grid":return n.e(7770).then(n.bind(n,7770)).then(s,be);case"dyte-stage":return n.e(4701).then(n.bind(n,4701)).then(s,be);case"dyte-text-field":return n.e(3642).then(n.bind(n,3642)).then(s,be);case"dyte-waiting-screen":return n.e(424).then(n.bind(n,424)).then(s,be);case"dyte-webinar-stage-toggle":return n.e(8785).then(n.bind(n,8785)).then(s,be);case"dyte-breakout-room-manager_3":return n.e(475).then(n.bind(n,475)).then(s,be);case"dyte-breakout-room-tile":return n.e(5196).then(n.bind(n,5196)).then(s,be);case"dyte-chat-composer-ui_3":return n.e(5134).then(n.bind(n,5134)).then(s,be);case"dyte-notification":return n.e(6324).then(n.bind(n,6324)).then(s,be);case"dyte-overlay-modal":return n.e(8212).then(n.bind(n,8212)).then(s,be);case"dyte-poll_2":return n.e(2027).then(n.bind(n,2027)).then(s,be);case"dyte-settings-audio_2":return n.e(5729).then(n.bind(n,5729)).then(s,be);case"dyte-spotlight-indicator":return n.e(296).then(n.bind(n,296)).then(s,be);case"dyte-audio-visualizer_2":return n.e(9244).then(n.bind(n,9244)).then(s,be);case"dyte-dialog":return n.e(8967).then(n.bind(n,8967)).then(s,be);case"dyte-emoji-picker":return n.e(9808).then(n.bind(n,9808)).then(s,be);case"dyte-file-message_3":return n.e(3718).then(n.bind(n,3718)).then(s,be);case"dyte-participant-tile":return n.e(9361).then(n.bind(n,9361)).then(s,be);case"dyte-logo":return n.e(6275).then(n.bind(n,6275)).then(s,be);case"dyte-avatar_5":return Promise.all([n.e(2858),n.e(9139)]).then(n.bind(n,9139)).then(s,be);case"dyte-controlbar-button":return n.e(2427).then(n.bind(n,2427)).then(s,be);case"dyte-tooltip":return Promise.all([n.e(2858),n.e(4673)]).then(n.bind(n,4673)).then(s,be);case"dyte-spinner":return n.e(9716).then(n.bind(n,9716)).then(s,be);case"dyte-button":return n.e(6200).then(n.bind(n,6200)).then(s,be);case"dyte-icon":return n.e(2072).then(n.bind(n,2072)).then(s,be)}}return n(8654)("./".concat(i,".entry.js")).then((function(e){return we.set(i,e),e[a]}),be)},Se=new Map,Ee="undefined"!==typeof window?window:{},Te=Ee.document||{head:{}},xe={$flags$:0,$resourcesUrl$:"",jmp:function(e){return e()},raf:function(e){return requestAnimationFrame(e)},ael:function(e,t,n,r){return e.addEventListener(t,n,r)},rel:function(e,t,n,r){return e.removeEventListener(t,n,r)},ce:function(e,t){return new CustomEvent(e,t)}},Ze=function(e){return Promise.resolve(e)},Ce=function(){try{return new CSSStyleSheet,"function"===typeof(new CSSStyleSheet).replaceSync}catch(e){}return!1}(),Re=[],Pe=[],Ie=function(e,t){return function(n){e.push(n),m||(m=!0,t&&4&xe.$flags$?Me(De):xe.raf(De))}},Oe=function(e){for(var t=0;t<e.length;t++)try{e[t](performance.now())}catch(n){be(n)}e.length=0},De=function e(){Oe(Re),Oe(Pe),(m=Re.length>0)&&xe.raf(e)},Me=function(e){return Ze().then(e)},Ae=Ie(Pe,!0)},4402:function(e,t,n){"use strict";n.d(t,{l:function(){return r}});var r=console},6758:function(e,t,n){"use strict";n.d(t,{D:function(){return u}});var r=n(4165),a=n(5861),i=n(5671),o=n(3144),s=n(4402),c={joined:"https://dyte-uploads.s3.ap-south-1.amazonaws.com/notification_join.mp3",left:"https://dyte-uploads.s3.ap-south-1.amazonaws.com/notification_join.mp3",message:"https://dyte-uploads.s3.ap-south-1.amazonaws.com/notification_message.mp3"},u=function(){function e(){(0,i.Z)(this,e),this.audio=document.createElement("audio"),this.audio.volume=.3}return(0,o.Z)(e,[{key:"play",value:function(e){var t,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;this.playing||(this.playing=!0,this.audio.src=c[e],this.audio.volume=.3,null===(t=this.audio.play())||void 0===t||t.catch((function(t){s.l.error("[dyte-notifications] play() failed\n",{sound:e,duration:r},t)})),setTimeout((function(){n.playing=!1}),r))}},{key:"setDevice",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a,i;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(i=null===(a=null===(n=this.audio)||void 0===n?void 0:n.setSinkId)||void 0===a?void 0:a.call(n,t))||void 0===i?void 0:i.catch((function(e){s.l.error("[dyte-notifications] setSinkId() error\n",e)}));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}()},4153:function(e,t,n){"use strict";n.d(t,{a:function(){return o},c:function(){return c},g:function(){return s},s:function(){return i}});var r=n(4130),a="dyte-prefs",i=function(e,t){var n=JSON.parse(r.g.getItem(a)||"{}");n[e]=JSON.stringify(t),r.g.setItem("dyte-prefs",JSON.stringify(n))},o=function(e){return JSON.parse(r.g.getItem(a)||"{}")[e]},s=function(){var e=JSON.parse(r.g.getItem(a)||"{}");return{mirrorVideo:!e["mirror-video"]||"true"===e["mirror-video"],muteNotificationSounds:!!e["mute-notification-sounds"]&&"true"===e["mute-notification-sounds"]}},c={}},3360:function(e,t,n){"use strict";n.d(t,{Z:function(){return Zx}});var r={};n.r(r),n.d(r,{Decoder:function(){return No},Encoder:function(){return Ao},PacketType:function(){return Do},protocol:function(){return Mo}});var a=n(8664),i=n(4942),o=n(2982),s=n(1413),c=n(7762),u=n(885),l=n(4165),d=n(5861),p=n(1120);function f(){return f="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,p.Z)(e)););return e}(e,t);if(r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(arguments.length<3?e:n):a.value}},f.apply(this,arguments)}var h,v=n(7326),m=n(136),g=n(7277),y=n(5671),k=n(3144),b=new Uint8Array(16);function w(){if(!h&&!(h="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return h(b)}var _=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var S=function(e){return"string"===typeof e&&_.test(e)},E=[],T=0;T<256;++T)E.push((T+256).toString(16).substr(1));var x=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(E[e[t+0]]+E[e[t+1]]+E[e[t+2]]+E[e[t+3]]+"-"+E[e[t+4]]+E[e[t+5]]+"-"+E[e[t+6]]+E[e[t+7]]+"-"+E[e[t+8]]+E[e[t+9]]+"-"+E[e[t+10]]+E[e[t+11]]+E[e[t+12]]+E[e[t+13]]+E[e[t+14]]+E[e[t+15]]).toLowerCase();if(!S(n))throw TypeError("Stringified UUID is invalid");return n};var Z=function(e,t,n){var r=(e=e||{}).random||(e.rng||w)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var a=0;a<16;++a)t[n+a]=r[a];return t}return x(r)},C=n(4569),R=n.n(C),P="object"===typeof globalThis?globalThis:"object"===typeof self?self:"object"===typeof window?window:"object"===typeof n.g?n.g:{},I="1.4.0",O=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;var D=function(e){var t=new Set([e]),n=new Set,r=e.match(O);if(!r)return function(){return!1};var a=+r[1],i=+r[2],o=+r[3];if(null!=r[4])return function(t){return t===e};function s(e){return n.add(e),!1}function c(e){return t.add(e),!0}return function(e){if(t.has(e))return!0;if(n.has(e))return!1;var r=e.match(O);if(!r)return s(e);var u=+r[1],l=+r[2],d=+r[3];return null!=r[4]||a!==u?s(e):0===a?i===l&&o<=d?c(e):s(e):i<=l?c(e):s(e)}}(I),M=I.split(".")[0],A=Symbol.for("opentelemetry.js.api."+M),N=P;function L(e,t,n,r){var a;void 0===r&&(r=!1);var i=N[A]=null!==(a=N[A])&&void 0!==a?a:{version:I};if(!r&&i[e]){var o=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return n.error(o.stack||o.message),!1}if(i.version!==I){o=new Error("@opentelemetry/api: All API registration versions must match");return n.error(o.stack||o.message),!1}return i[e]=t,n.debug("@opentelemetry/api: Registered a global for "+e+" v"+I+"."),!0}function j(e){var t,n,r=null===(t=N[A])||void 0===t?void 0:t.version;if(r&&D(r))return null===(n=N[A])||void 0===n?void 0:n[e]}function F(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+I+".");var n=N[A];n&&delete n[e]}var U,B=function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(s){a={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},V=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},H=function(){function e(e){this._namespace=e.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return z("debug",this._namespace,e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return z("error",this._namespace,e)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return z("info",this._namespace,e)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return z("warn",this._namespace,e)},e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return z("verbose",this._namespace,e)},e}();function z(e,t,n){var r=j("diag");if(r)return n.unshift(t),r[e].apply(r,V([],B(n),!1))}!function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"}(U||(U={}));var W=function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(s){a={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},G=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},q="diag",$=function(){function e(){function e(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=j("diag");if(r)return r[e].apply(r,G([],W(t),!1))}}var t=this;t.setLogger=function(e,n){var r,a,i;if(void 0===n&&(n={logLevel:U.INFO}),e===t){var o=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return t.error(null!==(r=o.stack)&&void 0!==r?r:o.message),!1}"number"===typeof n&&(n={logLevel:n});var s=j("diag"),c=function(e,t){function n(n,r){var a=t[n];return"function"===typeof a&&e>=r?a.bind(t):function(){}}return e<U.NONE?e=U.NONE:e>U.ALL&&(e=U.ALL),t=t||{},{error:n("error",U.ERROR),warn:n("warn",U.WARN),info:n("info",U.INFO),debug:n("debug",U.DEBUG),verbose:n("verbose",U.VERBOSE)}}(null!==(a=n.logLevel)&&void 0!==a?a:U.INFO,e);if(s&&!n.suppressOverrideMessage){var u=null!==(i=(new Error).stack)&&void 0!==i?i:"<failed to generate stacktrace>";s.warn("Current logger will be overwritten from "+u),c.warn("Current logger will overwrite one already registered from "+u)}return L("diag",c,t,!0)},t.disable=function(){F(q,t)},t.createComponentLogger=function(e){return new H(e)},t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}(),K=$.instance();function J(e){return Symbol.for(e)}var Q,X=function e(t){var n=this;n._currentContext=t?new Map(t):new Map,n.getValue=function(e){return n._currentContext.get(e)},n.setValue=function(t,r){var a=new e(n._currentContext);return a._currentContext.set(t,r),a},n.deleteValue=function(t){var r=new e(n._currentContext);return r._currentContext.delete(t),r}},Y=new X,ee=function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(s){a={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},te=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},ne=function(){function e(){}return e.prototype.active=function(){return Y},e.prototype.with=function(e,t,n){for(var r=[],a=3;a<arguments.length;a++)r[a-3]=arguments[a];return t.call.apply(t,te([n],ee(r),!1))},e.prototype.bind=function(e,t){return t},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),re=function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(s){a={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},ae=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},ie="context",oe=new ne,se=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(e){return L(ie,e,$.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(e,t,n){for(var r,a=[],i=3;i<arguments.length;i++)a[i-3]=arguments[i];return(r=this._getContextManager()).with.apply(r,ae([e,t,n],re(a),!1))},e.prototype.bind=function(e,t){return this._getContextManager().bind(e,t)},e.prototype._getContextManager=function(){return j(ie)||oe},e.prototype.disable=function(){this._getContextManager().disable(),F(ie,$.instance())},e}();!function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(Q||(Q={}));var ce="0000000000000000",ue="00000000000000000000000000000000",le={traceId:ue,spanId:ce,traceFlags:Q.NONE},de=function(){function e(e){void 0===e&&(e=le),this._spanContext=e}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(e,t){return this},e.prototype.setAttributes=function(e){return this},e.prototype.addEvent=function(e,t){return this},e.prototype.setStatus=function(e){return this},e.prototype.updateName=function(e){return this},e.prototype.end=function(e){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(e,t){},e}(),pe=J("OpenTelemetry Context Key SPAN");function fe(e){return e.getValue(pe)||void 0}function he(){return fe(se.getInstance().active())}function ve(e,t){return e.setValue(pe,t)}function me(e){return e.deleteValue(pe)}function ge(e,t){return ve(e,new de(t))}function ye(e){var t;return null===(t=fe(e))||void 0===t?void 0:t.spanContext()}var ke=/^([0-9a-f]{32})$/i,be=/^[0-9a-f]{16}$/i;function we(e){return ke.test(e)&&e!==ue}function _e(e){return we(e.traceId)&&(t=e.spanId,be.test(t)&&t!==ce);var t}function Se(e){return new de(e)}var Ee=se.getInstance(),Te=function(){function e(){}return e.prototype.startSpan=function(e,t,n){if(void 0===n&&(n=Ee.active()),Boolean(null===t||void 0===t?void 0:t.root))return new de;var r,a=n&&ye(n);return"object"===typeof(r=a)&&"string"===typeof r.spanId&&"string"===typeof r.traceId&&"number"===typeof r.traceFlags&&_e(a)?new de(a):new de},e.prototype.startActiveSpan=function(e,t,n,r){var a,i,o;if(!(arguments.length<2)){2===arguments.length?o=t:3===arguments.length?(a=t,o=n):(a=t,i=n,o=r);var s=null!==i&&void 0!==i?i:Ee.active(),c=this.startSpan(e,a,s),u=ve(s,c);return Ee.with(u,o,void 0,c)}},e}();var xe=new Te,Ze=function(){function e(e,t,n,r){this._provider=e,this.name=t,this.version=n,this.options=r}return e.prototype.startSpan=function(e,t,n){return this._getTracer().startSpan(e,t,n)},e.prototype.startActiveSpan=function(e,t,n,r){var a=this._getTracer();return Reflect.apply(a.startActiveSpan,a,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):xe},e}(),Ce=new(function(){function e(){}return e.prototype.getTracer=function(e,t,n){return new Te},e}()),Re=function(){function e(){}return e.prototype.getTracer=function(e,t,n){var r;return null!==(r=this.getDelegateTracer(e,t,n))&&void 0!==r?r:new Ze(this,e,t,n)},e.prototype.getDelegate=function(){var e;return null!==(e=this._delegate)&&void 0!==e?e:Ce},e.prototype.setDelegate=function(e){this._delegate=e},e.prototype.getDelegateTracer=function(e,t,n){var r;return null===(r=this._delegate)||void 0===r?void 0:r.getTracer(e,t,n)},e}(),Pe="trace",Ie=function(){function e(){this._proxyTracerProvider=new Re,this.wrapSpanContext=Se,this.isSpanContextValid=_e,this.deleteSpan=me,this.getSpan=fe,this.getActiveSpan=he,this.getSpanContext=ye,this.setSpan=ve,this.setSpanContext=ge}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(e){var t=L(Pe,this._proxyTracerProvider,$.instance());return t&&this._proxyTracerProvider.setDelegate(e),t},e.prototype.getTracerProvider=function(){return j(Pe)||this._proxyTracerProvider},e.prototype.getTracer=function(e,t){return this.getTracerProvider().getTracer(e,t)},e.prototype.disable=function(){F(Pe,$.instance()),this._proxyTracerProvider=new Re},e}().getInstance(),Oe=se.getInstance(),De=function(){function e(){}return e.prototype.inject=function(e,t){},e.prototype.extract=function(e,t){return e},e.prototype.fields=function(){return[]},e}(),Me={get:function(e,t){if(null!=e)return e[t]},keys:function(e){return null==e?[]:Object.keys(e)}},Ae={set:function(e,t,n){null!=e&&(e[t]=n)}},Ne=J("OpenTelemetry Baggage Key");function Le(e){return e.getValue(Ne)||void 0}function je(){return Le(se.getInstance().active())}function Fe(e,t){return e.setValue(Ne,t)}function Ue(e){return e.deleteValue(Ne)}var Be=function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(s){a={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},Ve=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},He=function(){function e(e){this._entries=e?new Map(e):new Map}return e.prototype.getEntry=function(e){var t=this._entries.get(e);if(t)return Object.assign({},t)},e.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map((function(e){var t=Be(e,2);return[t[0],t[1]]}))},e.prototype.setEntry=function(t,n){var r=new e(this._entries);return r._entries.set(t,n),r},e.prototype.removeEntry=function(t){var n=new e(this._entries);return n._entries.delete(t),n},e.prototype.removeEntries=function(){for(var t,n,r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];var i=new e(this._entries);try{for(var o=Ve(r),s=o.next();!s.done;s=o.next()){var c=s.value;i._entries.delete(c)}}catch(u){t={error:u}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return i},e.prototype.clear=function(){return new e},e}(),ze=Symbol("BaggageEntryMetadata"),We=$.instance();function Ge(e){return void 0===e&&(e={}),new He(new Map(Object.entries(e)))}var qe,$e,Ke="propagation",Je=new De,Qe=function(){function e(){this.createBaggage=Ge,this.getBaggage=Le,this.getActiveBaggage=je,this.setBaggage=Fe,this.deleteBaggage=Ue}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalPropagator=function(e){return L(Ke,e,$.instance())},e.prototype.inject=function(e,t,n){return void 0===n&&(n=Ae),this._getGlobalPropagator().inject(e,t,n)},e.prototype.extract=function(e,t,n){return void 0===n&&(n=Me),this._getGlobalPropagator().extract(e,t,n)},e.prototype.fields=function(){return this._getGlobalPropagator().fields()},e.prototype.disable=function(){F(Ke,$.instance())},e.prototype._getGlobalPropagator=function(){return j(Ke)||Je},e}().getInstance(),Xe="[object Object]",Ye="[object Null]",et="[object Undefined]",tt=Function.prototype.toString,nt=tt.call(Object),rt=(qe=Object.getPrototypeOf,$e=Object,function(e){return qe($e(e))}),at=Object.prototype,it=at.hasOwnProperty,ot=Symbol?Symbol.toStringTag:void 0,st=at.toString;function ct(e){if(!function(e){return null!=e&&"object"==typeof e}(e)||function(e){if(null==e)return void 0===e?et:Ye;return ot&&ot in Object(e)?function(e){var t=it.call(e,ot),n=e[ot],r=!1;try{e[ot]=void 0,r=!0}catch(i){}var a=st.call(e);r&&(t?e[ot]=n:delete e[ot]);return a}(e):function(e){return st.call(e)}(e)}(e)!==Xe)return!1;var t=rt(e);if(null===t)return!0;var n=it.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&tt.call(n)===nt}var ut,lt=20;function dt(e){return ht(e)?e.slice():e}function pt(e,t,n,r){var a;if(void 0===n&&(n=0),!(n>lt)){if(n++,gt(e)||gt(t)||vt(t))a=dt(t);else if(ht(e)){if(a=e.slice(),ht(t))for(var i=0,o=t.length;i<o;i++)a.push(dt(t[i]));else if(mt(t))for(i=0,o=(s=Object.keys(t)).length;i<o;i++){a[c=s[i]]=dt(t[c])}}else if(mt(e))if(mt(t)){if(!function(e,t){if(!ct(e)||!ct(t))return!1;return!0}(e,t))return t;a=Object.assign({},e);var s;for(i=0,o=(s=Object.keys(t)).length;i<o;i++){var c,u=t[c=s[i]];if(gt(u))"undefined"===typeof u?delete a[c]:a[c]=u;else{var l=a[c],d=u;if(ft(e,c,r)||ft(t,c,r))delete a[c];else{if(mt(l)&&mt(d)){var p=r.get(l)||[],f=r.get(d)||[];p.push({obj:e,key:c}),f.push({obj:t,key:c}),r.set(l,p),r.set(d,f)}a[c]=pt(a[c],u,n,r)}}}}else a=t;return a}}function ft(e,t,n){for(var r=n.get(e[t])||[],a=0,i=r.length;a<i;a++){var o=r[a];if(o.key===t&&o.obj===e)return!0}return!1}function ht(e){return Array.isArray(e)}function vt(e){return"function"===typeof e}function mt(e){return!gt(e)&&!ht(e)&&!vt(e)&&"object"===typeof e}function gt(e){return"string"===typeof e||"number"===typeof e||"boolean"===typeof e||"undefined"===typeof e||e instanceof Date||e instanceof RegExp||null===e}!function(e){e.AlwaysOff="always_off",e.AlwaysOn="always_on",e.ParentBasedAlwaysOff="parentbased_always_off",e.ParentBasedAlwaysOn="parentbased_always_on",e.ParentBasedTraceIdRatio="parentbased_traceidratio",e.TraceIdRatio="traceidratio"}(ut||(ut={}));var yt="object"===typeof globalThis?globalThis:"object"===typeof self?self:"object"===typeof window?window:"object"===typeof n.g?n.g:{},kt=",",bt=["OTEL_SDK_DISABLED"];function wt(e){return bt.indexOf(e)>-1}var _t=["OTEL_BSP_EXPORT_TIMEOUT","OTEL_BSP_MAX_EXPORT_BATCH_SIZE","OTEL_BSP_MAX_QUEUE_SIZE","OTEL_BSP_SCHEDULE_DELAY","OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_EVENT_COUNT_LIMIT","OTEL_SPAN_LINK_COUNT_LIMIT","OTEL_EXPORTER_OTLP_TIMEOUT","OTEL_EXPORTER_OTLP_TRACES_TIMEOUT","OTEL_EXPORTER_OTLP_METRICS_TIMEOUT","OTEL_EXPORTER_JAEGER_AGENT_PORT"];function St(e){return _t.indexOf(e)>-1}var Et=["OTEL_NO_PATCH_MODULES","OTEL_PROPAGATORS"];function Tt(e){return Et.indexOf(e)>-1}var xt=1/0,Zt=128,Ct={OTEL_SDK_DISABLED:!1,CONTAINER_NAME:"",ECS_CONTAINER_METADATA_URI_V4:"",ECS_CONTAINER_METADATA_URI:"",HOSTNAME:"",KUBERNETES_SERVICE_HOST:"",NAMESPACE:"",OTEL_BSP_EXPORT_TIMEOUT:3e4,OTEL_BSP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BSP_MAX_QUEUE_SIZE:2048,OTEL_BSP_SCHEDULE_DELAY:5e3,OTEL_EXPORTER_JAEGER_AGENT_HOST:"",OTEL_EXPORTER_JAEGER_AGENT_PORT:6832,OTEL_EXPORTER_JAEGER_ENDPOINT:"",OTEL_EXPORTER_JAEGER_PASSWORD:"",OTEL_EXPORTER_JAEGER_USER:"",OTEL_EXPORTER_OTLP_ENDPOINT:"",OTEL_EXPORTER_OTLP_TRACES_ENDPOINT:"",OTEL_EXPORTER_OTLP_METRICS_ENDPOINT:"",OTEL_EXPORTER_OTLP_HEADERS:"",OTEL_EXPORTER_OTLP_TRACES_HEADERS:"",OTEL_EXPORTER_OTLP_METRICS_HEADERS:"",OTEL_EXPORTER_OTLP_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_TRACES_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_METRICS_TIMEOUT:1e4,OTEL_EXPORTER_ZIPKIN_ENDPOINT:"http://localhost:9411/api/v2/spans",OTEL_LOG_LEVEL:U.INFO,OTEL_NO_PATCH_MODULES:[],OTEL_PROPAGATORS:["tracecontext","baggage"],OTEL_RESOURCE_ATTRIBUTES:"",OTEL_SERVICE_NAME:"",OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT:xt,OTEL_ATTRIBUTE_COUNT_LIMIT:Zt,OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT:xt,OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT:Zt,OTEL_SPAN_EVENT_COUNT_LIMIT:128,OTEL_SPAN_LINK_COUNT_LIMIT:128,OTEL_TRACES_EXPORTER:"",OTEL_TRACES_SAMPLER:ut.ParentBasedAlwaysOn,OTEL_TRACES_SAMPLER_ARG:"",OTEL_EXPORTER_OTLP_INSECURE:"",OTEL_EXPORTER_OTLP_TRACES_INSECURE:"",OTEL_EXPORTER_OTLP_METRICS_INSECURE:"",OTEL_EXPORTER_OTLP_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_COMPRESSION:"",OTEL_EXPORTER_OTLP_TRACES_COMPRESSION:"",OTEL_EXPORTER_OTLP_METRICS_COMPRESSION:"",OTEL_EXPORTER_OTLP_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_TRACES_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE:"cumulative"};function Rt(e,t,n){if("undefined"!==typeof n[e]){var r=String(n[e]);t[e]="true"===r.toLowerCase()}}function Pt(e,t,n,r,a){if(void 0===r&&(r=-1/0),void 0===a&&(a=1/0),"undefined"!==typeof n[e]){var i=Number(n[e]);isNaN(i)||(t[e]=i<r?r:i>a?a:i)}}function It(e,t,n,r){void 0===r&&(r=kt);var a=n[e];"string"===typeof a&&(t[e]=a.split(r).map((function(e){return e.trim()})))}var Ot={ALL:U.ALL,VERBOSE:U.VERBOSE,DEBUG:U.DEBUG,INFO:U.INFO,WARN:U.WARN,ERROR:U.ERROR,NONE:U.NONE};function Dt(e,t,n){var r=n[e];if("string"===typeof r){var a=Ot[r.toUpperCase()];null!=a&&(t[e]=a)}}function Mt(e){var t={};for(var n in Ct){var r=n;if("OTEL_LOG_LEVEL"===r)Dt(r,t,e);else if(wt(r))Rt(r,t,e);else if(St(r))Pt(r,t,e);else if(Tt(r))It(r,t,e);else{var a=e[r];"undefined"!==typeof a&&null!==a&&(t[r]=String(a))}}return t}function At(){var e=Mt(yt);return Object.assign({},Ct,e)}var Nt=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Lt=function(){function e(e){var t;void 0===e&&(e={}),this._propagators=null!==(t=e.propagators)&&void 0!==t?t:[],this._fields=Array.from(new Set(this._propagators.map((function(e){return"function"===typeof e.fields?e.fields():[]})).reduce((function(e,t){return e.concat(t)}),[])))}return e.prototype.inject=function(e,t,n){var r,a;try{for(var i=Nt(this._propagators),o=i.next();!o.done;o=i.next()){var s=o.value;try{s.inject(e,t,n)}catch(c){K.warn("Failed to inject with "+s.constructor.name+". Err: "+c.message)}}}catch(u){r={error:u}}finally{try{o&&!o.done&&(a=i.return)&&a.call(i)}finally{if(r)throw r.error}}},e.prototype.extract=function(e,t,n){return this._propagators.reduce((function(e,r){try{return r.extract(e,t,n)}catch(a){K.warn("Failed to inject with "+r.constructor.name+". Err: "+a.message)}return e}),e)},e.prototype.fields=function(){return this._fields.slice()},e}(),jt=J("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function Ft(e){return!0===e.getValue(jt)}var Ut="[_0-9a-z-*/]",Bt=new RegExp("^(?:"+("[a-z]"+Ut+"{0,255}")+"|"+("[a-z0-9]"+Ut+"{0,240}@[a-z]"+Ut+"{0,13}")+")$"),Vt=/^[ -~]{0,255}[!-~]$/,Ht=/,|=/;var zt=function(){function e(e){this._internalState=new Map,e&&this._parse(e)}return e.prototype.set=function(e,t){var n=this._clone();return n._internalState.has(e)&&n._internalState.delete(e),n._internalState.set(e,t),n},e.prototype.unset=function(e){var t=this._clone();return t._internalState.delete(e),t},e.prototype.get=function(e){return this._internalState.get(e)},e.prototype.serialize=function(){var e=this;return this._keys().reduce((function(t,n){return t.push(n+"="+e.get(n)),t}),[]).join(",")},e.prototype._parse=function(e){e.length>512||(this._internalState=e.split(",").reverse().reduce((function(e,t){var n=t.trim(),r=n.indexOf("=");if(-1!==r){var a=n.slice(0,r),i=n.slice(r+1,t.length);(function(e){return Bt.test(e)})(a)&&function(e){return Vt.test(e)&&!Ht.test(e)}(i)&&e.set(a,i)}return e}),new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))},e.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},e.prototype._clone=function(){var t=new e;return t._internalState=new Map(this._internalState),t},e}(),Wt="traceparent",Gt="tracestate",qt=new RegExp("^\\s?((?!ff)[\\da-f]{2})-((?![0]{32})[\\da-f]{32})-((?![0]{16})[\\da-f]{16})-([\\da-f]{2})(-.*)?\\s?$");var $t=function(){function e(){}return e.prototype.inject=function(e,t,n){var r=Ie.getSpanContext(e);if(r&&!Ft(e)&&_e(r)){var a="00-"+r.traceId+"-"+r.spanId+"-0"+Number(r.traceFlags||Q.NONE).toString(16);n.set(t,Wt,a),r.traceState&&n.set(t,Gt,r.traceState.serialize())}},e.prototype.extract=function(e,t,n){var r=n.get(t,Wt);if(!r)return e;var a=Array.isArray(r)?r[0]:r;if("string"!==typeof a)return e;var i=function(e){var t=qt.exec(e);return t?"00"===t[1]&&t[5]?null:{traceId:t[2],spanId:t[3],traceFlags:parseInt(t[4],16)}:null}(a);if(!i)return e;i.isRemote=!0;var o=n.get(t,Gt);if(o){var s=Array.isArray(o)?o.join(","):o;i.traceState=new zt("string"===typeof s?s:void 0)}return Ie.setSpanContext(e,i)},e.prototype.fields=function(){return[Wt,Gt]},e}(),Kt="=",Jt=";",Qt=",",Xt="baggage",Yt=8192,en=function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(s){a={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};function tn(e){var t=e.split(Jt);if(!(t.length<=0)){var n=t.shift();if(n){var r=n.split(Kt);if(2===r.length){var a,i,o=decodeURIComponent(r[0].trim()),s=decodeURIComponent(r[1].trim());return t.length>0&&("string"!==typeof(i=t.join(Jt))&&(We.error("Cannot create baggage metadata from unknown type: "+typeof i),i=""),a={__TYPE__:ze,toString:function(){return i}}),{key:o,value:s,metadata:a}}}}}function nn(e){return"string"!==typeof e||0===e.length?{}:e.split(Qt).map((function(e){return tn(e)})).filter((function(e){return void 0!==e&&e.value.length>0})).reduce((function(e,t){return e[t.key]=t.value,e}),{})}var rn,an=function(){function e(){}return e.prototype.inject=function(e,t,n){var r=Qe.getBaggage(e);if(r&&!Ft(e)){var a=function(e){return e.getAllEntries().map((function(e){var t=en(e,2),n=t[0],r=t[1],a=encodeURIComponent(n)+"="+encodeURIComponent(r.value);return void 0!==r.metadata&&(a+=Jt+r.metadata.toString()),a}))}(r).filter((function(e){return e.length<=4096})).slice(0,180),i=function(e){return e.reduce((function(e,t){var n=""+e+(""!==e?Qt:"")+t;return n.length>Yt?e:n}),"")}(a);i.length>0&&n.set(t,Xt,i)}},e.prototype.extract=function(e,t,n){var r=n.get(t,Xt),a=Array.isArray(r)?r.join(Qt):r;if(!a)return e;var i={};return 0===a.length?e:(a.split(Qt).forEach((function(e){var t=tn(e);if(t){var n={value:t.value};t.metadata&&(n.metadata=t.metadata),i[t.key]=n}})),0===Object.entries(i).length?e:Qe.setBaggage(e,Qe.createBaggage(i)))},e.prototype.fields=function(){return[Xt]},e}(),on="process.runtime.name",sn="service.name",cn="telemetry.sdk.name",un="telemetry.sdk.language",ln="telemetry.sdk.version",dn=((rn={})[cn]="opentelemetry",rn[on]="browser",rn[un]="webjs",rn[ln]="1.9.1",rn);var pn,fn,hn=function(){function e(e){this.attributes=e}return e.empty=function(){return e.EMPTY},e.default=function(){var t;return new e(((t={})[sn]="unknown_service",t[un]=dn[un],t[cn]=dn[cn],t[ln]=dn[ln],t))},e.prototype.merge=function(t){return t&&Object.keys(t.attributes).length?new e(Object.assign({},this.attributes,t.attributes)):this},e.EMPTY=new e({}),e}();!function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"}(pn||(pn={})),function(e){e[e.NOT_RECORD=0]="NOT_RECORD",e[e.RECORD=1]="RECORD",e[e.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(fn||(fn={}));var vn,mn=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},gn=function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(s){a={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};function yn(e){var t,n,r={};if("object"!==typeof e||null==e)return r;try{for(var a=mn(Object.entries(e)),i=a.next();!i.done;i=a.next()){var o=gn(i.value,2),s=o[0],c=o[1];kn(s)?bn(c)?Array.isArray(c)?r[s]=c.slice():r[s]=c:K.warn("Invalid attribute value set for key: "+s):K.warn("Invalid attribute key: "+s)}}catch(u){t={error:u}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return r}function kn(e){return"string"===typeof e&&e.length>0}function bn(e){return null==e||(Array.isArray(e)?function(e){var t,n,r;try{for(var a=mn(e),i=a.next();!i.done;i=a.next()){var o=i.value;if(null!=o){if(!r){if(wn(o)){r=typeof o;continue}return!1}if(typeof o!==r)return!1}}}catch(s){t={error:s}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return!0}(e):wn(e))}function wn(e){switch(typeof e){case"number":case"boolean":case"string":return!0}return!1}!function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(vn||(vn={}));var _n=performance,Sn=9,En=Math.pow(10,6),Tn=Math.pow(10,Sn);function xn(e){var t=e/1e3;return[Math.trunc(t),Math.round(e%1e3*En)]}function Zn(){var e=_n.timeOrigin;if("number"!==typeof e){var t=_n;e=t.timing&&t.timing.fetchStart}return e}function Cn(e){return On(xn(Zn()),xn("number"===typeof e?e:_n.now()))}function Rn(e){return e[0]*Tn+e[1]}function Pn(e){return Array.isArray(e)&&2===e.length&&"number"===typeof e[0]&&"number"===typeof e[1]}function In(e){return Pn(e)||"number"===typeof e||e instanceof Date}function On(e,t){var n=[e[0]+t[0],e[1]+t[1]];return n[1]>=Tn&&(n[1]-=Tn,n[0]+=1),n}var Dn,Mn={AWS_LAMBDA_INVOKED_ARN:"aws.lambda.invoked_arn",DB_SYSTEM:"db.system",DB_CONNECTION_STRING:"db.connection_string",DB_USER:"db.user",DB_JDBC_DRIVER_CLASSNAME:"db.jdbc.driver_classname",DB_NAME:"db.name",DB_STATEMENT:"db.statement",DB_OPERATION:"db.operation",DB_MSSQL_INSTANCE_NAME:"db.mssql.instance_name",DB_CASSANDRA_KEYSPACE:"db.cassandra.keyspace",DB_CASSANDRA_PAGE_SIZE:"db.cassandra.page_size",DB_CASSANDRA_CONSISTENCY_LEVEL:"db.cassandra.consistency_level",DB_CASSANDRA_TABLE:"db.cassandra.table",DB_CASSANDRA_IDEMPOTENCE:"db.cassandra.idempotence",DB_CASSANDRA_SPECULATIVE_EXECUTION_COUNT:"db.cassandra.speculative_execution_count",DB_CASSANDRA_COORDINATOR_ID:"db.cassandra.coordinator.id",DB_CASSANDRA_COORDINATOR_DC:"db.cassandra.coordinator.dc",DB_HBASE_NAMESPACE:"db.hbase.namespace",DB_REDIS_DATABASE_INDEX:"db.redis.database_index",DB_MONGODB_COLLECTION:"db.mongodb.collection",DB_SQL_TABLE:"db.sql.table",EXCEPTION_TYPE:"exception.type",EXCEPTION_MESSAGE:"exception.message",EXCEPTION_STACKTRACE:"exception.stacktrace",EXCEPTION_ESCAPED:"exception.escaped",FAAS_TRIGGER:"faas.trigger",FAAS_EXECUTION:"faas.execution",FAAS_DOCUMENT_COLLECTION:"faas.document.collection",FAAS_DOCUMENT_OPERATION:"faas.document.operation",FAAS_DOCUMENT_TIME:"faas.document.time",FAAS_DOCUMENT_NAME:"faas.document.name",FAAS_TIME:"faas.time",FAAS_CRON:"faas.cron",FAAS_COLDSTART:"faas.coldstart",FAAS_INVOKED_NAME:"faas.invoked_name",FAAS_INVOKED_PROVIDER:"faas.invoked_provider",FAAS_INVOKED_REGION:"faas.invoked_region",NET_TRANSPORT:"net.transport",NET_PEER_IP:"net.peer.ip",NET_PEER_PORT:"net.peer.port",NET_PEER_NAME:"net.peer.name",NET_HOST_IP:"net.host.ip",NET_HOST_PORT:"net.host.port",NET_HOST_NAME:"net.host.name",NET_HOST_CONNECTION_TYPE:"net.host.connection.type",NET_HOST_CONNECTION_SUBTYPE:"net.host.connection.subtype",NET_HOST_CARRIER_NAME:"net.host.carrier.name",NET_HOST_CARRIER_MCC:"net.host.carrier.mcc",NET_HOST_CARRIER_MNC:"net.host.carrier.mnc",NET_HOST_CARRIER_ICC:"net.host.carrier.icc",PEER_SERVICE:"peer.service",ENDUSER_ID:"enduser.id",ENDUSER_ROLE:"enduser.role",ENDUSER_SCOPE:"enduser.scope",THREAD_ID:"thread.id",THREAD_NAME:"thread.name",CODE_FUNCTION:"code.function",CODE_NAMESPACE:"code.namespace",CODE_FILEPATH:"code.filepath",CODE_LINENO:"code.lineno",HTTP_METHOD:"http.method",HTTP_URL:"http.url",HTTP_TARGET:"http.target",HTTP_HOST:"http.host",HTTP_SCHEME:"http.scheme",HTTP_STATUS_CODE:"http.status_code",HTTP_FLAVOR:"http.flavor",HTTP_USER_AGENT:"http.user_agent",HTTP_REQUEST_CONTENT_LENGTH:"http.request_content_length",HTTP_REQUEST_CONTENT_LENGTH_UNCOMPRESSED:"http.request_content_length_uncompressed",HTTP_RESPONSE_CONTENT_LENGTH:"http.response_content_length",HTTP_RESPONSE_CONTENT_LENGTH_UNCOMPRESSED:"http.response_content_length_uncompressed",HTTP_SERVER_NAME:"http.server_name",HTTP_ROUTE:"http.route",HTTP_CLIENT_IP:"http.client_ip",AWS_DYNAMODB_TABLE_NAMES:"aws.dynamodb.table_names",AWS_DYNAMODB_CONSUMED_CAPACITY:"aws.dynamodb.consumed_capacity",AWS_DYNAMODB_ITEM_COLLECTION_METRICS:"aws.dynamodb.item_collection_metrics",AWS_DYNAMODB_PROVISIONED_READ_CAPACITY:"aws.dynamodb.provisioned_read_capacity",AWS_DYNAMODB_PROVISIONED_WRITE_CAPACITY:"aws.dynamodb.provisioned_write_capacity",AWS_DYNAMODB_CONSISTENT_READ:"aws.dynamodb.consistent_read",AWS_DYNAMODB_PROJECTION:"aws.dynamodb.projection",AWS_DYNAMODB_LIMIT:"aws.dynamodb.limit",AWS_DYNAMODB_ATTRIBUTES_TO_GET:"aws.dynamodb.attributes_to_get",AWS_DYNAMODB_INDEX_NAME:"aws.dynamodb.index_name",AWS_DYNAMODB_SELECT:"aws.dynamodb.select",AWS_DYNAMODB_GLOBAL_SECONDARY_INDEXES:"aws.dynamodb.global_secondary_indexes",AWS_DYNAMODB_LOCAL_SECONDARY_INDEXES:"aws.dynamodb.local_secondary_indexes",AWS_DYNAMODB_EXCLUSIVE_START_TABLE:"aws.dynamodb.exclusive_start_table",AWS_DYNAMODB_TABLE_COUNT:"aws.dynamodb.table_count",AWS_DYNAMODB_SCAN_FORWARD:"aws.dynamodb.scan_forward",AWS_DYNAMODB_SEGMENT:"aws.dynamodb.segment",AWS_DYNAMODB_TOTAL_SEGMENTS:"aws.dynamodb.total_segments",AWS_DYNAMODB_COUNT:"aws.dynamodb.count",AWS_DYNAMODB_SCANNED_COUNT:"aws.dynamodb.scanned_count",AWS_DYNAMODB_ATTRIBUTE_DEFINITIONS:"aws.dynamodb.attribute_definitions",AWS_DYNAMODB_GLOBAL_SECONDARY_INDEX_UPDATES:"aws.dynamodb.global_secondary_index_updates",MESSAGING_SYSTEM:"messaging.system",MESSAGING_DESTINATION:"messaging.destination",MESSAGING_DESTINATION_KIND:"messaging.destination_kind",MESSAGING_TEMP_DESTINATION:"messaging.temp_destination",MESSAGING_PROTOCOL:"messaging.protocol",MESSAGING_PROTOCOL_VERSION:"messaging.protocol_version",MESSAGING_URL:"messaging.url",MESSAGING_MESSAGE_ID:"messaging.message_id",MESSAGING_CONVERSATION_ID:"messaging.conversation_id",MESSAGING_MESSAGE_PAYLOAD_SIZE_BYTES:"messaging.message_payload_size_bytes",MESSAGING_MESSAGE_PAYLOAD_COMPRESSED_SIZE_BYTES:"messaging.message_payload_compressed_size_bytes",MESSAGING_OPERATION:"messaging.operation",MESSAGING_CONSUMER_ID:"messaging.consumer_id",MESSAGING_RABBITMQ_ROUTING_KEY:"messaging.rabbitmq.routing_key",MESSAGING_KAFKA_MESSAGE_KEY:"messaging.kafka.message_key",MESSAGING_KAFKA_CONSUMER_GROUP:"messaging.kafka.consumer_group",MESSAGING_KAFKA_CLIENT_ID:"messaging.kafka.client_id",MESSAGING_KAFKA_PARTITION:"messaging.kafka.partition",MESSAGING_KAFKA_TOMBSTONE:"messaging.kafka.tombstone",RPC_SYSTEM:"rpc.system",RPC_SERVICE:"rpc.service",RPC_METHOD:"rpc.method",RPC_GRPC_STATUS_CODE:"rpc.grpc.status_code",RPC_JSONRPC_VERSION:"rpc.jsonrpc.version",RPC_JSONRPC_REQUEST_ID:"rpc.jsonrpc.request_id",RPC_JSONRPC_ERROR_CODE:"rpc.jsonrpc.error_code",RPC_JSONRPC_ERROR_MESSAGE:"rpc.jsonrpc.error_message",MESSAGE_TYPE:"message.type",MESSAGE_ID:"message.id",MESSAGE_COMPRESSED_SIZE:"message.compressed_size",MESSAGE_UNCOMPRESSED_SIZE:"message.uncompressed_size"},An=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Nn=function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(s){a={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},Ln=function(){function e(e,t,n,r,a,i,o,s,c){void 0===o&&(o=[]),this.attributes={},this.links=[],this.events=[],this.status={code:vn.UNSET},this.endTime=[0,0],this._ended=!1,this._duration=[-1,-1],this.name=n,this._spanContext=r,this.parentSpanId=i,this.kind=a,this.links=o;var u=Date.now();this._performanceStartTime=_n.now(),this._performanceOffset=u-(this._performanceStartTime+Zn()),this._startTimeProvided=null!=s,this.startTime=this._getTime(null!==s&&void 0!==s?s:u),this.resource=e.resource,this.instrumentationLibrary=e.instrumentationLibrary,this._spanLimits=e.getSpanLimits(),this._spanProcessor=e.getActiveSpanProcessor(),this._spanProcessor.onStart(this,t),this._attributeValueLengthLimit=this._spanLimits.attributeValueLengthLimit||0}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(e,t){return null==t||this._isSpanEnded()?this:0===e.length?(K.warn("Invalid attribute key: "+e),this):bn(t)?(Object.keys(this.attributes).length>=this._spanLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,e)||(this.attributes[e]=this._truncateToSize(t)),this):(K.warn("Invalid attribute value set for key: "+e),this)},e.prototype.setAttributes=function(e){var t,n;try{for(var r=An(Object.entries(e)),a=r.next();!a.done;a=r.next()){var i=Nn(a.value,2),o=i[0],s=i[1];this.setAttribute(o,s)}}catch(c){t={error:c}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return this},e.prototype.addEvent=function(e,t,n){if(this._isSpanEnded())return this;if(0===this._spanLimits.eventCountLimit)return K.warn("No events allowed."),this;this.events.length>=this._spanLimits.eventCountLimit&&(K.warn("Dropping extra events."),this.events.shift()),In(t)&&(In(n)||(n=t),t=void 0);var r=yn(t);return this.events.push({name:e,attributes:r,time:this._getTime(n)}),this},e.prototype.setStatus=function(e){return this._isSpanEnded()||(this.status=e),this},e.prototype.updateName=function(e){return this._isSpanEnded()||(this.name=e),this},e.prototype.end=function(e){this._isSpanEnded()?K.error("You can only call end() on a span once."):(this._ended=!0,this.endTime=this._getTime(e),this._duration=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return r<0&&(n-=1,r+=Tn),[n,r]}(this.startTime,this.endTime),this._duration[0]<0&&(K.warn("Inconsistent start and end time, startTime > endTime. Setting span duration to 0ms.",this.startTime,this.endTime),this.endTime=this.startTime.slice(),this._duration=[0,0]),this._spanProcessor.onEnd(this))},e.prototype._getTime=function(e){if("number"===typeof e&&e<_n.now())return Cn(e+this._performanceOffset);if("number"===typeof e)return xn(e);if(e instanceof Date)return xn(e.getTime());if(Pn(e))return e;if(this._startTimeProvided)return xn(Date.now());var t=_n.now()-this._performanceStartTime;return On(this.startTime,xn(t))},e.prototype.isRecording=function(){return!1===this._ended},e.prototype.recordException=function(e,t){var n={};"string"===typeof e?n[Mn.EXCEPTION_MESSAGE]=e:e&&(e.code?n[Mn.EXCEPTION_TYPE]=e.code.toString():e.name&&(n[Mn.EXCEPTION_TYPE]=e.name),e.message&&(n[Mn.EXCEPTION_MESSAGE]=e.message),e.stack&&(n[Mn.EXCEPTION_STACKTRACE]=e.stack)),n[Mn.EXCEPTION_TYPE]||n[Mn.EXCEPTION_MESSAGE]?this.addEvent("exception",n,t):K.warn("Failed to record an exception "+e)},Object.defineProperty(e.prototype,"duration",{get:function(){return this._duration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ended",{get:function(){return this._ended},enumerable:!1,configurable:!0}),e.prototype._isSpanEnded=function(){return this._ended&&K.warn("Can not execute the operation on ended Span {traceId: "+this._spanContext.traceId+", spanId: "+this._spanContext.spanId+"}"),this._ended},e.prototype._truncateToLimitUtil=function(e,t){return e.length<=t?e:e.substr(0,t)},e.prototype._truncateToSize=function(e){var t=this,n=this._attributeValueLengthLimit;return n<=0?(K.warn("Attribute value limit must be positive, got "+n),e):"string"===typeof e?this._truncateToLimitUtil(e,n):Array.isArray(e)?e.map((function(e){return"string"===typeof e?t._truncateToLimitUtil(e,n):e})):e},e}();!function(e){e[e.NOT_RECORD=0]="NOT_RECORD",e[e.RECORD=1]="RECORD",e[e.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(Dn||(Dn={}));var jn=function(){function e(){}return e.prototype.shouldSample=function(){return{decision:Dn.NOT_RECORD}},e.prototype.toString=function(){return"AlwaysOffSampler"},e}(),Fn=function(){function e(){}return e.prototype.shouldSample=function(){return{decision:Dn.RECORD_AND_SAMPLED}},e.prototype.toString=function(){return"AlwaysOnSampler"},e}();var Un=function(e){K.error(function(e){return"string"===typeof e?e:JSON.stringify(function(e){for(var t={},n=e;null!==n;)Object.getOwnPropertyNames(n).forEach((function(e){if(!t[e]){var r=n[e];r&&(t[e]=String(r))}})),n=Object.getPrototypeOf(n);return t}(e))}(e))};function Bn(e){try{Un(e)}catch(rn){}}var Vn=function(){function e(e){var t,n,r,a;this._root=e.root,this._root||(Bn(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new Fn),this._remoteParentSampled=null!==(t=e.remoteParentSampled)&&void 0!==t?t:new Fn,this._remoteParentNotSampled=null!==(n=e.remoteParentNotSampled)&&void 0!==n?n:new jn,this._localParentSampled=null!==(r=e.localParentSampled)&&void 0!==r?r:new Fn,this._localParentNotSampled=null!==(a=e.localParentNotSampled)&&void 0!==a?a:new jn}return e.prototype.shouldSample=function(e,t,n,r,a,i){var o=Ie.getSpanContext(e);return o&&_e(o)?o.isRemote?o.traceFlags&Q.SAMPLED?this._remoteParentSampled.shouldSample(e,t,n,r,a,i):this._remoteParentNotSampled.shouldSample(e,t,n,r,a,i):o.traceFlags&Q.SAMPLED?this._localParentSampled.shouldSample(e,t,n,r,a,i):this._localParentNotSampled.shouldSample(e,t,n,r,a,i):this._root.shouldSample(e,t,n,r,a,i)},e.prototype.toString=function(){return"ParentBased{root="+this._root.toString()+", remoteParentSampled="+this._remoteParentSampled.toString()+", remoteParentNotSampled="+this._remoteParentNotSampled.toString()+", localParentSampled="+this._localParentSampled.toString()+", localParentNotSampled="+this._localParentNotSampled.toString()+"}"},e}(),Hn=function(){function e(e){void 0===e&&(e=0),this._ratio=e,this._ratio=this._normalize(e),this._upperBound=Math.floor(4294967295*this._ratio)}return e.prototype.shouldSample=function(e,t){return{decision:we(t)&&this._accumulate(t)<this._upperBound?Dn.RECORD_AND_SAMPLED:Dn.NOT_RECORD}},e.prototype.toString=function(){return"TraceIdRatioBased{"+this._ratio+"}"},e.prototype._normalize=function(e){return"number"!==typeof e||isNaN(e)?0:e>=1?1:e<=0?0:e},e.prototype._accumulate=function(e){for(var t=0,n=0;n<e.length/8;n++){var r=8*n;t=(t^parseInt(e.slice(r,r+8),16))>>>0}return t},e}(),zn=At(),Wn=ut.AlwaysOn,Gn=1;function qn(){return{sampler:$n(zn),forceFlushTimeoutMillis:3e4,generalLimits:{attributeValueLengthLimit:At().OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:At().OTEL_ATTRIBUTE_COUNT_LIMIT},spanLimits:{attributeValueLengthLimit:At().OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:At().OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT,linkCountLimit:At().OTEL_SPAN_LINK_COUNT_LIMIT,eventCountLimit:At().OTEL_SPAN_EVENT_COUNT_LIMIT}}}function $n(e){switch(void 0===e&&(e=At()),e.OTEL_TRACES_SAMPLER){case ut.AlwaysOn:return new Fn;case ut.AlwaysOff:return new jn;case ut.ParentBasedAlwaysOn:return new Vn({root:new Fn});case ut.ParentBasedAlwaysOff:return new Vn({root:new jn});case ut.TraceIdRatio:return new Hn(Kn(e));case ut.ParentBasedTraceIdRatio:return new Vn({root:new Hn(Kn(e))});default:return K.error('OTEL_TRACES_SAMPLER value "'+e.OTEL_TRACES_SAMPLER+" invalid, defaulting to "+Wn+'".'),new Fn}}function Kn(e){if(void 0===e.OTEL_TRACES_SAMPLER_ARG||""===e.OTEL_TRACES_SAMPLER_ARG)return K.error("OTEL_TRACES_SAMPLER_ARG is blank, defaulting to "+Gn+"."),Gn;var t=Number(e.OTEL_TRACES_SAMPLER_ARG);return isNaN(t)?(K.error("OTEL_TRACES_SAMPLER_ARG="+e.OTEL_TRACES_SAMPLER_ARG+" was given, but it is invalid, defaulting to "+Gn+"."),Gn):t<0||t>1?(K.error("OTEL_TRACES_SAMPLER_ARG="+e.OTEL_TRACES_SAMPLER_ARG+" was given, but it is out of range ([0..1]), defaulting to "+Gn+"."),Gn):t}function Jn(e){var t,n,r,a,i,o,s,c,u,l,d,p,f=Object.assign({},e.spanLimits),h="undefined"!==typeof process?Mt({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}):Mt(yt);return f.attributeCountLimit=null!==(o=null!==(i=null!==(a=null!==(n=null===(t=e.spanLimits)||void 0===t?void 0:t.attributeCountLimit)&&void 0!==n?n:null===(r=e.generalLimits)||void 0===r?void 0:r.attributeCountLimit)&&void 0!==a?a:h.OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT)&&void 0!==i?i:h.OTEL_ATTRIBUTE_COUNT_LIMIT)&&void 0!==o?o:Zt,f.attributeValueLengthLimit=null!==(p=null!==(d=null!==(l=null!==(c=null===(s=e.spanLimits)||void 0===s?void 0:s.attributeValueLengthLimit)&&void 0!==c?c:null===(u=e.generalLimits)||void 0===u?void 0:u.attributeValueLengthLimit)&&void 0!==l?l:h.OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT)&&void 0!==d?d:h.OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT)&&void 0!==p?p:xt,Object.assign({},e,{spanLimits:f})}var Qn=8,Xn=16,Yn=function(){this.generateTraceId=tr(Xn),this.generateSpanId=tr(Qn)},er=Array(32);function tr(e){return function(){for(var t=0;t<2*e;t++)er[t]=Math.floor(16*Math.random())+48,er[t]>=58&&(er[t]+=39);return String.fromCharCode.apply(null,er.slice(0,2*e))}}var nr,rr=function(){function e(e,t,n){this._tracerProvider=n;var r=function(e){var t={sampler:$n()},n=qn(),r=Object.assign({},n,t,e);return r.generalLimits=Object.assign({},n.generalLimits,e.generalLimits||{}),r.spanLimits=Object.assign({},n.spanLimits,e.spanLimits||{}),r}(t);this._sampler=r.sampler,this._generalLimits=r.generalLimits,this._spanLimits=r.spanLimits,this._idGenerator=t.idGenerator||new Yn,this.resource=n.resource,this.instrumentationLibrary=e}return e.prototype.startSpan=function(e,t,n){var r,a;void 0===t&&(t={}),void 0===n&&(n=Oe.active()),t.root&&(n=Ie.deleteSpan(n));var i=Ie.getSpan(n);if(Ft(n))return K.debug("Instrumentation suppressed, returning Noop Span"),Ie.wrapSpanContext(le);var o,s,c,u=null===i||void 0===i?void 0:i.spanContext(),l=this._idGenerator.generateSpanId();u&&Ie.isSpanContextValid(u)?(o=u.traceId,s=u.traceState,c=u.spanId):o=this._idGenerator.generateTraceId();var d=null!==(r=t.kind)&&void 0!==r?r:pn.INTERNAL,p=(null!==(a=t.links)&&void 0!==a?a:[]).map((function(e){return{context:e.context,attributes:yn(e.attributes)}})),f=yn(t.attributes),h=this._sampler.shouldSample(n,o,e,d,f,p),v={traceId:o,spanId:l,traceFlags:h.decision===fn.RECORD_AND_SAMPLED?Q.SAMPLED:Q.NONE,traceState:s};if(h.decision===fn.NOT_RECORD)return K.debug("Recording is off, propagating context in a non-recording span"),Ie.wrapSpanContext(v);var m=new Ln(this,n,e,v,d,c,p,t.startTime),g=yn(Object.assign(f,h.attributes));return m.setAttributes(g),m},e.prototype.startActiveSpan=function(e,t,n,r){var a,i,o;if(!(arguments.length<2)){2===arguments.length?o=t:3===arguments.length?(a=t,o=n):(a=t,i=n,o=r);var s=null!==i&&void 0!==i?i:Oe.active(),c=this.startSpan(e,a,s),u=Ie.setSpan(s,c);return Oe.with(u,o,void 0,c)}},e.prototype.getGeneralLimits=function(){return this._generalLimits},e.prototype.getSpanLimits=function(){return this._spanLimits},e.prototype.getActiveSpanProcessor=function(){return this._tracerProvider.getActiveSpanProcessor()},e}(),ar=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},ir=function(){function e(e){this._spanProcessors=e}return e.prototype.forceFlush=function(){var e,t,n=[];try{for(var r=ar(this._spanProcessors),a=r.next();!a.done;a=r.next()){var i=a.value;n.push(i.forceFlush())}}catch(o){e={error:o}}finally{try{a&&!a.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return new Promise((function(e){Promise.all(n).then((function(){e()})).catch((function(t){Bn(t||new Error("MultiSpanProcessor: forceFlush failed")),e()}))}))},e.prototype.onStart=function(e,t){var n,r;try{for(var a=ar(this._spanProcessors),i=a.next();!i.done;i=a.next()){i.value.onStart(e,t)}}catch(o){n={error:o}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}},e.prototype.onEnd=function(e){var t,n;try{for(var r=ar(this._spanProcessors),a=r.next();!a.done;a=r.next()){a.value.onEnd(e)}}catch(i){t={error:i}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e.prototype.shutdown=function(){var e,t,n=[];try{for(var r=ar(this._spanProcessors),a=r.next();!a.done;a=r.next()){var i=a.value;n.push(i.shutdown())}}catch(o){e={error:o}}finally{try{a&&!a.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return new Promise((function(e,t){Promise.all(n).then((function(){e()}),t)}))},e}(),or=function(){function e(){}return e.prototype.onStart=function(e,t){},e.prototype.onEnd=function(e){},e.prototype.shutdown=function(){return Promise.resolve()},e.prototype.forceFlush=function(){return Promise.resolve()},e}(),sr=function(){function e(){var e=this;this._promise=new Promise((function(t,n){e._resolve=t,e._reject=n}))}return Object.defineProperty(e.prototype,"promise",{get:function(){return this._promise},enumerable:!1,configurable:!0}),e.prototype.resolve=function(e){this._resolve(e)},e.prototype.reject=function(e){this._reject(e)},e}(),cr=function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(s){a={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},ur=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},lr=function(){function e(e,t){this._callback=e,this._that=t,this._isCalled=!1,this._deferred=new sr}return Object.defineProperty(e.prototype,"isCalled",{get:function(){return this._isCalled},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"promise",{get:function(){return this._deferred.promise},enumerable:!1,configurable:!0}),e.prototype.call=function(){for(var e,t=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(!this._isCalled){this._isCalled=!0;try{Promise.resolve((e=this._callback).call.apply(e,ur([this._that],cr(n),!1))).then((function(e){return t._deferred.resolve(e)}),(function(e){return t._deferred.reject(e)}))}catch(a){this._deferred.reject(a)}}return this._deferred.promise},e}();!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.FAILED=1]="FAILED"}(nr||(nr={}));var dr,pr=function(){function e(e,t){this._exporter=e,this._finishedSpans=[];var n=At();this._maxExportBatchSize="number"===typeof(null===t||void 0===t?void 0:t.maxExportBatchSize)?t.maxExportBatchSize:n.OTEL_BSP_MAX_EXPORT_BATCH_SIZE,this._maxQueueSize="number"===typeof(null===t||void 0===t?void 0:t.maxQueueSize)?t.maxQueueSize:n.OTEL_BSP_MAX_QUEUE_SIZE,this._scheduledDelayMillis="number"===typeof(null===t||void 0===t?void 0:t.scheduledDelayMillis)?t.scheduledDelayMillis:n.OTEL_BSP_SCHEDULE_DELAY,this._exportTimeoutMillis="number"===typeof(null===t||void 0===t?void 0:t.exportTimeoutMillis)?t.exportTimeoutMillis:n.OTEL_BSP_EXPORT_TIMEOUT,this._shutdownOnce=new lr(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(K.warn("BatchSpanProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}return e.prototype.forceFlush=function(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()},e.prototype.onStart=function(e,t){},e.prototype.onEnd=function(e){this._shutdownOnce.isCalled||0!==(e.spanContext().traceFlags&Q.SAMPLED)&&this._addToBuffer(e)},e.prototype.shutdown=function(){return this._shutdownOnce.call()},e.prototype._shutdown=function(){var e=this;return Promise.resolve().then((function(){return e.onShutdown()})).then((function(){return e._flushAll()})).then((function(){return e._exporter.shutdown()}))},e.prototype._addToBuffer=function(e){this._finishedSpans.length>=this._maxQueueSize||(this._finishedSpans.push(e),this._maybeStartTimer())},e.prototype._flushAll=function(){var e=this;return new Promise((function(t,n){for(var r=[],a=0,i=Math.ceil(e._finishedSpans.length/e._maxExportBatchSize);a<i;a++)r.push(e._flushOneBatch());Promise.all(r).then((function(){t()})).catch(n)}))},e.prototype._flushOneBatch=function(){var e=this;return this._clearTimer(),0===this._finishedSpans.length?Promise.resolve():new Promise((function(t,n){var r=setTimeout((function(){n(new Error("Timeout"))}),e._exportTimeoutMillis);Oe.with(Oe.active().setValue(jt,!0),(function(){e._exporter.export(e._finishedSpans.splice(0,e._maxExportBatchSize),(function(e){var a;clearTimeout(r),e.code===nr.SUCCESS?t():n(null!==(a=e.error)&&void 0!==a?a:new Error("BatchSpanProcessor: span export failed"))}))}))}))},e.prototype._maybeStartTimer=function(){var e=this;void 0===this._timer&&(this._timer=setTimeout((function(){e._flushOneBatch().then((function(){e._finishedSpans.length>0&&(e._clearTimer(),e._maybeStartTimer())})).catch((function(e){Bn(e)}))}),this._scheduledDelayMillis),this._timer)},e.prototype._clearTimer=function(){void 0!==this._timer&&(clearTimeout(this._timer),this._timer=void 0)},e}(),fr=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),hr=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.onInit(n),r}return fr(t,e),t.prototype.onInit=function(e){var t=this;!0!==(null===e||void 0===e?void 0:e.disableAutoFlushOnDocumentHide)&&"undefined"!==typeof document&&(this._visibilityChangeListener=function(){"hidden"===document.visibilityState&&t.forceFlush()},this._pageHideListener=function(){t.forceFlush()},document.addEventListener("visibilitychange",this._visibilityChangeListener),document.addEventListener("pagehide",this._pageHideListener))},t.prototype.onShutdown=function(){"undefined"!==typeof document&&(this._visibilityChangeListener&&document.removeEventListener("visibilitychange",this._visibilityChangeListener),this._pageHideListener&&document.removeEventListener("pagehide",this._pageHideListener))},t}(pr);!function(e){e[e.resolved=0]="resolved",e[e.timeout=1]="timeout",e[e.error=2]="error",e[e.unresolved=3]="unresolved"}(dr||(dr={}));var vr=function(){function e(e){var t;void 0===e&&(e={}),this._registeredSpanProcessors=[],this._tracers=new Map;var n=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=e.shift(),r=new WeakMap;e.length>0;)n=pt(n,e.shift(),0,r);return n}({},qn(),Jn(e));this.resource=null!==(t=n.resource)&&void 0!==t?t:hn.empty(),this.resource=hn.default().merge(this.resource),this._config=Object.assign({},n,{resource:this.resource});var r=this._buildExporterFromEnv();if(void 0!==r){var a=new hr(r);this.activeSpanProcessor=a}else this.activeSpanProcessor=new or}return e.prototype.getTracer=function(e,t,n){var r=e+"@"+(t||"")+":"+((null===n||void 0===n?void 0:n.schemaUrl)||"");return this._tracers.has(r)||this._tracers.set(r,new rr({name:e,version:t,schemaUrl:null===n||void 0===n?void 0:n.schemaUrl},this._config,this)),this._tracers.get(r)},e.prototype.addSpanProcessor=function(e){0===this._registeredSpanProcessors.length&&this.activeSpanProcessor.shutdown().catch((function(e){return K.error("Error while trying to shutdown current span processor",e)})),this._registeredSpanProcessors.push(e),this.activeSpanProcessor=new ir(this._registeredSpanProcessors)},e.prototype.getActiveSpanProcessor=function(){return this.activeSpanProcessor},e.prototype.register=function(e){void 0===e&&(e={}),Ie.setGlobalTracerProvider(this),void 0===e.propagator&&(e.propagator=this._buildPropagatorFromEnv()),e.contextManager&&Oe.setGlobalContextManager(e.contextManager),e.propagator&&Qe.setGlobalPropagator(e.propagator)},e.prototype.forceFlush=function(){var e=this._config.forceFlushTimeoutMillis,t=this._registeredSpanProcessors.map((function(t){return new Promise((function(n){var r,a=setTimeout((function(){n(new Error("Span processor did not completed within timeout period of "+e+" ms")),r=dr.timeout}),e);t.forceFlush().then((function(){clearTimeout(a),r!==dr.timeout&&(r=dr.resolved,n(r))})).catch((function(e){clearTimeout(a),r=dr.error,n(e)}))}))}));return new Promise((function(e,n){Promise.all(t).then((function(t){var r=t.filter((function(e){return e!==dr.resolved}));r.length>0?n(r):e()})).catch((function(e){return n([e])}))}))},e.prototype.shutdown=function(){return this.activeSpanProcessor.shutdown()},e.prototype._getPropagator=function(e){var t;return null===(t=this.constructor._registeredPropagators.get(e))||void 0===t?void 0:t()},e.prototype._getSpanExporter=function(e){var t;return null===(t=this.constructor._registeredExporters.get(e))||void 0===t?void 0:t()},e.prototype._buildPropagatorFromEnv=function(){var e=this,t=Array.from(new Set(At().OTEL_PROPAGATORS)),n=t.map((function(t){var n=e._getPropagator(t);return n||K.warn('Propagator "'+t+'" requested through environment variable is unavailable.'),n})).reduce((function(e,t){return t&&e.push(t),e}),[]);return 0===n.length?void 0:1===t.length?n[0]:new Lt({propagators:n})},e.prototype._buildExporterFromEnv=function(){var e=At().OTEL_TRACES_EXPORTER;if("none"!==e&&""!==e){var t=this._getSpanExporter(e);return t||K.error('Exporter "'+e+'" requested through environment variable is unavailable.'),t}},e._registeredPropagators=new Map([["tracecontext",function(){return new $t}],["baggage",function(){return new an}]]),e._registeredExporters=new Map,e}(),mr=function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(s){a={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},gr=function(e,t,n){if(n||2===arguments.length)for(var r,a=0,i=t.length;a<i;a++)!r&&a in t||(r||(r=Array.prototype.slice.call(t,0,a)),r[a]=t[a]);return e.concat(r||Array.prototype.slice.call(t))},yr=function(){function e(){this._enabled=!1,this._currentContext=Y}return e.prototype._bindFunction=function(e,t){void 0===e&&(e=Y);var n=this,r=function(){for(var r=this,a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];return n.with(e,(function(){return t.apply(r,a)}))};return Object.defineProperty(r,"length",{enumerable:!1,configurable:!0,writable:!1,value:t.length}),r},e.prototype.active=function(){return this._currentContext},e.prototype.bind=function(e,t){return void 0===e&&(e=this.active()),"function"===typeof t?this._bindFunction(e,t):t},e.prototype.disable=function(){return this._currentContext=Y,this._enabled=!1,this},e.prototype.enable=function(){return this._enabled||(this._enabled=!0,this._currentContext=Y),this},e.prototype.with=function(e,t,n){for(var r=[],a=3;a<arguments.length;a++)r[a-3]=arguments[a];var i=this._currentContext;this._currentContext=e||Y;try{return t.call.apply(t,gr([n],mr(r),!1))}finally{this._currentContext=i}},e}(),kr=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),br=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;if(t.contextManager)throw"contextManager should be defined in register method not in constructor";if(t.propagator)throw"propagator should be defined in register method not in constructor";return n}return kr(t,e),t.prototype.register=function(t){void 0===t&&(t={}),void 0===t.contextManager&&(t.contextManager=new yr),t.contextManager&&t.contextManager.enable(),e.prototype.register.call(this,t)},t}(vr),wr=function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(s){a={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o},_r=1e4;function Sr(e){return"number"===typeof e?e<=0?Er(e,_r):e:function(){var e,t=Number(null!==(e=At().OTEL_EXPORTER_OTLP_TRACES_TIMEOUT)&&void 0!==e?e:At().OTEL_EXPORTER_OTLP_TIMEOUT);return t<=0?Er(t,_r):t}()}function Er(e,t){return K.warn("Timeout must be greater than 0",e),t}var Tr=function(){function e(e){void 0===e&&(e={}),this._sendingPromises=[],this.url=this.getDefaultUrl(e),"string"===typeof e.hostname&&(this.hostname=e.hostname),this.shutdown=this.shutdown.bind(this),this._shutdownOnce=new lr(this._shutdown,this),this._concurrencyLimit="number"===typeof e.concurrencyLimit?e.concurrencyLimit:1/0,this.timeoutMillis=Sr(e.timeoutMillis),this.onInit(e)}return e.prototype.export=function(e,t){this._shutdownOnce.isCalled?t({code:nr.FAILED,error:new Error("Exporter has been shutdown")}):this._sendingPromises.length>=this._concurrencyLimit?t({code:nr.FAILED,error:new Error("Concurrent export limit reached")}):this._export(e).then((function(){t({code:nr.SUCCESS})})).catch((function(e){t({code:nr.FAILED,error:e})}))},e.prototype._export=function(e){var t=this;return new Promise((function(n,r){try{K.debug("items to be sent",e),t.send(e,n,r)}catch(a){r(a)}}))},e.prototype.shutdown=function(){return this._shutdownOnce.call()},e.prototype._shutdown=function(){return K.debug("shutdown started"),this.onShutdown(),Promise.all(this._sendingPromises).then((function(){}))},e}(),xr=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Zr=function(e){function t(t,n,r){var a=e.call(this,t)||this;return a.name="OTLPExporterError",a.data=r,a.code=n,a}return xr(t,e),t}(Error),Cr=function(){return Cr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},Cr.apply(this,arguments)},Rr=function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(s){a={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};var Pr=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ir=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._useXHR=!1,n._useXHR=!!t.headers||"function"!==typeof navigator.sendBeacon,n._useXHR?n._headers=Object.assign({},function(e){void 0===e&&(e={});var t={};return Object.entries(e).forEach((function(e){var n=wr(e,2),r=n[0],a=n[1];"undefined"!==typeof a?t[r]=String(a):K.warn('Header "'+r+'" has wrong value and will be ignored')})),t}(t.headers),nn(At().OTEL_EXPORTER_OTLP_HEADERS)):n._headers={},n}return Pr(t,e),t.prototype.onInit=function(){window.addEventListener("unload",this.shutdown)},t.prototype.onShutdown=function(){window.removeEventListener("unload",this.shutdown)},t.prototype.send=function(e,t,n){var r=this;if(this._shutdownOnce.isCalled)K.debug("Shutdown already started. Cannot send objects");else{var a=this.convert(e),i=JSON.stringify(a),o=new Promise((function(e,t){r._useXHR?function(e,t,n,r,a,i){var o,s=setTimeout((function(){o=!0,c.abort()}),r),c=new XMLHttpRequest;c.open("POST",t),Object.entries(Cr(Cr({},{Accept:"application/json","Content-Type":"application/json"}),n)).forEach((function(e){var t=Rr(e,2),n=t[0],r=t[1];c.setRequestHeader(n,r)})),c.send(e),c.onreadystatechange=function(){if(c.readyState===XMLHttpRequest.DONE)if(c.status>=200&&c.status<=299)clearTimeout(s),K.debug("xhr success",e),a();else if(o){var t=new Zr("Request Timeout",c.status);i(t)}else t=new Zr("Failed to export with XHR (status: "+c.status+")",c.status),clearTimeout(s),i(t)}}(i,r.url,r._headers,r.timeoutMillis,e,t):function(e,t,n,r,a){navigator.sendBeacon(t,new Blob([e],n))?(K.debug("sendBeacon - can send",e),r()):a(new Zr("sendBeacon - cannot send "+e))}(i,r.url,{type:"application/json"},e,t)})).then(t,n);this._sendingPromises.push(o);var s=function(){var e=r._sendingPromises.indexOf(o);r._sendingPromises.splice(e,1)};o.then(s,s)}},t}(Tr),Or=function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(s){a={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};function Dr(e){return Object.keys(e).map((function(t){return Mr(t,e[t])}))}function Mr(e,t){return{key:e,value:Ar(t)}}function Ar(e){var t=typeof e;return"string"===t?{stringValue:e}:"number"===t?Number.isInteger(e)?{intValue:e}:{doubleValue:e}:"boolean"===t?{boolValue:e}:e instanceof Uint8Array?{bytesValue:e}:Array.isArray(e)?{arrayValue:{values:e.map(Ar)}}:"object"===t&&null!=e?{kvlistValue:{values:Object.entries(e).map((function(e){var t=Or(e,2);return Mr(t[0],t[1])}))}}:{}}function Nr(e){for(var t=e.length,n="",r=0;r<t;r+=2){var a=e.substring(r,r+2),i=parseInt(a,16);n+=String.fromCharCode(i)}return btoa(n)}function Lr(e,t){var n,r=e.spanContext(),a=e.status,i=t?e.parentSpanId:null!=e.parentSpanId?Nr(e.parentSpanId):void 0;return{traceId:t?r.traceId:Nr(r.traceId),spanId:t?r.spanId:Nr(r.spanId),parentSpanId:i,traceState:null===(n=r.traceState)||void 0===n?void 0:n.serialize(),name:e.name,kind:null==e.kind?0:e.kind+1,startTimeUnixNano:Rn(e.startTime),endTimeUnixNano:Rn(e.endTime),attributes:Dr(e.attributes),droppedAttributesCount:0,events:e.events.map(jr),droppedEventsCount:0,status:{code:a.code,message:a.message},links:e.links.map((function(e){return function(e,t){var n;return{attributes:e.attributes?Dr(e.attributes):[],spanId:t?e.context.spanId:Nr(e.context.spanId),traceId:t?e.context.traceId:Nr(e.context.traceId),traceState:null===(n=e.context.traceState)||void 0===n?void 0:n.serialize(),droppedAttributesCount:0}}(e,t)})),droppedLinksCount:0}}function jr(e){return{attributes:e.attributes?Dr(e.attributes):[],name:e.name,timeUnixNano:Rn(e.time),droppedAttributesCount:0}}var Fr=function(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Ur=function(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,i=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(s){a={error:s}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return o};function Br(e,t){for(var n=function(e){var t,n,r=new Map;try{for(var a=Fr(e),i=a.next();!i.done;i=a.next()){var o=i.value,s=r.get(o.resource);s||(s=new Map,r.set(o.resource,s));var c=o.instrumentationLibrary.name+"@"+(o.instrumentationLibrary.version||"")+":"+(o.instrumentationLibrary.schemaUrl||""),u=s.get(c);u||(u=[],s.set(c,u)),u.push(o)}}catch(l){t={error:l}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return r}(e),r=[],a=n.entries(),i=a.next();!i.done;){for(var o=Ur(i.value,2),s=o[0],c=[],u=o[1].values(),l=u.next();!l.done;){var d=l.value;if(d.length>0){var p=d[0].instrumentationLibrary,f=p.name,h=p.version,v=p.schemaUrl,m=d.map((function(e){return Lr(e,t)}));c.push({scope:{name:f,version:h},spans:m,schemaUrl:v})}l=u.next()}var g={resource:{attributes:Dr(s.attributes),droppedAttributesCount:0},scopeSpans:c,schemaUrl:void 0};r.push(g),i=a.next()}return r}var Vr=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Hr="v1/traces",zr="http://localhost:4318/"+Hr,Wr=function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;return n._headers=Object.assign(n._headers,nn(At().OTEL_EXPORTER_OTLP_TRACES_HEADERS)),n}return Vr(t,e),t.prototype.convert=function(e){return function(e,t){return{resourceSpans:Br(e,t)}}(e,!0)},t.prototype.getDefaultUrl=function(e){return"string"===typeof e.url?e.url:At().OTEL_EXPORTER_OTLP_TRACES_ENDPOINT.length>0?function(e){try{var t=new URL(e);return""===t.pathname&&(t.pathname=t.pathname+"/"),t.toString()}catch(rn){return K.warn("Could not parse export URL: '"+e+"'"),e}}(At().OTEL_EXPORTER_OTLP_TRACES_ENDPOINT):At().OTEL_EXPORTER_OTLP_ENDPOINT.length>0?function(e,t){return e.endsWith("/")||(e+="/"),e+t}(At().OTEL_EXPORTER_OTLP_ENDPOINT,Hr):zr},t}(Ir);var Gr="OT_ZONE_CONTEXT",qr=function(){function e(){this._enabled=!1,this._zoneCounter=0}return e.prototype._activeContextFromZone=function(e){return e&&e.get(Gr)||Y},e.prototype._bindFunction=function(e,t){var n=this,r=function(){for(var r=this,a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];return n.with(e,(function(){return t.apply(r,a)}))};return Object.defineProperty(r,"length",{enumerable:!1,configurable:!0,writable:!1,value:t.length}),r},e.prototype._bindListener=function(e,t){var n=t;return void 0!==n.__ot_listeners||(n.__ot_listeners={},"function"===typeof n.addEventListener&&(n.addEventListener=this._patchAddEventListener(n,n.addEventListener,e)),"function"===typeof n.removeEventListener&&(n.removeEventListener=this._patchRemoveEventListener(n,n.removeEventListener))),t},e.prototype._createZoneName=function(){this._zoneCounter++;var e=Math.random();return this._zoneCounter+"-"+e},e.prototype._createZone=function(e,t){var n;return Zone.current.fork({name:e,properties:(n={},n[Gr]=t,n)})},e.prototype._getActiveZone=function(){return Zone.current},e.prototype._patchAddEventListener=function(e,t,n){var r=this;return function(a,i,o){void 0===e.__ot_listeners&&(e.__ot_listeners={});var s=e.__ot_listeners[a];void 0===s&&(s=new WeakMap,e.__ot_listeners[a]=s);var c=r.bind(n,i);return s.set(i,c),t.call(this,a,c,o)}},e.prototype._patchRemoveEventListener=function(e,t){return function(n,r){if(void 0===e.__ot_listeners||void 0===e.__ot_listeners[n])return t.call(this,n,r);var a=e.__ot_listeners[n],i=a.get(r);return a.delete(r),t.call(this,n,i||r)}},e.prototype.active=function(){if(!this._enabled)return Y;var e=this._getActiveZone(),t=this._activeContextFromZone(e);return t||Y},e.prototype.bind=function(e,t){return void 0===e&&(e=this.active()),"function"===typeof t?this._bindFunction(e,t):(void 0===(n=t)&&(n={}),"function"===typeof n.addEventListener&&"function"===typeof n.removeEventListener&&this._bindListener(e,t),t);var n},e.prototype.disable=function(){return this._enabled=!1,this},e.prototype.enable=function(){return this._enabled=!0,this},e.prototype.with=function(e,t,n){for(var r=[],a=3;a<arguments.length;a++)r[a-3]=arguments[a];var i=this._createZoneName();return this._createZone(i,e).run(t,n,r)},e}(),$r=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!==typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Kr=function(){function e(){}return e.prototype.createHistogram=function(e,t){return oa},e.prototype.createCounter=function(e,t){return ia},e.prototype.createUpDownCounter=function(e,t){return sa},e.prototype.createObservableGauge=function(e,t){return ua},e.prototype.createObservableCounter=function(e,t){return ca},e.prototype.createObservableUpDownCounter=function(e,t){return la},e.prototype.addBatchObservableCallback=function(e,t){},e.prototype.removeBatchObservableCallback=function(e){},e}(),Jr=function(){},Qr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $r(t,e),t.prototype.add=function(e,t){},t}(Jr),Xr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $r(t,e),t.prototype.add=function(e,t){},t}(Jr),Yr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $r(t,e),t.prototype.record=function(e,t){},t}(Jr),ea=function(){function e(){}return e.prototype.addCallback=function(e){},e.prototype.removeCallback=function(e){},e}(),ta=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $r(t,e),t}(ea),na=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $r(t,e),t}(ea),ra=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $r(t,e),t}(ea),aa=new Kr,ia=new Qr,oa=new Yr,sa=new Xr,ca=new ta,ua=new na,la=new ra;var da,pa,fa,ha=new(function(){function e(){}return e.prototype.getMeter=function(e,t,n){return aa},e}()),va="metrics",ma=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalMeterProvider=function(e){return L(va,e,$.instance())},e.prototype.getMeterProvider=function(){return j(va)||ha},e.prototype.getMeter=function(e,t,n){return this.getMeterProvider().getMeter(e,t,n)},e.prototype.disable=function(){F(va,$.instance())},e}().getInstance(),ga={context:Oe,diag:K,metrics:ma,propagation:Qe,trace:Ie},ya=n(5524),ka=n.n(ya),ba=n(2389),wa=function(e,t){var n=null;return function(){if(null!==n)return n;var r=new Blob([t],{type:"application/javascript; charset=utf-8"}),a=URL.createObjectURL(r);return n=e(a),setTimeout((function(){return URL.revokeObjectURL(a)})),n}}((function(e){var t=new Map([[0,function(){}]]),n=new Map([[0,function(){}]]),r=new Map,a=new Worker(e);a.addEventListener("message",(function(e){var a=e.data;if(function(e){return void 0!==e.method&&"call"===e.method}(a)){var i=a.params,o=i.timerId,s=i.timerType;if("interval"===s){var c=t.get(o);if("number"===typeof c){var u=r.get(c);if(void 0===u||u.timerId!==o||u.timerType!==s)throw new Error("The timer is in an undefined state.")}else{if("undefined"===typeof c)throw new Error("The timer is in an undefined state.");c()}}else if("timeout"===s){var l=n.get(o);if("number"===typeof l){var d=r.get(l);if(void 0===d||d.timerId!==o||d.timerType!==s)throw new Error("The timer is in an undefined state.")}else{if("undefined"===typeof l)throw new Error("The timer is in an undefined state.");l(),n.delete(o)}}}else{if(!function(e){return null===e.error&&"number"===typeof e.id}(a)){var p=a.error.message;throw new Error(p)}var f=a.id,h=r.get(f);if(void 0===h)throw new Error("The timer is in an undefined state.");var v=h.timerId,m=h.timerType;r.delete(f),"interval"===m?t.delete(v):n.delete(v)}}));return{clearInterval:function(e){var n=(0,ba.generateUniqueNumber)(r);r.set(n,{timerId:e,timerType:"interval"}),t.set(e,n),a.postMessage({id:n,method:"clear",params:{timerId:e,timerType:"interval"}})},clearTimeout:function(e){var t=(0,ba.generateUniqueNumber)(r);r.set(t,{timerId:e,timerType:"timeout"}),n.set(e,t),a.postMessage({id:t,method:"clear",params:{timerId:e,timerType:"timeout"}})},setInterval:function(e,n){var r=(0,ba.generateUniqueNumber)(t);return t.set(r,(function(){e(),"function"===typeof t.get(r)&&a.postMessage({id:null,method:"set",params:{delay:n,now:performance.now(),timerId:r,timerType:"interval"}})})),a.postMessage({id:null,method:"set",params:{delay:n,now:performance.now(),timerId:r,timerType:"interval"}}),r},setTimeout:function(e,t){var r=(0,ba.generateUniqueNumber)(n);return n.set(r,e),a.postMessage({id:null,method:"set",params:{delay:t,now:performance.now(),timerId:r,timerType:"timeout"}}),r}}}),'(()=>{"use strict";const e=new Map,t=new Map,r=(e,t)=>{let r,o;const i=performance.now();r=i,o=e-Math.max(0,i-t);return{expected:r+o,remainingDelay:o}},o=(e,t,r,i)=>{const s=performance.now();s>r?postMessage({id:null,method:"call",params:{timerId:t,timerType:i}}):e.set(t,setTimeout(o,r-s,e,t,r,i))};addEventListener("message",(i=>{let{data:s}=i;try{if("clear"===s.method){const{id:r,params:{timerId:o,timerType:i}}=s;if("interval"===i)(t=>{const r=e.get(t);if(void 0===r)throw new Error(\'There is no interval scheduled with the given id "\'.concat(t,\'".\'));clearTimeout(r),e.delete(t)})(o),postMessage({error:null,id:r});else{if("timeout"!==i)throw new Error(\'The given type "\'.concat(i,\'" is not supported\'));(e=>{const r=t.get(e);if(void 0===r)throw new Error(\'There is no timeout scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(r),t.delete(e)})(o),postMessage({error:null,id:r})}}else{if("set"!==s.method)throw new Error(\'The given method "\'.concat(s.method,\'" is not supported\'));{const{params:{delay:i,now:n,timerId:a,timerType:d}}=s;if("interval"===d)((t,i,s)=>{const{expected:n,remainingDelay:a}=r(t,s);e.set(i,setTimeout(o,a,e,i,n,"interval"))})(i,a,n);else{if("timeout"!==d)throw new Error(\'The given type "\'.concat(d,\'" is not supported\'));((e,i,s)=>{const{expected:n,remainingDelay:a}=r(e,s);t.set(i,setTimeout(o,a,t,i,n,"timeout"))})(i,a,n)}}}}catch(e){postMessage({error:{message:e.message},id:s.id,result:null})}}))})();'),_a=function(e){return wa().clearInterval(e)},Sa=function(e,t){return wa().setInterval(e,t)};function Ea(e){for(var t=!1,n=[],r=0;r<e.length;r++){var a=e.charAt(r);"_"==a?t=!0:/\d/.test(a)?(n.push(a),t=!0):t?(n.push(a.toUpperCase()),t=!1):0==r?n.push(a.toLowerCase()):n.push(a)}return n.join("")}function Ta(e){var t,n,r,a;return e.localName=null!==(t=e.localName)&&void 0!==t?t:Ea(e.name),e.jsonName=null!==(n=e.jsonName)&&void 0!==n?n:Ea(e.name),e.repeat=null!==(r=e.repeat)&&void 0!==r?r:fa.NO,e.opt=null!==(a=e.opt)&&void 0!==a?a:!e.repeat&&(!e.oneof&&"message"==e.kind),e}!function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"}(da||(da={})),function(e){e[e.BIGINT=0]="BIGINT",e[e.STRING=1]="STRING",e[e.NUMBER=2]="NUMBER"}(pa||(pa={})),function(e){e[e.NO=0]="NO",e[e.PACKED=1]="PACKED",e[e.UNPACKED=2]="UNPACKED"}(fa||(fa={}));var xa=function(){function e(t){var n;(0,y.Z)(this,e),this.fields=null!==(n=t.fields)&&void 0!==n?n:[]}return(0,k.Z)(e,[{key:"prepare",value:function(){if(!this.data){var e,t=[],n=[],r=[],a=(0,c.Z)(this.fields);try{for(a.s();!(e=a.n()).done;){var i=e.value;if(i.oneof)r.includes(i.oneof)||(r.push(i.oneof),t.push(i.oneof),n.push(i.oneof));else switch(n.push(i.localName),i.kind){case"scalar":case"enum":i.opt&&!i.repeat||t.push(i.localName);break;case"message":i.repeat&&t.push(i.localName);break;case"map":t.push(i.localName)}}}catch(o){a.e(o)}finally{a.f()}this.data={req:t,known:n,oneofs:Object.values(r)}}}},{key:"is",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t<0)return!0;if(null===e||void 0===e||"object"!=typeof e)return!1;this.prepare();var a=Object.keys(e),i=this.data;if(a.length<i.req.length||i.req.some((function(e){return!a.includes(e)})))return!1;if(!r&&a.some((function(e){return!i.known.includes(e)})))return!1;if(t<1)return!0;var o,s=(0,c.Z)(i.oneofs);try{var u=function(){var a=o.value,i=e[a];if(!function(e){if("object"!=typeof e||null===e||!e.hasOwnProperty("oneofKind"))return!1;switch(typeof e.oneofKind){case"string":return void 0!==e[e.oneofKind]&&2==Object.keys(e).length;case"undefined":return 1==Object.keys(e).length;default:return!1}}(i))return{v:!1};if(void 0===i.oneofKind)return"continue";var s=n.fields.find((function(e){return e.localName===i.oneofKind}));return s&&n.field(i[i.oneofKind],s,r,t)?void 0:{v:!1}};for(s.s();!(o=s.n()).done;){var l=u();if("continue"!==l&&"object"===typeof l)return l.v}}catch(h){s.e(h)}finally{s.f()}var d,p=(0,c.Z)(this.fields);try{for(p.s();!(d=p.n()).done;){var f=d.value;if(void 0===f.oneof&&!this.field(e[f.localName],f,r,t))return!1}}catch(h){p.e(h)}finally{p.f()}return!0}},{key:"field",value:function(e,t,n,r){var a=t.repeat;switch(t.kind){case"scalar":return void 0===e?t.opt:a?this.scalars(e,t.T,r,t.L):this.scalar(e,t.T,t.L);case"enum":return void 0===e?t.opt:a?this.scalars(e,da.INT32,r):this.scalar(e,da.INT32);case"message":return void 0===e||(a?this.messages(e,t.T(),n,r):this.message(e,t.T(),n,r));case"map":if("object"!=typeof e||null===e)return!1;if(r<2)return!0;if(!this.mapKeys(e,t.K,r))return!1;switch(t.V.kind){case"scalar":return this.scalars(Object.values(e),t.V.T,r,t.V.L);case"enum":return this.scalars(Object.values(e),da.INT32,r);case"message":return this.messages(Object.values(e),t.V.T(),n,r)}}return!0}},{key:"message",value:function(e,t,n,r){return n?t.isAssignable(e,r):t.is(e,r)}},{key:"messages",value:function(e,t,n,r){if(!Array.isArray(e))return!1;if(r<2)return!0;if(n){for(var a=0;a<e.length&&a<r;a++)if(!t.isAssignable(e[a],r-1))return!1}else for(var i=0;i<e.length&&i<r;i++)if(!t.is(e[i],r-1))return!1;return!0}},{key:"scalar",value:function(e,t,n){var r=typeof e;switch(t){case da.UINT64:case da.FIXED64:case da.INT64:case da.SFIXED64:case da.SINT64:switch(n){case pa.BIGINT:return"bigint"==r;case pa.NUMBER:return"number"==r&&!isNaN(e);default:return"string"==r}case da.BOOL:return"boolean"==r;case da.STRING:return"string"==r;case da.BYTES:return e instanceof Uint8Array;case da.DOUBLE:case da.FLOAT:return"number"==r&&!isNaN(e);default:return"number"==r&&Number.isInteger(e)}}},{key:"scalars",value:function(e,t,n,r){if(!Array.isArray(e))return!1;if(n<2)return!0;if(Array.isArray(e))for(var a=0;a<e.length&&a<n;a++)if(!this.scalar(e[a],t,r))return!1;return!0}},{key:"mapKeys",value:function(e,t,n){var r=Object.keys(e);switch(t){case da.INT32:case da.FIXED32:case da.SFIXED32:case da.SINT32:case da.UINT32:return this.scalars(r.slice(0,n).map((function(e){return parseInt(e)})),t,n);case da.BOOL:return this.scalars(r.slice(0,n).map((function(e){return"true"==e||"false"!=e&&e})),t,n);default:return this.scalars(r,t,n,pa.STRING)}}}]),e}();function Za(e){var t=typeof e;if("object"==t){if(Array.isArray(e))return"array";if(null===e)return"null"}return t}function Ca(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}for(var Ra="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),Pa=[],Ia=0;Ia<Ra.length;Ia++)Pa[Ra[Ia].charCodeAt(0)]=Ia;function Oa(){for(var e=0,t=0,n=0;n<28;n+=7){var r=this.buf[this.pos++];if(e|=(127&r)<<n,0==(128&r))return this.assertBounds(),[e,t]}var a=this.buf[this.pos++];if(e|=(15&a)<<28,t=(112&a)>>4,0==(128&a))return this.assertBounds(),[e,t];for(var i=3;i<=31;i+=7){var o=this.buf[this.pos++];if(t|=(127&o)<<i,0==(128&o))return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function Da(e,t,n){for(var r=0;r<28;r+=7){var a=e>>>r,i=!(a>>>7==0&&0==t),o=255&(i?128|a:a);if(n.push(o),!i)return}var s=e>>>28&15|(7&t)<<4,c=!(t>>3==0);if(n.push(255&(c?128|s:s)),c){for(var u=3;u<31;u+=7){var l=t>>>u,d=!(l>>>7==0),p=255&(d?128|l:l);if(n.push(p),!d)return}n.push(t>>>31&1)}}Pa["-".charCodeAt(0)]=Ra.indexOf("+"),Pa["_".charCodeAt(0)]=Ra.indexOf("/");var Ma=4294967296;function Aa(e){var t="-"==e[0];t&&(e=e.slice(1));var n=1e6,r=0,a=0;function i(t,i){var o=Number(e.slice(t,i));a*=n,(r=r*n+o)>=Ma&&(a+=r/Ma|0,r%=Ma)}return i(-24,-18),i(-18,-12),i(-12,-6),i(-6),[t,r,a]}function Na(e,t){if(t<=2097151)return""+(Ma*t+(e>>>0));var n=(e>>>24|t<<8)>>>0&16777215,r=t>>16&65535,a=(16777215&e)+6777216*n+6710656*r,i=n+8147497*r,o=2*r,s=1e7;function c(e,t){var n=e?String(e):"";return t?"0000000".slice(n.length)+n:n}return a>=s&&(i+=Math.floor(a/s),a%=s),i>=s&&(o+=Math.floor(i/s),i%=s),c(o,0)+c(i,o)+c(a,1)}function La(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(var n=0;n<9;n++)t.push(127&e|128),e>>=7;t.push(1)}}function ja(){var e=this.buf[this.pos++],t=127&e;if(0==(128&e))return this.assertBounds(),t;if(t|=(127&(e=this.buf[this.pos++]))<<7,0==(128&e))return this.assertBounds(),t;if(t|=(127&(e=this.buf[this.pos++]))<<14,0==(128&e))return this.assertBounds(),t;if(t|=(127&(e=this.buf[this.pos++]))<<21,0==(128&e))return this.assertBounds(),t;t|=(15&(e=this.buf[this.pos++]))<<28;for(var n=5;0!==(128&e)&&n<10;n++)e=this.buf[this.pos++];if(0!=(128&e))throw new Error("invalid varint");return this.assertBounds(),t>>>0}var Fa=function(){var e=new DataView(new ArrayBuffer(8));return void 0!==globalThis.BigInt&&"function"===typeof e.getBigInt64&&"function"===typeof e.getBigUint64&&"function"===typeof e.setBigInt64&&"function"===typeof e.setBigUint64?{MIN:BigInt("-9223372036854775808"),MAX:BigInt("9223372036854775807"),UMIN:BigInt("0"),UMAX:BigInt("18446744073709551615"),C:BigInt,V:e}:void 0}();function Ua(e){if(!e)throw new Error("BigInt unavailable, see https://github.com/timostamm/protobuf-ts/blob/v1.0.8/MANUAL.md#bigint-support")}var Ba=/^-?[0-9]+$/,Va=4294967296,Ha=function(){function e(t,n){(0,y.Z)(this,e),this.lo=0|t,this.hi=0|n}return(0,k.Z)(e,[{key:"isZero",value:function(){return 0==this.lo&&0==this.hi}},{key:"toNumber",value:function(){var e=this.hi*Va+(this.lo>>>0);if(!Number.isSafeInteger(e))throw new Error("cannot convert to safe number");return e}}]),e}(),za=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.apply(this,arguments)}return(0,k.Z)(n,[{key:"toString",value:function(){return Fa?this.toBigInt().toString():Na(this.lo,this.hi)}},{key:"toBigInt",value:function(){return Ua(Fa),Fa.V.setInt32(0,this.lo,!0),Fa.V.setInt32(4,this.hi,!0),Fa.V.getBigUint64(0,!0)}}],[{key:"from",value:function(e){if(Fa)switch(typeof e){case"string":if("0"==e)return this.ZERO;if(""==e)throw new Error("string is no integer");e=Fa.C(e);case"number":if(0===e)return this.ZERO;e=Fa.C(e);case"bigint":if(!e)return this.ZERO;if(e<Fa.UMIN)throw new Error("signed value for ulong");if(e>Fa.UMAX)throw new Error("ulong too large");return Fa.V.setBigUint64(0,e,!0),new n(Fa.V.getInt32(0,!0),Fa.V.getInt32(4,!0))}else switch(typeof e){case"string":if("0"==e)return this.ZERO;if(e=e.trim(),!Ba.test(e))throw new Error("string is no integer");var t=Aa(e),r=(0,u.Z)(t,3),a=r[0],i=r[1],o=r[2];if(a)throw new Error("signed value");return new n(i,o);case"number":if(0==e)return this.ZERO;if(!Number.isSafeInteger(e))throw new Error("number is no integer");if(e<0)throw new Error("signed value for ulong");return new n(e,e/Va)}throw new Error("unknown value "+typeof e)}}]),n}(Ha);za.ZERO=new za(0,0);var Wa=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.apply(this,arguments)}return(0,k.Z)(n,[{key:"isNegative",value:function(){return 0!==(2147483648&this.hi)}},{key:"negate",value:function(){var e=~this.hi,t=this.lo;return t?t=1+~t:e+=1,new n(t,e)}},{key:"toString",value:function(){if(Fa)return this.toBigInt().toString();if(this.isNegative()){var e=this.negate();return"-"+Na(e.lo,e.hi)}return Na(this.lo,this.hi)}},{key:"toBigInt",value:function(){return Ua(Fa),Fa.V.setInt32(0,this.lo,!0),Fa.V.setInt32(4,this.hi,!0),Fa.V.getBigInt64(0,!0)}}],[{key:"from",value:function(e){if(Fa)switch(typeof e){case"string":if("0"==e)return this.ZERO;if(""==e)throw new Error("string is no integer");e=Fa.C(e);case"number":if(0===e)return this.ZERO;e=Fa.C(e);case"bigint":if(!e)return this.ZERO;if(e<Fa.MIN)throw new Error("ulong too small");if(e>Fa.MAX)throw new Error("ulong too large");return Fa.V.setBigInt64(0,e,!0),new n(Fa.V.getInt32(0,!0),Fa.V.getInt32(4,!0))}else switch(typeof e){case"string":if("0"==e)return this.ZERO;if(e=e.trim(),!Ba.test(e))throw new Error("string is no integer");var t=Aa(e),r=(0,u.Z)(t,3),a=r[0],i=new n(r[1],r[2]);return a?i.negate():i;case"number":if(0==e)return this.ZERO;if(!Number.isSafeInteger(e))throw new Error("number is no integer");return e>0?new n(e,e/Va):new n(-e,-e/Va).negate()}throw new Error("unknown value "+typeof e)}}]),n}(Ha);function Ga(e,t){if(!e)throw new Error(t)}Wa.ZERO=new Wa(0,0);var qa=34028234663852886e22,$a=-34028234663852886e22,Ka=4294967295,Ja=2147483647,Qa=-2147483648;function Xa(e){if("number"!==typeof e)throw new Error("invalid int 32: "+typeof e);if(!Number.isInteger(e)||e>Ja||e<Qa)throw new Error("invalid int 32: "+e)}function Ya(e){if("number"!==typeof e)throw new Error("invalid uint 32: "+typeof e);if(!Number.isInteger(e)||e>Ka||e<0)throw new Error("invalid uint 32: "+e)}function ei(e){if("number"!==typeof e)throw new Error("invalid float 32: "+typeof e);if(Number.isFinite(e)&&(e>qa||e<$a))throw new Error("invalid float 32: "+e)}function ti(e,t){switch(t){case pa.BIGINT:return e.toBigInt();case pa.NUMBER:return e.toNumber();default:return e.toString()}}var ni,ri,ai=function(){function e(t){(0,y.Z)(this,e),this.info=t}return(0,k.Z)(e,[{key:"prepare",value:function(){var e;if(void 0===this.fMap){this.fMap={};var t,n=null!==(e=this.info.fields)&&void 0!==e?e:[],r=(0,c.Z)(n);try{for(r.s();!(t=r.n()).done;){var a=t.value;this.fMap[a.name]=a,this.fMap[a.jsonName]=a,this.fMap[a.localName]=a}}catch(i){r.e(i)}finally{r.f()}}}},{key:"assert",value:function(e,t,n){if(!e){var r=Za(n);throw"number"!=r&&"boolean"!=r||(r=n.toString()),new Error("Cannot parse JSON ".concat(r," for ").concat(this.info.typeName,"#").concat(t))}}},{key:"read",value:function(e,t,n){this.prepare();for(var r=[],a=0,i=Object.entries(e);a<i.length;a++){var o=(0,u.Z)(i[a],2),s=o[0],l=o[1],d=this.fMap[s];if(d){var p=d.localName,f=void 0;if(d.oneof){if(r.includes(d.oneof))throw new Error('Multiple members of the oneof group "'.concat(d.oneof,'" of ').concat(this.info.typeName," are present in JSON."));r.push(d.oneof),f=t[d.oneof]={oneofKind:p}}else f=t;if("map"==d.kind){if(null===l)continue;this.assert(Ca(l),d.name,l);for(var h=f[p],v=0,m=Object.entries(l);v<m.length;v++){var g=(0,u.Z)(m[v],2),y=g[0],k=g[1];this.assert(null!==k,d.name+" map value",null);var b=void 0;switch(d.V.kind){case"message":b=d.V.T().internalJsonRead(k,n);break;case"enum":if(!1===(b=this.enum(d.V.T(),k,d.name,n.ignoreUnknownFields)))continue;break;case"scalar":b=this.scalar(k,d.V.T,d.V.L,d.name)}this.assert(void 0!==b,d.name+" map value",k);var w=y;d.K==da.BOOL&&(w="true"==w||"false"!=w&&w),h[w=this.scalar(w,d.K,pa.STRING,d.name).toString()]=b}}else if(d.repeat){if(null===l)continue;this.assert(Array.isArray(l),d.name,l);var _,S=f[p],E=(0,c.Z)(l);try{for(E.s();!(_=E.n()).done;){var T=_.value;this.assert(null!==T,d.name,null);var x=void 0;switch(d.kind){case"message":x=d.T().internalJsonRead(T,n);break;case"enum":if(!1===(x=this.enum(d.T(),T,d.name,n.ignoreUnknownFields)))continue;break;case"scalar":x=this.scalar(T,d.T,d.L,d.name)}this.assert(void 0!==x,d.name,l),S.push(x)}}catch(C){E.e(C)}finally{E.f()}}else switch(d.kind){case"message":if(null===l&&"google.protobuf.Value"!=d.T().typeName){this.assert(void 0===d.oneof,d.name+" (oneof member)",null);continue}f[p]=d.T().internalJsonRead(l,n,f[p]);break;case"enum":var Z=this.enum(d.T(),l,d.name,n.ignoreUnknownFields);if(!1===Z)continue;f[p]=Z;break;case"scalar":f[p]=this.scalar(l,d.T,d.L,d.name)}}else if(!n.ignoreUnknownFields)throw new Error("Found unknown field while reading ".concat(this.info.typeName," from JSON format. JSON key: ").concat(s))}}},{key:"enum",value:function(e,t,n,r){if("google.protobuf.NullValue"==e[0]&&Ga(null===t,"Unable to parse field ".concat(this.info.typeName,"#").concat(n,", enum ").concat(e[0]," only accepts null.")),null===t)return 0;switch(typeof t){case"number":return Ga(Number.isInteger(t),"Unable to parse field ".concat(this.info.typeName,"#").concat(n,", enum can only be integral number, got ").concat(t,".")),t;case"string":var a=t;e[2]&&t.substring(0,e[2].length)===e[2]&&(a=t.substring(e[2].length));var i=e[1][a];return("undefined"!==typeof i||!r)&&(Ga("number"==typeof i,"Unable to parse field ".concat(this.info.typeName,"#").concat(n,", enum ").concat(e[0],' has no value for "').concat(t,'".')),i)}Ga(!1,"Unable to parse field ".concat(this.info.typeName,"#").concat(n,", cannot parse enum value from ").concat(typeof t,'".'))}},{key:"scalar",value:function(e,t,n,r){var a;try{switch(t){case da.DOUBLE:case da.FLOAT:if(null===e)return 0;if("NaN"===e)return Number.NaN;if("Infinity"===e)return Number.POSITIVE_INFINITY;if("-Infinity"===e)return Number.NEGATIVE_INFINITY;if(""===e){a="empty string";break}if("string"==typeof e&&e.trim().length!==e.length){a="extra whitespace";break}if("string"!=typeof e&&"number"!=typeof e)break;var i=Number(e);if(Number.isNaN(i)){a="not a number";break}if(!Number.isFinite(i)){a="too large or small";break}return t==da.FLOAT&&ei(i),i;case da.INT32:case da.FIXED32:case da.SFIXED32:case da.SINT32:case da.UINT32:if(null===e)return 0;var o;if("number"==typeof e?o=e:""===e?a="empty string":"string"==typeof e&&(e.trim().length!==e.length?a="extra whitespace":o=Number(e)),void 0===o)break;return t==da.UINT32?Ya(o):Xa(o),o;case da.INT64:case da.SFIXED64:case da.SINT64:if(null===e)return ti(Wa.ZERO,n);if("number"!=typeof e&&"string"!=typeof e)break;return ti(Wa.from(e),n);case da.FIXED64:case da.UINT64:if(null===e)return ti(za.ZERO,n);if("number"!=typeof e&&"string"!=typeof e)break;return ti(za.from(e),n);case da.BOOL:if(null===e)return!1;if("boolean"!==typeof e)break;return e;case da.STRING:if(null===e)return"";if("string"!==typeof e){a="extra whitespace";break}try{encodeURIComponent(e)}catch(a){a="invalid UTF8";break}return e;case da.BYTES:if(null===e||""===e)return new Uint8Array(0);if("string"!==typeof e)break;return function(e){var t=3*e.length/4;"="==e[e.length-2]?t-=2:"="==e[e.length-1]&&(t-=1);for(var n,r=new Uint8Array(t),a=0,i=0,o=0,s=0;s<e.length;s++){if(void 0===(n=Pa[e.charCodeAt(s)]))switch(e[s]){case"=":i=0;case"\n":case"\r":case"\t":case" ":continue;default:throw Error("invalid base64 string.")}switch(i){case 0:o=n,i=1;break;case 1:r[a++]=o<<2|(48&n)>>4,o=n,i=2;break;case 2:r[a++]=(15&o)<<4|(60&n)>>2,o=n,i=3;break;case 3:r[a++]=(3&o)<<6|n,i=0}}if(1==i)throw Error("invalid base64 string.");return r.subarray(0,a)}(e)}}catch(s){a=s.message}this.assert(!1,r+(a?" - "+a:""),e)}}]),e}(),ii=function(){function e(t){var n;(0,y.Z)(this,e),this.fields=null!==(n=t.fields)&&void 0!==n?n:[]}return(0,k.Z)(e,[{key:"write",value:function(e,t){var n,r={},a=e,i=(0,c.Z)(this.fields);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o.oneof){var s=a[o.oneof];if(s.oneofKind===o.localName){var u="scalar"==o.kind||"enum"==o.kind?Object.assign(Object.assign({},t),{emitDefaultValues:!0}):t,l=this.field(o,s[o.localName],u);Ga(void 0!==l),r[t.useProtoFieldName?o.name:o.jsonName]=l}}else{var d=this.field(o,a[o.localName],t);void 0!==d&&(r[t.useProtoFieldName?o.name:o.jsonName]=d)}}}catch(p){i.e(p)}finally{i.f()}return r}},{key:"field",value:function(e,t,n){var r=void 0;if("map"==e.kind){Ga("object"==typeof t&&null!==t);var a={};switch(e.V.kind){case"scalar":for(var i=0,o=Object.entries(t);i<o.length;i++){var s=(0,u.Z)(o[i],2),c=s[0],l=s[1],d=this.scalar(e.V.T,l,e.name,!1,!0);Ga(void 0!==d),a[c.toString()]=d}break;case"message":for(var p=e.V.T(),f=0,h=Object.entries(t);f<h.length;f++){var v=(0,u.Z)(h[f],2),m=v[0],g=v[1],y=this.message(p,g,e.name,n);Ga(void 0!==y),a[m.toString()]=y}break;case"enum":for(var k=e.V.T(),b=0,w=Object.entries(t);b<w.length;b++){var _=(0,u.Z)(w[b],2),S=_[0],E=_[1];Ga(void 0===E||"number"==typeof E);var T=this.enum(k,E,e.name,!1,!0,n.enumAsInteger);Ga(void 0!==T),a[S.toString()]=T}}(n.emitDefaultValues||Object.keys(a).length>0)&&(r=a)}else if(e.repeat){Ga(Array.isArray(t));var x=[];switch(e.kind){case"scalar":for(var Z=0;Z<t.length;Z++){var C=this.scalar(e.T,t[Z],e.name,e.opt,!0);Ga(void 0!==C),x.push(C)}break;case"enum":for(var R=e.T(),P=0;P<t.length;P++){Ga(void 0===t[P]||"number"==typeof t[P]);var I=this.enum(R,t[P],e.name,e.opt,!0,n.enumAsInteger);Ga(void 0!==I),x.push(I)}break;case"message":for(var O=e.T(),D=0;D<t.length;D++){var M=this.message(O,t[D],e.name,n);Ga(void 0!==M),x.push(M)}}(n.emitDefaultValues||x.length>0||n.emitDefaultValues)&&(r=x)}else switch(e.kind){case"scalar":r=this.scalar(e.T,t,e.name,e.opt,n.emitDefaultValues);break;case"enum":r=this.enum(e.T(),t,e.name,e.opt,n.emitDefaultValues,n.enumAsInteger);break;case"message":r=this.message(e.T(),t,e.name,n)}return r}},{key:"enum",value:function(e,t,n,r,a,i){if("google.protobuf.NullValue"==e[0])return null;if(void 0!==t){if(0!==t||a||r)return Ga("number"==typeof t),Ga(Number.isInteger(t)),i||!e[1].hasOwnProperty(t)?t:e[2]?e[2]+e[1][t]:e[1][t]}else Ga(r)}},{key:"message",value:function(e,t,n,r){return void 0===t?r.emitDefaultValues?null:void 0:e.internalJsonWrite(t,r)}},{key:"scalar",value:function(e,t,n,r,a){if(void 0!==t){var i=a||r;switch(e){case da.INT32:case da.SFIXED32:case da.SINT32:return 0===t?i?0:void 0:(Xa(t),t);case da.FIXED32:case da.UINT32:return 0===t?i?0:void 0:(Ya(t),t);case da.FLOAT:ei(t);case da.DOUBLE:return 0===t?i?0:void 0:(Ga("number"==typeof t),Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":t);case da.STRING:return""===t?i?"":void 0:(Ga("string"==typeof t),t);case da.BOOL:return!1===t?!i&&void 0:(Ga("boolean"==typeof t),t);case da.UINT64:case da.FIXED64:Ga("number"==typeof t||"string"==typeof t||"bigint"==typeof t);var o=za.from(t);if(o.isZero()&&!i)return;return o.toString();case da.INT64:case da.SFIXED64:case da.SINT64:Ga("number"==typeof t||"string"==typeof t||"bigint"==typeof t);var s=Wa.from(t);if(s.isZero()&&!i)return;return s.toString();case da.BYTES:return Ga(t instanceof Uint8Array),t.byteLength?function(e){for(var t,n="",r=0,a=0,i=0;i<e.length;i++)switch(t=e[i],r){case 0:n+=Ra[t>>2],a=(3&t)<<4,r=1;break;case 1:n+=Ra[a|t>>4],a=(15&t)<<2,r=2;break;case 2:n+=Ra[a|t>>6],n+=Ra[63&t],r=0}return r&&(n+=Ra[a],n+="=",1==r&&(n+="=")),n}(t):i?"":void 0}}else Ga(r)}}]),e}();function oi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pa.STRING;switch(e){case da.BOOL:return!1;case da.UINT64:case da.FIXED64:return ti(za.ZERO,t);case da.INT64:case da.SFIXED64:case da.SINT64:return ti(Wa.ZERO,t);case da.DOUBLE:case da.FLOAT:return 0;case da.BYTES:return new Uint8Array(0);case da.STRING:return"";default:return 0}}!function(e){e.symbol=Symbol.for("protobuf-ts/unknown"),e.onRead=function(n,r,a,i,o){(t(r)?r[e.symbol]:r[e.symbol]=[]).push({no:a,wireType:i,data:o})},e.onWrite=function(t,n,r){var a,i=(0,c.Z)(e.list(n));try{for(i.s();!(a=i.n()).done;){var o=a.value,s=o.no,u=o.wireType,l=o.data;r.tag(s,u).raw(l)}}catch(d){i.e(d)}finally{i.f()}},e.list=function(n,r){if(t(n)){var a=n[e.symbol];return r?a.filter((function(e){return e.no==r})):a}return[]},e.last=function(t,n){return e.list(t,n).slice(-1)[0]};var t=function(t){return t&&Array.isArray(t[e.symbol])}}(ni||(ni={})),function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"}(ri||(ri={}));var si=function(){function e(t){(0,y.Z)(this,e),this.info=t}return(0,k.Z)(e,[{key:"prepare",value:function(){var e;if(!this.fieldNoToField){var t=null!==(e=this.info.fields)&&void 0!==e?e:[];this.fieldNoToField=new Map(t.map((function(e){return[e.no,e]})))}}},{key:"read",value:function(e,t,n,r){this.prepare();for(var a=void 0===r?e.len:e.pos+r;e.pos<a;){var i=e.tag(),o=(0,u.Z)(i,2),s=o[0],c=o[1],l=this.fieldNoToField.get(s);if(l){var d=t,p=l.repeat,f=l.localName;switch(l.oneof&&(d=d[l.oneof]).oneofKind!==f&&(d=t[l.oneof]={oneofKind:f}),l.kind){case"scalar":case"enum":var h="enum"==l.kind?da.INT32:l.T,v="scalar"==l.kind?l.L:void 0;if(p){var m=d[f];if(c==ri.LengthDelimited&&h!=da.STRING&&h!=da.BYTES)for(var g=e.uint32()+e.pos;e.pos<g;)m.push(this.scalar(e,h,v));else m.push(this.scalar(e,h,v))}else d[f]=this.scalar(e,h,v);break;case"message":if(p){var y=d[f],k=l.T().internalBinaryRead(e,e.uint32(),n);y.push(k)}else d[f]=l.T().internalBinaryRead(e,e.uint32(),n,d[f]);break;case"map":var b=this.mapEntry(l,e,n),w=(0,u.Z)(b,2),_=w[0],S=w[1];d[f][_]=S}}else{var E=n.readUnknownField;if("throw"==E)throw new Error("Unknown field ".concat(s," (wire type ").concat(c,") for ").concat(this.info.typeName));var T=e.skip(c);!1!==E&&(!0===E?ni.onRead:E)(this.info.typeName,t,s,c,T)}}}},{key:"mapEntry",value:function(e,t,n){for(var r=t.uint32(),a=t.pos+r,i=void 0,o=void 0;t.pos<a;){var s=t.tag(),c=(0,u.Z)(s,2),l=c[0],d=c[1];switch(l){case 1:i=e.K==da.BOOL?t.bool().toString():this.scalar(t,e.K,pa.STRING);break;case 2:switch(e.V.kind){case"scalar":o=this.scalar(t,e.V.T,e.V.L);break;case"enum":o=t.int32();break;case"message":o=e.V.T().internalBinaryRead(t,t.uint32(),n)}break;default:throw new Error("Unknown field ".concat(l," (wire type ").concat(d,") in map entry for ").concat(this.info.typeName,"#").concat(e.name))}}if(void 0===i){var p=oi(e.K);i=e.K==da.BOOL?p.toString():p}if(void 0===o)switch(e.V.kind){case"scalar":o=oi(e.V.T,e.V.L);break;case"enum":o=0;break;case"message":o=e.V.T().create()}return[i,o]}},{key:"scalar",value:function(e,t,n){switch(t){case da.INT32:return e.int32();case da.STRING:return e.string();case da.BOOL:return e.bool();case da.DOUBLE:return e.double();case da.FLOAT:return e.float();case da.INT64:return ti(e.int64(),n);case da.UINT64:return ti(e.uint64(),n);case da.FIXED64:return ti(e.fixed64(),n);case da.FIXED32:return e.fixed32();case da.BYTES:return e.bytes();case da.UINT32:return e.uint32();case da.SFIXED32:return e.sfixed32();case da.SFIXED64:return ti(e.sfixed64(),n);case da.SINT32:return e.sint32();case da.SINT64:return ti(e.sint64(),n)}}}]),e}(),ci=function(){function e(t){(0,y.Z)(this,e),this.info=t}return(0,k.Z)(e,[{key:"prepare",value:function(){if(!this.fields){var e=this.info.fields?this.info.fields.concat():[];this.fields=e.sort((function(e,t){return e.no-t.no}))}}},{key:"write",value:function(e,t,n){this.prepare();var r,a=(0,c.Z)(this.fields);try{for(a.s();!(r=a.n()).done;){var i=r.value,o=void 0,s=void 0,l=i.repeat,d=i.localName;if(i.oneof){var p=e[i.oneof];if(p.oneofKind!==d)continue;o=p[d],s=!0}else o=e[d],s=!1;switch(i.kind){case"scalar":case"enum":var f="enum"==i.kind?da.INT32:i.T;if(l)if(Ga(Array.isArray(o)),l==fa.PACKED)this.packed(t,f,i.no,o);else{var h,v=(0,c.Z)(o);try{for(v.s();!(h=v.n()).done;){var m=h.value;this.scalar(t,f,i.no,m,!0)}}catch(x){v.e(x)}finally{v.f()}}else void 0===o?Ga(i.opt):this.scalar(t,f,i.no,o,s||i.opt);break;case"message":if(l){Ga(Array.isArray(o));var g,y=(0,c.Z)(o);try{for(y.s();!(g=y.n()).done;){var k=g.value;this.message(t,n,i.T(),i.no,k)}}catch(x){y.e(x)}finally{y.f()}}else this.message(t,n,i.T(),i.no,o);break;case"map":Ga("object"==typeof o&&null!==o);for(var b=0,w=Object.entries(o);b<w.length;b++){var _=(0,u.Z)(w[b],2),S=_[0],E=_[1];this.mapEntry(t,n,i,S,E)}}}}catch(x){a.e(x)}finally{a.f()}var T=n.writeUnknownFields;!1!==T&&(!0===T?ni.onWrite:T)(this.info.typeName,e,t)}},{key:"mapEntry",value:function(e,t,n,r,a){e.tag(n.no,ri.LengthDelimited),e.fork();var i=r;switch(n.K){case da.INT32:case da.FIXED32:case da.UINT32:case da.SFIXED32:case da.SINT32:i=Number.parseInt(r);break;case da.BOOL:Ga("true"==r||"false"==r),i="true"==r}switch(this.scalar(e,n.K,1,i,!0),n.V.kind){case"scalar":this.scalar(e,n.V.T,2,a,!0);break;case"enum":this.scalar(e,da.INT32,2,a,!0);break;case"message":this.message(e,t,n.V.T(),2,a)}e.join()}},{key:"message",value:function(e,t,n,r,a){void 0!==a&&(n.internalBinaryWrite(a,e.tag(r,ri.LengthDelimited).fork(),t),e.join())}},{key:"scalar",value:function(e,t,n,r,a){var i=this.scalarInfo(t,r),o=(0,u.Z)(i,3),s=o[0],c=o[1];o[2]&&!a||(e.tag(n,s),e[c](r))}},{key:"packed",value:function(e,t,n,r){if(r.length){Ga(t!==da.BYTES&&t!==da.STRING),e.tag(n,ri.LengthDelimited),e.fork();for(var a=this.scalarInfo(t),i=(0,u.Z)(a,2)[1],o=0;o<r.length;o++)e[i](r[o]);e.join()}}},{key:"scalarInfo",value:function(e,t){var n,r=ri.Varint,a=void 0===t,i=0===t;switch(e){case da.INT32:n="int32";break;case da.STRING:i=a||!t.length,r=ri.LengthDelimited,n="string";break;case da.BOOL:i=!1===t,n="bool";break;case da.UINT32:n="uint32";break;case da.DOUBLE:r=ri.Bit64,n="double";break;case da.FLOAT:r=ri.Bit32,n="float";break;case da.INT64:i=a||Wa.from(t).isZero(),n="int64";break;case da.UINT64:i=a||za.from(t).isZero(),n="uint64";break;case da.FIXED64:i=a||za.from(t).isZero(),r=ri.Bit64,n="fixed64";break;case da.BYTES:i=a||!t.byteLength,r=ri.LengthDelimited,n="bytes";break;case da.FIXED32:r=ri.Bit32,n="fixed32";break;case da.SFIXED32:r=ri.Bit32,n="sfixed32";break;case da.SFIXED64:i=a||Wa.from(t).isZero(),r=ri.Bit64,n="sfixed64";break;case da.SINT32:n="sint32";break;case da.SINT64:i=a||Wa.from(t).isZero(),n="sint64"}return[r,n,a||i]}}]),e}(),ui=Symbol.for("protobuf-ts/message-type");function li(e,t,n){var r,a,i,o=n,s=(0,c.Z)(e.fields);try{for(s.s();!(i=s.n()).done;){var u=i.value,l=u.localName;if(u.oneof){var d=o[u.oneof];if(void 0==(null===d||void 0===d?void 0:d.oneofKind))continue;if(r=d[l],(a=t[u.oneof]).oneofKind=d.oneofKind,void 0==r){delete a[l];continue}}else if(r=o[l],a=t,void 0==r)continue;switch(u.repeat&&(a[l].length=r.length),u.kind){case"scalar":case"enum":if(u.repeat)for(var p=0;p<r.length;p++)a[l][p]=r[p];else a[l]=r;break;case"message":var f=u.T();if(u.repeat)for(var h=0;h<r.length;h++)a[l][h]=f.create(r[h]);else void 0===a[l]?a[l]=f.create(r):f.mergePartial(a[l],r);break;case"map":switch(u.V.kind){case"scalar":case"enum":Object.assign(a[l],r);break;case"message":for(var v=u.V.T(),m=0,g=Object.keys(r);m<g.length;m++){var y=g[m];a[l][y]=v.create(r[y])}}}}}catch(k){s.e(k)}finally{s.f()}}var di={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0},pi={ignoreUnknownFields:!1};var fi=Object.values;function hi(e,t,n){if(t===n)return!0;if(e!==da.BYTES)return!1;var r=t,a=n;if(r.length!==a.length)return!1;for(var i=0;i<r.length;i++)if(r[i]!=a[i])return!1;return!0}function vi(e,t,n){if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(!hi(e,t[r],n[r]))return!1;return!0}function mi(e,t,n){if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(!e.equals(t[r],n[r]))return!1;return!0}var gi={writeUnknownFields:!0,writerFactory:function(){return new yi}};var yi=function(){function e(t){(0,y.Z)(this,e),this.stack=[],this.textEncoder=null!==t&&void 0!==t?t:new TextEncoder,this.chunks=[],this.buf=[]}return(0,k.Z)(e,[{key:"finish",value:function(){this.chunks.push(new Uint8Array(this.buf));for(var e=0,t=0;t<this.chunks.length;t++)e+=this.chunks[t].length;for(var n=new Uint8Array(e),r=0,a=0;a<this.chunks.length;a++)n.set(this.chunks[a],r),r+=this.chunks[a].length;return this.chunks=[],n}},{key:"fork",value:function(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}},{key:"join",value:function(){var e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}},{key:"tag",value:function(e,t){return this.uint32((e<<3|t)>>>0)}},{key:"raw",value:function(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}},{key:"uint32",value:function(e){for(Ya(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}},{key:"int32",value:function(e){return Xa(e),La(e,this.buf),this}},{key:"bool",value:function(e){return this.buf.push(e?1:0),this}},{key:"bytes",value:function(e){return this.uint32(e.byteLength),this.raw(e)}},{key:"string",value:function(e){var t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}},{key:"float",value:function(e){ei(e);var t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}},{key:"double",value:function(e){var t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}},{key:"fixed32",value:function(e){Ya(e);var t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}},{key:"sfixed32",value:function(e){Xa(e);var t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}},{key:"sint32",value:function(e){return Xa(e),La(e=(e<<1^e>>31)>>>0,this.buf),this}},{key:"sfixed64",value:function(e){var t=new Uint8Array(8),n=new DataView(t.buffer),r=Wa.from(e);return n.setInt32(0,r.lo,!0),n.setInt32(4,r.hi,!0),this.raw(t)}},{key:"fixed64",value:function(e){var t=new Uint8Array(8),n=new DataView(t.buffer),r=za.from(e);return n.setInt32(0,r.lo,!0),n.setInt32(4,r.hi,!0),this.raw(t)}},{key:"int64",value:function(e){var t=Wa.from(e);return Da(t.lo,t.hi,this.buf),this}},{key:"sint64",value:function(e){var t=Wa.from(e),n=t.hi>>31;return Da(t.lo<<1^n,(t.hi<<1|t.lo>>>31)^n,this.buf),this}},{key:"uint64",value:function(e){var t=za.from(e);return Da(t.lo,t.hi,this.buf),this}}]),e}(),ki=n(5647),bi={readUnknownField:!0,readerFactory:function(e){return new wi(e)}};var wi=function(){function e(t,n){(0,y.Z)(this,e),this.varint64=Oa,this.uint32=ja,this.buf=t,this.len=t.length,this.pos=0,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength),this.textDecoder=null!==n&&void 0!==n?n:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0})}return(0,k.Z)(e,[{key:"tag",value:function(){var e=this.uint32(),t=e>>>3,n=7&e;if(t<=0||n<0||n>5)throw new Error("illegal tag: field no "+t+" wire type "+n);return[t,n]}},{key:"skip",value:function(e){var t=this.pos;switch(e){case ri.Varint:for(;128&this.buf[this.pos++];);break;case ri.Bit64:this.pos+=4;case ri.Bit32:this.pos+=4;break;case ri.LengthDelimited:var n=this.uint32();this.pos+=n;break;case ri.StartGroup:for(var r;(r=this.tag()[1])!==ri.EndGroup;)this.skip(r);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(t,this.pos)}},{key:"assertBounds",value:function(){if(this.pos>this.len)throw new RangeError("premature EOF")}},{key:"int32",value:function(){return 0|this.uint32()}},{key:"sint32",value:function(){var e=this.uint32();return e>>>1^-(1&e)}},{key:"int64",value:function(){return(0,ki.Z)(Wa,(0,o.Z)(this.varint64()))}},{key:"uint64",value:function(){return(0,ki.Z)(za,(0,o.Z)(this.varint64()))}},{key:"sint64",value:function(){var e=this.varint64(),t=(0,u.Z)(e,2),n=t[0],r=t[1],a=-(1&n);return new Wa(n=(n>>>1|(1&r)<<31)^a,r=r>>>1^a)}},{key:"bool",value:function(){var e=this.varint64(),t=(0,u.Z)(e,2),n=t[0],r=t[1];return 0!==n||0!==r}},{key:"fixed32",value:function(){return this.view.getUint32((this.pos+=4)-4,!0)}},{key:"sfixed32",value:function(){return this.view.getInt32((this.pos+=4)-4,!0)}},{key:"fixed64",value:function(){return new za(this.sfixed32(),this.sfixed32())}},{key:"sfixed64",value:function(){return new Wa(this.sfixed32(),this.sfixed32())}},{key:"float",value:function(){return this.view.getFloat32((this.pos+=4)-4,!0)}},{key:"double",value:function(){return this.view.getFloat64((this.pos+=8)-8,!0)}},{key:"bytes",value:function(){var e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}},{key:"string",value:function(){return this.textDecoder.decode(this.bytes())}}]),e}(),_i=function(){function e(t,n,r){(0,y.Z)(this,e),this.defaultCheckDepth=16,this.typeName=t,this.fields=n.map(Ta),this.options=null!==r&&void 0!==r?r:{},this.refTypeCheck=new xa(this),this.refJsonReader=new ai(this),this.refJsonWriter=new ii(this),this.refBinReader=new si(this),this.refBinWriter=new ci(this)}return(0,k.Z)(e,[{key:"create",value:function(e){var t=function(e){var t={};Object.defineProperty(t,ui,{enumerable:!1,value:e});var n,r=(0,c.Z)(e.fields);try{for(r.s();!(n=r.n()).done;){var a=n.value,i=a.localName;if(!a.opt)if(a.oneof)t[a.oneof]={oneofKind:void 0};else if(a.repeat)t[i]=[];else switch(a.kind){case"scalar":t[i]=oi(a.T,a.L);break;case"enum":t[i]=0;break;case"map":t[i]={}}}}catch(o){r.e(o)}finally{r.f()}return t}(this);return void 0!==e&&li(this,t,e),t}},{key:"clone",value:function(e){var t=this.create();return li(this,t,e),t}},{key:"equals",value:function(e,t){return function(e,t,n){if(t===n)return!0;if(!t||!n)return!1;var r,a=(0,c.Z)(e.fields);try{for(a.s();!(r=a.n()).done;){var i=r.value,o=i.localName,s=i.oneof?t[i.oneof][o]:t[o],u=i.oneof?n[i.oneof][o]:n[o];switch(i.kind){case"enum":case"scalar":var l="enum"==i.kind?da.INT32:i.T;if(!(i.repeat?vi(l,s,u):hi(l,s,u)))return!1;break;case"map":if(!("message"==i.V.kind?mi(i.V.T(),fi(s),fi(u)):vi("enum"==i.V.kind?da.INT32:i.V.T,fi(s),fi(u))))return!1;break;case"message":var d=i.T();if(!(i.repeat?mi(d,s,u):d.equals(s,u)))return!1}}}catch(p){a.e(p)}finally{a.f()}return!0}(this,e,t)}},{key:"is",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultCheckDepth;return this.refTypeCheck.is(e,t,!1)}},{key:"isAssignable",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.defaultCheckDepth;return this.refTypeCheck.is(e,t,!0)}},{key:"mergePartial",value:function(e,t){li(this,e,t)}},{key:"fromBinary",value:function(e,t){var n=function(e){return e?Object.assign(Object.assign({},bi),e):bi}(t);return this.internalBinaryRead(n.readerFactory(e),e.byteLength,n)}},{key:"fromJson",value:function(e,t){return this.internalJsonRead(e,function(e){return e?Object.assign(Object.assign({},pi),e):pi}(t))}},{key:"fromJsonString",value:function(e,t){var n=JSON.parse(e);return this.fromJson(n,t)}},{key:"toJson",value:function(e,t){return this.internalJsonWrite(e,function(e){return e?Object.assign(Object.assign({},di),e):di}(t))}},{key:"toJsonString",value:function(e,t){var n,r=this.toJson(e,t);return JSON.stringify(r,null,null!==(n=null===t||void 0===t?void 0:t.prettySpaces)&&void 0!==n?n:0)}},{key:"toBinary",value:function(e,t){var n=function(e){return e?Object.assign(Object.assign({},gi),e):gi}(t);return this.internalBinaryWrite(e,n.writerFactory(),n).finish()}},{key:"internalJsonRead",value:function(e,t,n){if(null!==e&&"object"==typeof e&&!Array.isArray(e)){var r=null!==n&&void 0!==n?n:this.create();return this.refJsonReader.read(e,r,t),r}throw new Error("Unable to parse message ".concat(this.typeName," from JSON ").concat(Za(e),"."))}},{key:"internalJsonWrite",value:function(e,t){return this.refJsonWriter.write(e,t)}},{key:"internalBinaryWrite",value:function(e,t,n){return this.refBinWriter.write(e,t,n),t}},{key:"internalBinaryRead",value:function(e,t,n,r){var a=null!==r&&void 0!==r?r:this.create();return this.refBinReader.read(e,a,n,t),a}}]),e}(),Si=n(7724),Ei=n(9647),Ti=Object.create(null);Ti.open="0",Ti.close="1",Ti.ping="2",Ti.pong="3",Ti.message="4",Ti.upgrade="5",Ti.noop="6";var xi=Object.create(null);Object.keys(Ti).forEach((function(e){xi[Ti[e]]=e}));for(var Zi={type:"error",data:"parser error"},Ci="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),Ri="function"===typeof ArrayBuffer,Pi=function(e,t){var n=new FileReader;return n.onload=function(){var e=n.result.split(",")[1];t("b"+(e||""))},n.readAsDataURL(e)},Ii=function(e,t,n){var r,a=e.type,i=e.data;return Ci&&i instanceof Blob?t?n(i):Pi(i,n):Ri&&(i instanceof ArrayBuffer||(r=i,"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(r):r&&r.buffer instanceof ArrayBuffer))?t?n(i):Pi(new Blob([i]),n):n(Ti[a]+(i||""))},Oi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Di="undefined"===typeof Uint8Array?[]:new Uint8Array(256),Mi=0;Mi<Oi.length;Mi++)Di[Oi.charCodeAt(Mi)]=Mi;var Ai="function"===typeof ArrayBuffer,Ni=function(e,t){if(Ai){var n=function(e){var t,n,r,a,i,o=.75*e.length,s=e.length,c=0;"="===e[e.length-1]&&(o--,"="===e[e.length-2]&&o--);var u=new ArrayBuffer(o),l=new Uint8Array(u);for(t=0;t<s;t+=4)n=Di[e.charCodeAt(t)],r=Di[e.charCodeAt(t+1)],a=Di[e.charCodeAt(t+2)],i=Di[e.charCodeAt(t+3)],l[c++]=n<<2|r>>4,l[c++]=(15&r)<<4|a>>2,l[c++]=(3&a)<<6|63&i;return u}(e);return Li(n,t)}return{base64:!0,data:e}},Li=function(e,t){return"blob"===t&&e instanceof ArrayBuffer?new Blob([e]):e},ji=function(e,t){if("string"!==typeof e)return{type:"message",data:Li(e,t)};var n=e.charAt(0);return"b"===n?{type:"message",data:Ni(e.substring(1),t)}:xi[n]?e.length>1?{type:xi[n],data:e.substring(1)}:{type:xi[n]}:Zi},Fi=String.fromCharCode(30);function Ui(e){if(e)return function(e){for(var t in Ui.prototype)e[t]=Ui.prototype[t];return e}(e)}Ui.prototype.on=Ui.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},Ui.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},Ui.prototype.off=Ui.prototype.removeListener=Ui.prototype.removeAllListeners=Ui.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var a=0;a<r.length;a++)if((n=r[a])===t||n.fn===t){r.splice(a,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},Ui.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var a=(n=n.slice(0)).length;r<a;++r)n[r].apply(this,t)}return this},Ui.prototype.emitReserved=Ui.prototype.emit,Ui.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},Ui.prototype.hasListeners=function(e){return!!this.listeners(e).length};var Bi="undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")();function Vi(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.reduce((function(t,n){return e.hasOwnProperty(n)&&(t[n]=e[n]),t}),{})}var Hi=Bi.setTimeout,zi=Bi.clearTimeout;function Wi(e,t){t.useNativeTimers?(e.setTimeoutFn=Hi.bind(Bi),e.clearTimeoutFn=zi.bind(Bi)):(e.setTimeoutFn=Bi.setTimeout.bind(Bi),e.clearTimeoutFn=Bi.clearTimeout.bind(Bi))}var Gi=1.33;var qi,$i=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e,r,a){var i;return(0,y.Z)(this,n),(i=t.call(this,e)).description=r,i.context=a,i.type="TransportError",i}return(0,k.Z)(n)}((0,a.Z)(Error)),Ki=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;return(0,y.Z)(this,n),(r=t.call(this)).writable=!1,Wi((0,v.Z)(r),e),r.opts=e,r.query=e.query,r.socket=e.socket,r}return(0,k.Z)(n,[{key:"onError",value:function(e,t,r){return f((0,p.Z)(n.prototype),"emitReserved",this).call(this,"error",new $i(e,t,r)),this}},{key:"open",value:function(){return this.readyState="opening",this.doOpen(),this}},{key:"close",value:function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}},{key:"send",value:function(e){"open"===this.readyState&&this.write(e)}},{key:"onOpen",value:function(){this.readyState="open",this.writable=!0,f((0,p.Z)(n.prototype),"emitReserved",this).call(this,"open")}},{key:"onData",value:function(e){var t=ji(e,this.socket.binaryType);this.onPacket(t)}},{key:"onPacket",value:function(e){f((0,p.Z)(n.prototype),"emitReserved",this).call(this,"packet",e)}},{key:"onClose",value:function(e){this.readyState="closed",f((0,p.Z)(n.prototype),"emitReserved",this).call(this,"close",e)}},{key:"pause",value:function(e){}}]),n}(Ui),Ji="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),Qi=64,Xi={},Yi=0,eo=0;function to(e){var t="";do{t=Ji[e%Qi]+t,e=Math.floor(e/Qi)}while(e>0);return t}function no(){var e=to(+new Date);return e!==qi?(Yi=0,qi=e):e+"."+to(Yi++)}for(;eo<Qi;eo++)Xi[Ji[eo]]=eo;function ro(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}var ao=!1;try{ao="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(Cx){}var io=ao;function oo(e){var t=e.xdomain;try{if("undefined"!==typeof XMLHttpRequest&&(!t||io))return new XMLHttpRequest}catch(n){}if(!t)try{return new(Bi[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(n){}}function so(){}var co=null!=new oo({xdomain:!1}).responseType,uo=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;if((0,y.Z)(this,n),(r=t.call(this,e)).polling=!1,"undefined"!==typeof location){var a="https:"===location.protocol,i=location.port;i||(i=a?"443":"80"),r.xd="undefined"!==typeof location&&e.hostname!==location.hostname||i!==e.port,r.xs=e.secure!==a}var o=e&&e.forceBase64;return r.supportsBinary=co&&!o,r}return(0,k.Z)(n,[{key:"name",get:function(){return"polling"}},{key:"doOpen",value:function(){this.poll()}},{key:"pause",value:function(e){var t=this;this.readyState="pausing";var n=function(){t.readyState="paused",e()};if(this.polling||!this.writable){var r=0;this.polling&&(r++,this.once("pollComplete",(function(){--r||n()}))),this.writable||(r++,this.once("drain",(function(){--r||n()})))}else n()}},{key:"poll",value:function(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}},{key:"onData",value:function(e){var t=this;(function(e,t){for(var n=e.split(Fi),r=[],a=0;a<n.length;a++){var i=ji(n[a],t);if(r.push(i),"error"===i.type)break}return r})(e,this.socket.binaryType).forEach((function(e){if("opening"===t.readyState&&"open"===e.type&&t.onOpen(),"close"===e.type)return t.onClose({description:"transport closed by the server"}),!1;t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}},{key:"doClose",value:function(){var e=this,t=function(){e.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)}},{key:"write",value:function(e){var t=this;this.writable=!1,function(e,t){var n=e.length,r=new Array(n),a=0;e.forEach((function(e,i){Ii(e,!1,(function(e){r[i]=e,++a===n&&t(r.join(Fi))}))}))}(e,(function(e){t.doWrite(e,(function(){t.writable=!0,t.emitReserved("drain")}))}))}},{key:"uri",value:function(){var e=this.query||{},t=this.opts.secure?"https":"http",n="";!1!==this.opts.timestampRequests&&(e[this.opts.timestampParam]=no()),this.supportsBinary||e.sid||(e.b64=1),this.opts.port&&("https"===t&&443!==Number(this.opts.port)||"http"===t&&80!==Number(this.opts.port))&&(n=":"+this.opts.port);var r=ro(e);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(r.length?"?"+r:"")}},{key:"request",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new lo(this.uri(),e)}},{key:"doWrite",value:function(e,t){var n=this,r=this.request({method:"POST",data:e});r.on("success",t),r.on("error",(function(e,t){n.onError("xhr post error",e,t)}))}},{key:"doPoll",value:function(){var e=this,t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(function(t,n){e.onError("xhr poll error",t,n)})),this.pollXhr=t}}]),n}(Ki),lo=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e,r){var a;return(0,y.Z)(this,n),a=t.call(this),Wi((0,v.Z)(a),r),a.opts=r,a.method=r.method||"GET",a.uri=e,a.async=!1!==r.async,a.data=void 0!==r.data?r.data:null,a.create(),a}return(0,k.Z)(n,[{key:"create",value:function(){var e=this,t=Vi(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;var r=this.xhr=new oo(t);try{r.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders)for(var a in r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0),this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(a)&&r.setRequestHeader(a,this.opts.extraHeaders[a])}catch(i){}if("POST"===this.method)try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(i){}try{r.setRequestHeader("Accept","*/*")}catch(i){}"withCredentials"in r&&(r.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(r.timeout=this.opts.requestTimeout),r.onreadystatechange=function(){4===r.readyState&&(200===r.status||1223===r.status?e.onLoad():e.setTimeoutFn((function(){e.onError("number"===typeof r.status?r.status:0)}),0))},r.send(this.data)}catch(i){return void this.setTimeoutFn((function(){e.onError(i)}),0)}"undefined"!==typeof document&&(this.index=n.requestsCount++,n.requests[this.index]=this)}},{key:"onError",value:function(e){this.emitReserved("error",e,this.xhr),this.cleanup(!0)}},{key:"cleanup",value:function(e){if("undefined"!==typeof this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=so,e)try{this.xhr.abort()}catch(t){}"undefined"!==typeof document&&delete n.requests[this.index],this.xhr=null}}},{key:"onLoad",value:function(){var e=this.xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this.cleanup())}},{key:"abort",value:function(){this.cleanup()}}]),n}(Ui);if(lo.requestsCount=0,lo.requests={},"undefined"!==typeof document)if("function"===typeof attachEvent)attachEvent("onunload",po);else if("function"===typeof addEventListener){addEventListener("onpagehide"in Bi?"pagehide":"unload",po,!1)}function po(){for(var e in lo.requests)lo.requests.hasOwnProperty(e)&&lo.requests[e].abort()}var fo="function"===typeof Promise&&"function"===typeof Promise.resolve?function(e){return Promise.resolve().then(e)}:function(e,t){return t(e,0)},ho=Bi.WebSocket||Bi.MozWebSocket,vo="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),mo=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;return(0,y.Z)(this,n),(r=t.call(this,e)).supportsBinary=!e.forceBase64,r}return(0,k.Z)(n,[{key:"name",get:function(){return"websocket"}},{key:"doOpen",value:function(){if(this.check()){var e=this.uri(),t=this.opts.protocols,n=vo?{}:Vi(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=vo?new ho(e,t,n):t?new ho(e,t):new ho(e)}catch(Cx){return this.emitReserved("error",Cx)}this.ws.binaryType=this.socket.binaryType||"arraybuffer",this.addEventListeners()}}},{key:"addEventListeners",value:function(){var e=this;this.ws.onopen=function(){e.opts.autoUnref&&e.ws._socket.unref(),e.onOpen()},this.ws.onclose=function(t){return e.onClose({description:"websocket connection closed",context:t})},this.ws.onmessage=function(t){return e.onData(t.data)},this.ws.onerror=function(t){return e.onError("websocket error",t)}}},{key:"write",value:function(e){var t=this;this.writable=!1;for(var n=function(){var n=e[r],a=r===e.length-1;Ii(n,t.supportsBinary,(function(e){try{t.ws.send(e)}catch(n){}a&&fo((function(){t.writable=!0,t.emitReserved("drain")}),t.setTimeoutFn)}))},r=0;r<e.length;r++)n()}},{key:"doClose",value:function(){"undefined"!==typeof this.ws&&(this.ws.close(),this.ws=null)}},{key:"uri",value:function(){var e=this.query||{},t=this.opts.secure?"wss":"ws",n="";this.opts.port&&("wss"===t&&443!==Number(this.opts.port)||"ws"===t&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=no()),this.supportsBinary||(e.b64=1);var r=ro(e);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(r.length?"?"+r:"")}},{key:"check",value:function(){return!!ho}}]),n}(Ki),go={websocket:mo,polling:uo},yo=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,ko=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function bo(e){var t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));for(var a=yo.exec(e||""),i={},o=14;o--;)i[ko[o]]=a[o]||"";return-1!=n&&-1!=r&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=function(e,t){var n=/\/{2,9}/g,r=t.replace(n,"/").split("/");"/"!=t.slice(0,1)&&0!==t.length||r.splice(0,1);"/"==t.slice(-1)&&r.splice(r.length-1,1);return r}(0,i.path),i.queryKey=function(e,t){var n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,r){t&&(n[t]=r)})),n}(0,i.query),i}var wo=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,y.Z)(this,n),(r=t.call(this)).writeBuffer=[],e&&"object"===typeof e&&(a=e,e=null),e?(e=bo(e),a.hostname=e.host,a.secure="https"===e.protocol||"wss"===e.protocol,a.port=e.port,e.query&&(a.query=e.query)):a.host&&(a.hostname=bo(a.host).host),Wi((0,v.Z)(r),a),r.secure=null!=a.secure?a.secure:"undefined"!==typeof location&&"https:"===location.protocol,a.hostname&&!a.port&&(a.port=r.secure?"443":"80"),r.hostname=a.hostname||("undefined"!==typeof location?location.hostname:"localhost"),r.port=a.port||("undefined"!==typeof location&&location.port?location.port:r.secure?"443":"80"),r.transports=a.transports||["polling","websocket"],r.writeBuffer=[],r.prevBufferLen=0,r.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},a),r.opts.path=r.opts.path.replace(/\/$/,"")+(r.opts.addTrailingSlash?"/":""),"string"===typeof r.opts.query&&(r.opts.query=function(e){for(var t={},n=e.split("&"),r=0,a=n.length;r<a;r++){var i=n[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}(r.opts.query)),r.id=null,r.upgrades=null,r.pingInterval=null,r.pingTimeout=null,r.pingTimeoutTimer=null,"function"===typeof addEventListener&&(r.opts.closeOnBeforeunload&&(r.beforeunloadEventListener=function(){r.transport&&(r.transport.removeAllListeners(),r.transport.close())},addEventListener("beforeunload",r.beforeunloadEventListener,!1)),"localhost"!==r.hostname&&(r.offlineEventListener=function(){r.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",r.offlineEventListener,!1))),r.open(),r}return(0,k.Z)(n,[{key:"createTransport",value:function(e){var t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);var n=Object.assign({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new go[e](n)}},{key:"open",value:function(){var e,t=this;if(this.opts.rememberUpgrade&&n.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((function(){t.emitReserved("error","No transports available")}),0);e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(r){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}},{key:"setTransport",value:function(e){var t=this;this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(function(e){return t.onClose("transport close",e)}))}},{key:"probe",value:function(e){var t=this,r=this.createTransport(e),a=!1;n.priorWebsocketSuccess=!1;var i=function(){a||(r.send([{type:"ping",data:"probe"}]),r.once("packet",(function(e){if(!a)if("pong"===e.type&&"probe"===e.data){if(t.upgrading=!0,t.emitReserved("upgrading",r),!r)return;n.priorWebsocketSuccess="websocket"===r.name,t.transport.pause((function(){a||"closed"!==t.readyState&&(d(),t.setTransport(r),r.send([{type:"upgrade"}]),t.emitReserved("upgrade",r),r=null,t.upgrading=!1,t.flush())}))}else{var i=new Error("probe error");i.transport=r.name,t.emitReserved("upgradeError",i)}})))};function o(){a||(a=!0,d(),r.close(),r=null)}var s=function(e){var n=new Error("probe error: "+e);n.transport=r.name,o(),t.emitReserved("upgradeError",n)};function c(){s("transport closed")}function u(){s("socket closed")}function l(e){r&&e.name!==r.name&&o()}var d=function(){r.removeListener("open",i),r.removeListener("error",s),r.removeListener("close",c),t.off("close",u),t.off("upgrading",l)};r.once("open",i),r.once("error",s),r.once("close",c),this.once("close",u),this.once("upgrading",l),r.open()}},{key:"onOpen",value:function(){if(this.readyState="open",n.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade)for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},{key:"onPacket",value:function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}},{key:"onHandshake",value:function(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}},{key:"resetPingTimeout",value:function(){var e=this;this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((function(){e.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}},{key:"onDrain",value:function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}},{key:"flush",value:function(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){var e=this.getWritablePackets();this.transport.send(e),this.prevBufferLen=e.length,this.emitReserved("flush")}}},{key:"getWritablePackets",value:function(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;for(var e,t=1,n=0;n<this.writeBuffer.length;n++){var r=this.writeBuffer[n].data;if(r&&(t+="string"===typeof(e=r)?function(e){for(var t=0,n=0,r=0,a=e.length;r<a;r++)(t=e.charCodeAt(r))<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(r++,n+=4);return n}(e):Math.ceil((e.byteLength||e.size)*Gi)),n>0&&t>this.maxPayload)return this.writeBuffer.slice(0,n);t+=2}return this.writeBuffer}},{key:"write",value:function(e,t,n){return this.sendPacket("message",e,t,n),this}},{key:"send",value:function(e,t,n){return this.sendPacket("message",e,t,n),this}},{key:"sendPacket",value:function(e,t,n,r){if("function"===typeof t&&(r=t,t=void 0),"function"===typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var a={type:e,data:t,options:n};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),r&&this.once("flush",r),this.flush()}}},{key:"close",value:function(){var e=this,t=function(){e.onClose("forced close"),e.transport.close()},n=function n(){e.off("upgrade",n),e.off("upgradeError",n),t()},r=function(){e.once("upgrade",n),e.once("upgradeError",n)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(function(){e.upgrading?r():t()})):this.upgrading?r():t()),this}},{key:"onError",value:function(e){n.priorWebsocketSuccess=!1,this.emitReserved("error",e),this.onClose("transport error",e)}},{key:"onClose",value:function(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"===typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)}},{key:"filterUpgrades",value:function(e){for(var t=[],n=0,r=e.length;n<r;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}]),n}(Ui);wo.protocol=4;wo.protocol;var _o="function"===typeof ArrayBuffer,So=function(e){return"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer},Eo=Object.prototype.toString,To="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Eo.call(Blob),xo="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===Eo.call(File);function Zo(e){return _o&&(e instanceof ArrayBuffer||So(e))||To&&e instanceof Blob||xo&&e instanceof File}function Co(e,t){if(!e||"object"!==typeof e)return!1;if(Array.isArray(e)){for(var n=0,r=e.length;n<r;n++)if(Co(e[n]))return!0;return!1}if(Zo(e))return!0;if(e.toJSON&&"function"===typeof e.toJSON&&1===arguments.length)return Co(e.toJSON(),!0);for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)&&Co(e[a]))return!0;return!1}function Ro(e){var t=[],n=e.data,r=e;return r.data=Po(n,t),r.attachments=t.length,{packet:r,buffers:t}}function Po(e,t){if(!e)return e;if(Zo(e)){var n={_placeholder:!0,num:t.length};return t.push(e),n}if(Array.isArray(e)){for(var r=new Array(e.length),a=0;a<e.length;a++)r[a]=Po(e[a],t);return r}if("object"===typeof e&&!(e instanceof Date)){var i={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(i[o]=Po(e[o],t));return i}return e}function Io(e,t){return e.data=Oo(e.data,t),delete e.attachments,e}function Oo(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"===typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(var n=0;n<e.length;n++)e[n]=Oo(e[n],t);else if("object"===typeof e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=Oo(e[r],t));return e}var Do,Mo=5;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(Do||(Do={}));var Ao=function(){function e(t){(0,y.Z)(this,e),this.replacer=t}return(0,k.Z)(e,[{key:"encode",value:function(e){return e.type!==Do.EVENT&&e.type!==Do.ACK||!Co(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===Do.EVENT?Do.BINARY_EVENT:Do.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}},{key:"encodeAsString",value:function(e){var t=""+e.type;return e.type!==Do.BINARY_EVENT&&e.type!==Do.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}},{key:"encodeAsBinary",value:function(e){var t=Ro(e),n=this.encodeAsString(t.packet),r=t.buffers;return r.unshift(n),r}}]),e}(),No=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;return(0,y.Z)(this,n),(r=t.call(this)).reviver=e,r}return(0,k.Z)(n,[{key:"add",value:function(e){var t;if("string"===typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");var r=(t=this.decodeString(e)).type===Do.BINARY_EVENT;r||t.type===Do.BINARY_ACK?(t.type=r?Do.EVENT:Do.ACK,this.reconstructor=new Lo(t),0===t.attachments&&f((0,p.Z)(n.prototype),"emitReserved",this).call(this,"decoded",t)):f((0,p.Z)(n.prototype),"emitReserved",this).call(this,"decoded",t)}else{if(!Zo(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,f((0,p.Z)(n.prototype),"emitReserved",this).call(this,"decoded",t))}}},{key:"decodeString",value:function(e){var t=0,r={type:Number(e.charAt(0))};if(void 0===Do[r.type])throw new Error("unknown packet type "+r.type);if(r.type===Do.BINARY_EVENT||r.type===Do.BINARY_ACK){for(var a=t+1;"-"!==e.charAt(++t)&&t!=e.length;);var i=e.substring(a,t);if(i!=Number(i)||"-"!==e.charAt(t))throw new Error("Illegal attachments");r.attachments=Number(i)}if("/"===e.charAt(t+1)){for(var o=t+1;++t;){if(","===e.charAt(t))break;if(t===e.length)break}r.nsp=e.substring(o,t)}else r.nsp="/";var s=e.charAt(t+1);if(""!==s&&Number(s)==s){for(var c=t+1;++t;){var u=e.charAt(t);if(null==u||Number(u)!=u){--t;break}if(t===e.length)break}r.id=Number(e.substring(c,t+1))}if(e.charAt(++t)){var l=this.tryParse(e.substr(t));if(!n.isPayloadValid(r.type,l))throw new Error("invalid payload");r.data=l}return r}},{key:"tryParse",value:function(e){try{return JSON.parse(e,this.reviver)}catch(t){return!1}}},{key:"destroy",value:function(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}],[{key:"isPayloadValid",value:function(e,t){switch(e){case Do.CONNECT:return"object"===typeof t;case Do.DISCONNECT:return void 0===t;case Do.CONNECT_ERROR:return"string"===typeof t||"object"===typeof t;case Do.EVENT:case Do.BINARY_EVENT:return Array.isArray(t)&&t.length>0;case Do.ACK:case Do.BINARY_ACK:return Array.isArray(t)}}}]),n}(Ui),Lo=function(){function e(t){(0,y.Z)(this,e),this.packet=t,this.buffers=[],this.reconPack=t}return(0,k.Z)(e,[{key:"takeBinaryData",value:function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=Io(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}},{key:"finishedReconstruction",value:function(){this.reconPack=null,this.buffers=[]}}]),e}();function jo(e,t,n){return e.on(t,n),function(){e.off(t,n)}}var Fo=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),Uo=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e,r,a){var i;return(0,y.Z)(this,n),(i=t.call(this)).connected=!1,i.recovered=!1,i.receiveBuffer=[],i.sendBuffer=[],i._queue=[],i._queueSeq=0,i.ids=0,i.acks={},i.flags={},i.io=e,i.nsp=r,a&&a.auth&&(i.auth=a.auth),i._opts=Object.assign({},a),i.io._autoConnect&&i.open(),i}return(0,k.Z)(n,[{key:"disconnected",get:function(){return!this.connected}},{key:"subEvents",value:function(){if(!this.subs){var e=this.io;this.subs=[jo(e,"open",this.onopen.bind(this)),jo(e,"packet",this.onpacket.bind(this)),jo(e,"error",this.onerror.bind(this)),jo(e,"close",this.onclose.bind(this))]}}},{key:"active",get:function(){return!!this.subs}},{key:"connect",value:function(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}},{key:"open",value:function(){return this.connect()}},{key:"send",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.unshift("message"),this.emit.apply(this,t),this}},{key:"emit",value:function(e){if(Fo.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(n.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;var a={type:Do.EVENT,data:n,options:{}};if(a.options.compress=!1!==this.flags.compress,"function"===typeof n[n.length-1]){var i=this.ids++,o=n.pop();this._registerAckCallback(i,o),a.id=i}var s=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!s||!this.connected)||(this.connected?(this.notifyOutgoingListeners(a),this.packet(a)):this.sendBuffer.push(a)),this.flags={},this}},{key:"_registerAckCallback",value:function(e,t){var n,r=this,a=null!==(n=this.flags.timeout)&&void 0!==n?n:this._opts.ackTimeout;if(void 0!==a){var i=this.io.setTimeoutFn((function(){delete r.acks[e];for(var n=0;n<r.sendBuffer.length;n++)r.sendBuffer[n].id===e&&r.sendBuffer.splice(n,1);t.call(r,new Error("operation has timed out"))}),a);this.acks[e]=function(){r.io.clearTimeoutFn(i);for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];t.apply(r,[null].concat(n))}}else this.acks[e]=t}},{key:"emitWithAck",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];var i=void 0!==this.flags.timeout||void 0!==this._opts.ackTimeout;return new Promise((function(n,a){r.push((function(e,t){return i?e?a(e):n(t):n(e)})),t.emit.apply(t,[e].concat(r))}))}},{key:"_addToQueue",value:function(e){var t,n=this;"function"===typeof e[e.length-1]&&(t=e.pop());var r={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push((function(e){if(r===n._queue[0]){if(null!==e)r.tryCount>n._opts.retries&&(n._queue.shift(),t&&t(e));else if(n._queue.shift(),t){for(var a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];t.apply(void 0,[null].concat(i))}return r.pending=!1,n._drainQueue()}})),this._queue.push(r),this._drainQueue()}},{key:"_drainQueue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.connected&&0!==this._queue.length){var t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}}},{key:"packet",value:function(e){e.nsp=this.nsp,this.io._packet(e)}},{key:"onopen",value:function(){var e=this;"function"==typeof this.auth?this.auth((function(t){e._sendConnectPacket(t)})):this._sendConnectPacket(this.auth)}},{key:"_sendConnectPacket",value:function(e){this.packet({type:Do.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}},{key:"onerror",value:function(e){this.connected||this.emitReserved("connect_error",e)}},{key:"onclose",value:function(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t)}},{key:"onpacket",value:function(e){if(e.nsp===this.nsp)switch(e.type){case Do.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case Do.EVENT:case Do.BINARY_EVENT:this.onevent(e);break;case Do.ACK:case Do.BINARY_ACK:this.onack(e);break;case Do.DISCONNECT:this.ondisconnect();break;case Do.CONNECT_ERROR:this.destroy();var t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}},{key:"onevent",value:function(e){var t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}},{key:"emitEvent",value:function(e){if(this._anyListeners&&this._anyListeners.length){var t,r=this._anyListeners.slice(),a=(0,c.Z)(r);try{for(a.s();!(t=a.n()).done;){t.value.apply(this,e)}}catch(Cx){a.e(Cx)}finally{a.f()}}f((0,p.Z)(n.prototype),"emit",this).apply(this,e),this._pid&&e.length&&"string"===typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}},{key:"ack",value:function(e){var t=this,n=!1;return function(){if(!n){n=!0;for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];t.packet({type:Do.ACK,id:e,data:a})}}}},{key:"onack",value:function(e){var t=this.acks[e.id];"function"===typeof t&&(t.apply(this,e.data),delete this.acks[e.id])}},{key:"onconnect",value:function(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}},{key:"emitBuffered",value:function(){var e=this;this.receiveBuffer.forEach((function(t){return e.emitEvent(t)})),this.receiveBuffer=[],this.sendBuffer.forEach((function(t){e.notifyOutgoingListeners(t),e.packet(t)})),this.sendBuffer=[]}},{key:"ondisconnect",value:function(){this.destroy(),this.onclose("io server disconnect")}},{key:"destroy",value:function(){this.subs&&(this.subs.forEach((function(e){return e()})),this.subs=void 0),this.io._destroy(this)}},{key:"disconnect",value:function(){return this.connected&&this.packet({type:Do.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{key:"close",value:function(){return this.disconnect()}},{key:"compress",value:function(e){return this.flags.compress=e,this}},{key:"volatile",get:function(){return this.flags.volatile=!0,this}},{key:"timeout",value:function(e){return this.flags.timeout=e,this}},{key:"onAny",value:function(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}},{key:"prependAny",value:function(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}},{key:"offAny",value:function(e){if(!this._anyListeners)return this;if(e){for(var t=this._anyListeners,n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}},{key:"listenersAny",value:function(){return this._anyListeners||[]}},{key:"onAnyOutgoing",value:function(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}},{key:"prependAnyOutgoing",value:function(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}},{key:"offAnyOutgoing",value:function(e){if(!this._anyOutgoingListeners)return this;if(e){for(var t=this._anyOutgoingListeners,n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}},{key:"listenersAnyOutgoing",value:function(){return this._anyOutgoingListeners||[]}},{key:"notifyOutgoingListeners",value:function(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){var t,n=this._anyOutgoingListeners.slice(),r=(0,c.Z)(n);try{for(r.s();!(t=r.n()).done;){t.value.apply(this,e.data)}}catch(Cx){r.e(Cx)}finally{r.f()}}}}]),n}(Ui);function Bo(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Bo.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},Bo.prototype.reset=function(){this.attempts=0},Bo.prototype.setMin=function(e){this.ms=e},Bo.prototype.setMax=function(e){this.max=e},Bo.prototype.setJitter=function(e){this.jitter=e};var Vo=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e,a){var i,o;(0,y.Z)(this,n),(i=t.call(this)).nsps={},i.subs=[],e&&"object"===typeof e&&(a=e,e=void 0),(a=a||{}).path=a.path||"/socket.io",i.opts=a,Wi((0,v.Z)(i),a),i.reconnection(!1!==a.reconnection),i.reconnectionAttempts(a.reconnectionAttempts||1/0),i.reconnectionDelay(a.reconnectionDelay||1e3),i.reconnectionDelayMax(a.reconnectionDelayMax||5e3),i.randomizationFactor(null!==(o=a.randomizationFactor)&&void 0!==o?o:.5),i.backoff=new Bo({min:i.reconnectionDelay(),max:i.reconnectionDelayMax(),jitter:i.randomizationFactor()}),i.timeout(null==a.timeout?2e4:a.timeout),i._readyState="closed",i.uri=e;var s=a.parser||r;return i.encoder=new s.Encoder,i.decoder=new s.Decoder,i._autoConnect=!1!==a.autoConnect,i._autoConnect&&i.open(),i}return(0,k.Z)(n,[{key:"reconnection",value:function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}},{key:"reconnectionAttempts",value:function(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}},{key:"reconnectionDelay",value:function(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}},{key:"randomizationFactor",value:function(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}},{key:"reconnectionDelayMax",value:function(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}},{key:"timeout",value:function(e){return arguments.length?(this._timeout=e,this):this._timeout}},{key:"maybeReconnectOnOpen",value:function(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}},{key:"open",value:function(e){var t=this;if(~this._readyState.indexOf("open"))return this;this.engine=new wo(this.uri,this.opts);var n=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;var a=jo(n,"open",(function(){r.onopen(),e&&e()})),i=jo(n,"error",(function(n){r.cleanup(),r._readyState="closed",t.emitReserved("error",n),e?e(n):r.maybeReconnectOnOpen()}));if(!1!==this._timeout){var o=this._timeout;0===o&&a();var s=this.setTimeoutFn((function(){a(),n.close(),n.emit("error",new Error("timeout"))}),o);this.opts.autoUnref&&s.unref(),this.subs.push((function(){clearTimeout(s)}))}return this.subs.push(a),this.subs.push(i),this}},{key:"connect",value:function(e){return this.open(e)}},{key:"onopen",value:function(){this.cleanup(),this._readyState="open",this.emitReserved("open");var e=this.engine;this.subs.push(jo(e,"ping",this.onping.bind(this)),jo(e,"data",this.ondata.bind(this)),jo(e,"error",this.onerror.bind(this)),jo(e,"close",this.onclose.bind(this)),jo(this.decoder,"decoded",this.ondecoded.bind(this)))}},{key:"onping",value:function(){this.emitReserved("ping")}},{key:"ondata",value:function(e){try{this.decoder.add(e)}catch(t){this.onclose("parse error",t)}}},{key:"ondecoded",value:function(e){var t=this;fo((function(){t.emitReserved("packet",e)}),this.setTimeoutFn)}},{key:"onerror",value:function(e){this.emitReserved("error",e)}},{key:"socket",value:function(e,t){var n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new Uo(this,e,t),this.nsps[e]=n),n}},{key:"_destroy",value:function(e){for(var t=0,n=Object.keys(this.nsps);t<n.length;t++){var r=n[t];if(this.nsps[r].active)return}this._close()}},{key:"_packet",value:function(e){for(var t=this.encoder.encode(e),n=0;n<t.length;n++)this.engine.write(t[n],e.options)}},{key:"cleanup",value:function(){this.subs.forEach((function(e){return e()})),this.subs.length=0,this.decoder.destroy()}},{key:"_close",value:function(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}},{key:"disconnect",value:function(){return this._close()}},{key:"onclose",value:function(e,t){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}},{key:"reconnect",value:function(){var e=this;if(this._reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{var n=this.backoff.duration();this._reconnecting=!0;var r=this.setTimeoutFn((function(){t.skipReconnect||(e.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open((function(n){n?(t._reconnecting=!1,t.reconnect(),e.emitReserved("reconnect_error",n)):t.onreconnect()})))}),n);this.opts.autoUnref&&r.unref(),this.subs.push((function(){clearTimeout(r)}))}}},{key:"onreconnect",value:function(){var e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}]),n}(Ui),Ho={};function zo(e,t){"object"===typeof e&&(t=e,e=void 0);var n,r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=e;n=n||"undefined"!==typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"===typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(e="undefined"!==typeof n?n.protocol+"//"+e:"https://"+e),r=bo(e)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";var a=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+a+":"+r.port+t,r.href=r.protocol+"://"+a+(n&&n.port===r.port?"":":"+r.port),r}(e,(t=t||{}).path||"/socket.io"),a=r.source,i=r.id,o=r.path,s=Ho[i]&&o in Ho[i].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||s?n=new Vo(a,t):(Ho[i]||(Ho[i]=new Vo(a,t)),n=Ho[i]),r.query&&!t.query&&(t.query=r.queryKey),n.socket(r.path,t)}Object.assign(zo,{Manager:Vo,Socket:Uo,io:zo,connect:zo}),e=n.hmd(e);var Wo,Go,qo,$o=Object.defineProperty,Ko=function(e,t,n){return function(e,t,n){t in e?$o(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=typeof t?t+"":t,n),n},Jo=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},Qo=function(e,t,n){return Jo(e,t,"read from private field"),n?n.call(e):t.get(e)},Xo=function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},Yo=function(e,t,n,r){return Jo(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n},es=function(e,t,n){return Jo(e,t,"access private method"),n};(Go=Wo||(Wo={}))[Go.MAJOR_EVENT=0]="MAJOR_EVENT",Go[Go.MINOR_EVENT=1]="MINOR_EVENT",function(e){e.PRECALL_TEST_BEGIN="precall_begin",e.PRECALL_TEST_COMPLETE="precall_end",e.CALL_JOIN_BEGIN="call_join",e.NET_QUALITY_TEST_BEGIN="net_quality_test_begin",e.NET_QUALITY_TEST_END="net_quality_test_end",e.WEBSOCKET_CONNECTED="websocket_connected",e.TRANSPORT_CONNECTED="transport_connected",e.AUDIO_ON="audio_on",e.AUDIO_OFF="audio_off",e.VIDEO_ON="video_on",e.VIDEO_OFF="video_off",e.PARTICIPANT_ROLE="participant_role",e.PING_STAT="ping_stat",e.DISCONNECT="disconnect",e.RECONNECT_ATTEMPT="reconnect_attempt",e.SCREENSHARE_START_REQUESTED="screenshare_start_requested",e.SCREENSHARE_STARTED="screenshare_started",e.SCREENSHARE_STOPPED="screenshare_stopped",e.TAB_CHANGE="tab_change",e.BROWSER_BACKGROUNDED="browser_backgrounded",e.BROWSER_FOREGROUNDED="browser_foregrounded",e.DOMINANT_SPEAKER="dominant_speaker",e.AUDIO_DEVICES_UPDATES="audio_devices_updates",e.VIDEO_DEVICES_UPDATES="video_devices_updates",e.SPEAKER_DEVICES_UPDATES="speaker_devices_updates",e.SELECTED_MICROHPONE_UPDATE="selected_microphone_update",e.SELECTED_CAMERA_UPDATE="selected_camera_update",e.SELECTED_SPEAKER_UPDATE="selected_speaker_update",e.MEDIA_PERMISSION="camera_permission",e.LEGACY_SWITCH="legacy_switch",e.AUDIO_PLAY_FAILED="audio_play_failed",e.VIDEO_PLAY_FAILED="video_play_failed",e.AUDIO_TRACK_MUTED="audio_track_muted",e.VIDEO_TRACK_MUTED="video_track_muted"}(qo||(qo={}));var ts=new Map([[qo.PRECALL_TEST_BEGIN,Wo.MINOR_EVENT],[qo.PRECALL_TEST_COMPLETE,Wo.MINOR_EVENT],[qo.CALL_JOIN_BEGIN,Wo.MAJOR_EVENT],[qo.NET_QUALITY_TEST_BEGIN,Wo.MINOR_EVENT],[qo.NET_QUALITY_TEST_END,Wo.MINOR_EVENT],[qo.WEBSOCKET_CONNECTED,Wo.MINOR_EVENT],[qo.TRANSPORT_CONNECTED,Wo.MAJOR_EVENT],[qo.AUDIO_ON,Wo.MINOR_EVENT],[qo.AUDIO_OFF,Wo.MINOR_EVENT],[qo.VIDEO_ON,Wo.MINOR_EVENT],[qo.VIDEO_OFF,Wo.MINOR_EVENT],[qo.PARTICIPANT_ROLE,Wo.MINOR_EVENT],[qo.PING_STAT,Wo.MAJOR_EVENT],[qo.DISCONNECT,Wo.MAJOR_EVENT],[qo.RECONNECT_ATTEMPT,Wo.MAJOR_EVENT],[qo.SCREENSHARE_START_REQUESTED,Wo.MINOR_EVENT],[qo.SCREENSHARE_STARTED,Wo.MINOR_EVENT],[qo.SCREENSHARE_STOPPED,Wo.MINOR_EVENT],[qo.TAB_CHANGE,Wo.MINOR_EVENT],[qo.BROWSER_BACKGROUNDED,Wo.MINOR_EVENT],[qo.BROWSER_FOREGROUNDED,Wo.MINOR_EVENT],[qo.DOMINANT_SPEAKER,Wo.MINOR_EVENT],[qo.AUDIO_DEVICES_UPDATES,Wo.MINOR_EVENT],[qo.VIDEO_DEVICES_UPDATES,Wo.MINOR_EVENT],[qo.SPEAKER_DEVICES_UPDATES,Wo.MINOR_EVENT],[qo.SELECTED_MICROHPONE_UPDATE,Wo.MINOR_EVENT],[qo.SELECTED_CAMERA_UPDATE,Wo.MINOR_EVENT],[qo.SELECTED_SPEAKER_UPDATE,Wo.MINOR_EVENT],[qo.MEDIA_PERMISSION,Wo.MINOR_EVENT],[qo.LEGACY_SWITCH,Wo.MINOR_EVENT],[qo.AUDIO_PLAY_FAILED,Wo.MINOR_EVENT],[qo.VIDEO_PLAY_FAILED,Wo.MINOR_EVENT],[qo.AUDIO_TRACK_MUTED,Wo.MINOR_EVENT],[qo.VIDEO_TRACK_MUTED,Wo.MINOR_EVENT]]),ns="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof n.g?n.g:"undefined"!=typeof self?self:{};function rs(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var n=function e(){if(this instanceof e){var n=[null];return n.push.apply(n,arguments),new(Function.bind.apply(t,n))}return t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})})),n}var as,is={},os={get exports(){return is},set exports(e){is=e}},ss="object"==typeof Reflect?Reflect:null,cs=ss&&"function"==typeof ss.apply?ss.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};as=ss&&"function"==typeof ss.ownKeys?ss.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var us=Number.isNaN||function(e){return e!==e};function ls(){ls.init.call(this)}os.exports=ls,is.once=function(e,t){return new Promise((function(n,r){function a(n){e.removeListener(t,i),r(n)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",a),n([].slice.call(arguments))}bs(e,t,i,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&bs(e,"error",t,n)}(e,a,{once:!0})}))},ls.EventEmitter=ls,ls.prototype._events=void 0,ls.prototype._eventsCount=0,ls.prototype._maxListeners=void 0;var ds=10;function ps(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function fs(e){return void 0===e._maxListeners?ls.defaultMaxListeners:e._maxListeners}function hs(e,t,n,r){var a,i,o;if(ps(n),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),o=i[t]),void 0===o)o=i[t]=n,++e._eventsCount;else if("function"==typeof o?o=i[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),(a=fs(e))>0&&o.length>a&&!o.warned){o.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=o.length,function(e){console&&console.warn&&console.warn(e)}(s)}return e}function vs(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function ms(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},a=vs.bind(r);return a.listener=n,r.wrapFn=a,a}function gs(e,t,n){var r=e._events;if(void 0===r)return[];var a=r[t];return void 0===a?[]:"function"==typeof a?n?[a.listener||a]:[a]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(a):ks(a,a.length)}function ys(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function ks(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function bs(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function a(i){r.once&&e.removeEventListener(t,a),n(i)}))}}Object.defineProperty(ls,"defaultMaxListeners",{enumerable:!0,get:function(){return ds},set:function(e){if("number"!=typeof e||e<0||us(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");ds=e}}),ls.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},ls.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||us(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},ls.prototype.getMaxListeners=function(){return fs(this)},ls.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,a=this._events;if(void 0!==a)r=r&&void 0===a.error;else if(!r)return!1;if(r){var i;if(t.length>0&&(i=t[0]),i instanceof Error)throw i;var o=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw o.context=i,o}var s=a[e];if(void 0===s)return!1;if("function"==typeof s)cs(s,this,t);else{var c=s.length,u=ks(s,c);for(n=0;n<c;++n)cs(u[n],this,t)}return!0},ls.prototype.addListener=function(e,t){return hs(this,e,t,!1)},ls.prototype.on=ls.prototype.addListener,ls.prototype.prependListener=function(e,t){return hs(this,e,t,!0)},ls.prototype.once=function(e,t){return ps(t),this.on(e,ms(this,e,t)),this},ls.prototype.prependOnceListener=function(e,t){return ps(t),this.prependListener(e,ms(this,e,t)),this},ls.prototype.removeListener=function(e,t){var n,r,a,i,o;if(ps(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(a=-1,i=n.length-1;i>=0;i--)if(n[i]===t||n[i].listener===t){o=n[i].listener,a=i;break}if(a<0)return this;0===a?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,a),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,o||t)}return this},ls.prototype.off=ls.prototype.removeListener,ls.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var a,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(a=i[r])&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},ls.prototype.listeners=function(e){return gs(this,e,!0)},ls.prototype.rawListeners=function(e){return gs(this,e,!1)},ls.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):ys.call(e,t)},ls.prototype.listenerCount=ys,ls.prototype.eventNames=function(){return this._eventsCount>0?as(this._events):[]};var ws,_s,Ss,Es,Ts=function(){function e(){(0,y.Z)(this,e),Ko(this,"currentChunk"),Ko(this,"flushedChunks"),this.currentChunk={entries:[]},this.flushedChunks=[]}return(0,k.Z)(e,[{key:"add",value:function(e){this.currentChunk.entries.push(e)}},{key:"flush",value:function(){var e=this.currentChunk;return this.currentChunk={entries:[]},this.flushedChunks.push(e),e}}]),e}(),xs=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;return(0,y.Z)(this,n),r=t.call(this),Ko((0,v.Z)(r),"connection"),Ko((0,v.Z)(r),"eventStore"),r.connection=e,r.eventStore=new Ts,r}return(0,k.Z)(n,[{key:"callEvent",value:function(e){if(e.timestamp=new Date,this.eventStore.add(e),this.emit(e.event,e.metaData),ts.get(e.event)===Wo.MAJOR_EVENT){var t=this.eventStore.flush();this.connection.sendChunk(t)}}}]),n}(is);!function(e){e.CHROMIUM="chromum",e.FIREFOX="firefox",e.SAFARI="safari"}(ws||(ws={})),function(e){e.DEV="dev",e.STAGING="staging",e.PRODUCTION="production"}(_s||(_s={})),function(e){e.AUDIO="AUDIO",e.VIDEO="VIDEO",e.SPEAKER="SPEAKER"}(Ss||(Ss={})),function(e){e[e.INIT=0]="INIT",e[e.ACCEPTED=1]="ACCEPTED",e[e.DENIED=2]="DENIED",e[e.SYS_DENIED=3]="SYS_DENIED",e[e.FAILED=4]="FAILED",e[e.NOTFOUND=5]="NOTFOUND",e[e.NOT_APPLICABLE=6]="NOT_APPLICABLE"}(Es||(Es={}));var Zs=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5e3;return(0,y.Z)(this,n),e=t.call(this),Ko((0,v.Z)(e),"chunkQueue"),Ko((0,v.Z)(e),"flushTicker"),Ko((0,v.Z)(e),"flushInterval"),e.chunkQueue={entries:[]},e.flushInterval=r,e}return(0,k.Z)(n,[{key:"sendChunk",value:function(e){this.sendChunkToServer(e)}}]),n}(function(){function e(){(0,y.Z)(this,e),Ko(this,"authInfo")}return(0,k.Z)(e,[{key:"authenticate",value:function(e){this.authInfo=e}}]),e}()),Cs=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.apply(this,arguments)}return(0,k.Z)(n,[{key:"sendChunk",value:function(e){f((0,p.Z)(n.prototype),"sendChunk",this).call(this,e)}},{key:"sendChunkToServer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),n}(Zs),Rs={};function Ps(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var Is=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Os=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}},Ds=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function Ms(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var As=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t};Rs.decode=Rs.parse=function(e,t,n,r){t=t||"&",n=n||"=";var a={};if("string"!=typeof e||0===e.length)return a;var i=/\+/g;e=e.split(t);var o=1e3;r&&"number"==typeof r.maxKeys&&(o=r.maxKeys);var s=e.length;o>0&&s>o&&(s=o);for(var c=0;c<s;++c){var u,l,d,p,f=e[c].replace(i,"%20"),h=f.indexOf(n);h>=0?(u=f.substr(0,h),l=f.substr(h+1)):(u=f,l=""),d=decodeURIComponent(u),p=decodeURIComponent(l),Ps(a,d)?Is(a[d])?a[d].push(p):a[d]=[a[d],p]:a[d]=p}return a},Rs.encode=Rs.stringify=function(e,t,n,r){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?Ms(As(e),(function(r){var a=encodeURIComponent(Os(r))+n;return Ds(e[r])?Ms(e[r],(function(e){return a+encodeURIComponent(Os(e))})).join(t):a+encodeURIComponent(Os(e[r]))})).join(t):r?encodeURIComponent(Os(r))+n+encodeURIComponent(Os(e)):""};var Ns={},Ls={get exports(){return Ns},set exports(e){Ns=e}};var js,Fs={},Us={get exports(){return Fs},set exports(e){Fs=e}},Bs=rs(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));function Vs(){return js||(js=1,function(e,t){e.exports=function(){var e=e||function(e,t){var n;if("undefined"!=typeof window&&window.crypto&&(n=window.crypto),"undefined"!=typeof self&&self.crypto&&(n=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(n=globalThis.crypto),!n&&"undefined"!=typeof window&&window.msCrypto&&(n=window.msCrypto),!n&&"undefined"!=typeof ns&&ns.crypto&&(n=ns.crypto),!n)try{n=Bs}catch(v){}var r=function(){if(n){if("function"==typeof n.getRandomValues)try{return n.getRandomValues(new Uint32Array(1))[0]}catch(v){}if("function"==typeof n.randomBytes)try{return n.randomBytes(4).readInt32LE()}catch(v){}}throw new Error("Native crypto module could not be used to get secure random number.")},a=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),i={},o=i.lib={},s=o.Base={extend:function(e){var t=a(this);return e&&t.mixIn(e),(!t.hasOwnProperty("init")||this.init===t.init)&&(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},c=o.WordArray=s.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n!=t?n:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t=this.words,n=e.words,r=this.sigBytes,a=e.sigBytes;if(this.clamp(),r%4)for(var i=0;i<a;i++){var o=n[i>>>2]>>>24-i%4*8&255;t[r+i>>>2]|=o<<24-(r+i)%4*8}else for(var s=0;s<a;s+=4)t[r+s>>>2]=n[s>>>2];return this.sigBytes+=a,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=s.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],n=0;n<e;n+=4)t.push(r());return new c.init(t,e)}}),u=i.enc={},l=u.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],a=0;a<n;a++){var i=t[a>>>2]>>>24-a%4*8&255;r.push((i>>>4).toString(16)),r.push((15&i).toString(16))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[r>>>3]|=parseInt(e.substr(r,2),16)<<24-r%8*4;return new c.init(n,t/2)}},d=u.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,r=[],a=0;a<n;a++){var i=t[a>>>2]>>>24-a%4*8&255;r.push(String.fromCharCode(i))}return r.join("")},parse:function(e){for(var t=e.length,n=[],r=0;r<t;r++)n[r>>>2]|=(255&e.charCodeAt(r))<<24-r%4*8;return new c.init(n,t)}},p=u.Utf8={stringify:function(e){try{return decodeURIComponent(escape(d.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return d.parse(unescape(encodeURIComponent(e)))}},f=o.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=p.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,r=this._data,a=r.words,i=r.sigBytes,o=this.blockSize,s=i/(4*o),u=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*o,l=e.min(4*u,i);if(u){for(var d=0;d<u;d+=o)this._doProcessBlock(a,d);n=a.splice(0,u),r.sigBytes-=l}return new c.init(n,l)},clone:function(){var e=s.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});o.Hasher=f.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new h.HMAC.init(e,n).finalize(t)}}});var h=i.algo={};return i}(Math);return e}()}(Us)),Fs}!function(e,t){var n;e.exports=(n=Vs(),function(e){var t=n,r=t.lib,a=r.WordArray,i=r.Hasher,o=t.algo,s=[],c=[];!function(){function t(t){for(var n=e.sqrt(t),r=2;r<=n;r++)if(!(t%r))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var r=2,a=0;a<64;)t(r)&&(a<8&&(s[a]=n(e.pow(r,.5))),c[a]=n(e.pow(r,1/3)),a++),r++}();var u=[],l=o.SHA256=i.extend({_doReset:function(){this._hash=new a.init(s.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,r=n[0],a=n[1],i=n[2],o=n[3],s=n[4],l=n[5],d=n[6],p=n[7],f=0;f<64;f++){if(f<16)u[f]=0|e[t+f];else{var h=u[f-15],v=(h<<25|h>>>7)^(h<<14|h>>>18)^h>>>3,m=u[f-2],g=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;u[f]=v+u[f-7]+g+u[f-16]}var y=r&a^r&i^a&i,k=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),b=p+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&l^~s&d)+c[f]+u[f];p=d,d=l,l=s,s=o+b|0,o=i,i=a,a=r,r=b+(k+y)|0}n[0]=n[0]+r|0,n[1]=n[1]+a|0,n[2]=n[2]+i|0,n[3]=n[3]+o|0,n[4]=n[4]+s|0,n[5]=n[5]+l|0,n[6]=n[6]+d|0,n[7]=n[7]+p|0},_doFinalize:function(){var t=this._data,n=t.words,r=8*this._nDataBytes,a=8*t.sigBytes;return n[a>>>5]|=128<<24-a%32,n[14+(a+64>>>9<<4)]=e.floor(r/4294967296),n[15+(a+64>>>9<<4)]=r,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=i._createHelper(l),t.HmacSHA256=i._createHmacHelper(l)}(Math),n.SHA256)}(Ls);var Hs,zs=Ns,Ws={},Gs={get exports(){return Ws},set exports(e){Ws=e}},qs={},$s={get exports(){return qs},set exports(e){qs=e}};!function(e,t){var n;e.exports=(n=Vs(),Hs||(Hs=1,function(e,t){var n;e.exports=(n=Vs(),void function(){var e=n,t=e.lib.Base,r=e.enc.Utf8;e.algo.HMAC=t.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=r.parse(t));var n=e.blockSize,a=4*n;t.sigBytes>a&&(t=e.finalize(t)),t.clamp();for(var i=this._oKey=t.clone(),o=this._iKey=t.clone(),s=i.words,c=o.words,u=0;u<n;u++)s[u]^=1549556828,c[u]^=909522486;i.sigBytes=o.sigBytes=a,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})}())}($s)),n.HmacSHA256)}(Gs);var Ks=Ws;function Js(e){this.capacity=0|e,this.map=Object.create(null),this.list=new Qs}function Qs(){this.firstNode=null,this.lastNode=null}function Xs(e,t){this.key=e,this.val=t,this.prev=null,this.next=null}Js.prototype.get=function(e){var t=this.map[e];if(null!=t)return this.used(t),t.val},Js.prototype.set=function(e,t){var n=this.map[e];if(null!=n)n.val=t;else{if(this.capacity||this.prune(),!this.capacity)return!1;n=new Xs(e,t),this.map[e]=n,this.capacity--}return this.used(n),!0},Js.prototype.used=function(e){this.list.moveToFront(e)},Js.prototype.prune=function(){var e=this.list.pop();null!=e&&(delete this.map[e.key],this.capacity+=1)},Qs.prototype.moveToFront=function(e){this.firstNode!=e&&(this.remove(e),null==this.firstNode?(this.firstNode=e,this.lastNode=e,e.prev=null,e.next=null):(e.prev=null,e.next=this.firstNode,e.next.prev=e,this.firstNode=e))},Qs.prototype.pop=function(){var e=this.lastNode;return null!=e&&this.remove(e),e},Qs.prototype.remove=function(e){this.firstNode==e?this.firstNode=e.next:null!=e.prev&&(e.prev.next=e.next),this.lastNode==e?this.lastNode=e.prev:null!=e.next&&(e.next.prev=e.prev)},Rs||console.error("Error in callstats, querystring module undefined");var Ys=function(e){return new Js(e)}(1e3);function ec(e,t,n){return Ks(t,e)}function tc(e,t){return zs(e)}function nc(e){return e.replace(/[!'()*]/g,(function(e){return"%".concat(e.charCodeAt(0).toString(16).toUpperCase())}))}function rc(e){return nc(encodeURIComponent(e))}var ac={authorization:!0,connection:!0,"x-amzn-trace-id":!0,"user-agent":!0,expect:!0,"presigned-expires":!0,range:!0};function ic(e,t){"string"==typeof e&&(e=new URL(e));var n=e.headers=e.headers||{},r=(!this.service||!this.region)&&this.matchHost(e.hostname||e.host||n.Host||n.host);this.request=e,this.credentials=t||this.defaultCredentials(),this.service=e.service||r[0]||"",this.region=e.region||r[1]||"us-east-1","email"===this.service&&(this.service="ses"),!e.method&&e.body&&(e.method="POST"),!n.Host&&!n.host&&(n.Host=e.hostname||e.host||this.createHost(),e.port&&(n.Host+=":".concat(e.port))),!e.hostname&&!e.host&&(e.hostname=n.Host||n.host),this.isCodeCommitGit="codecommit"===this.service&&"GIT"===e.method}ic.prototype.matchHost=function(e){var t=((e||"").match(/([^\.]+)\.(?:([^\.]*)\.)?amazonaws\.com(\.cn)?$/)||[]).slice(1,3);if("es"===t[1]&&(t=t.reverse()),"s3"==t[1])t[0]="s3",t[1]="us-east-1";else for(var n=0;n<2;n+=1)if(/^s3-/.test(t[n])){t[1]=t[n].slice(3),t[0]="s3";break}return t},ic.prototype.isSingleRegion=function(){return["s3","sdb"].indexOf(this.service)>=0&&"us-east-1"===this.region||["cloudfront","ls","route53","iam","importexport","sts"].indexOf(this.service)>=0},ic.prototype.createHost=function(){var e=this.isSingleRegion()?"":".".concat(this.region);return"".concat(("ses"===this.service?"email":this.service)+e,".amazonaws.com")},ic.prototype.prepareRequest=function(){try{this.parsePath()}catch(r){console.error("Error in callstats:",r)}var e,t=this.request,n=t.headers;t.signQuery?(this.parsedPath.query=e=this.parsedPath.query||{},this.credentials.sessionToken&&(e["X-Amz-Security-Token"]=this.credentials.sessionToken),"s3"===this.service&&!e["X-Amz-Expires"]&&(e["X-Amz-Expires"]=86400),e["X-Amz-Date"]?this.datetime=e["X-Amz-Date"]:e["X-Amz-Date"]=this.getDateTime(),e["X-Amz-Algorithm"]="AWS4-HMAC-SHA256",e["X-Amz-Credential"]="".concat(this.credentials.accessKeyId,"/").concat(this.credentialString()),e["X-Amz-SignedHeaders"]=this.signedHeaders()):(!t.doNotModifyHeaders&&!this.isCodeCommitGit&&(t.body&&!n["Content-Type"]&&!n["content-type"]&&(n["Content-Type"]="application/x-www-form-urlencoded; charset=utf-8"),t.body&&!n["Content-Length"]&&!n["content-length"]&&(n["Content-Length"]=Buffer.byteLength(t.body)),this.credentials.sessionToken&&!n["X-Amz-Security-Token"]&&!n["x-amz-security-token"]&&(n["X-Amz-Security-Token"]=this.credentials.sessionToken),"s3"===this.service&&!n["X-Amz-Content-Sha256"]&&!n["x-amz-content-sha256"]&&(n["X-Amz-Content-Sha256"]=tc(this.request.body||"")),n["X-Amz-Date"]||n["x-amz-date"]?this.datetime=n["X-Amz-Date"]||n["x-amz-date"]:n["X-Amz-Date"]=this.getDateTime()),delete n.Authorization,delete n.authorization)},ic.prototype.sign=function(){return this.parsedPath||this.prepareRequest(),this.request.signQuery?this.parsedPath.query["X-Amz-Signature"]=this.signature():this.request.headers.Authorization=this.authHeader(),this.request.path=this.formatPath(),this.request},ic.prototype.getDateTime=function(){if(!this.datetime){var e=this.request.headers,t=new Date(e.Date||e.date||new Date);this.datetime=t.toISOString().replace(/[:\-]|\.\d{3}/g,""),this.isCodeCommitGit&&(this.datetime=this.datetime.slice(0,-1))}return this.datetime},ic.prototype.getDate=function(){return this.getDateTime().substr(0,8)},ic.prototype.authHeader=function(){return["AWS4-HMAC-SHA256 Credential=".concat(this.credentials.accessKeyId,"/").concat(this.credentialString()),"SignedHeaders=".concat(this.signedHeaders()),"Signature=".concat(this.signature())].join(", ")},ic.prototype.signature=function(){var e,t,n,r=this.getDate(),a=[this.credentials.secretAccessKey,r,this.region,this.service].join(),i=Ys.get(a);return i||(e=ec("AWS4".concat(this.credentials.secretAccessKey),r),t=ec(e,this.region),n=ec(t,this.service),i=ec(n,"aws4_request"),Ys.set(a,i)),ec(i,this.stringToSign())},ic.prototype.stringToSign=function(){return["AWS4-HMAC-SHA256",this.getDateTime(),this.credentialString(),tc(this.canonicalString())].join("\n")},ic.prototype.canonicalString=function(){this.parsedPath||this.prepareRequest();var e,t=this.parsedPath.path,n=this.parsedPath.query,r=this.request.headers,a="",i="s3"!==this.service,o="s3"===this.service||this.request.doNotEncodePath,s="s3"===this.service,c="s3"===this.service;if(e="s3"===this.service&&this.request.signQuery?"UNSIGNED-PAYLOAD":this.isCodeCommitGit?"":r["X-Amz-Content-Sha256"]||r["x-amz-content-sha256"]||tc(this.request.body||""),n){var u=Object.keys(n).reduce((function(e,t){return t&&(e[rc(t)]=Array.isArray(n[t])&&c?n[t][0]:n[t]),e}),{}),l=[];Object.keys(u).sort().forEach((function(e){Array.isArray(u[e])?u[e].map(rc).sort().forEach((function(t){l.push("".concat(e,"=").concat(t))})):l.push("".concat(e,"=").concat(rc(u[e])))})),a=l.join("&")}return"/"!==t&&(i&&(t=t.replace(/\/{2,}/g,"/")),t=t.split("/").reduce((function(e,t){return i&&".."===t?e.pop():(!i||"."!==t)&&(o&&(t=decodeURIComponent(t.replace(/\+/g," "))),e.push(rc(t))),e}),[]).join("/"),"/"!==t[0]&&(t="/".concat(t)),s&&(t=t.replace(/%2F/g,"/"))),[this.request.method||"GET",t,a,"".concat(this.canonicalHeaders(),"\n"),this.signedHeaders(),e].join("\n")},ic.prototype.canonicalHeaders=function(){var e=this.request.headers;return Object.keys(e).filter((function(e){return null==ac[e.toLowerCase()]})).sort((function(e,t){return e.toLowerCase()<t.toLowerCase()?-1:1})).map((function(t){return"".concat(t.toLowerCase(),":").concat(function(e){return e.toString().trim().replace(/\s+/g," ")}(e[t]))})).join("\n")},ic.prototype.signedHeaders=function(){return Object.keys(this.request.headers).map((function(e){return e.toLowerCase()})).filter((function(e){return null==ac[e]})).sort().join(";")},ic.prototype.credentialString=function(){return[this.getDate(),this.region,this.service,"aws4_request"].join("/")},ic.prototype.defaultCredentials=function(){process;var e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0};return{accessKeyId:e.AWS_ACCESS_KEY_ID||e.AWS_ACCESS_KEY,secretAccessKey:e.AWS_SECRET_ACCESS_KEY||e.AWS_SECRET_KEY,sessionToken:e.AWS_SESSION_TOKEN}},ic.prototype.parsePath=function(){var e=this.request.path||"/";/[^0-9A-Za-z;,/?:@&=+$\-_.!~*'()#%]/.test(e)&&(e=encodeURI(decodeURI(e)));var t=e.indexOf("?"),n=null;t>=0&&(n=Rs.parse(e.slice(t+1)),e=e.slice(0,t)),this.parsedPath={path:e,query:n}},ic.prototype.formatPath=function(){var e=this.parsedPath.path,t=this.parsedPath.query;return t?(null!=t[""]&&delete t[""],"".concat(e,"?").concat(nc(Rs.stringify(t)))):e};var oc=ic,sc=function(e,t){return new oc(e,t).sign()},cc=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e,r,a){var i;return(0,y.Z)(this,n),i=t.call(this),Ko((0,v.Z)(i),"config"),Ko((0,v.Z)(i),"logger"),Ko((0,v.Z)(i),"sqsApiEndpoint"),Ko((0,v.Z)(i),"ingestionLayerDetails"),i.logger=a,i.config={region:"ap-south-1",credentials:{accessKeyId:atob("QUtJQTVZQUhSS1pSQklZTjdXVTc="),secretAccessKey:atob("YVpIM2Y5SHlHZnp6ZDZ4OHg5SkhaZzlUcGVPS2Z0cE92MUk3bE1HKw==")}},e===_s.PRODUCTION?(i.config.queue="/944908621410/Callstats-Queue",i.sqsApiEndpoint="https://collector.prod.da.dyte.io/api/v1/message"):(i.config.queue="/944908621410/Callstats-Queue",i.sqsApiEndpoint="https://collector.non-prod.da.dyte.io/api/v1/message"),i.ingestionLayerDetails=null!=r?r:"SQS",i}return(0,k.Z)(n,[{key:"sendChunk",value:function(e){f((0,p.Z)(n.prototype),"sendChunk",this).call(this,e)}},{key:"sendDirectly",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new URLSearchParams({Action:"SendMessage",MessageBody:JSON.stringify(t)}),r=sc({service:"sqs",region:this.config.region,path:"".concat(this.config.queue,"/?").concat(n.toString())},this.config.credentials),a="https://".concat(r.hostname).concat(r.path),e.next=3,fetch(a,r);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendToNewIngestionLayer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(this.sqsApiEndpoint,{method:"POST",body:JSON.stringify(t)});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendChunkToServer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={payload:t,peerId:null==(n=this.authInfo)?void 0:n.peerId},a=[],e.prev=1,("INGESTION"===this.ingestionLayerDetails||"ALL"===this.ingestionLayerDetails)&&a.push(this.sendToNewIngestionLayer(r)),("SQS"===this.ingestionLayerDetails||"ALL"===this.ingestionLayerDetails)&&a.push(this.sendDirectly(r)),e.next=6,Promise.allSettled(a);case 6:return e.sent.forEach((function(e){"rejected"===e.status&&i.logger.error("callStats::sqs::sendChunkToServer",{error:{reason:e.reason}})})),e.abrupt("return",!0);case 10:return e.prev=10,e.t0=e.catch(1),e.abrupt("return",(this.logger.error("callStats::sqs::sendChunkToServer::catch",{error:{reason:e.t0.reason,message:e.t0.message}}),!1));case 13:case"end":return e.stop()}}),e,this,[[1,10]])})));return function(t){return e.apply(this,arguments)}}()}]),n}(Cs),uc=function(){function e(t){(0,y.Z)(this,e),Ko(this,"pc1"),Ko(this,"pc2"),Ko(this,"constrainVideoBitrateKbps"),Ko(this,"constrainOfferToRemoveVideoFec",!1),Ko(this,"iceCandidateFilter");var n=new RTCPeerConnection(t),r=new RTCPeerConnection(t);this.pc1=n,this.pc2=r,this.iceCandidateFilter=e.noFilter,this.pc1.addEventListener("icecandidate",this.onIceCandidate.bind(this,this.pc2)),this.pc2.addEventListener("icecandidate",this.onIceCandidate.bind(this,this.pc1))}return(0,k.Z)(e,[{key:"onIceCandidate",value:function(t,n){if(n.candidate){var r=e.parseCandidate(n.candidate.candidate);this.iceCandidateFilter(r)&&t.addIceCandidate(n.candidate)}}},{key:"setIceCandidateFilter",value:function(e){this.iceCandidateFilter=e}},{key:"constrainVideoBitrate",value:function(e){this.constrainVideoBitrateKbps=e}},{key:"disableVideoFec",value:function(){this.constrainOfferToRemoveVideoFec=!0}},{key:"gotOffer",value:function(e){this.constrainOfferToRemoveVideoFec&&(e.sdp=e.sdp.replace(/(m=video 1 [^\r]+)(116 117)(\r\n)/g,"$1\r\n"),e.sdp=e.sdp.replace(/a=rtpmap:116 red\/90000\r\n/g,""),e.sdp=e.sdp.replace(/a=rtpmap:117 ulpfec\/90000\r\n/g,""),e.sdp=e.sdp.replace(/a=rtpmap:98 rtx\/90000\r\n/g,""),e.sdp=e.sdp.replace(/a=fmtp:98 apt=116\r\n/g,"")),this.pc1.setLocalDescription(e),this.pc2.setRemoteDescription(e),this.pc2.createAnswer().then(this.gotAnswer.bind(this),this.reportFatal.bind(this))}},{key:"gotAnswer",value:function(e){this.constrainVideoBitrateKbps&&(e.sdp=e.sdp.replace(/a=mid:video\r\n/g,"a=mid:video\r\nb=AS:".concat(this.constrainVideoBitrateKbps,"\r\n"))),this.pc2.setLocalDescription(e),this.pc1.setRemoteDescription(e)}},{key:"establishConnection",value:function(){this.pc1.createOffer().then(this.gotOffer.bind(this),this.reportFatal.bind(this))}},{key:"reportFatal",value:function(e){console.error("Error:",e)}},{key:"getRoundTripTime",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r,a,i,o,s;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.pc1.getStats(),this.pc2.getStats()]);case 2:if(t=e.sent,n=(0,u.Z)(t,2),r=n[0],a=n[1],r.forEach((function(e){"candidate-pair"===e.type&&!0===e.nominated&&e.bytesSent>0&&(i=e)})),a.forEach((function(e){"candidate-pair"===e.type&&!0===e.nominated&&e.bytesReceived>0&&(o=e)})),!i||!o){e.next=17;break}if(e.prev=7,!i.currentRoundTripTime||!o.currentRoundTripTime){e.next=10;break}return e.abrupt("return",{rtt:i.currentRoundTripTime,backendRTT:o.currentRoundTripTime});case 10:return s=(o.lastPacketReceivedTimestamp-i.lastPacketSentTimestamp)/1e3,e.abrupt("return",{rtt:s,backendRTT:s});case 14:return e.prev=14,e.t0=e.catch(7),e.abrupt("return");case 17:case"end":return e.stop()}}),e,this,[[7,14]])})));return function(){return e.apply(this,arguments)}}()},{key:"close",value:function(){this.pc1.close(),this.pc2.close()}}],[{key:"parseCandidate",value:function(e){var t="candidate:",n=e.indexOf(t)+t.length,r=e.substr(n).split(" ");return{type:r[7],protocol:r[2],address:r[4]}}},{key:"isNotHostCandidate",value:function(e){return"host"!==e.type}},{key:"isHost",value:function(e){return"host"===e.type}},{key:"isRelay",value:function(e){return"relay"===e.type}},{key:"isReflexive",value:function(e){return"srflx"===e.type}},{key:"noFilter",value:function(e){return!0}}]),e}(),lc=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;return(0,y.Z)(this,n),r=t.call(this),Ko((0,v.Z)(r),"call"),Ko((0,v.Z)(r),"timeOut"),r.call=new uc(e),r}return(0,k.Z)(n,[{key:"start",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4;this.call.establishConnection(),this.timeOut=setTimeout(this.testFailed.bind(this),e)}},{key:"testComplete",value:function(e){clearTimeout(this.timeOut),this.call.close(),this.emit("done",e)}},{key:"testFailed",value:function(e){console.warn("Test failed, ",e),this.call.close(),this.emit("failed",e)}}]),n}(is),dc=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;(0,y.Z)(this,n),r=t.call(this,e),Ko((0,v.Z)(r),"senderChannel"),Ko((0,v.Z)(r),"recieveChannel"),Ko((0,v.Z)(r),"startTime"),Ko((0,v.Z)(r),"lastBitrateMeasureTime"),Ko((0,v.Z)(r),"sentPayloadBytes",0),Ko((0,v.Z)(r),"recievedPayloadBytes",0),Ko((0,v.Z)(r),"lastReceivedPayloadBytes",0),Ko((0,v.Z)(r),"stopSending",!1),Ko((0,v.Z)(r),"testProgress",0),Ko((0,v.Z)(r),"samplePacket",""),Ko((0,v.Z)(r),"finalBitrateSum",0),Ko((0,v.Z)(r),"bitRateSampels",0),Ko((0,v.Z)(r),"maxNumberOfPacketsToSend",0),Ko((0,v.Z)(r),"bytesToKeepBuffered",0),Ko((0,v.Z)(r),"testDurationSeconds",5),r.call.setIceCandidateFilter(uc.isNotHostCandidate),r.senderChannel=r.call.pc1.createDataChannel(null);for(var a=0;a<262144;a+=1)r.samplePacket+="h";return r.maxNumberOfPacketsToSend=1,r.bytesToKeepBuffered=1024*r.maxNumberOfPacketsToSend,r.testDurationSeconds=4,r.senderChannel.addEventListener("open",r.sendingStep.bind((0,v.Z)(r))),r.call.pc2.addEventListener("datachannel",r.onRecieverChannel.bind((0,v.Z)(r))),r}return(0,k.Z)(n,[{key:"sendingStep",value:function(){var e=new Date;this.startTime||(this.startTime=e,this.lastBitrateMeasureTime=e);for(var t=0;t!==this.maxNumberOfPacketsToSend&&!(this.senderChannel.bufferedAmount>=this.bytesToKeepBuffered);t+=1){this.sentPayloadBytes+=this.samplePacket.length;try{this.senderChannel.send(this.samplePacket)}catch(r){}}var n=e.getTime()-this.startTime.getTime();n>=1e3*this.testDurationSeconds?(this.stopSending=!0,this.testProgress=100):(this.testProgress=n/(10*this.testDurationSeconds),setTimeout(this.sendingStep.bind(this),1))}},{key:"onMessageRecieved",value:function(e){this.recievedPayloadBytes+=e.data.length;var t=new Date,n=t.getTime()-this.lastBitrateMeasureTime.getTime();if(n>=1e3){var r=8*(this.recievedPayloadBytes-this.lastReceivedPayloadBytes)/(n/1e3);this.finalBitrateSum+=r,this.bitRateSampels+=1,this.lastReceivedPayloadBytes=this.recievedPayloadBytes,this.lastBitrateMeasureTime=t}if(this.stopSending&&this.sentPayloadBytes===this.recievedPayloadBytes){var a=this.finalBitrateSum/this.bitRateSampels;this.testComplete({throughput:Math.round(.001*a)})}}},{key:"testComplete",value:function(e){var t=this;this.call.getRoundTripTime().then((function(r){var a=r.rtt,i=r.backendRTT;return f((0,p.Z)(n.prototype),"testComplete",t).call(t,{RTT:a,backendRTT:i,throughput:e.throughput})}))}},{key:"onRecieverChannel",value:function(e){this.recieveChannel=e.channel,this.recieveChannel.addEventListener("message",this.onMessageRecieved.bind(this))}}]),n}(lc),pc=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:uc.noFilter;(0,y.Z)(this,n),r=t.call(this,e),Ko((0,v.Z)(r),"ch1"),Ko((0,v.Z)(r),"ch2"),r.call.setIceCandidateFilter(a);var i=r.call.pc1.createDataChannel(null);return r.ch1=i,i.addEventListener("open",(function(){i.send("hello")})),i.addEventListener("message",r.onCh1Recieve.bind((0,v.Z)(r))),r.call.pc2.addEventListener("datachannel",r.dataChannelHandler.bind((0,v.Z)(r))),r}return(0,k.Z)(n,[{key:"onCh1Recieve",value:function(e){"world"!==e.data?this.hangup("Invalid data transmitted."):this.testComplete({connectivity:!0})}},{key:"onCh2Recieve",value:function(e){if("hello"!==e.data)this.hangup("Invalid data transmitted.");else try{this.ch2.send("world")}catch(t){}}},{key:"dataChannelHandler",value:function(e){var t=e.channel;this.ch2=t,t.addEventListener("message",this.onCh2Recieve.bind(this))}},{key:"hangup",value:function(e){this.testFailed(e)}}]),n}(lc),fc=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){return(0,y.Z)(this,n),t.call(this,e,uc.isHost)}return(0,k.Z)(n)}(pc),hc=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){return(0,y.Z)(this,n),t.call(this,e,uc.isRelay)}return(0,k.Z)(n)}(pc),vc=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){return(0,y.Z)(this,n),t.call(this,e,uc.isReflexive)}return(0,k.Z)(n)}(pc),mc=function(){function e(){(0,y.Z)(this,e),Ko(this,"ipInformation",null)}return(0,k.Z)(e,[{key:"getIPDetails",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.peerId,this.ipInformation){e.next=8;break}return e.next=4,fetch("https://location-service.dyte.io/?token=3c493932b0624c&peerId=".concat(n),{method:"POST"});case 4:return r=e.sent,e.next=7,r.json();case 7:this.ipInformation=e.sent;case 8:return e.abrupt("return",this.ipInformation);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),gc=new mc,yc=[{urls:"turn:turn.dyte.in:443?transport=tcp",username:"dyte",credential:"dytein",credentialType:"password"},{urls:"turn:turn.dyte.in:3478?transport=udp",username:"dyte",credential:"dytein",credentialType:"password"}];function kc(e){var t=e.split(","),n=(0,u.Z)(t,2),r=n[0],a=n[1];return{coords:{latitude:Number(r),longitude:Number(a)}}}var bc=(0,k.Z)((function e(){(0,y.Z)(this,e),Ko(this,"transport"),Ko(this,"candidatePair"),Ko(this,"outboundVideoRtp",new Map),Ko(this,"inboundVideoRtp",new Map),Ko(this,"outboundAudioRtp",new Map),Ko(this,"inboundAudioRtp",new Map),Ko(this,"remoteInboundRtp",new Map),Ko(this,"producerStreamMap",new Map),Ko(this,"consumerStreamMap",new Map),Ko(this,"staleProducerStreamMap",!1),Ko(this,"staleConsumerStreamMap",!1)})),wc=function(){function e(){(0,y.Z)(this,e),Ko(this,"outboundProducerMap",new Map),Ko(this,"inboundConsumerMap",new Map),Ko(this,"consumerPeerIdMap",new Map),Ko(this,"overallProducingTransportsStatsMap",{}),Ko(this,"overallConsumingTransportsStatsMap",{}),Ko(this,"overallConsumersStatsMap",{}),Ko(this,"overallProducersStatsMap",{}),Ko(this,"consumerIdsWithFreezedVideo",new Set),Ko(this,"consumerIdsWithFreezedAudio",new Set),Ko(this,"producerIdsWithFreezedVideo",new Set),Ko(this,"producerIdsWithFreezedAudio",new Set),Ko(this,"freezedProducingTransportIds",new Set),Ko(this,"freezedConsumingTransportIds",new Set),Ko(this,"ipDetails"),Ko(this,"callStatsInstance")}return(0,k.Z)(e,[{key:"registerProducer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.generateProducerStreamMap(t);case 2:t.observer.on("close",this.deregisterProducer.bind(this,t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"processInboundConsumerVideoStats",value:function(e,t,n){var r,a,i=(null==(a=null==(r=null==this?void 0:this.callStatsInstance)?void 0:r.consumerSharedMediaStatesMap)?void 0:a.get(e))||{};t.totalVideoPacketsReceived===n.packetsReceived?(this.consumerIdsWithFreezedVideo.add(e),this.callStatsInstance&&i.video&&(this.callStatsInstance.logger.debug("callstats::measurements::consumerVideoFreezed",{consumerId:e}),this.callStatsInstance.eventHandler.emit("consumer_video_status","pause",e))):(t.totalVideoPacketsReceived=n.packetsReceived,this.consumerIdsWithFreezedVideo.has(e)&&(this.consumerIdsWithFreezedVideo.delete(e),this.callStatsInstance&&i.video&&(this.callStatsInstance.logger.debug("callstats::measurements::consumerVideoDefreezed",{consumerId:e}),this.callStatsInstance.eventHandler.emit("consumer_video_status","resume",e))))}},{key:"processInboundConsumerAudioStats",value:function(e,t,n){var r,a,i=(null==(a=null==(r=null==this?void 0:this.callStatsInstance)?void 0:r.consumerSharedMediaStatesMap)?void 0:a.get(e))||{};t.totalAudioPacketsReceived===n.packetsReceived?(this.consumerIdsWithFreezedAudio.add(e),this.callStatsInstance&&i.audio&&(this.callStatsInstance.logger.debug("callStats::measurements::consumerAudioFreezed",{consumerId:e}),this.callStatsInstance.eventHandler.emit("consumer_audio_status","pause",e))):(t.totalAudioPacketsReceived=n.packetsReceived,this.consumerIdsWithFreezedAudio.has(e)&&(this.consumerIdsWithFreezedAudio.delete(e),this.callStatsInstance&&i.audio&&(this.callStatsInstance.logger.debug("callStats::measurements::consumerAudioDefreezed",{consumerId:e}),this.callStatsInstance.eventHandler.emit("consumer_audio_status","resume",e))))}},{key:"processOutboundProducerVideoStats",value:function(e,t,n){var r,a=(null==(r=null==this?void 0:this.callStatsInstance)?void 0:r.currentUserMediaStates)||{};t.totalVideoPacketsSent===n.packetsSent?(this.producerIdsWithFreezedVideo.add(e),this.callStatsInstance&&a.video&&(this.callStatsInstance.logger.debug("callStats::measurements::producerVideoFreezed",{producerId:e}),this.callStatsInstance.eventHandler.emit("producer_video_status","pause",e))):(t.totalVideoPacketsSent=n.packetsSent,this.producerIdsWithFreezedVideo.has(e)&&(this.producerIdsWithFreezedVideo.delete(e),this.callStatsInstance&&a.video&&(this.callStatsInstance.logger.debug("callStats::measurements::producerVideoDefreezed",{producerId:e}),this.callStatsInstance.eventHandler.emit("producer_video_status","resume",e))))}},{key:"processOutboundProducerAudioStats",value:function(e,t,n){var r,a=(null==(r=null==this?void 0:this.callStatsInstance)?void 0:r.currentUserMediaStates)||{};t.totalAudioPacketsSent===n.packetsSent?(this.producerIdsWithFreezedAudio.add(e),this.callStatsInstance&&a.audio&&(this.callStatsInstance.logger.debug("callStats::measurements::producerAudioFreezed",{producerId:e}),this.callStatsInstance.eventHandler.emit("producer_audio_status","pause",e))):(t.totalAudioPacketsSent=n.packetsSent,this.producerIdsWithFreezedAudio.has(e)&&(this.producerIdsWithFreezedAudio.delete(e),this.callStatsInstance&&a.audio&&(this.callStatsInstance.logger.debug("callStats::measurements::producerAudioDefreezed",{producerId:e}),this.callStatsInstance.eventHandler.emit("producer_audio_status","resume",e))))}},{key:"processProducingTransportStats",value:function(e,t,n){var r,a=(null==(r=null==this?void 0:this.callStatsInstance)?void 0:r.currentUserMediaStates)||{},i=a.audio,o=a.video,s=a.screen,c=i||o||s;t.totalPacketsSent===n.packetsSent?(this.freezedProducingTransportIds.add(e),this.callStatsInstance&&c&&(this.callStatsInstance.logger.debug("callStats::measurements::producingTransportFreezed",{transportId:e}),this.callStatsInstance.eventHandler.emit("producing_transport_status","pause",e))):(t.totalPacketsSent=n.packetsSent,this.freezedProducingTransportIds.has(e)&&(this.freezedProducingTransportIds.delete(e),this.callStatsInstance&&c&&(this.callStatsInstance.logger.debug("callStats::measurements::producingTransportDefreezed",{transportId:e}),this.callStatsInstance.eventHandler.emit("producing_transport_status","resume",e))))}},{key:"processConsumingTransportStats",value:function(e,t,n){var r,a,i=!!Array.from((null==(a=null==(r=null==this?void 0:this.callStatsInstance)?void 0:r.consumerSharedMediaStatesMap)?void 0:a.values())||[]).reduce((function(e,t){return e||t.audio||t.video||t.screen}),!1);t.totalPacketsReceived===n.packetsSent?(this.freezedConsumingTransportIds.add(e),this.callStatsInstance&&i&&(this.callStatsInstance.logger.debug("callStats::measurements::consumingTransportFreezed",{transportId:e}),this.callStatsInstance.eventHandler.emit("consuming_transport_status","pause",e))):(t.totalPacketsReceived=n.packetsSent,this.freezedConsumingTransportIds.has(e)&&(this.freezedConsumingTransportIds.delete(e),this.callStatsInstance&&i&&(this.callStatsInstance.logger.debug("callStats::measurements::consumingTransportDefreezed",{transportId:e}),this.callStatsInstance.eventHandler.emit("consuming_transport_status","resume",e))))}},{key:"registerConsumer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.generateConsumerStreamMap(t);case 2:this.consumerPeerIdMap.set(t.id,{producerId:t.producerId,peerId:t.appData.peerId}),t.observer.on("close",this.deregisterConsumer.bind(this,t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"generateProducerStreamMap",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,u=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]&&u[1],e.next=3,t.getStats();case 3:r=e.sent,a=n?this.getProducerStatsFromReport(this.parseRTCReport(r,["outbound-rtp","remote-inbound-rtp"],!1,t.id))[0]:void 0,i=(0,c.Z)(r.values()),e.prev=6,i.s();case 8:if((o=i.n()).done){e.next=17;break}s=o.value,e.t0=s.type,e.next="outbound-rtp"===e.t0?13:15;break;case 13:return this.outboundProducerMap.set(s.id,t.id),e.abrupt("break",15);case 15:e.next=8;break;case 17:e.next=22;break;case 19:e.prev=19,e.t1=e.catch(6),i.e(e.t1);case 22:return e.prev=22,i.f(),e.finish(22);case 25:return e.abrupt("return",a);case 26:case"end":return e.stop()}}),e,this,[[6,19,22,25]])})));return function(t){return e.apply(this,arguments)}}()},{key:"generateConsumerStreamMap",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,u=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]&&u[1],e.next=3,t.getStats();case 3:r=e.sent,a=n?this.getConsumerStatsFromReport(this.parseRTCReport(r,["inbound-rtp"],!1,t.id))[0]:void 0,i=(0,c.Z)(r.values()),e.prev=6,i.s();case 8:if((o=i.n()).done){e.next=17;break}s=o.value,e.t0=s.type,e.next="inbound-rtp"===e.t0?13:15;break;case 13:return this.inboundConsumerMap.set(s.id,t.id),e.abrupt("break",15);case 15:e.next=8;break;case 17:e.next=22;break;case 19:e.prev=19,e.t1=e.catch(6),i.e(e.t1);case 22:return e.prev=22,i.f(),e.finish(22);case 25:return e.abrupt("return",a);case 26:case"end":return e.stop()}}),e,this,[[6,19,22,25]])})));return function(t){return e.apply(this,arguments)}}()},{key:"deregisterProducer",value:function(e){var t=this;this.outboundProducerMap.forEach((function(n,r){n===e.id&&t.outboundProducerMap.delete(r)}))}},{key:"deregisterConsumer",value:function(e){var t=this;this.inboundConsumerMap.forEach((function(n,r){n===e.id&&t.inboundConsumerMap.delete(r)})),this.consumerPeerIdMap.delete(e.id)}},{key:"parseRTCReport",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,o=e,u=new bc,l=n.length?new Set(n):void 0,d=(0,c.Z)(o.values());try{for(d.s();!(t=d.n()).done;){var p=t.value;if(l){if(0===l.size)break;if(!l.has(p.type))continue;r&&l.delete(p.type)}switch(p.type){case"candidate-pair":if(!0===p.nominated||!0===p.selected){var f=p,h={bytesReceived:f.bytesReceived,bytesSent:f.bytesSent,currentRoundTripTime:f.currentRoundTripTime,totalRoundTripTime:f.totalRoundTripTime,availableOutgoingBitrate:f.availableOutgoingBitrate};u.candidatePair=h;break}break;case"transport":var v=p;i&&(i.producing&&(this.overallProducingTransportsStatsMap[i.id]||(this.overallProducingTransportsStatsMap[i.id]={totalPacketsSent:0})),i.consuming&&(this.overallConsumingTransportsStatsMap[i.id]||(this.overallConsumingTransportsStatsMap[i.id]={totalPacketsReceived:0})));var m={bytesReceived:v.bytesReceived,bytesSent:v.bytesSent,packetsSent:v.packetsSent,packetsReceived:v.packetsReceived,dtlsCipher:v.dtlsCipher,dtlsState:v.dtlsState,iceRole:v.iceRole};if(u.transport=m,i){if(i.producing){var g=this.overallProducingTransportsStatsMap[i.id];this.processProducingTransportStats(i.id,g,m)}if(i.consuming){var y=this.overallConsumingTransportsStatsMap[i.id];this.processConsumingTransportStats(i.id,y,m)}}break;case"remote-inbound-rtp":var k=p,b={jitter:k.jitter,fractionLost:k.fractionLost,roundTripTime:k.roundTripTime,roundTripTimeMeasurements:k.roundTripTimeMeasurements,totalRoundTripTime:k.totalRoundTripTime,packetsLost:k.packetsLost};u.remoteInboundRtp.set(k.localId,b);break;case"outbound-rtp":var w=p,_=a||this.outboundProducerMap.get(p.id);this.overallProducersStatsMap[_]||(this.overallProducersStatsMap[_]={totalVideoPacketsSent:0,totalAudioPacketsSent:0});var S=this.overallProducersStatsMap[_];if(["video","audio"].includes(w.mediaType)){if(!this.outboundProducerMap.has(p.id)){u.staleProducerStreamMap=!0,l&&l.delete("outbound-rtp");break}u.producerStreamMap.has(_)||u.producerStreamMap.set(_,{outboundVideoRtpId:[],outboundAudioRtpId:[]});var E={bytesSent:w.bytesSent,packetsSent:w.packetsSent,nackCount:w.nackCount};if("video"===w.mediaType){if("unknown"===w.decoderImplementation)break;var T=w,x=(0,s.Z)({frameHeight:T.frameHeight,frameWidth:T.frameWidth,framesEncoded:T.framesEncoded,framesDropped:T.framesDropped,framesPerSecond:T.framesPerSecond,framesSent:T.framesSent,keyFramesEncoded:T.keyFramesEncoded,firCount:T.firCount,encoderImplementation:T.encoderImplementation,hugeFramesSent:T.hugeFramesSent,pliCount:T.pliCount,qpSum:T.qpSum,qualityLimitationDurations:T.qualityLimitationDurations,qualityLimitationReason:T.qualityLimitationReason,qualityLimitationResolutionChanges:T.qualityLimitationResolutionChanges,totalEncodeTime:T.totalEncodeTime,totalPacketSendDelay:T.totalEncodeTime,retransmittedBytesSent:T.retransmittedBytesSent,retransmittedPacketsSent:T.retransmittedPacketsSent},E);u.outboundVideoRtp.set(p.id,x),u.producerStreamMap.get(_).outboundVideoRtpId.push(p.id),this.processOutboundProducerVideoStats(_,S,x)}else if("audio"===w.mediaType){var Z=w,C=(0,s.Z)({retransmittedBytesSent:Z.retransmittedBytesSent,retransmittedPacketsSent:Z.retransmittedPacketsSent},E);u.outboundAudioRtp.set(p.id,C),u.producerStreamMap.get(_).outboundAudioRtpId.push(p.id),this.processOutboundProducerAudioStats(_,S,C)}}break;case"inbound-rtp":var R=p,P=a||this.inboundConsumerMap.get(p.id);if(1234===R.ssrc)break;this.overallConsumersStatsMap[P]||(this.overallConsumersStatsMap[P]={totalVideoPacketsReceived:0,totalAudioPacketsReceived:0});var I=this.overallConsumersStatsMap[P];if(["video","audio"].includes(R.mediaType)){if(!this.inboundConsumerMap.has(p.id)){u.staleConsumerStreamMap=!0,l&&l.delete("inbound-rtp");break}u.consumerStreamMap.has(P)||u.consumerStreamMap.set(P,{inboundVideoRtpId:[],inboundAudioRtpId:[]});var O={bytesReceived:R.bytesReceived,packetsReceived:R.packetsReceived,packetsLost:R.packetsLost,jitter:R.jitter,nackCount:R.nackCount};if("video"===R.mediaType){if("unknown"===R.decoderImplementation)break;var D=R,M=(0,s.Z)({frameHeight:D.frameHeight,frameWidth:D.frameWidth,framesDecoded:D.framesDecoded,framesDropped:D.framesDropped,framesPerSecond:D.framesPerSecond,framesReceived:D.framesReceived,keyFramesDecoded:D.keyFramesDecoded,firCount:D.firCount,decoderImplementation:D.decoderImplementation},O);u.inboundVideoRtp.set(p.id,M),u.consumerStreamMap.get(P).inboundVideoRtpId.push(p.id),this.processInboundConsumerVideoStats(P,I,M)}else if("audio"===R.mediaType){var A=R,N=(0,s.Z)({audioLevel:A.audioLevel,concealedSampels:A.concealedSampels,concealmentEvents:A.concealmentEvents,jitterBufferDelay:A.jitterBufferDelay,jitterBufferEmittedCount:A.jitterBufferEmittedCount,totalAudioEnergy:A.totalAudioEnergy,totalSamplesDuration:A.totalSamplesDuration,totalSamplesReceived:A.totalSamplesReceived},O);u.inboundAudioRtp.set(p.id,N),u.consumerStreamMap.get(P).inboundAudioRtpId.push(p.id),this.processInboundConsumerAudioStats(P,I,N)}}}}}catch(Cx){d.e(Cx)}finally{d.f()}if(u.outboundVideoRtp.forEach((function(e,t){e.remoteData=u.remoteInboundRtp.get(t)})),u.outboundAudioRtp.forEach((function(e,t){e.remoteData=u.remoteInboundRtp.get(t)})),u.candidatePair&&(u.transport?(u.transport.totalRoundTripTime=u.candidatePair.totalRoundTripTime,u.transport.availableOutgoingBitrate=u.candidatePair.availableOutgoingBitrate,u.transport.roundTripTime=u.candidatePair.currentRoundTripTime):u.transport={bytesReceived:u.candidatePair.bytesReceived,bytesSent:u.candidatePair.bytesSent,totalRoundTripTime:u.candidatePair.totalRoundTripTime,availableOutgoingBitrate:u.candidatePair.availableOutgoingBitrate,roundTripTime:u.candidatePair.currentRoundTripTime}),u.transport&&!u.transport.roundTripTime){var L=0,j=0;u.remoteInboundRtp.forEach((function(e,t){e.roundTripTime&&e.roundTripTime>L&&(L=e.roundTripTime,j=e.totalRoundTripTime)})),u.transport.roundTripTime=L,u.transport.totalRoundTripTime=j}return u}},{key:"getProducersReport",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map((function(e){return r.generateProducerStreamMap(e,!0)})),e.abrupt("return",n.length>0?Promise.all(n):void 0);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConsumersReport",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map((function(e){return r.generateConsumerStreamMap(e,!0)})),e.abrupt("return",n.length>0?Promise.all(n):void 0);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTransportReport",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.getStats());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getProcessedStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n,r){var a,i,o,s,c,u,d;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getTransportReport(t);case 2:if(a=e.sent,i={producing:r,consuming:n,id:t.id},o=a,s=this.parseRTCReport(o,["transport","candidate-pair","inbound-rtp","outbound-rtp","remote-inbound-rtp"],!1,void 0,i)){e.next=8;break}return e.abrupt("return");case 8:return c={stats:s.transport,transportId:t.id,consuming:n,producing:r},u=s.staleProducerStreamMap?void 0:this.getProducerStatsFromReport(s),d=s.staleConsumerStreamMap?void 0:this.getConsumerStatsFromReport(s),e.abrupt("return",{transportReport:c,producerReport:u,consumerReport:d});case 10:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getProducerStatsFromReport",value:function(e){var t=this,n=[];try{e.producerStreamMap.forEach((function(r,a){var i,o;n.push({producerId:a,videoStats:r.outboundVideoRtpId.map((function(t){return e.outboundVideoRtp.get(t)})),audioStats:r.outboundAudioRtpId.map((function(t){return e.outboundAudioRtp.get(t)})),appData:(null==(o=null==(i=t.callStatsInstance.producers)?void 0:i.get(a))?void 0:o.appData)||null})}))}catch(r){this.callStatsInstance.logger.error("callStats::measurements::getProducerStatsFromReport",{error:{reason:r.reason,message:r.message}})}return n}},{key:"getConsumerStatsFromReport",value:function(e){var t=this,n=[];try{e.consumerStreamMap.forEach((function(r,a){var i=t.consumerPeerIdMap.get(a),o=i.peerId,s=i.producerId;n.push({consumerId:a,peerId:o,producerId:s,videoStats:r.inboundVideoRtpId.map((function(t){return e.inboundVideoRtp.get(t)})),audioStats:r.inboundAudioRtpId.map((function(t){return e.inboundAudioRtp.get(t)}))})}))}catch(r){console.error("getConsumersReport: ",r,e)}return n}},{key:"getUserLocation",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,t){try{navigator.geolocation?navigator.geolocation.getCurrentPosition((function(t){e(t)})):t()}catch(T){t(T)}})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getConnectivity",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,d,p;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={iceServers:t||yc},r=new Promise((function(e,t){try{var r=new fc(n);r.addListener("done",e),r.addListener("failed",(function(){e({connectivity:!1})})),r.start(2e3)}catch(r){t(r)}})),a=new Promise((function(e,t){try{var r=new hc(n);r.addListener("done",e),r.addListener("failed",(function(){e({connectivity:!1})})),r.start(2e3)}catch(r){t(r)}})),i=new Promise((function(e,t){try{var r=new vc(n);r.addListener("done",e),r.addListener("failed",(function(){e({connectivity:!1})})),r.start(2e3)}catch(r){t(r)}})),e.next=7,Promise.all([r,a,i]);case 7:return o=e.sent,s=(0,u.Z)(o,3),c=s[0],d=s[1],p=s[2],e.abrupt("return",{host:null==c?void 0:c.connectivity,relay:null==d?void 0:d.connectivity,reflexive:null==p?void 0:p.connectivity});case 15:return e.prev=15,e.t0=e.catch(0),e.abrupt("return",{host:!1,relay:!1,reflexive:!1});case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getThroughput",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(e,n){try{var r,a=new dc({iceServers:t||yc});a.addListener("done",e),a.addListener("failed",n),a.start(1e4)}catch(r){n(r)}}));case 3:return n=e.sent,e.abrupt("return",{throughput:n.throughput,fractionalLoss:0,RTT:n.RTT,jitter:0,backendRTT:n.backendRTT});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getIPDetails",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,e.t0=this.ipDetails,e.t0){e.next=6;break}return e.next=5,gc.getIPDetails({peerId:null==(t=this.callStatsInstance)?void 0:t.peerId});case 5:this.ipDetails=e.sent;case 6:return e.abrupt("return",this.ipDetails);case 9:return e.prev=9,e.t1=e.catch(0),e.abrupt("return");case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"getNetworkQuality",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.getConnectivity(t),this.getThroughput(t)]);case 2:return n=e.sent,r=(0,u.Z)(n,2),a=r[0],i=r[1],e.abrupt("return",{connectivity:a,throughput:null==i?void 0:i.throughput,fractionalLoss:null==i?void 0:i.fractionalLoss,RTT:null==i?void 0:i.RTT,jitter:null==i?void 0:i.jitter,backendRTT:null==i?void 0:i.backendRTT});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getNetworkInfo",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.getConnectivity(t),this.getThroughput(t),this.getIPDetails()]);case 2:return r=e.sent,a=(0,u.Z)(r,3),i=a[0],o=a[1],s=a[2],e.abrupt("return",{ipDetails:s,effectiveNetworkType:null==(n=navigator.connection)?void 0:n.effectiveType,location:s.loc?kc(s.loc):void 0,turnConnectivity:!!i&&(i.host||i.relay||i.reflexive),connectivity:i,throughput:null==o?void 0:o.throughput,fractionalLoss:null==o?void 0:o.fractionalLoss,RTT:null==o?void 0:o.RTT,jitter:null==o?void 0:o.jitter,backendRTT:null==o?void 0:o.backendRTT});case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),_c=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.apply(this,arguments)}return(0,k.Z)(n)}(wc),Sc=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;return(0,y.Z)(this,n),e=t.apply(this,arguments),Ko((0,v.Z)(e),"producerMap",new Map),Ko((0,v.Z)(e),"consumerMap",new Map),e}return(0,k.Z)(n,[{key:"registerProducer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.producerMap.set(t.id,t),e.next=3,this.generateProducerStreamMap(t);case 3:t.observer.on("close",this.deregisterProducer.bind(this,t));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"registerConsumer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.consumerMap.set(t.id,t),e.next=3,this.generateConsumerStreamMap(t);case 3:this.consumerPeerIdMap.set(t.id,{producerId:t.producerId,peerId:t.appData.peerId}),t.observer.on("close",this.deregisterConsumer.bind(this,t));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"generateConsumerStreamMap",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,s,u,d,p,f=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=f.length>1&&void 0!==f[1]&&f[1],e.next=3,t.getStats();case 3:r=e.sent,a=this.parseRTCReport(r,["inbound-rtp"],!1,t.id),i=(0,o.Z)(a.consumerStreamMap.values())[0],s=n?this.getConsumerStatsFromParsedConsumerStats(a,i,t.id):void 0,u=(0,c.Z)(r.values()),e.prev=8,u.s();case 10:if((d=u.n()).done){e.next=19;break}p=d.value,e.t0=p.type,e.next="inbound-rtp"===e.t0?15:17;break;case 15:return this.inboundConsumerMap.set(p.id,t.id),e.abrupt("break",17);case 17:e.next=10;break;case 19:e.next=24;break;case 21:e.prev=21,e.t1=e.catch(8),u.e(e.t1);case 24:return e.prev=24,u.f(),e.finish(24);case 27:return e.abrupt("return",s);case 28:case"end":return e.stop()}}),e,this,[[8,21,24,27]])})));return function(t){return e.apply(this,arguments)}}()},{key:"deregisterProducer",value:function(e){var t=this;this.producerMap.delete(e.id),this.outboundProducerMap.forEach((function(n,r){n===e.id&&t.outboundProducerMap.delete(r)}))}},{key:"deregisterConsumer",value:function(e){var t=this;this.consumerMap.delete(e.id),this.inboundConsumerMap.forEach((function(n,r){n===e.id&&t.inboundConsumerMap.delete(r)})),this.consumerPeerIdMap.delete(e.id)}},{key:"parseRTCReport",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,o=e,u=new bc,l=n.length?new Set(n):void 0,d=(0,c.Z)(o.values());try{for(d.s();!(t=d.n()).done;){var p=t.value;if(l){if(0===l.size)break;if(!l.has(p.type))continue;r&&l.delete(p.type)}switch(p.type){case"candidate-pair":if(!0===p.nominated||!0===p.selected){var f=p,h={bytesReceived:f.bytesReceived,bytesSent:f.bytesSent,currentRoundTripTime:f.currentRoundTripTime,totalRoundTripTime:f.totalRoundTripTime,availableOutgoingBitrate:f.availableOutgoingBitrate};u.candidatePair=h;break}break;case"transport":var v=p;i&&(i.producing&&(this.overallProducingTransportsStatsMap[i.id]||(this.overallProducingTransportsStatsMap[i.id]={totalPacketsSent:0})),i.consuming&&(this.overallConsumingTransportsStatsMap[i.id]||(this.overallConsumingTransportsStatsMap[i.id]={totalPacketsReceived:0})));var m={bytesReceived:v.bytesReceived,bytesSent:v.bytesSent,packetsSent:v.packetsSent,packetsReceived:v.packetsReceived,dtlsCipher:v.dtlsCipher,dtlsState:v.dtlsState,iceRole:v.iceRole};if(u.transport=m,i){if(i.producing){var g=this.overallProducingTransportsStatsMap[i.id];this.processProducingTransportStats(i.id,g,m)}if(i.consuming){var y=this.overallConsumingTransportsStatsMap[i.id];this.processConsumingTransportStats(i.id,y,m)}}break;case"remote-inbound-rtp":var k=p,b={jitter:k.jitter,fractionLost:k.fractionLost,roundTripTime:k.roundTripTime,roundTripTimeMeasurements:k.roundTripTimeMeasurements,totalRoundTripTime:k.totalRoundTripTime,packetsLost:k.packetsLost};u.remoteInboundRtp.set(k.localId,b);break;case"outbound-rtp":var w=p,_=a||this.outboundProducerMap.get(p.id);this.overallProducersStatsMap[_]||(this.overallProducersStatsMap[_]={totalVideoPacketsSent:0,totalAudioPacketsSent:0});var S=this.overallProducersStatsMap[_];if(["video","audio"].includes(w.mediaType)){if(!this.outboundProducerMap.has(p.id)){u.staleProducerStreamMap=!0,l&&l.delete("outbound-rtp");break}u.producerStreamMap.has(_)||u.producerStreamMap.set(_,{outboundVideoRtpId:[],outboundAudioRtpId:[]});var E={bytesSent:w.bytesSent,packetsSent:w.packetsSent,nackCount:w.nackCount};if("video"===w.mediaType){if("unknown"===w.decoderImplementation)break;var T=w,x=(0,s.Z)({frameHeight:T.frameHeight,frameWidth:T.frameWidth,framesEncoded:T.framesEncoded,framesDropped:T.framesDropped?T.framesDropped:T.droppedFrames,framesPerSecond:T.framesPerSecond?T.framesPerSecond:T.framerateMean,framesSent:T.framesSent,keyFramesEncoded:T.keyFramesEncoded,firCount:T.firCount,encoderImplementation:T.encoderImplementation,hugeFramesSent:T.hugeFramesSent,pliCount:T.pliCount,qpSum:T.qpSum,qualityLimitationReason:T.qualityLimitationReason,qualityLimitationDurations:T.qualityLimitationDurations,qualityLimitationResolutionChanges:T.qualityLimitationResolutionChanges,totalEncodeTime:T.totalEncodeTime,totalPacketSendDelay:T.totalEncodeTime,retransmittedBytesSent:T.retransmittedBytesSent,retransmittedPacketsSent:T.retransmittedPacketsSent},E);u.outboundVideoRtp.set(p.id,x),u.producerStreamMap.get(_).outboundVideoRtpId.push(p.id),this.processOutboundProducerVideoStats(_,S,x)}else if("audio"===w.mediaType){var Z=w,C=(0,s.Z)({retransmittedBytesSent:Z.retransmittedBytesSent,retransmittedPacketsSent:Z.retransmittedPacketsSent},E);u.outboundAudioRtp.set(p.id,C),u.producerStreamMap.get(_).outboundAudioRtpId.push(p.id),this.processOutboundProducerAudioStats(_,S,C)}}break;case"inbound-rtp":var R=p,P=a||this.inboundConsumerMap.get(p.id);this.overallConsumersStatsMap[P]||(this.overallConsumersStatsMap[P]={totalVideoPacketsReceived:0,totalAudioPacketsReceived:0});var I=this.overallConsumersStatsMap[P];if(["video","audio"].includes(R.mediaType)){if(!this.inboundConsumerMap.has(p.id)){u.staleConsumerStreamMap=!0,l&&l.delete("inbound-rtp");break}u.consumerStreamMap.has(P)||u.consumerStreamMap.set(P,{inboundVideoRtpId:[],inboundAudioRtpId:[]});var O={bytesReceived:R.bytesReceived,packetsReceived:R.packetsReceived,packetsLost:R.packetsLost,jitter:R.jitter,nackCount:R.nackCount};if("video"===R.mediaType){if("unknown"===R.decoderImplementation)break;var D=R,M=(0,s.Z)({frameHeight:D.frameHeight,frameWidth:D.frameWidth,framesDecoded:D.framesDecoded,framesDropped:D.framesDropped?D.framesDropped:D.droppedFrames,framesPerSecond:D.framesPerSecond?D.framesPerSecond:D.framerateMean,framesReceived:D.framesReceived,keyFramesDecoded:D.keyFramesDecoded,firCount:D.firCount,decoderImplementation:D.decoderImplementation},O);u.inboundVideoRtp.set(p.id,M),u.consumerStreamMap.get(P).inboundVideoRtpId.push(p.id),this.processInboundConsumerVideoStats(P,I,M)}else if("audio"===R.mediaType){var A=R,N=(0,s.Z)({audioLevel:A.audioLevel,concealedSampels:A.concealedSampels,concealmentEvents:A.concealmentEvents,jitterBufferDelay:A.jitterBufferDelay,jitterBufferEmittedCount:A.jitterBufferEmittedCount,totalAudioEnergy:A.totalAudioEnergy,totalSamplesDuration:A.totalSamplesDuration,totalSamplesReceived:A.totalSamplesReceived},O);u.inboundAudioRtp.set(p.id,N),u.consumerStreamMap.get(P).inboundAudioRtpId.push(p.id),this.processInboundConsumerAudioStats(P,I,N)}}}}}catch(Cx){d.e(Cx)}finally{d.f()}if(u.outboundVideoRtp.forEach((function(e,t){e.remoteData=u.remoteInboundRtp.get(t)})),u.outboundAudioRtp.forEach((function(e,t){e.remoteData=u.remoteInboundRtp.get(t)})),u.candidatePair&&(u.transport?(u.transport.bytesReceived=u.candidatePair.bytesReceived,u.transport.bytesSent=u.candidatePair.bytesSent,u.transport.totalRoundTripTime=u.candidatePair.totalRoundTripTime,u.transport.availableOutgoingBitrate=u.candidatePair.availableOutgoingBitrate,u.transport.roundTripTime=u.candidatePair.currentRoundTripTime):u.transport={bytesReceived:u.candidatePair.bytesReceived,bytesSent:u.candidatePair.bytesSent,totalRoundTripTime:u.candidatePair.totalRoundTripTime,availableOutgoingBitrate:u.candidatePair.availableOutgoingBitrate,roundTripTime:u.candidatePair.currentRoundTripTime}),u.transport&&!u.transport.roundTripTime){var L=0,j=0;u.remoteInboundRtp.forEach((function(e,t){e.roundTripTime&&e.roundTripTime>L&&(L=e.roundTripTime,j=e.totalRoundTripTime)})),u.transport.roundTripTime=L,u.transport.totalRoundTripTime=j}return u}},{key:"getProducerStatsFromReport",value:function(e){var t=this,n=[];try{e.producerStreamMap.forEach((function(r,a){var i=t.producerMap.get(a).track.getSettings(),o={producerId:a,videoStats:r.outboundVideoRtpId.map((function(t){var n=e.outboundVideoRtp.get(t);return n.frameHeight||(n.frameHeight=i.height,n.frameWidth=i.width,n.framesPerSecond=i.frameRate),n})),audioStats:r.outboundAudioRtpId.map((function(t){return e.outboundAudioRtp.get(t)}))};n.push(o)}))}catch(T){console.error("getProducersReport: ",T,e)}return n}},{key:"getConsumerStatsFromParsedConsumerStats",value:function(e,t,n){var r,a=this;try{var i=this.consumerPeerIdMap.get(n),o=i.peerId,s=i.producerId,c=null==t?void 0:t.inboundVideoRtpId.map((function(t){var r=a.consumerMap.get(n).track.getSettings(),i=e.inboundVideoRtp.get(t);return i.frameHeight||(i.frameHeight=r.height,i.frameWidth=r.width,i.framesPerSecond=r.frameRate),i}));r={consumerId:n,peerId:o,producerId:s,videoStats:c,audioStats:null==t?void 0:t.inboundAudioRtpId.map((function(t){return e.inboundAudioRtp.get(t)}))}}catch(o){console.error("getConsumerStatsFromParsedConsumerStats: ",o,e)}return r}},{key:"getConsumerStatsFromReport",value:function(e){var t=this,n=[];try{e.consumerStreamMap.forEach((function(r,a){n.push(t.getConsumerStatsFromParsedConsumerStats(e,r,a))}))}catch(T){console.error("getConsumerStatsFromReport: ",T,e)}return n}}]),n}(wc),Ec=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.apply(this,arguments)}return(0,k.Z)(n)}(Sc);function Tc(e,t,n,r){if(!("function"==typeof n&&r instanceof t))throw r;n.call(null,r,e)}function xc(e,t,n){var r=e.value;return e.value=function(){var e=this;try{for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];var s=r.apply(this,i);return s&&s instanceof Promise?s.catch((function(r){Tc(e,t,n,r)})):s}catch(s){Tc(this,t,n,s)}return null},e}var Zc=function(e,t){return function(n,r,a){var i=a.value;return a.value=function(){var n=this;try{for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];var s=i.apply(this,a);return s&&s instanceof Promise?s.catch((function(r){Tc(n,e,t,r)})):s}catch(s){Tc(this,e,t,s)}return null},a}},Cc=globalThis&&globalThis.__decorate||function(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o},Rc=console,Pc=function(){function e(){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Blink",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_s.PRODUCTION,a=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0;(0,y.Z)(this,e),Ko(this,"eventHandler"),Ko(this,"measurements"),Ko(this,"producingTransport"),Ko(this,"consumingTransport"),Ko(this,"producers",new Map),Ko(this,"consumers",new Map),Ko(this,"iceServers"),Ko(this,"connectionInfoPromise"),Ko(this,"pingStatsTimeout"),Ko(this,"logger"),Ko(this,"env"),Ko(this,"peerId"),Ko(this,"consumerSharedMediaStatesMap",new Map),Ko(this,"currentUserMediaStates",{}),this.env=r,this.logger=i,this.peerId=o;var c=new cc(r,a.ingestionLayerDetails,i);switch(this.eventHandler=new xs(c),this.logger.debug("callStats::engineName: ",{engineName:n}),n){case"Blink":this.measurements=new _c;break;case"Gecko":this.measurements=new Sc;break;case"WebKit":this.measurements=new Ec;break;default:throw Error("Unknown engineName! ".concat(n))}this.measurements.callStatsInstance=this,this.registerProducer=this.registerProducer.bind(this),this.registerConsumer=this.registerConsumer.bind(this),this.measurements.getIPDetails().then((function(e){if(e){var n=(0,s.Z)({},e);e.loc&&(n.loc=kc(e.loc)),t.eventHandler.emit("initialized",n)}}))}return(0,k.Z)(e,[{key:"authenticate",value:function(e){this.eventHandler.connection.authenticate(e)}},{key:"registerIceServers",value:function(e){this.iceServers=e}},{key:"registerConsumer",value:function(e){var t;this.consumerSharedMediaStatesMap.has(e.id)||this.consumerSharedMediaStatesMap.set(e.id,{}),this.consumers.set(e.id,e),this.measurements.registerConsumer(e),this.logger.debug("callStats::registerConsumer",{consumerId:e.id,consumerkind:e.kind,isScreenShare:!(null==(t=e.appData)||!t.screenShare)}),e.observer.on("close",this.deRegisterConsumer.bind(this,e))}},{key:"registerProducer",value:function(e){var t;this.producers.set(e.id,e),this.measurements.registerProducer(e),this.logger.debug("callStats::registerProducer",{producerId:e.id,producerKind:e.kind,isScreenShare:!(null==(t=e.appData)||!t.screenShare)}),e.observer.on("close",this.deRegisterProducer.bind(this,e))}},{key:"sendConsumerSharedMediaStateEvent",value:function(e,t){this.consumerSharedMediaStatesMap.has(e)||this.consumerSharedMediaStatesMap.set(e,{});var n=this.consumerSharedMediaStatesMap.get(e);this.consumerSharedMediaStatesMap.set(e,Object.assign(n,t))}},{key:"registerProducingTransport",value:function(e){var t,n=this;this.producingTransport=e,e.observer.on("close",this.disconnectProducingTransport.bind(this,e)),e.observer.on("disconnect",this.disconnectProducingTransport.bind(this,e)),Array.from((null==(t=e._producers)?void 0:t.values())||[]).forEach((function(e){n.registerProducer(e)})),e.observer.on("newproducer",this.registerProducer)}},{key:"registerConsumingTransport",value:function(e){var t,n=this;this.consumingTransport=e,e.observer.on("close",this.disconnectConsumingTransport.bind(this,e)),e.observer.on("disconnect",this.disconnectConsumingTransport.bind(this,e)),Array.from((null==(t=e._consumers)?void 0:t.values())||[]).forEach((function(e){n.registerConsumer(e)})),e.observer.on("newconsumer",this.registerConsumer)}},{key:"deRegisterConsumer",value:function(e){this.consumers.delete(e.id)}},{key:"deRegisterProducer",value:function(e){this.producers.delete(e.id)}},{key:"disconnectConsumingTransport",value:function(){this.consumingTransport=void 0}},{key:"disconnectProducingTransport",value:function(){this.producingTransport=void 0}},{key:"callEvent",value:function(e){this.eventHandler.callEvent(e)}},{key:"sendPreCallTestBeginEvent",value:function(){var e=this;this.connectionInfoPromise=this.measurements.getNetworkInfo(this.iceServers),this.eventHandler.callEvent({event:qo.PRECALL_TEST_BEGIN,timestamp:new Date}),this.connectionInfoPromise&&this.connectionInfoPromise.then((function(t){e.eventHandler.callEvent({event:qo.PRECALL_TEST_COMPLETE,metaData:{connectionInfo:t},timestamp:new Date})}))}},{key:"sendScreenShareToggleEvent",value:function(e,t){this.currentUserMediaStates.screen=e,this.eventHandler.callEvent({event:e?qo.SCREENSHARE_STARTED:qo.SCREENSHARE_STOPPED,metaData:{ssrc:t},timestamp:new Date})}},{key:"sendScreenShareRequestedEvent",value:function(){this.eventHandler.callEvent({event:qo.SCREENSHARE_START_REQUESTED,timestamp:new Date})}},{key:"sendActiveSpeakerEvent",value:function(e){this.eventHandler.callEvent({event:qo.DOMINANT_SPEAKER,metaData:{peerId:e},timestamp:new Date})}},{key:"devices",value:function(e,t){this.eventHandler.callEvent({event:e===Ss.AUDIO&&qo.AUDIO_DEVICES_UPDATES||e===Ss.VIDEO&&qo.VIDEO_DEVICES_UPDATES||e===Ss.SPEAKER&&qo.SPEAKER_DEVICES_UPDATES,metaData:{deviceList:t},timestamp:new Date})}},{key:"selectedDevice",value:function(e,t){this.eventHandler.callEvent({event:e===Ss.AUDIO&&qo.SELECTED_MICROHPONE_UPDATE||e===Ss.VIDEO&&qo.SELECTED_CAMERA_UPDATE||e===Ss.SPEAKER&&qo.SELECTED_SPEAKER_UPDATE,metaData:{device:t},timestamp:new Date})}},{key:"mediaPermission",value:function(e,t){this.eventHandler.callEvent({event:qo.MEDIA_PERMISSION,metaData:{deviceType:e,permission:t},timestamp:new Date})}},{key:"mediaPlaybackFailed",value:function(e){this.eventHandler.callEvent({event:e===Ss.AUDIO&&qo.AUDIO_PLAY_FAILED||e===Ss.VIDEO&&qo.VIDEO_PLAY_FAILED,metaData:{deviceType:e},timestamp:new Date})}},{key:"mediaTrackMuted",value:function(e){this.eventHandler.callEvent({event:e===Ss.AUDIO&&qo.AUDIO_TRACK_MUTED||e===Ss.VIDEO&&qo.VIDEO_TRACK_MUTED,metaData:{deviceType:e},timestamp:new Date})}},{key:"tabChanged",value:function(e){this.eventHandler.callEvent({event:qo.TAB_CHANGE,backToCurrentTab:e,timestamp:new Date})}},{key:"browserBackgrounded",value:function(){this.eventHandler.callEvent({event:qo.BROWSER_BACKGROUNDED,timestamp:new Date})}},{key:"browserForegrounded",value:function(){this.eventHandler.callEvent({event:qo.BROWSER_FOREGROUNDED,timestamp:new Date})}},{key:"legacySwitch",value:function(e){this.eventHandler.callEvent({event:qo.LEGACY_SWITCH,metadata:{on:e},timestamp:new Date})}},{key:"getPreCallTestResults",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.connectionInfoPromise);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"sendCallJoinBeginEvent",value:function(e){(e=(0,s.Z)((0,s.Z)({},e),{},{meetingEnv:this.env})).deviceInfo=(0,s.Z)((0,s.Z)({},e.deviceInfo),{},{userAgent:navigator.userAgent,cpus:navigator.hardwareConcurrency,memory:navigator.deviceMemory}),this.eventHandler.callEvent({event:qo.CALL_JOIN_BEGIN,metaData:{peerMetaData:e},timestamp:new Date})}},{key:"sendNetworkQualityTestBeginEvent",value:function(e){var t=this;this.eventHandler.callEvent({event:qo.NET_QUALITY_TEST_BEGIN,timestamp:new Date}),new Promise(function(){var n=(0,d.Z)((0,l.Z)().mark((function n(r,a){var i,o,u,d,p;return(0,l.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:i=[],n.prev=1,o=(0,c.Z)(e),n.prev=3,o.s();case 5:if((u=o.n()).done){n.next=20;break}if(d=u.value,n.prev=7,!(d.iceServers&&d.iceServers.length>0)){n.next=13;break}return n.next=11,t.measurements.getNetworkQuality(d.iceServers);case 11:p=n.sent,i.push((0,s.Z)((0,s.Z)({},d),{},{networkResults:p}));case 13:n.next=18;break;case 15:n.prev=15,n.t0=n.catch(7),console.warn("Error handling ",n.t0);case 18:n.next=5;break;case 20:n.next=25;break;case 22:n.prev=22,n.t1=n.catch(3),o.e(n.t1);case 25:return n.prev=25,o.f(),n.finish(25);case 28:r({regionData:i}),n.next=34;break;case 31:n.prev=31,n.t2=n.catch(1),console.warn("Error in callstats, ",n.t2),a(n.t2);case 34:case"end":return n.stop()}}),n,null,[[1,31],[3,22,25,28],[7,15]])})));return function(e,t){return n.apply(this,arguments)}}()).then((function(e){t.eventHandler.callEvent({event:qo.NET_QUALITY_TEST_END,timestamp:new Date,metaData:e})}))}},{key:"sendWebSocketConnectedEvent",value:function(){this.eventHandler.callEvent({event:qo.WEBSOCKET_CONNECTED,timestamp:new Date})}},{key:"sendTransportConnectedEvent",value:function(){this.eventHandler.callEvent({event:qo.TRANSPORT_CONNECTED,timestamp:new Date})}},{key:"sendAudioToggleEvent",value:function(e){var t;this.currentUserMediaStates.audio=e,t=e?qo.AUDIO_ON:qo.AUDIO_OFF,this.eventHandler.callEvent({event:t,timestamp:new Date})}},{key:"sendVideoToggleEvent",value:function(e){var t;this.currentUserMediaStates.video=e,t=e?qo.VIDEO_ON:qo.VIDEO_OFF,this.eventHandler.callEvent({event:t,timestamp:new Date})}},{key:"sendParticipantRoleToggleEvent",value:function(e){this.eventHandler.callEvent({event:qo.PARTICIPANT_ROLE,timestamp:new Date,metaData:e})}},{key:"startPingStats",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7e3;this.sendPingStatsEvent(!1),this.pingStatsTimeout=setInterval(this.sendPingStatsEvent.bind(this),e)}},{key:"stopPingStats",value:function(){clearInterval(this.pingStatsTimeout)}},{key:"sendPingStatsEvent",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r,a,i,s,c=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!(c.length>0&&void 0!==c[0])||c[0],e.t0=this.producingTransport,!e.t0){e.next=7;break}return e.next=5,this.measurements.getProcessedStats(this.producingTransport,!1,!0);case 5:n=e.sent,e.t0=!n||!(null!=n&&n.producerReport);case 7:if(!e.t0){e.next=20;break}return this.logger.debug("callStats::sendPingStatsEvent::staleProducingTransport",{disclaimer:"Stale producer? Regenerating Stream Maps!"}),e.next=11,this.measurements.getProducersReport((0,o.Z)(this.producers.values()));case 11:if(a=e.sent,!n||!a){e.next=16;break}n.producerReport=a,e.next=20;break;case 16:return e.next=18,this.measurements.getProcessedStats(this.producingTransport,!1,!0);case 18:(!(n=e.sent)||null==n||!n.producerReport)&&this.logger.debug("callStats::sendPingStatsEvent::noProducingTransportReport",{disclaimer:"Stream maps invalid despite regenerating!"});case 20:if(e.t1=this.consumingTransport,!e.t1){e.next=26;break}return e.next=24,this.measurements.getProcessedStats(this.consumingTransport,!0,!1);case 24:r=e.sent,e.t1=!r||!r.consumerReport;case 26:if(!e.t1){e.next=39;break}return this.logger.debug("callStats::sendPingStatsEvent::staleConsumingTransport",{disclaimer:"Stale consumer? Regenerating Stream Maps!"}),e.next=30,this.measurements.getConsumersReport((0,o.Z)(this.consumers.values()));case 30:if(i=e.sent,!r||!i){e.next=35;break}r.consumerReport=i,e.next=39;break;case 35:return e.next=37,this.measurements.getProcessedStats(this.consumingTransport,!0,!1);case 37:(!(r=e.sent)||!r.consumerReport)&&this.logger.debug("callStats::sendPingStatsEvent::noConsumingTransportReport",{disclaimer:"Stream maps invalid despite regenerating!"});case 39:s={producingTransportStats:n?null==n?void 0:n.transportReport:void 0,consumingTransportStats:r?null==r?void 0:r.transportReport:void 0,producerStats:[].concat((null==n?void 0:n.producerReport)||[]).concat((null==r?void 0:r.producerReport)||[]),consumerStats:[].concat((null==r?void 0:r.consumerReport)||[]).concat((null==n?void 0:n.consumerReport)||[])},t&&0===s.producerStats.length&&0===s.consumerStats.length||this.eventHandler.callEvent({event:qo.PING_STAT,metaData:s,timestamp:new Date});case 41:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"sendDisconnectEvent",value:function(){this.eventHandler.callEvent({event:qo.DISCONNECT,timestamp:new Date})}},{key:"sendReconnectEvent",value:function(){this.eventHandler.callEvent({event:qo.RECONNECT_ATTEMPT,timestamp:new Date})}}]),e}();Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"authenticate",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"registerIceServers",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"registerConsumer",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"registerProducer",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"sendConsumerSharedMediaStateEvent",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"registerProducingTransport",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"registerConsumingTransport",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"deRegisterConsumer",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"deRegisterProducer",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"disconnectConsumingTransport",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"disconnectProducingTransport",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"sendPreCallTestBeginEvent",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"sendScreenShareToggleEvent",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"sendScreenShareRequestedEvent",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"sendActiveSpeakerEvent",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"devices",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"selectedDevice",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"mediaPermission",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"mediaPlaybackFailed",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"mediaTrackMuted",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"tabChanged",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"browserBackgrounded",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"browserForegrounded",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"legacySwitch",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"getPreCallTestResults",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"sendCallJoinBeginEvent",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"sendNetworkQualityTestBeginEvent",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"sendWebSocketConnectedEvent",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"sendTransportConnectedEvent",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"sendAudioToggleEvent",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"sendVideoToggleEvent",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"sendParticipantRoleToggleEvent",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"startPingStats",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"stopPingStats",null),Cc([Zc(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc.prototype,"sendPingStatsEvent",null),Pc=Cc([function(e,t){return function(n,r,a){if(a)return xc(a,e,t);var i,o=(0,c.Z)(Reflect.ownKeys(n.prototype).filter((function(e){return"constructor"!==e})));try{for(o.s();!(i=o.n()).done;){var s=i.value,u=Object.getOwnPropertyDescriptor(n.prototype,s);u.value instanceof Function&&Object.defineProperty(n.prototype,s,xc(u,e,t))}}catch(Cx){o.e(Cx)}finally{o.f()}}}(TypeError,(function(e,t){return Rc.error(t,e)}))],Pc);var Ic,Oc,Dc,Mc,Ac=Pc,Nc=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;return(0,y.Z)(this,n),e=t.apply(this,arguments),Ko((0,v.Z)(e),"stats"),Ko((0,v.Z)(e),"roomURL"),Ko((0,v.Z)(e),"peerId"),Ko((0,v.Z)(e),"backend"),Ko((0,v.Z)(e),"iceServers"),Ko((0,v.Z)(e),"initialized",!1),Ko((0,v.Z)(e),"stalled",!1),Ko((0,v.Z)(e),"ipInformation"),Ko((0,v.Z)(e),"logger"),e}return(0,k.Z)(n,[{key:"initialize",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u,d,p,f,h,v=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.peerId,r=t.engineName,a=t.env,i=void 0===a?_s.PRODUCTION:a,o=t.iceServers,s=t.apiBase,c=void 0===s?"https://api.cluster.dyte.in":s,u=t.flags,d=t.logger,p=void 0===d?console:d;try{this.peerId=n,this.logger=p,this.backend=new Ac(c,r,i,u,p,n),this.backend.eventHandler.on("initialized",(function(e){v.ipInformation=e,v.initialized=!0,v.emit("initialized",e)})),null==(f=this.backend)||f.authenticate({peerId:n}),this.iceServers=o,null==(h=this.backend)||h.registerIceServers(this.iceServers),this.startPreCallTest()}catch(l){this.logger.error("callStats::CallStatsIntegration: ",{error:{reason:l.reason}}),this.stallCallStats()}case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setRoomName",value:function(e){this.roomURL=e}},{key:"configureSendTransport",value:function(e){var t;null==(t=this.backend)||t.registerProducingTransport(e)}},{key:"configureRecvTransport",value:function(e){var t;null==(t=this.backend)||t.registerConsumingTransport(e)}},{key:"candidateRegionalNetworkQualityTest",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{null==(n=this.backend)||n.sendNetworkQualityTestBeginEvent(t)}catch(T){this.logger.error("callStats::sendNetworkQualityTestBeginEvent",{error:{reason:T.reason}})}case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"roomJoined",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(n=this.backend)||n.sendCallJoinBeginEvent(t),this.backend,null==(r=this.backend)||r.startPingStats();case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"audioOff",value:function(){var e;null==(e=this.backend)||e.sendAudioToggleEvent(!1)}},{key:"audioOn",value:function(){var e;null==(e=this.backend)||e.sendAudioToggleEvent(!0)}},{key:"videoOff",value:function(){var e;null==(e=this.backend)||e.sendVideoToggleEvent(!1)}},{key:"videoOn",value:function(){var e;null==(e=this.backend)||e.sendVideoToggleEvent(!0)}},{key:"callEnded",value:function(){var e,t;null==(e=this.backend)||e.stopPingStats(),null==(t=this.backend)||t.sendDisconnectEvent()}},{key:"screenShareStart",value:function(e){var t;null==(t=this.backend)||t.sendScreenShareToggleEvent(!0,e)}},{key:"consumerSharedMediaState",value:function(e,t){var n;null==(n=this.backend)||n.sendConsumerSharedMediaStateEvent(e,t)}},{key:"screenShareStop",value:function(e){var t;null==(t=this.backend)||t.sendScreenShareToggleEvent(!1,e)}},{key:"screenShareRequested",value:function(){var e;null==(e=this.backend)||e.sendScreenShareRequestedEvent()}},{key:"activeSpeaker",value:function(e){var t;e===this.peerId&&(null==(t=this.backend)||t.sendActiveSpeakerEvent(e))}},{key:"devices",value:function(e,t){var n;null==(n=this.backend)||n.devices(e,t)}},{key:"selectedDevice",value:function(e,t){var n;null==(n=this.backend)||n.selectedDevice(e,t)}},{key:"mediaPermission",value:function(e,t){var n;null==(n=this.backend)||n.mediaPermission(e,t)}},{key:"mediaPlaybackFailed",value:function(e){var t;null==(t=this.backend)||t.mediaPlaybackFailed(e)}},{key:"mediaTrackMuted",value:function(e){var t;null==(t=this.backend)||t.mediaTrackMuted(e)}},{key:"tabChanged",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null==(e=this.backend)||e.tabChanged(t)}},{key:"browserBackgrounded",value:function(){var e;null==(e=this.backend)||e.browserBackgrounded()}},{key:"browserForegrounded",value:function(){var e;null==(e=this.backend)||e.browserForegrounded()}},{key:"legacySwitch",value:function(e){var t;null==(t=this.backend)||t.legacySwitch(e)}},{key:"startPreCallTest",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(t=this.backend)||t.sendPreCallTestBeginEvent();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onPreCallTestResults",value:function(e){var t;return null==(t=this.backend)||t.eventHandler.once("precall_end",e),e}},{key:"onReceivingConsumerAudioStatus",value:function(e){var t;null==(t=this.backend)||t.eventHandler.on("consumer_audio_status",e)}},{key:"onReceivingConsumerVideoStatus",value:function(e){var t;null==(t=this.backend)||t.eventHandler.on("consumer_video_status",e)}},{key:"onReceivingProducerAudioStatus",value:function(e){var t;null==(t=this.backend)||t.eventHandler.on("producer_audio_status",e)}},{key:"onReceivingProducerVideoStatus",value:function(e){var t;null==(t=this.backend)||t.eventHandler.on("producer_video_status",e)}},{key:"onReceivingProducingTransportStatus",value:function(e){var t;null==(t=this.backend)||t.eventHandler.on("producing_transport_status",e)}},{key:"onReceivingConsumingTransportStatus",value:function(e){var t;null==(t=this.backend)||t.eventHandler.on("consuming_transport_status",e)}},{key:"onSafeInitialization",value:function(e){if(this.initialized)e(this.ipInformation,!1);else if(!this.stalled){var t=function(t){e(t,!0)};return this.once("initialized",t),t}return function(){}}},{key:"removeInitializationListener",value:function(e){this.removeListener("initialized",e)}},{key:"stallCallStats",value:function(){this.stalled=!0,this.removeAllListeners("initialized")}}]),n}(is),Lc=new Nc;Lc.setMaxListeners(30),Array.prototype.at||Object.assign(Array.prototype,{at:function(e){var t=this.length,n=e>=0?e:t+e;return n<0||n>=t?void 0:this[n]}}),String.prototype.at||Object.assign(String.prototype,{at:function(e){var t=this.length,n=e>=0?e:t+e;return n<0||n>=t?void 0:this[n]}}),function(e){e.skip="SKIP",e.onAccept="ON_ACCEPT",e.skipOnPrivilegedUserEntry="SKIP_ON_PRIVILEGED_USER_ENTRY",e.skipOnAccept="SKIP_ON_ACCEPT"}(Ic||(Ic={})),function(e){e.none="NONE",e.recorder="RECORDER",e.livestreamer="LIVESTREAMER"}(Oc||(Oc={})),function(e){e.groupCall="GROUP_CALL",e.webinar="WEBINAR",e.audioRoom="AUDIO_ROOM",e.livestream="LIVESTREAM"}(Dc||(Dc={})),function(e){e.SKIP="skip",e.SKIP_ON_PRIVILEGED_USER_ENTRY="skipOnPrivilegedUserEntry",e.ON_ACCEPT="skipOnAccept",e.SKIP_ON_ACCEPT="skipOnAccept"}(Mc||(Mc={})),Dc.groupCall,Ic.skipOnAccept,Oc.none,Dc.groupCall,Oc.none,Ic.skipOnAccept;var jc,Fc="hXgU8Wc8pwuGNq9ms5q9Hh";function Uc(){var e={};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((function(t){e[t.feature.name]={enabled:t.enabled,value:t.feature_state_value}})),e}"undefined"!=typeof process&&null!=(jc=null==process?void 0:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})&&jc.FLAGSMITH_ENVIRONMENT_KEY&&(Fc={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.FLAGSMITH_ENVIRONMENT_KEY);var Bc=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fc;(0,y.Z)(this,e),Ko(this,"flags",{}),Ko(this,"environmentKey",null),this.environmentKey=t,this.identify=this.identify.bind(this),this.getValue=this.getValue.bind(this),this.hasFeature=this.hasFeature.bind(this),this.getAllFlags=this.getAllFlags.bind(this)}return(0,k.Z)(e,[{key:"identify",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]?u[1]:{},r=u.length>2&&void 0!==u[2]&&u[2],a=u.length>3&&void 0!==u[3]?u[3]:5e3,i=JSON.parse(JSON.stringify(n)),o=Object.entries(i).map((function(e){return{trait_key:e[0],trait_value:e[1]}})),e.prev=4,s="_"+(Math.random()+1).toString(36).substring(2),e.next=8,R().post("https://edge.api.flagsmith.com/api/v1/identities/",{identifier:t+(r?s:""),traits:o},{headers:{"Content-Type":"application/json","X-Environment-Key":this.environmentKey},timeout:a});case 8:c=e.sent,this.flags=Uc(c.data.flags||[]),e.next=14;break;case 12:e.prev=12,e.t0=e.catch(4);case 14:return e.abrupt("return",this.flags);case 15:case"end":return e.stop()}}),e,this,[[4,12]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getValue",value:function(e){return this.flags&&this.flags[e]&&this.flags[e].value}},{key:"hasFeature",value:function(e){return this.flags&&this.flags[e]&&this.flags[e].enabled}},{key:"getAllFlags",value:function(){return this.flags}}]),e}(),Vc=new Bc,Hc=[-2,-1,0,1,2],zc=[0,1,2,3,4];var Wc=function(e,t,n){var r,a,i;if(0==t)r=a=i=n;else{var o=function(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<.16666666666666666?e+6*(t-e)*n:n<.5?t:n<.6666666666666666?e+(t-e)*(.6666666666666666-n)*6:e},s=n<.5?n*(1+t):n+t-n*t,c=2*n-s;r=o(c,s,e+1/3),a=o(c,s,e),i=o(c,s,e-1/3)}return[Math.round(255*r),Math.round(255*a),Math.round(255*i)]},Gc=function(e,t,n){e/=255,t/=255,n/=255;var r,a,i=Math.max(e,t,n),o=Math.min(e,t,n),s=(i+o)/2;if(i==o)r=a=0;else{var c=i-o;switch(a=s>.5?c/(2-i-o):c/(i+o),i){case e:r=(t-n)/c+(t<n?6:0);break;case t:r=(n-e)/c+2;break;case n:r=(e-t)/c+4}r/=6}return[r,a,s]},qc=function(e,t,n){var r=function(e){return e.toString(16).padStart(2,"0")};return"#".concat(r(e)).concat(r(t)).concat(r(n))},$c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Hc,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.4,r=[],a=function(e){var t="0",n="0",r="0";if(4==e.length)t="0x"+e[1]+e[1],n="0x"+e[2]+e[2],r="0x"+e[3]+e[3];else{if(7!=e.length)throw new Error("[dyte] Invalid hex color code provided");t="0x"+e[1]+e[2],n="0x"+e[3]+e[4],r="0x"+e[5]+e[6]}return[+t,+n,+r]}(e),i=(0,u.Z)(a,3),o=i[0],s=i[1],l=i[2],d=Gc(o,s,l),p=(0,u.Z)(d,3),f=p[0],h=p[1],v=p[2],m=Math.round(100*v);m>70?n=.8:m>60?n=.9:m<10?n=.075:m<42&&(n=.3);var g=t.findIndex((function(e){return 0===e}));if(-1===g)throw new Error("Invalid reducer provided, it must contain atleast one zero");var y,k=(100-m)/(5-g),b=m/(g+1),w=(0,c.Z)(t);try{for(w.s();!(y=w.n()).done;){var _=y.value,S=Wc(f,h,(_<0?m+_*b*n:_>0?m+_*k*n:m)/100),E=(0,u.Z)(S,3),T=E[0],x=E[1],Z=E[2];r.push(qc(T,x,Z))}}catch(Cx){w.e(Cx)}finally{w.f()}return r};function Kc(e,t){return e===t||e!==e&&t!==t}function Jc(e,t){for(var n=e.length;n--;)if(Kc(e[n][0],t))return n;return-1}var Qc=Array.prototype.splice;function Xc(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Xc.prototype.clear=function(){this.__data__=[],this.size=0},Xc.prototype.delete=function(e){var t=this.__data__,n=Jc(t,e);return!(n<0)&&(n==t.length-1?t.pop():Qc.call(t,n,1),--this.size,!0)},Xc.prototype.get=function(e){var t=this.__data__,n=Jc(t,e);return n<0?void 0:t[n][1]},Xc.prototype.has=function(e){return Jc(this.__data__,e)>-1},Xc.prototype.set=function(e,t){var n=this.__data__,r=Jc(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};var Yc="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,eu="object"==typeof self&&self&&self.Object===Object&&self,tu=Yc||eu||Function("return this")(),nu=tu.Symbol,ru=Object.prototype,au=ru.hasOwnProperty,iu=ru.toString,ou=nu?nu.toStringTag:void 0;var su=Object.prototype.toString;var cu="[object Null]",uu="[object Undefined]",lu=nu?nu.toStringTag:void 0;function du(e){return null==e?void 0===e?uu:cu:lu&&lu in Object(e)?function(e){var t=au.call(e,ou),n=e[ou];try{e[ou]=void 0;var r=!0}catch(i){}var a=iu.call(e);return r&&(t?e[ou]=n:delete e[ou]),a}(e):function(e){return su.call(e)}(e)}function pu(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var fu="[object AsyncFunction]",hu="[object Function]",vu="[object GeneratorFunction]",mu="[object Proxy]";function gu(e){if(!pu(e))return!1;var t=du(e);return t==hu||t==vu||t==fu||t==mu}var yu=tu["__core-js_shared__"],ku=function(){var e=/[^.]+$/.exec(yu&&yu.keys&&yu.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var bu=Function.prototype.toString;function wu(e){if(null!=e){try{return bu.call(e)}catch(t){}try{return e+""}catch(t){}}return""}var _u=/^\[object .+?Constructor\]$/,Su=Function.prototype,Eu=Object.prototype,Tu=Su.toString,xu=Eu.hasOwnProperty,Zu=RegExp("^"+Tu.call(xu).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Cu(e){return!(!pu(e)||function(e){return!!ku&&ku in e}(e))&&(gu(e)?Zu:_u).test(wu(e))}function Ru(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return Cu(n)?n:void 0}var Pu=Ru(tu,"Map"),Iu=Ru(Object,"create");var Ou="__lodash_hash_undefined__",Du=Object.prototype.hasOwnProperty;var Mu=Object.prototype.hasOwnProperty;var Au="__lodash_hash_undefined__";function Nu(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Lu(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function ju(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Nu.prototype.clear=function(){this.__data__=Iu?Iu(null):{},this.size=0},Nu.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Nu.prototype.get=function(e){var t=this.__data__;if(Iu){var n=t[e];return n===Ou?void 0:n}return Du.call(t,e)?t[e]:void 0},Nu.prototype.has=function(e){var t=this.__data__;return Iu?void 0!==t[e]:Mu.call(t,e)},Nu.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Iu&&void 0===t?Au:t,this},ju.prototype.clear=function(){this.size=0,this.__data__={hash:new Nu,map:new(Pu||Xc),string:new Nu}},ju.prototype.delete=function(e){var t=Lu(this,e).delete(e);return this.size-=t?1:0,t},ju.prototype.get=function(e){return Lu(this,e).get(e)},ju.prototype.has=function(e){return Lu(this,e).has(e)},ju.prototype.set=function(e,t){var n=Lu(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};var Fu=200;function Uu(e){var t=this.__data__=new Xc(e);this.size=t.size}Uu.prototype.clear=function(){this.__data__=new Xc,this.size=0},Uu.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},Uu.prototype.get=function(e){return this.__data__.get(e)},Uu.prototype.has=function(e){return this.__data__.has(e)},Uu.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Xc){var r=n.__data__;if(!Pu||r.length<Fu-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new ju(r)}return n.set(e,t),this.size=n.size,this};var Bu=function(){try{var e=Ru(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),Vu=Bu;function Hu(e,t,n){"__proto__"==t&&Vu?Vu(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}var zu=Object.prototype.hasOwnProperty;function Wu(e,t,n){var r=e[t];(!zu.call(e,t)||!Kc(r,n)||void 0===n&&!(t in e))&&Hu(e,t,n)}function Gu(e,t,n,r){var a=!n;n||(n={});for(var i=-1,o=t.length;++i<o;){var s=t[i],c=r?r(n[s],e[s],s,n,e):void 0;void 0===c&&(c=e[s]),a?Hu(n,s,c):Wu(n,s,c)}return n}function qu(e){return null!=e&&"object"==typeof e}var $u="[object Arguments]";function Ku(e){return qu(e)&&du(e)==$u}var Ju=Object.prototype,Qu=Ju.hasOwnProperty,Xu=Ju.propertyIsEnumerable,Yu=Ku(function(){return arguments}())?Ku:function(e){return qu(e)&&Qu.call(e,"callee")&&!Xu.call(e,"callee")},el=Yu,tl=Array.isArray;var nl="object"==typeof exports&&exports&&!exports.nodeType&&exports,rl=nl&&e&&!e.nodeType&&e,al=rl&&rl.exports===nl?tu.Buffer:void 0,il=(al?al.isBuffer:void 0)||function(){return!1},ol=9007199254740991,sl=/^(?:0|[1-9]\d*)$/;function cl(e,t){var n=typeof e;return!!(t=null==t?ol:t)&&("number"==n||"symbol"!=n&&sl.test(e))&&e>-1&&e%1==0&&e<t}var ul=9007199254740991;function ll(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=ul}var dl={};function pl(e){return function(t){return e(t)}}dl["[object Float32Array]"]=dl["[object Float64Array]"]=dl["[object Int8Array]"]=dl["[object Int16Array]"]=dl["[object Int32Array]"]=dl["[object Uint8Array]"]=dl["[object Uint8ClampedArray]"]=dl["[object Uint16Array]"]=dl["[object Uint32Array]"]=!0,dl["[object Arguments]"]=dl["[object Array]"]=dl["[object ArrayBuffer]"]=dl["[object Boolean]"]=dl["[object DataView]"]=dl["[object Date]"]=dl["[object Error]"]=dl["[object Function]"]=dl["[object Map]"]=dl["[object Number]"]=dl["[object Object]"]=dl["[object RegExp]"]=dl["[object Set]"]=dl["[object String]"]=dl["[object WeakMap]"]=!1;var fl="object"==typeof exports&&exports&&!exports.nodeType&&exports,hl=fl&&e&&!e.nodeType&&e,vl=hl&&hl.exports===fl&&Yc.process,ml=function(){try{return hl&&hl.require&&hl.require("util").types||vl&&vl.binding&&vl.binding("util")}catch(e){}}(),gl=ml&&ml.isTypedArray,yl=gl?pl(gl):function(e){return qu(e)&&ll(e.length)&&!!dl[du(e)]},kl=yl,bl=Object.prototype.hasOwnProperty;function wl(e,t){var n=tl(e),r=!n&&el(e),a=!n&&!r&&il(e),i=!n&&!r&&!a&&kl(e),o=n||r||a||i,s=o?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],c=s.length;for(var u in e)(t||bl.call(e,u))&&(!o||!("length"==u||a&&("offset"==u||"parent"==u)||i&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||cl(u,c)))&&s.push(u);return s}var _l=Object.prototype;function Sl(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||_l)}function El(e,t){return function(n){return e(t(n))}}var Tl=El(Object.keys,Object),xl=Object.prototype.hasOwnProperty;function Zl(e){return null!=e&&ll(e.length)&&!gu(e)}function Cl(e){return Zl(e)?wl(e):function(e){if(!Sl(e))return Tl(e);var t=[];for(var n in Object(e))xl.call(e,n)&&"constructor"!=n&&t.push(n);return t}(e)}var Rl=Object.prototype.hasOwnProperty;function Pl(e){if(!pu(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=Sl(e),n=[];for(var r in e)"constructor"==r&&(t||!Rl.call(e,r))||n.push(r);return n}function Il(e){return Zl(e)?wl(e,!0):Pl(e)}var Ol="object"==typeof exports&&exports&&!exports.nodeType&&exports,Dl=Ol&&e&&!e.nodeType&&e,Ml=Dl&&Dl.exports===Ol?tu.Buffer:void 0,Al=Ml?Ml.allocUnsafe:void 0;function Nl(){return[]}var Ll=Object.prototype.propertyIsEnumerable,jl=Object.getOwnPropertySymbols,Fl=jl?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,r=null==e?0:e.length,a=0,i=[];++n<r;){var o=e[n];t(o,n,e)&&(i[a++]=o)}return i}(jl(e),(function(t){return Ll.call(e,t)})))}:Nl,Ul=Fl;function Bl(e,t){for(var n=-1,r=t.length,a=e.length;++n<r;)e[a+n]=t[n];return e}var Vl=El(Object.getPrototypeOf,Object),Hl=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Bl(t,Ul(e)),e=Vl(e);return t}:Nl,zl=Hl;function Wl(e,t,n){var r=t(e);return tl(e)?r:Bl(r,n(e))}function Gl(e){return Wl(e,Cl,Ul)}function ql(e){return Wl(e,Il,zl)}var $l=Ru(tu,"DataView"),Kl=Ru(tu,"Promise"),Jl=Ru(tu,"Set"),Ql=Ru(tu,"WeakMap"),Xl="[object Map]",Yl="[object Promise]",ed="[object Set]",td="[object WeakMap]",nd="[object DataView]",rd=wu($l),ad=wu(Pu),id=wu(Kl),od=wu(Jl),sd=wu(Ql),cd=du;($l&&cd(new $l(new ArrayBuffer(1)))!=nd||Pu&&cd(new Pu)!=Xl||Kl&&cd(Kl.resolve())!=Yl||Jl&&cd(new Jl)!=ed||Ql&&cd(new Ql)!=td)&&(cd=function(e){var t=du(e),n="[object Object]"==t?e.constructor:void 0,r=n?wu(n):"";if(r)switch(r){case rd:return nd;case ad:return Xl;case id:return Yl;case od:return ed;case sd:return td}return t});var ud=cd,ld=Object.prototype.hasOwnProperty;var dd=tu.Uint8Array;function pd(e){var t=new e.constructor(e.byteLength);return new dd(t).set(new dd(e)),t}var fd=/\w*$/;var hd=nu?nu.prototype:void 0,vd=hd?hd.valueOf:void 0;var md="[object Boolean]",gd="[object Date]",yd="[object Map]",kd="[object Number]",bd="[object RegExp]",wd="[object Set]",_d="[object String]",Sd="[object Symbol]",Ed="[object ArrayBuffer]",Td="[object DataView]",xd="[object Float32Array]",Zd="[object Float64Array]",Cd="[object Int8Array]",Rd="[object Int16Array]",Pd="[object Int32Array]",Id="[object Uint8Array]",Od="[object Uint8ClampedArray]",Dd="[object Uint16Array]",Md="[object Uint32Array]";function Ad(e,t,n){var r=e.constructor;switch(t){case Ed:return pd(e);case md:case gd:return new r(+e);case Td:return function(e,t){var n=t?pd(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case xd:case Zd:case Cd:case Rd:case Pd:case Id:case Od:case Dd:case Md:return function(e,t){var n=t?pd(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}(e,n);case yd:return new r;case kd:case _d:return new r(e);case bd:return function(e){var t=new e.constructor(e.source,fd.exec(e));return t.lastIndex=e.lastIndex,t}(e);case wd:return new r;case Sd:return function(e){return vd?Object(vd.call(e)):{}}(e)}}var Nd=Object.create,Ld=function(){function e(){}return function(t){if(!pu(t))return{};if(Nd)return Nd(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),jd=Ld;var Fd="[object Map]";var Ud=ml&&ml.isMap,Bd=Ud?pl(Ud):function(e){return qu(e)&&ud(e)==Fd},Vd=Bd,Hd="[object Set]";var zd=ml&&ml.isSet,Wd=zd?pl(zd):function(e){return qu(e)&&ud(e)==Hd},Gd=Wd,qd=1,$d=2,Kd=4,Jd="[object Arguments]",Qd="[object Function]",Xd="[object GeneratorFunction]",Yd="[object Object]",ep={};function tp(e,t,n,r,a,i){var o,s=t&qd,c=t&$d,u=t&Kd;if(n&&(o=a?n(e,r,a,i):n(e)),void 0!==o)return o;if(!pu(e))return e;var l=tl(e);if(l){if(o=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&ld.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!s)return function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}(e,o)}else{var d=ud(e),p=d==Qd||d==Xd;if(il(e))return function(e,t){if(t)return e.slice();var n=e.length,r=Al?Al(n):new e.constructor(n);return e.copy(r),r}(e,s);if(d==Yd||d==Jd||p&&!a){if(o=c||p?{}:function(e){return"function"!=typeof e.constructor||Sl(e)?{}:jd(Vl(e))}(e),!s)return c?function(e,t){return Gu(e,zl(e),t)}(e,function(e,t){return e&&Gu(t,Il(t),e)}(o,e)):function(e,t){return Gu(e,Ul(e),t)}(e,function(e,t){return e&&Gu(t,Cl(t),e)}(o,e))}else{if(!ep[d])return a?e:{};o=Ad(e,d,s)}}i||(i=new Uu);var f=i.get(e);if(f)return f;i.set(e,o),Gd(e)?e.forEach((function(r){o.add(tp(r,t,n,r,e,i))})):Vd(e)&&e.forEach((function(r,a){o.set(a,tp(r,t,n,a,e,i))}));var h=l?void 0:(u?c?ql:Gl:c?Il:Cl)(e);return function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););}(h||e,(function(r,a){h&&(r=e[a=r]),Wu(o,a,tp(r,t,n,a,e,i))})),o}ep[Jd]=ep["[object Array]"]=ep["[object ArrayBuffer]"]=ep["[object DataView]"]=ep["[object Boolean]"]=ep["[object Date]"]=ep["[object Float32Array]"]=ep["[object Float64Array]"]=ep["[object Int8Array]"]=ep["[object Int16Array]"]=ep["[object Int32Array]"]=ep["[object Map]"]=ep["[object Number]"]=ep[Yd]=ep["[object RegExp]"]=ep["[object Set]"]=ep["[object String]"]=ep["[object Symbol]"]=ep["[object Uint8Array]"]=ep["[object Uint8ClampedArray]"]=ep["[object Uint16Array]"]=ep["[object Uint32Array]"]=!0,ep["[object Error]"]=ep[Qd]=ep["[object WeakMap]"]=!1;var np=1,rp=4;function ap(e){return tp(e,np|rp)}var ip="[object Symbol]";var op,sp,cp,up,lp,dp="Expected a function";function pp(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(dp);var n=function n(){var r=arguments,a=t?t.apply(this,r):r[0],i=n.cache;if(i.has(a))return i.get(a);var o=e.apply(this,r);return n.cache=i.set(a,o)||i,o};return n.cache=new(pp.Cache||ju),n}pp.Cache=ju,function(e){e.GroupCall="GROUP_CALL",e.Webinar="WEBINAR",e.AudioRoom="AUDIO_ROOM",e.Livestream="LIVESTREAM"}(op||(op={})),function(e){e.Skip="SKIP",e.OnPrivilegedUserEntry="ON_PRIVILEGED_USER_ENTRY",e.SkipOnAccept="SKIP_ON_ACCEPT"}(sp||(sp={})),function(e){e.Allowed="ALLOWED",e.NotAllowed="NOT_ALLOWED",e.CanRequest="CAN_REQUEST"}(cp||(cp={})),function(e){e.Allowed="ALLOWED",e.NotAllowed="NOT_ALLOWED"}(up||(up={})),function(e){e.FULL_ACCESS="FULL_ACCESS",e.VIEW_ONLY="VIEW_ONLY"}(lp||(lp={}));var fp={border_radius:"rounded",border_width:"thin",spacing_base:4,theme:"dark",colors:{brand:function(e){var t=$c(e,Hc),n=(0,u.Z)(t,5);return{300:n[0],400:n[1],500:n[2],600:n[3],700:n[4]}}("#2160FD"),background:function(e){var t=$c(e,zc),n=(0,u.Z)(t,5);return{1e3:n[0],900:n[1],800:n[2],700:n[3],600:n[4]}}("#141414"),danger:"#FF2D2D",text:"#EEEEEE",text_on_brand:"#EEEEEE",success:"#62A504",video_bg:"#191919",warning:"#FFCD07"}};function hp(){return ap(fp)}var vp={permissions:{can_accept_production_requests:!1,can_edit_display_name:!0,accept_waiting_requests:!1,disable_participant_audio:!1,disable_participant_screensharing:!1,disable_participant_video:!1,can_spotlight:!1,kick_participant:!1,pin_participant:!1,can_record:!1,can_livestream:!1,waiting_room_type:sp.Skip,plugins:{can_close:!0,can_start:!0,can_edit_config:!1,config:{}},polls:{can_create:!0,can_vote:!0,can_view:!0},media:{video:{can_produce:cp.Allowed,can_consume:up.Allowed},audio:{can_produce:cp.Allowed},screenshare:{can_produce:cp.Allowed,can_consume:up.Allowed}},chat:{public:{can_send:!0,text:!0,files:!0},private:{can_send:!1,can_receive:!1,text:!1,files:!1}},hidden_participant:!1,is_recorder:!1,recorder_type:Oc.none,show_participant_list:!0,can_change_participant_permissions:!1,connected_meetings:{can_alter_connected_meetings:!1,can_switch_connected_meetings:!1,can_switch_to_parent_meeting:!1}},ui:{oldTheme:{setup_screen:{is_enabled:!1},alone_here:{is_enabled:!1},waiting_room:{is_enabled:!1,enable_preview:!0},control_bar:{is_enabled:!0,elements:{plugins:!0,screenshare:!0,invite:!1,participants:!0,chat:!0,reactions:!1,polls:!0,fullscreen:!0,layout:!0}},header:{is_enabled:!0,elements:{timer:!0,title:!0,participant_count:!0,change_layout:!0}},pip_mode:!0,auto_tune:!0,colors:{primary:"#2160FD",secondary:"#1A1A1A",text:"#EEEEEE",background:"#1A1A1A",textPrimary:"#EEEEEE",videoBackground:"#1A1A1A"},dimensions:{mode:"fillParent"},grid:{multi:{maxVideoCount:6,videoFit:"cover"},single:{maxVideoCount:6,videoFit:"cover"},defaultView:"MULTI"},controls:{pip_toggle:!1},plugins:[]},design_tokens:hp(),config_diff:{}},config:{view_type:op.GroupCall,media:{video:{quality:"vga",frame_rate:24},screenshare:{quality:"hd",frame_rate:5}},max_video_streams:{mobile:6,desktop:6},max_screenshare_count:1},version:"hybrid"};Oc.none,Ic.skip;var mp={permissions:{can_accept_production_requests:!1,can_edit_display_name:!0,accept_waiting_requests:!1,disable_participant_audio:!1,disable_participant_screensharing:!1,disable_participant_video:!1,can_spotlight:!1,kick_participant:!1,pin_participant:!1,can_record:!1,can_livestream:!1,waiting_room_type:sp.Skip,plugins:{can_close:!0,can_start:!0,can_edit_config:!1,config:{}},polls:{can_create:!0,can_vote:!0,can_view:!0},media:{video:{can_produce:cp.Allowed},audio:{can_produce:cp.Allowed},screenshare:{can_produce:cp.Allowed}},chat:{public:{can_send:!0,text:!0,files:!0},private:{can_send:!1,can_receive:!1,text:!1,files:!1}},hidden_participant:!1,is_recorder:!1,recorder_type:Oc.none,show_participant_list:!0,can_change_participant_permissions:!1,connected_meetings:{can_alter_connected_meetings:!1,can_switch_connected_meetings:!1,can_switch_to_parent_meeting:!1}},ui:{design_tokens:hp(),config_diff:{}},config:{view_type:op.GroupCall,media:{video:{quality:"vga",frame_rate:24},screenshare:{quality:"hd",frame_rate:5}},max_video_streams:{mobile:6,desktop:6},max_screenshare_count:1},version:"2.0.0"};function gp(){return ap(mp)}var yp=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.apply(this,arguments)}return(0,k.Z)(n,[{key:"emit",value:function(e){for(var t,r,a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];return(t=f((0,p.Z)(n.prototype),"emit",this)).call.apply(t,[this,"*",e].concat(i)),(r=f((0,p.Z)(n.prototype),"emit",this)).call.apply(r,[this,e].concat(i))}},{key:"on",value:function(e,t){return f((0,p.Z)(n.prototype),"on",this).call(this,e,t)}},{key:"addListener",value:function(e,t){return f((0,p.Z)(n.prototype),"addListener",this).call(this,e,t)}},{key:"off",value:function(e,t){return f((0,p.Z)(n.prototype),"off",this).call(this,e,t)}},{key:"once",value:function(e,t){return f((0,p.Z)(n.prototype),"once",this).call(this,e,t)}},{key:"prependListener",value:function(e,t){return f((0,p.Z)(n.prototype),"prependListener",this).call(this,e,t)}},{key:"prependOnceListener",value:function(e,t){return f((0,p.Z)(n.prototype),"prependOnceListener",this).call(this,e,t)}},{key:"removeListener",value:function(e,t){return f((0,p.Z)(n.prototype),"removeListener",this).call(this,e,t)}},{key:"removeAllListeners",value:function(e){return f((0,p.Z)(n.prototype),"removeAllListeners",this).call(this,e)}},{key:"listeners",value:function(e){return f((0,p.Z)(n.prototype),"listeners",this).call(this,e)}},{key:"listenerCount",value:function(e){return f((0,p.Z)(n.prototype),"listenerCount",this).call(this,e)}}]),n}(is.EventEmitter),kp={roomName:void 0,authToken:void 0,peerId:void 0,apiBase:void 0,defaults:void 0,modules:void 0,organizationId:void 0,overrides:{}};function bp(e){null!=kp.roomName||(kp.roomName=null==e?void 0:e.roomName),null!=kp.authToken||(kp.authToken=null==e?void 0:e.authToken),null!=kp.peerId||(kp.peerId=null==e?void 0:e.peerId),null!=kp.apiBase||(kp.apiBase=null==e?void 0:e.apiBase),null!=kp.defaults||(kp.defaults=null==e?void 0:e.defaults),null!=kp.modules||(kp.modules=null==e?void 0:e.modules),null!=kp.organizationId||(kp.organizationId=null==e?void 0:e.organizationId)}var wp="1.5.3",_p=function(e){return e.PARTICIPANT="PARTICIPANT",e.PEER="PEER",e.CLIENT="CLIENT",e}(_p||{}),Sp={INTERNAL_CALL_STATS:"internal_call_stats",SIMULCAST:"simulcast",CHAT_SOCKET_SERVER:"chat_socket_server",PLUGIN_SOCKET_SERVER:"plugin_socket_server",NR_OTEL_WEB:"nr_otel_web",CONNECTED_MEETINGS:"connected_meetings",FEAT_SPOTLIGHT:"feat_spotlight",ICE_RESTART_ON_FAILED_STATE:"ice_restart_on_failed_state",ICE_RESTART_ON_DISCONNECTED_STATE:"ice_restart_on_disconnected_state",ENABLE_ICE_STATE_LOGGING:"enable_ice_state_logging",REMOVE_OPERATIONAL_MIC:"web_core_remove_operational_mic",SUPPRESS_PEER_MUTE_UNMUTE_EMITS:"web_core_suppress_peer_mute_unmute_emits",SKIP_OTEL_TRACES:"skip_otel_traces",NEW_LOCAL_MEDIA_HANDLER:"new_local_media_handler",CALLSTATS_INGESTION_LAYER:"callstats_ingestion_layer",USE_USERIDS_IN_CHAT:"use_userids_in_chat",CUSTOM_PING_PONG:"custom_ping_pong",ENABLE_HIVE_SIMULCAST:"enable_hive_simulcast",ENABLE_HIVE_TRANSPORT_RECONNECTION_ON_ICE_FAILED:"enable_hive_transport_reconnection_on_ice_failed",BYPASS_LOG_EXCLUSION_LIST:"bypass_log_exclusion_list",LOG_LEVEL:"log_level",V1_PLUGINS:"v1_plugins",SCREENSHARE_DTX:"screenshare_dtx",SCREENSHARE_PRIORITY:"screenshare_priority",SCREENSHARE_MIN_BITRATE:"screenshare_minbitrate",SCREENSHARE_MAX_DIMENSIONS:"screenshare_maxdimensions",SCREENSHARE_SIMULCAST:"screenshare_simulcast",DISABLE_WEBCAM_LAYERS_ON_SCREENSHARE:"disable_webcam_layers_on_screenshare",SCREENSHARE_FORCE_GOOG_CONFERENCE:"screenshare_force_goog_conference",LIVESTREAM:"feat_livestream",FETCH_RETRY:"fetch_retry",DEVICE_REMOVE_EXP:"device_remove_exp",DISABLE_WEBCAM_SIMULCAST:"webcore_disable_webcam_simulcast",OVERRIDE_WEBCAM_SIMULCAST:"override_webcam_simulcast",SOCKET_POLLING:"socket_polling",NS_NETWORK_SCORE:"ns_network_score"};function Ep(){var e,t,n,r,a="undefined"!=typeof navigator&&!navigator.isReactNative&&(null==(e=window.location.host)?void 0:e.includes("staging"))&&(null==(t=window.location.host)?void 0:t.includes("dyte.io")),i=!(null==(r=null==(n=kp.modules)?void 0:n.devTools)||!r.logs);return a||i}function Tp(e){var t={};return"string"==typeof(null==e?void 0:e.message)&&(t.message=e.message.substring(0,500)),"string"==typeof(null==e?void 0:e.reason)&&(t.reason=e.reason.substring(0,500)),"string"==typeof(null==e?void 0:e.stack)&&(t.stack=e.stack.substring(0,500)),t}function xp(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object.getOwnPropertyNames(e).forEach((function(r){var a;if(!([null,void 0,NaN].includes(e[r])||t&&((null==(a=t.match(/\./g))?void 0:a.length)||0)>=10)){var i=t?"".concat(t,".").concat(r):r;"object"==typeof e[r]?xp(e[r],i,n):["number","string","boolean"].includes(typeof e[r])&&(n[i]=e[r])}})),n}function Zp(e,t,n){var r={};try{var a=JSON.stringify(t),i=xp(JSON.parse(a),n),o=JSON.stringify(i);if(o.length>5e3){var s='Log named: "'.concat(e,'" is trying to log an flattened object of size ').concat(o.length," chars that is beyond permitted limit of 5000 chars. Please optimize.");throw Ep()&&console.error(s,{log:t,flattened:o}),new Error(s)}return JSON.parse(o)}catch(a){var c=Tp(a);r["".concat(n,".error.message")]=c.message||"",r["".concat(n,".error.stack")]=c.stack||"",r["".concat(n,".error.reason")]=c.reason||"",r["".concat(n,".error.source")]="safelyFlattenObjForOpenTelemetry"}return r}var Cp="chrome",Rp="opera",Pp="firefox",Ip="iexplorer",Op="safari",Dp="nwjs",Mp="electron",Ap="react-native",Np="unknown",Lp={Chrome:Cp,Chromium:Cp,Opera:Rp,Firefox:Pp,"Internet Explorer":Ip,Safari:Op};function jp(){var e=navigator.userAgent;if(e.match(/Electron/)){var t=e.match(/Electron\/([\d.]+)/)[1];return{name:Mp,version:t}}return null}function Fp(){var e=navigator.userAgent;if(e.match(/JitsiMeetNW/)){var t=e.match(/JitsiMeetNW\/([\d.]+)/)[1];return{name:Dp,version:t}}}function Up(){var e,t=navigator.userAgent.match(/\b(react[ \t_-]*native)(?:\/(\S+))?/i);if(t||"ReactNative"===navigator.product)return t&&t.length>2&&(t[1],e=t[2]),e||(e="unknown"),{name:Ap,version:e}}function Bp(e){for(var t,n=[Up,jp,Fp],r=0;r<n.length;r+=1)if(t=n[r]())return t;var a=e.getBrowserName();return a in Lp?{name:Lp[a],version:e.getBrowserVersion()}:(t=function(){var e=navigator.userAgent,t={name:Np,version:void 0};if(e.match(/Chrome/)&&!e.match(/Edge/))if(e.match(/Edg(A?)/)){var n=e.match(/Chrome\/([\d.]+)/)[1];Number.parseInt(n,10)>72&&(t.name=Cp,t.version=n)}else t.name=Cp,t.version=e.match(/Chrome\/([\d.]+)/)[1];return t}(),t||{name:Np,version:void 0})}var Vp=function(){function e(){var t=this;(0,y.Z)(this,e),Ko(this,"_bowser"),Ko(this,"_name"),Ko(this,"_version"),Ko(this,"getDeviceInfo",(function(){return{isMobile:t.isMobile(),browserName:t._bowser.getBrowserName(),osName:t._bowser.getOSName(),browserVersion:t._bowser.getBrowserVersion(),osVersionName:t._bowser.getOSVersion(),engineName:t._bowser.getEngineName()}}))}return(0,k.Z)(e,[{key:"init",value:function(e){var t,n;if(this._bowser=ka().getParser(navigator.userAgent),"undefined"==typeof e){var r=Bp(this._bowser);t=r.name,n=r.version}else e.name in Lp?(t=Lp[e.name],n=e.version):(t=Np,n=void 0);this._name=t,this._version=n}},{key:"getName",value:function(){return this._name}},{key:"isChrome",value:function(){return this._name===Cp}},{key:"isOpera",value:function(){return this._name===Rp}},{key:"isFirefox",value:function(){return this._name===Pp}},{key:"isIExplorer",value:function(){return this._name===Ip}},{key:"isSafari",value:function(){return this._name===Op}},{key:"isNWJS",value:function(){return this._name===Dp}},{key:"isElectron",value:function(){return this._name===Mp}},{key:"isReactNative",value:function(){return this._name===Ap||!0===navigator.isReactNative}},{key:"getVersion",value:function(){return this._version}},{key:"isMobile",value:function(){return"mobile"===this._bowser.getPlatformType()}},{key:"_checkCondition",value:function(e){if(this._version)return this._bowser.satisfies(e)}},{key:"isVersionGreaterThan",value:function(e){return this._checkCondition((0,i.Z)({},this._name,">".concat(e)))}},{key:"isVersionLessThan",value:function(e){return this._checkCondition((0,i.Z)({},this._name,"<".concat(e)))}},{key:"isVersionEqualTo",value:function(e){return this._checkCondition((0,i.Z)({},this._name,"~".concat(e)))}}]),e}(),Hp=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.apply(this,arguments)}return(0,k.Z)(n,[{key:"doesVideoMuteByStreamRemove",value:function(){return this.isChromiumBased()||this.isWebKitBased()}},{key:"supportsP2P",value:function(){return!this.usesUnifiedPlan()}},{key:"isChromiumBased",value:function(){return this.isChrome()||this.isElectron()||this.isNWJS()||this.isOpera()}},{key:"isWebKitBased",value:function(){return this._bowser.isEngine("webkit")&&"undefined"!=typeof navigator.mediaDevices&&"undefined"!=typeof navigator.mediaDevices.getUserMedia&&"undefined"!=typeof window.RTCRtpTransceiver&&Object.keys(RTCRtpTransceiver.prototype).indexOf("currentDirection")>-1}},{key:"isSupported",value:function(){return this.isChromiumBased()&&this._getChromiumBasedVersion()>=72||this.isFirefox()||this.isReactNative()||this.isWebKitBased()}},{key:"isUserInteractionRequiredForUnmute",value:function(){return this.isFirefox()&&this.isVersionLessThan("68")}},{key:"supportsVideoMuteOnConnInterrupted",value:function(){return this.isChromiumBased()||this.isReactNative()||this.isWebKitBased()}},{key:"supportsBandwidthStatistics",value:function(){return!this.isFirefox()&&!this.isWebKitBased()}},{key:"supportsCodecPreferences",value:function(){return this.usesUnifiedPlan()&&"undefined"!=typeof window.RTCRtpTransceiver&&Object.keys(window.RTCRtpTransceiver.prototype).indexOf("setCodecPreferences")>-1&&Object.keys(RTCRtpSender.prototype).indexOf("getCapabilities")>-1&&!this.isWebKitBased()}},{key:"supportsDeviceChangeEvent",value:function(){return navigator.mediaDevices&&"undefined"!=typeof navigator.mediaDevices.ondevicechange&&"undefined"!=typeof navigator.mediaDevices.addEventListener}},{key:"supportsLocalCandidateRttStatistics",value:function(){return this.isChromiumBased()||this.isReactNative()||this.isWebKitBased()}},{key:"supportsPerformanceObserver",value:function(){return"undefined"!=typeof window.PerformanceObserver&&PerformanceObserver.supportedEntryTypes.indexOf("longtask")>-1}},{key:"supportsReceiverStats",value:function(){return"undefined"!=typeof window.RTCRtpReceiver&&Object.keys(RTCRtpReceiver.prototype).indexOf("getSynchronizationSources")>-1}},{key:"supportsRTTStatistics",value:function(){return!this.isFirefox()}},{key:"usesPlanB",value:function(){return!this.usesUnifiedPlan()}},{key:"usesSdpMungingForSimulcast",value:function(){return this.isChromiumBased()||this.isReactNative()||this.isWebKitBased()}},{key:"usesUnifiedPlan",value:function(){return!(!this.isFirefox()&&!this.isWebKitBased())}},{key:"usesNewGumFlow",value:function(){return!!(this.isChromiumBased()||this.isFirefox()||this.isWebKitBased())}},{key:"usesAdapter",value:function(){return this.usesNewGumFlow()}},{key:"usesRidsForSimulcast",value:function(){return!1}},{key:"supportsGetDisplayMedia",value:function(){return"undefined"!=typeof navigator.getDisplayMedia||"undefined"!=typeof navigator.mediaDevices&&"undefined"!=typeof navigator.mediaDevices.getDisplayMedia}},{key:"supportsInsertableStreams",value:function(){if("undefined"==typeof window.RTCRtpSender||!window.RTCRtpSender.prototype.createEncodedStreams&&!window.RTCRtpSender.prototype.createEncodedVideoStreams)return!1;var e=new ReadableStream;try{return window.postMessage(e,"*",[e]),!0}catch(t){return!1}}},{key:"supportsAudioRed",value:function(){return Boolean(window.RTCRtpSender&&window.RTCRtpSender.getCapabilities&&window.RTCRtpSender.getCapabilities("audio").codecs.some((function(e){return"audio/red"===e.mimeType}))&&window.RTCRtpReceiver&&window.RTCRtpReceiver.getCapabilities&&window.RTCRtpReceiver.getCapabilities("audio").codecs.some((function(e){return"audio/red"===e.mimeType})))}},{key:"supportsSdpSemantics",value:function(){return this.isChromiumBased()}},{key:"_getChromiumBasedVersion",value:function(){if(this.isChromiumBased()){if(this.isNWJS())return Number.parseInt(process.versions.chromium,10);var e=navigator.userAgent;if(e.match(/Chrome/))return Number.parseInt(e.match(/Chrome\/([\d.]+)/)[1],10)}return-1}}]),n}(Vp),zp=new Hp,Wp=function(){function e(){(0,y.Z)(this,e)}return(0,k.Z)(e,null,[{key:"logsEndpoint",get:function(){return Ep()?"https://api-silos-staging.dyte.io/otel/logs":"https://api-silos.dyte.io/otel/logs"}},{key:"init",value:function(t,n){if(!navigator.isReactNative){var r=new Wr({url:"https://otel.dyte.io/v1/traces",headers:{"api-key":""}}),a=new br({resource:new hn({"service.name":"web-core"}),idGenerator:{generateTraceId:function(){return"".concat(t).replace(/-/g,"")},generateSpanId:function(){return Z().replace(/-/g,"").substring(0,16)}}});e.tracingEnabled=n,e.tracer=a.getTracer(t),e.meetingMetadata.peerId=t,e.meetingMetadata.sdkVersion=wp,e.meetingMetadata.deviceInfo=zp.getDeviceInfo(),e.meetingMetadata.visitedUrl=!navigator.isReactNative&&"undefined"!=typeof window&&window.location.href,a.addSpanProcessor(new hr(r)),"zone"in window?a.register({contextManager:new qr}):a.register({contextManager:new yr}),e.contextPropagator=Qe,document.addEventListener("visibilitychange",e.processCachedLogs),e.logsProcessorTimer=setInterval(e.processCachedLogs,e.logsProcessingInterval),n&&(e.rootSpan=e.tracer.startSpan("peer_".concat(t),{},Y),e.rootSpan.end())}}},{key:"trace",value:function(t){return function(n,r,a){var o=a.value;return a.value=function(){for(var n=this,r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];if(navigator.isReactNative||!e.tracingEnabled||Vc.hasFeature(Sp.SKIP_OTEL_TRACES))return o.apply(this,a);var c=e.getCurrentSpan(),u=ga.trace.setSpan(Y,c);return Vc.hasFeature(Sp.NR_OTEL_WEB)||e.addLogInCurrentSpan("info",t),e.tracer.startActiveSpan(t,{},u,(function(e){e.setAttributes((0,i.Z)({},Mn.CODE_FUNCTION,t));var r=o.apply(n,a);return Promise.resolve(r).then((function(){e.end()})).catch((function(){e.end()})),r}))},a}}},{key:"getCurrentSpan",value:function(){if(navigator.isReactNative)return null;var t=ga.trace.getSpan(ga.context.active());return null!=t||(t=e.rootSpan),t}},{key:"getCurrentContext",value:function(){return ga.trace.setSpan(Y,e.getCurrentSpan())}},{key:"getCurrentSpanName",value:function(){var e;return null==(e=this.getCurrentSpan())?void 0:e.name}},{key:"injectContext",value:function(t){e.getCurrentSpan()&&e.contextPropagator.inject(e.getCurrentContext(),t)}},{key:"addLogInCurrentSpan",value:function(){var t,n,r,a,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"info",o=arguments.length>1?arguments[1]:void 0,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=arguments.length>3?arguments[3]:void 0;if(null!=(n=null==(t=kp.modules)?void 0:t.devTools)&&n.logs&&console[i]("DyteInternalLogs:: ",i,o,c),function(e){if(Vc.hasFeature(Sp.LOG_LEVEL)){var t=Vc.getValue(Sp.LOG_LEVEL)||"all";if("off"===(t=t.toLowerCase().trim()))return!1;if("all"!==t){var n=["debug","log","info","warn","error"];if(n.indexOf(e)<n.indexOf(t))return!1}}return!0}(i))try{var l=Zp(o,c,"metadata"),d=e.getCurrentSpan(),p=new Date,f=(0,s.Z)((0,s.Z)({message:o,level:i},l),{},{"trace.id":null==(r=null==d?void 0:d.spanContext())?void 0:r.traceId,"span.id":null==(a=null==d?void 0:d.spanContext())?void 0:a.spanId,loggedAt:p.toISOString(),loggedAtTzOffset:p.getTimezoneOffset()});u?e.sendOtelLogsToNewRelic([f]):e.logsCache.push(f)}catch(l){e.addLogInCurrentSpan("error","opentelemetry::addLogInCurrentSpan_failed",{error:Tp(l)})}}},{key:"sendOtelLogsToNewRelic",value:function(t){R().post(e.logsEndpoint,{meetingMetadata:Zp("sendOtelLogsToNewRelic",e.meetingMetadata,"meetingMetadata"),serviceName:"web-core",logs:t}).catch((function(n){var r;e.addLogInCurrentSpan("error","opentelemetry::sendOtelLogToNewRelic_failed",{error:Tp(n)}),(r=e.logsCache).push.apply(r,(0,o.Z)(t))}))}},{key:"processCachedLogs",value:function(){var t=e.logsCache.splice(0,25);null!=t&&t.length&&e.sendOtelLogsToNewRelic(t)}},{key:"destruct",value:function(){clearInterval(e.logsProcessorTimer),e.processCachedLogs(),document.removeEventListener("visibilitychange",e.processCachedLogs)}}]),e}(),Gp=Wp;Ko(Gp,"tracer"),Ko(Gp,"contextPropagator"),Ko(Gp,"rootSpan"),Ko(Gp,"logsCache",[]),Ko(Gp,"logsProcessorTimer"),Ko(Gp,"tracingEnabled",!0),Ko(Gp,"logsProcessingInterval",7e3),Ko(Gp,"logExclusionList",["message","websocket/message","roomMessage","websocket/room-message","websocket/room-legacy-mode","chatMessage","websocket/new-chat-message","websocket/no-active-speaker","websocket/selected-peers","websocket/active-speaker","ping","websocket/new-consumer","websocket/producer-score","websocket/consumer-score","websocket/plugin-event","websocket/plugin-data","websocket/plugin-internal-data"]),Ko(Gp,"meetingMetadata",{});var qp=function(){function e(){(0,y.Z)(this,e)}return(0,k.Z)(e,null,[{key:"info",value:function(e,t,n){Gp.addLogInCurrentSpan("info",e,t,n)}},{key:"error",value:function(e,t,n){Gp.addLogInCurrentSpan("error",e,t,n)}},{key:"debug",value:function(e,t,n){Gp.addLogInCurrentSpan("debug",e,t,n)}},{key:"log",value:function(e,t,n){Gp.addLogInCurrentSpan("log",e,t,n)}},{key:"warn",value:function(e,t,n){Gp.addLogInCurrentSpan("warn",e,t,n)}}]),e}(),$p={"00":"DyteClient","01":"Controller","02":"RoomNodeClient","03":"HiveNodeClient","04":"SocketService","05":"Chat","06":"Plugin","07":"Polls","08":"Meta","09":"Preset",10:"Recording",11:"Self",12:"Participant",13:"Spotlight",14:"Remote Request",15:"Webinar",16:"LocalMediaHandler"},Kp={"0000":"Internal exception.","0001":"Failed to initialize.","0002":"Failed to join room.","0003":"Failed to leave room.","0100":"Internal exception","0200":"Internal exception.","0300":"Internal exception","0400":"Internal exception","0500":"Internal exception","0501":"Permission denied.","0502":"Invalid message body.","0600":"Internal exception","0700":"Internal exception","0800":"Internal exception","0900":"Internal exception",1e3:"Internal exception",1100:"Internal exception",1200:"Internal exception",1300:"Internal exception",1400:"Internal exception",1500:"Internal exception",1600:"Internal exception",1601:"Failed to get audio track",1602:"Failed to get video track",1603:"Incorrect device",1604:"Failed to change device"};Object.keys(Kp).forEach((function(e){Kp[e]="{".concat($p[e.slice(0,2)],"} ").concat(Kp[e])}));var Jp=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(0,y.Z)(this,n),a=t.call(this,e),Ko((0,v.Z)(a),"code"),a.code=r,a.name="DyteError",a.message="[ERR".concat(a.code,"]: ").concat(Kp[a.code],"\n").concat(a.message);try{var o=i;r&&r.endsWith("00")&&(o=!0),o&&qp.error("ERR".concat(a.code),{error:e})}catch(o){}return a}return(0,k.Z)(n)}((0,a.Z)(Error));function Qp(e,t,n,r){if(!("function"==typeof n&&r instanceof t))throw r;n.call(null,r,e)}function Xp(e,t,n){if(!e.value){var r=e.get,a=e.set;return r&&(e.get=function(){try{return r.apply(this)}catch(e){Qp(this,t,n,e)}}),a&&(e.set=function(e){try{return a.apply(this,[e])}catch(r){Qp(this,t,n,r)}}),e}var i=e.value;return e.value=function(){var e=this;try{for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];var c=i.apply(this,o);return c&&c instanceof Promise?c.catch((function(r){Qp(e,t,n,r)})):c}catch(a){Qp(this,t,n,a)}},e}var Yp=function(e){return function(e,t){return function(n,r,a){if(a)return Xp(a,e,t);var i,o=(0,c.Z)(Reflect.ownKeys(n.prototype).filter((function(e){return"constructor"!==e})));try{for(o.s();!(i=o.n()).done;){var s=i.value,u=Object.getOwnPropertyDescriptor(n.prototype,s);(u.value instanceof Function||u.get instanceof Function||u.set instanceof Function)&&Object.defineProperty(n.prototype,s,Xp(u,e,t))}}catch(Cx){o.e(Cx)}finally{o.f()}}}(Error,e)},ef=function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o,s,c;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t&&t.length){e.next=2;break}return e.abrupt("return",n);case 2:return r=new AudioContext,e.next=5,Promise.all(null==t?void 0:t.map((function(e){return e(r)})));case 5:for(a=e.sent,i=r.createMediaStreamSource(new MediaStream([n])),o=r.createMediaStreamDestination(),e.prev=8,s=i,c=0;c<a.length;c+=1)s.connect(a[c]),s=a[c];s.connect(o),e.next=17;break;case 14:return e.prev=14,e.t0=e.catch(8),e.abrupt("return",(qp.error("getTransformedAudioTrack::middleware_execution_failed",{}),n));case 17:return e.abrupt("return",o.stream.getAudioTracks()[0]);case 18:case"end":return e.stop()}}),e,null,[[8,14]])})));return function(t,n){return e.apply(this,arguments)}}(),tf=Object.defineProperty,nf=Object.getOwnPropertyDescriptor,rf=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e,r){var a;return(0,y.Z)(this,n),a=t.call(this),Ko((0,v.Z)(a),"constructorName",a.constructor.name),Ko((0,v.Z)(a),"userSelectedDevice"),Ko((0,v.Z)(a),"mediaInterface"),Ko((0,v.Z)(a),"_mediaTrack"),Ko((0,v.Z)(a),"transformedMediaTrack"),Ko((0,v.Z)(a),"middlewares",[]),Ko((0,v.Z)(a),"currentDevice"),a.mediaInterface=e,r&&a.setMediaTrack(r),a.userSelectedDevice=void 0,a.onTrackEnded=a.onTrackEnded.bind((0,v.Z)(a)),a.onTrackMuted=a.onTrackMuted.bind((0,v.Z)(a)),a}return(0,k.Z)(n,[{key:"disableTrack",value:function(){var e,t;this.removeMediaTrackListeners(),null==(e=this._mediaTrack)||e.stop(),this._mediaTrack=void 0,null==(t=this.transformedMediaTrack)||t.stop(),this.transformedMediaTrack=void 0}},{key:"mediaTrack",get:function(){return this._mediaTrack}},{key:"setMediaTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=function(e){qp.error("".concat(r.constructorName,".setMediaTrack.error"),{error:{name:e.name,message:e.message},class:r.constructorName})};try{this.disableTrack()}catch(a){n(a)}return this._mediaTrack=t,e.next=5,this.setTransformedTrack();case 5:return e.prev=5,this.addMediaTrackListeners(),e.next=9,this.setCurrentDevice();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(5),n(e.t0);case 14:case"end":return e.stop()}}),e,this,[[5,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"trackEnabled",get:function(){return!!this.mediaTrack&&"live"===this.mediaTrack.readyState&&this.mediaTrack.enabled}},{key:"muteTrack",value:function(){this.mediaTrack?(this.transformedMediaTrack&&(this.transformedMediaTrack.enabled=!1),this.mediaTrack.enabled=!1):qp.warn("BaseMediaHandler.muteTrack Tried muting with no track present")}},{key:"unmuteTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.mediaTrack){e.next=5;break}this.mediaTrack.enabled=!0,e.next=7;break;case 5:return e.next=7,this.enableTrack(!1);case 7:e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(0),qp.error("".concat(this.constructorName,".unmuteTrack.error"),{error:{name:e.t0.name,message:e.t0.message},class:this.constructorName}),this.disableTrack(),new Jp("Failed to unmute track");case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"setCurrentDevice",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mediaTrack){e.next=3;break}return this.currentDevice=void 0,e.abrupt("return");case 3:if(e.t0=(null==(t=this.currentDevice)?void 0:t.deviceId)!==this.mediaTrack.getSettings().deviceId,!e.t0){e.next=8;break}return e.next=7,this.mediaInterface.getDevice(this.mediaTrack.getSettings().deviceId);case 7:this.currentDevice=e.sent;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addMiddleware",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!zp.isSafari()){e.next=2;break}return e.abrupt("return",{success:!1,message:"Middlewares are not yet supported in Safari."});case 2:if(!this.middlewares.includes(t)){e.next=4;break}return e.abrupt("return",{success:!1,message:"This middleware has been applied, already. Skipping."});case 4:if(e.prev=4,e.t0=this.trackEnabled,!e.t0){e.next=9;break}return e.next=9,this.setTransformedTrack();case 9:return this.middlewares.push(t),e.abrupt("return",{success:!0,message:"Successfully added the middleware."});case 13:return e.prev=13,e.t1=e.catch(4),e.abrupt("return",(qp.error("While adding middleware",{error:{name:e.t1.name,message:e.t1.message}}),{success:!1,message:null==e.t1?void 0:e.t1.message}));case 16:case"end":return e.stop()}}),e,this,[[4,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"removeMiddleware",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((n=this.middlewares.indexOf(t,0))>-1)){e.next=12;break}return e.prev=2,e.next=5,this.setTransformedTrack();case 5:return this.middlewares.splice(n,1),e.abrupt("return",{success:!0,message:"Successfully removed the middleware."});case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",(qp.error("While removing middleware",{error:e.t0}),{success:!1,message:null==e.t0?void 0:e.t0.message}));case 12:return e.abrupt("return",{success:!1,message:"No such middleware was found. Skipping."});case 13:case"end":return e.stop()}}),e,this,[[2,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"addMediaTrackListeners",value:function(){var e,t,n;this.mediaTrack&&(qp.info("".concat(this.constructorName,".addMediaTrackListeners"),{mediaTrackKind:null==(e=this.mediaTrack)?void 0:e.kind,deviceId:null==(n=null==(t=this.mediaTrack)?void 0:t.getSettings())?void 0:n.deviceId}),this.mediaTrack.addEventListener("ended",this.onTrackEnded),this.mediaTrack.addEventListener("mute",this.onTrackMuted))}},{key:"removeMediaTrackListeners",value:function(){var e,t,n;this.mediaTrack&&(qp.info("".concat(this.constructorName,".removeMediaTrackListeners"),{mediaTrackKind:null==(e=this.mediaTrack)?void 0:e.kind,deviceId:null==(n=null==(t=this.mediaTrack)?void 0:t.getSettings())?void 0:n.deviceId}),this.mediaTrack.removeEventListener("ended",this.onTrackEnded),this.mediaTrack.removeEventListener("mute",this.onTrackMuted))}}]),n}(yp);rf=function(e,t,n,r){for(var a,i=r>1?void 0:r?nf(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&tf(t,n,i),i}([Yp((function(e){throw new Jp(e.message,"1600")}))],rf);var af=rf,of=Object.defineProperty,sf=Object.getOwnPropertyDescriptor,cf=function(e,t,n,r){for(var a,i=r>1?void 0:r?sf(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&of(t,n,i),i},uf=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.apply(this,arguments)}return(0,k.Z)(n,[{key:"setDevice",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw qp.warn("AudioMediaHandler.setDevice No device received"),new Jp("No device received!","1603");case 2:if("audioinput"===t.kind){e.next=4;break}throw qp.warn("AudioMediaHandler.setDevice Received non audio device"),new Jp("Non audio device received while setting device!","1603");case 4:return e.prev=4,n=this.trackEnabled,this.userSelectedDevice=t.deviceId,e.t0=this,e.next=10,this.mediaInterface.getAudioTrack(!n,t.deviceId);case 10:return e.t1=e.sent,e.next=13,e.t0.setMediaTrack.call(e.t0,e.t1);case 13:e.next=18;break;case 15:throw e.prev=15,e.t2=e.catch(4),qp.error("AudioMediaHandler.setDevice.error",{error:{name:e.t2.name,message:e.t2.message},class:"AudioMediaHandler"}),this.disableTrack(),new Jp(e.t2.message,"1604");case 18:case"end":return e.stop()}}),e,this,[[4,15]])})));return function(t){return e.apply(this,arguments)}}()},{key:"enableTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.trackEnabled){e.next=3;break}return qp.warn("AudioMediaHandler.enableTrack Track already enabled!"),e.abrupt("return");case 3:return e.next=5,this.mediaInterface.getAudioTrack(t,this.userSelectedDevice);case 5:return n=e.sent,e.next=8,this.setMediaTrack(n);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setTransformedTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(t=this.middlewares)&&t.length){e.next=3;break}return this.transformedMediaTrack=this.mediaTrack,e.abrupt("return");case 3:return e.prev=3,e.next=6,ef(this.middlewares,this.mediaTrack);case 6:this.transformedMediaTrack=e.sent,this.emit("trackChanged"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),qp.error("AudioMediaHandler.setTransformedTrack",{error:e.t0}),this.transformedMediaTrack=this.mediaTrack;case 13:case"end":return e.stop()}}),e,this,[[3,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"onTrackEnded",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return qp.info("AudioMediaHandler.TrackEnded"),this.emit("trackEnded"),t=this.mediaTrack.enabled,this.disableTrack(),e.next=5,this.enableTrack(!t);case 5:return e.next=7,this.setTransformedTrack();case 7:this.emit("trackChanged");case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onTrackMuted",value:function(){qp.info("AudioMediaHandler.TrackMuted"),this.emit("trackMuted")}}]),n}(af);cf([Gp.trace("AudioMediaHandler.setTransformedTrack")],uf.prototype,"setTransformedTrack",1),cf([Gp.trace("AudioMediaHandler.onTrackEnded")],uf.prototype,"onTrackEnded",1);var lf,df,pf=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e,r,a){var i;return(0,y.Z)(this,n),i=t.call(this,r),Ko((0,v.Z)(i),"constraints"),Ko((0,v.Z)(i),"name"),i.name=e,i.constraints=a,i}return(0,k.Z)(n)}((0,a.Z)(Error)),ff=function(e){return e.NEW_PRODUCER="NEW_PRODUCER",e.ROOM_NODE_CONNECTED="ROOM_NODE_CONNECTED",e.ROOM_NODE_DISCONNECTED="ROOM_NODE_DISCONNECTED",e.ROOM_NODE_CONNECTION_ERROR="ROOM_NODE_CONNECTION_ERROR",e.SOCKET_SERVICE_CONNECTED="SOCKET_SERVICE_CONNECTED",e.SOCKET_SERVICE_ROOM_JOINED="SOCKET_SERVICE_ROOM_JOINED",e.SOCKET_SERVICE_DISCONNECTED="SOCKET_SERVICE_DISCONNECTED",e.SOCKET_SERVICE_RECONNECTING="SOCKET_SERVICE_RECONNECTING",e.SOCKET_SERVICE_RECONNECTION_ATTEMPT="SOCKET_SERVICE_RECONNECTION_ATTEMPT",e.SOCKET_SERVICE_RECONNECT_FAILURE="SOCKET_SERVICE_RECONNECT_FAILURE",e.SOCKET_SERVICE_RECONNECTED="SOCKET_SERVICE_RECONNECTED",e.SOCKET_SERVICE_FAILED="SOCKET_SERVICE_FAILED",e.ROOM_JOINED="ROOM_JOINED",e.SELF_ROOM_JOINED="SELF_ROOM_JOINED",e.PRODUCER_SCORE_UPDATE="PRODUCER_SCORE_UPDATE",e.CONSUMER_SCORE_UPDATE="CONSUMER_SCORE_UPDATE",e.PRODUCER_STATUS_UPDATE="PRODUCER_STATUS_UPDATE",e.CONSUMER_STATUS_UPDATE="CONSUMER_STATUS_UPDATE",e.LOW_PRODUCER_SCORE="LOW_PRODUCER_SCORE",e.LOW_CONSUMER_SCORE="LOW_CONSUMER_SCORE",e.MEDIA_PERMISSION_ERROR="MEDIA_PERMISSION_ERROR",e.WAITLISTED="WAIT_LISTED",e.WAITLIST_ACCEPTED="websocket/waitlist-accepted",e.WAITLIST_REJECTED="websocket/waitlist-rejected",e.WAITLIST_PEER_ADDED="websocket/waitlist-peer-added",e.WAITLIST_PEER_REMOVED="websocket/waitlist-peer-closed",e.MESSAGE="websocket/message",e.ROOM_MESSAGE="websocket/room-message",e.DISABLE_AUDIO="websocket/disable-audio",e.DISABLE_VIDEO="websocket/disable-video",e.PEER_JOINED="websocket/peer-joined",e.PEER_CLOSED="websocket/peer-closed",e.PEER_MUTED="websocket/peer-muted",e.PEER_UNMUTED="websocket/peer-unmuted",e.PEER_PINNED="websocket/pin-peer",e.PEER_UNPINNED="websocker/unpin-peer",e.MUTE_ALL="websocket/mute-all",e.MUTE_ALL_VIDEO="websocket/mute-all-video",e.CONSUMER_CLOSED="websocket/consumer-closed",e.CONSUMER_PAUSED="websocket/consumer-paused",e.CONSUMER_RESUMED="websocket/consumer-resumed",e.PRODUCER_CLOSED="websocket/producer-closed",e.NEW_CONSUMER="websocket/new-consumer",e.CONNECTED_MEETING_STATE="websocket/connectedMeetingState",e.MOVE_TO_CONNECTED_MEETING="websocket/transferMeeting",e.GET_CHAT_MESSAGES="websocket/get-chat-messages",e.NEW_CHAT_MESSAGE="websocket/new-chat-message",e.PIN_CHAT_MESSAGE="websocket/pin-chat-message",e.UNPIN_CHAT_MESSAGE="websocket/unpin-chat-message",e.GET_POLLS="websocket/get-polls",e.UPDATE_POLL="websocket/update-poll",e.SELECTED_PEERS="websocket/selected-peers",e.GET_PAGE="websocket/get-page",e.ACTIVE_SPEAKER="websocket/active-speaker",e.NO_ACTIVE_SPEAKER="websocket/no-active-speaker",e.PRODUCER_SCORE="websocket/producer-score",e.CONSUMER_SCORE="websocket/consumer-score",e.ENABLE_PLUGIN="websocket/enable-plugin",e.DISABLE_PLUGIN="websocket/disable-plugin",e.PLUGIN_EVENT="websocket/plugin-event",e.PLUGIN_DATA="websocket/plugin-data",e.PLUGIN_INTERNAL_DATA="websocket/plugin-internal-data",e.KICKED="websocket/kicked",e.RECORDING_STARTED="websocket/recording-started",e.RECORDING_STOPPED="websocket/recording-stopped",e.ICE_CONNECTED="ICE_CONNECTED",e.ICE_DISCONNECTED="ICE_DISCONNECTED",e.ICE_FAILED="ICE_FAILED",e.ICE_RECONNECTING="ICE_RECONNECTING",e.PRODUCER_TOGGLE="hive/producer-toggle",e.CONSUMER_TOGGLE="hive/consumer-toggle",e.SELECTED_PEERS_DIFF="hive/selected-peers-diff",e.REFRESH_GRID="hive/refresh-grid",e.RESET_PRODUCER_STATE="hive/reset-producer-state",e.HIVE_RECORDING_STARTED="hive/recording-started",e.HIVE_RECORDING_STOPPED="hive/recording-stopped",e.ROOM_STATE="sockethub/room-state",e.ASSERT_SPOTLIGHTER="websocket/assert-spotlighter",e.PEER_REQUESTED_TO_JOIN_STAGE="websocket/request-to-join-stage-peer-added",e.PEER_REJECTED_TO_JOIN_STAGE="websocket/peer-rejected-to-join-stage",e.PEER_ADDED_TO_STAGE="websocket/peer-added-to-stage",e.PEER_REMOVED_FROM_STAGE="websocket/peer-removed-from-stage",e.PEER_STARTED_PRESENTING="websocket/peer-started-presenting",e.PEER_STOPPED_PRESENTING="websocket/peer-stopped-presenting",e.REQUEST_TO_JOIN_STAGE_ACCEPTED="websocket/request-to-join-stage-accepted",e.REQUEST_TO_JOIN_STAGE_REJECTED="websocket/request-to-join-stage-rejected",e.STARTED_PRESENTING="websocket/started-presenting",e.STOPPED_PRESENTING="websocket/stopped-presenting",e.REMOVED_FROM_STAGE="websocket/removed-from-stage",e}(ff||{}),hf=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;return(0,y.Z)(this,n),e=t.call(this),Xo((0,v.Z)(e),lf,void 0),Xo((0,v.Z)(e),df,void 0),Ko((0,v.Z)(e),"asyncPromiseTimeout"),Yo((0,v.Z)(e),lf,new Map),Yo((0,v.Z)(e),df,new Map),e.asyncPromiseTimeout=8e3,e}return(0,k.Z)(n,[{key:"emitAsync",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var r,a,i,o,s,c=this,u=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(Qo(this,lf).set(t,[]),a=Qo(this,df).get(t).map((function(){return new Promise((function(e){Qo(c,lf).get(t).push(e)}))})),i=u.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=u[s];return(r=f((0,p.Z)(n.prototype),"emit",this)).call.apply(r,[this,t].concat(o)),e.next=6,Promise.race([Promise.all(a),new Promise((function(e,t){return setTimeout((function(){return t(new Error("emitAsync failed to resolve."))}),c.asyncPromiseTimeout)}))]);case 6:Qo(this,lf).delete(t);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onAsync",value:function(e,t){var r=Qo(this,lf),a=function(){var n=(0,d.Z)((0,l.Z)().mark((function n(){var a,i,o=arguments;return(0,l.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.apply(void 0,o);case 3:n.next=8;break;case 5:n.prev=5,n.t0=n.catch(0),qp.error("[onAsync]",n.t0);case 8:null==(i=null==(a=r.get(e))?void 0:a.shift())||i();case 10:case"end":return n.stop()}}),n,null,[[0,5]])})));return function(){return n.apply(this,arguments)}}();return Qo(this,df).get(e)||Qo(this,df).set(e,[]),Qo(this,df).get(e).push(a),f((0,p.Z)(n.prototype),"on",this).call(this,e,a)}}]),n}(is.EventEmitter);lf=new WeakMap,df=new WeakMap;var vf=new hf;function mf(e,t){if(zp.isChromiumBased()){if("NotAllowedError"===e)return t.indexOf("by system")>0?"SYSTEM_DENIED":"DENIED";if("NotReadableError"===e)return"COULD_NOT_START"}else if(zp.isSafari()){if("NotAllowedError"===e)return"DENIED"}else if(zp.isFirefox()){if("NotFoundError"===e||"NotReadableError"===e)return"SYSTEM_DENIED";if("NotAllowedError"===e)return"DENIED";if("AbortError"===e)return"COULD_NOT_START"}return"COULD_NOT_START"}function gf(e){return e===2..toString()?Es.DENIED:e===3..toString()?Es.SYS_DENIED:e===1..toString()?Es.ACCEPTED:Es.FAILED}var yf=function(){function e(){(0,y.Z)(this,e),Ko(this,"permissions"),this.permissions={audio:"NOT_REQUESTED",video:"NOT_REQUESTED",screenshare:"NOT_REQUESTED"}}return(0,k.Z)(e,[{key:"getAudioInputDevices",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAvailableDevices();case 2:return e.abrupt("return",e.sent.filter((function(e){return"audioinput"===e.kind})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getVideoInputDevices",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAvailableDevices();case 2:return e.abrupt("return",e.sent.filter((function(e){return"videoinput"===e.kind})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAudioOutputDevices",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAvailableDevices();case 2:return e.abrupt("return",e.sent.filter((function(e){return"audiooutput"===e.kind})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),kf={qvga:{width:{ideal:320},height:{ideal:240}},vga:{width:{ideal:640},height:{ideal:480}},hd:{width:{ideal:1280},height:{ideal:720}},hd_cropped:{width:{ideal:900},height:{ideal:720}}},bf={},wf=[{rid:"r0",scalabilityMode:"L1T2"},{rid:"r1",scalabilityMode:"L1T2"}],_f=[{active:!1,adaptivePtime:!1,networkPriority:"low",priority:"low"},{active:!1,adaptivePtime:!1,networkPriority:"low",priority:"low"},{active:!0,adaptivePtime:!1,networkPriority:"low",priority:"low",maxBitrate:25e5}],Sf=[{active:!1,priority:"low"},{active:!1,priority:"low"},{active:!0,priority:"low"}],Ef=[{rid:"f",maxBitrate:4e6,maxFramerate:30,scalabilityMode:"L1T3"},{rid:"h",scaleResolutionDownBy:2,maxBitrate:25e5,maxFramerate:30,scalabilityMode:"L1T3"},{rid:"q",scaleResolutionDownBy:4,maxBitrate:5e5,maxFramerate:30,scalabilityMode:"L1T3"}],Tf=[{scalabilityMode:"L3T3_KEY"}],xf=function(e){return e.WEBCAM="webcam",e.MIC="mic",e.SCREENSHARE_VIDEO="screenshare_video",e.SCREENSHARE_AUDIO="screenshare_audio",e}(xf||{});function Zf(e){if(!e||"object"!=typeof e)return e;if(Array.isArray(e))return e.map((function(e){return Zf(e)}));var t={};return Object.keys(e).forEach((function(n){var r=S(n)?n:function(e){return e.replace(/([-_]\w)/g,(function(e){return e[1].toUpperCase()}))}(n);t[r]=Zf(e[n])})),t}function Cf(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==e?{}:(Object.getOwnPropertyNames(e).forEach((function(n){if("function"!=typeof e[n]){if("object"==typeof e[n])return void Cf(e[n],t[n]={});t[n]=e[n]}})),t)}var Rf,Pf=Zf(ap(vp).config.media),If=(0,k.Z)((function e(t){var n=this;(0,y.Z)(this,e),Xo(this,Rf,void 0),Ko(this,"getScreenShareConstraints",(function(){return{audio:!0,video:{width:{max:1920},height:{max:1080},frameRate:{max:5}}}})),Ko(this,"getAudioConstraints",(function(e){var t={};return zp.isFirefox()||zp.isWebKitBased()?(t.audio={deviceId:e,autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0},t):(t.audio={},t.audio.optional=[e?{sourceId:e}:{sourceId:"default"},{echoCancellation:!0},{googEchoCancellation:!0},{googAutoGainControl:!0},{googNoiseSuppression:!0},{googHighpassFilter:!0}],t)})),Ko(this,"getVideoConstraints",(function(e){var t={},r=kf[Qo(n,Rf).video.quality];return t.video=r,e?t.video.deviceId={exact:e}:t.video.facingMode="user",t.video.frameRate={ideal:24,max:30},t})),Yo(this,Rf,null!=t?t:Pf)}));Rf=new WeakMap;var Of,Df,Mf=Object.defineProperty,Af=Object.getOwnPropertyDescriptor,Nf=(Df=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;return(0,y.Z)(this,n),r=t.call(this),Xo((0,v.Z)(r),Of,void 0),Yo((0,v.Z)(r),Of,new If(e)),r}return(0,k.Z)(n,[{key:"handlePermissionErrors",value:function(e,t){var n=mf(t.name,t.message);this.permissions[e]=n,vf.emit(ff.MEDIA_PERMISSION_ERROR,{message:n,constraints:t.constraints,kind:e})}},{key:"getAudioAndVideoTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r,a,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={audio:Qo(this,Of).getAudioConstraints().audio,video:Qo(this,Of).getVideoConstraints().video},e.prev=1,e.next=4,navigator.mediaDevices.getUserMedia(t);case 4:return n=e.sent,r=n.getAudioTracks()[0],a=n.getVideoTracks()[0],e.abrupt("return",{audioTrack:r,videoTrack:a});case 10:if(e.prev=10,e.t0=e.catch(1),"NotAllowedError"!==e.t0.name){e.next=20;break}return e.next=15,this.getAudioTrack(!1);case 15:return i=e.sent,e.next=18,this.getVideoTrack();case 18:return o=e.sent,e.abrupt("return",{audioTrack:i,videoTrack:o});case 20:throw qp.error("WebMediaInterface.getAudioAndVideoTrack",{error:{name:e.t0.name,message:e.t0.message}}),new Jp("Couldnt fetch audio and video track");case 21:case"end":return e.stop()}}),e,this,[[1,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"getAudioTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Qo(this,Of).getAudioConstraints(n),e.prev=1,e.next=4,navigator.mediaDevices.getUserMedia(r);case 4:return a=e.sent.getAudioTracks()[0],e.abrupt("return",(a.enabled=!t,a));case 8:throw e.prev=8,e.t0=e.catch(1),this.handlePermissionErrors("audio",new pf(e.t0.name,e.t0.message,r)),new Jp(e.t0.message,"1601");case 11:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getScreenShareTracks",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Qo(this,Of).getScreenShareConstraints(),e.prev=1,e.next=4,navigator.mediaDevices.getDisplayMedia(t);case 4:return n=e.sent,e.abrupt("return",{audioTrack:n.getAudioTracks()[0],videoTrack:n.getVideoTracks()[0]});case 8:throw e.prev=8,e.t0=e.catch(1),this.handlePermissionErrors("screenshare",new pf(e.t0.name,e.t0.message,t)),qp.error("WebMediaInterface.getScreenShareTracks Error while fetching screenshare tracks",{error:{name:e.t0.name,message:e.t0.message}}),new Jp("Couldnt fetch screen share tracks");case 11:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"getVideoTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Qo(this,Of).getVideoConstraints(t),e.prev=1,e.next=4,navigator.mediaDevices.getUserMedia(n);case 4:return e.abrupt("return",e.sent.getVideoTracks()[0]);case 7:throw e.prev=7,e.t0=e.catch(1),this.handlePermissionErrors("video",new pf(e.t0.name,e.t0.message,n)),qp.error("WebMediaInterface.getVideoTrack Error while fetching video track",{error:{name:e.t0.name,message:e.t0.message}}),new Jp("Couldnt fetch video track");case 10:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getAvailableDevices",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",navigator.mediaDevices.enumerateDevices());case 4:throw e.prev=4,e.t0=e.catch(0),qp.error("enumerate_devices_failed",{error:{name:e.t0.name,message:e.t0.message}}),new Jp("Failed to get available devices");case 7:case"end":return e.stop()}}),e,null,[[0,4]])})));return function(){return e.apply(this,arguments)}}()},{key:"getAvailableDevicesByKind",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.enumerateDevices();case 3:return e.abrupt("return",e.sent.filter((function(e){var n=e.kind;return t===n})));case 6:throw e.prev=6,e.t0=e.catch(0),qp.error("enumerate_devices_failed",{error:{name:e.t0.name,message:e.t0.message}}),new Jp("Failed to get available devices by kind");case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getDevice",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.enumerateDevices();case 3:return e.abrupt("return",e.sent.filter((function(e){return e.deviceId===t}))[0]);case 6:throw e.prev=6,e.t0=e.catch(0),qp.error("enumerate_devices_failed",{error:{name:e.t0.name,message:e.t0.message}}),new Jp("Failed to get device");case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()}]),n}(yf),Of=new WeakMap,Df);Nf=function(e,t,n,r){for(var a,i=r>1?void 0:r?Af(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Mf(t,n,i),i}([Yp((function(e){throw new Jp(e.message,"1600")}))],Nf);var Lf,jf=Nf,Ff=function(){function e(t){(0,y.Z)(this,e),Xo(this,Lf,void 0),Ko(this,"currentDevice"),Yo(this,Lf,t)}return(0,k.Z)(e,[{key:"setupSpeaker",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Qo(this,Lf)instanceof jf){e.next=2;break}return e.abrupt("return");case 2:if(i=t,e.t0=t,e.t0){e.next=11;break}return e.next=7,Qo(this,Lf).getAvailableDevicesByKind("audiooutput");case 7:n=e.sent,r=(0,u.Z)(n,1),i=r[0];case 11:if(i){e.next=13;break}throw new Jp("No speaker found");case 13:(null==(a=this.currentDevice)?void 0:a.deviceId)!==i.deviceId&&(null!=this.currentDevice||(this.currentDevice=i),document.querySelectorAll("audio").forEach(function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"==typeof t.sinkId||!o.currentDevice.deviceId||t.sinkId===o.currentDevice.deviceId){e.next=8;break}return e.prev=1,e.next=4,t.setSinkId(o.currentDevice.deviceId);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()));case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();Lf=new WeakMap;var Uf,Bf=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;return(0,y.Z)(this,n),r=t.call(this),Ko((0,v.Z)(r),"mediaInterface"),Ko((0,v.Z)(r),"audioMediaTrack"),Ko((0,v.Z)(r),"videoMediaTrack"),r.mediaInterface=e,r}return(0,k.Z)(n,[{key:"trackEnabled",get:function(){return!!this.videoMediaTrack}},{key:"enableScreenShare",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.mediaInterface.getScreenShareTracks();case 2:t=e.sent,n=t.audioTrack,r=t.videoTrack,this.audioMediaTrack=n,this.videoMediaTrack=r,this.addMediaTrackListeners();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"disableScreenShare",value:function(){var e,t;this.removeMediaTrackListeners(),null==(e=this.audioMediaTrack)||e.stop(),null==(t=this.videoMediaTrack)||t.stop(),this.videoMediaTrack=void 0,this.audioMediaTrack=void 0}},{key:"addMediaTrackListeners",value:function(){var e;null==(e=this.videoMediaTrack)||e.addEventListener("ended",this.onTrackEnded.bind(this))}},{key:"removeMediaTrackListeners",value:function(){var e;null==(e=this.videoMediaTrack)||e.removeEventListener("ended",this.onTrackEnded)}},{key:"onTrackEnded",value:function(){this.emit("trackEnded")}}]),n}(yp),Vf=function(){function e(){(0,y.Z)(this,e),Xo(this,Uf,void 0)}return(0,k.Z)(e,[{key:"terminateMiddlewareWebWorker",value:function(){if(Qo(this,Uf))try{_a(Qo(this,Uf)),Yo(this,Uf,void 0)}catch(e){qp.debug("WorkerTimers::terminateMiddlewareWebWorker::failed")}}},{key:"getTransformedVideoTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o,s,c,u=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t&&t.length){e.next=2;break}return e.abrupt("return",n);case 2:return e.next=4,Promise.all(null==t?void 0:t.map((function(e){return e()})));case 4:r=e.sent,(a=new MediaStream).addTrack(n),i=document.createElement("canvas"),o=i.getContext("2d"),(s=document.createElement("video")).srcObject=a,s.autoplay=!0,this.terminateMiddlewareWebWorker(),c=function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==n.enabled&&"ended"!==n.readyState){e.next=3;break}return u.terminateMiddlewareWebWorker(),s.remove(),i.remove(),e.abrupt("return");case 3:e.prev=3,o.drawImage(s,0,0),t=0;case 6:if(!(t<r.length)){e.next=12;break}return e.next=9,r[t](i,o);case 9:t+=1,e.next=6;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),qp.error("getTransformedVideoTrack::middleware_execution_failed",{});case 17:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(){return e.apply(this,arguments)}}();try{s.play()}catch(p){}return e.abrupt("return",(s.addEventListener("play",(function(){i.width=s.width||n.getSettings().width,i.height=s.width||n.getSettings().height,Yo(u,Uf,Sa(c,50))}),!1),i.captureStream().getVideoTracks()[0]));case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();Uf=new WeakMap;var Hf,zf=Object.defineProperty,Wf=Object.getOwnPropertyDescriptor,Gf=function(e,t,n,r){for(var a,i=r>1?void 0:r?Wf(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&zf(t,n,i),i},qf=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e,r){var a;return(0,y.Z)(this,n),a=t.call(this,e,r),Xo((0,v.Z)(a),Hf,void 0),Yo((0,v.Z)(a),Hf,new Vf),a}return(0,k.Z)(n,[{key:"setDevice",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw qp.warn("VideoMediaHandler.setDevice No device received"),new Jp("No device received!");case 2:if("videoinput"===t.kind){e.next=4;break}throw qp.warn("VideoMediaHandler.setDevice Received non video device",{deviceId:t.deviceId}),new Jp("Non video device received while setting video device!");case 4:if(this.userSelectedDevice=t.deviceId,this.mediaTrack&&this.mediaTrack.enabled){e.next=7;break}return qp.warn("VideoMediaHandler.setDevice Tried switching device with video disabled",{deviceId:t.deviceId}),this.currentDevice=t,e.abrupt("return");case 7:return e.prev=7,e.t0=this,e.next=11,this.mediaInterface.getVideoTrack(this.userSelectedDevice);case 11:return e.t1=e.sent,e.next=14,e.t0.setMediaTrack.call(e.t0,e.t1);case 14:e.next=19;break;case 16:throw e.prev=16,e.t2=e.catch(7),qp.error("VideoMediaHandler.setDevice.error",{error:{name:e.t2.name,message:e.t2.message},class:"VideoMediaHandler"}),this.disableTrack(),new Jp("Failed to change device");case 19:case"end":return e.stop()}}),e,this,[[7,16]])})));return function(t){return e.apply(this,arguments)}}()},{key:"enableTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.trackEnabled){e.next=3;break}return qp.warn("VideoMediaHandler.enableTrack Track already enabled!"),e.abrupt("return");case 3:return e.t0=this,e.next=6,this.mediaInterface.getVideoTrack(this.userSelectedDevice);case 6:return e.t1=e.sent,e.next=9,e.t0.setMediaTrack.call(e.t0,e.t1);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setTransformedTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(t=this.middlewares)&&t.length){e.next=3;break}return this.transformedMediaTrack=this.mediaTrack,e.abrupt("return");case 3:return e.prev=3,e.next=6,Qo(this,Hf).getTransformedVideoTrack(this.middlewares,this.mediaTrack);case 6:this.transformedMediaTrack=e.sent,this.emit("trackChanged"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),qp.error("VideoMediaHandler.setTransformedTrack",{error:e.t0}),this.transformedMediaTrack=this.mediaTrack;case 13:case"end":return e.stop()}}),e,this,[[3,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"terminateMiddlewareWebWorker",value:function(){Qo(this,Hf).terminateMiddlewareWebWorker()}},{key:"onTrackEnded",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:qp.info("VideoMediaHandler.TrackEnded"),this.disableTrack(),this.emit("trackEnded");case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onTrackMuted",value:function(){qp.info("VideoMediaHandler.TrackMuted"),this.emit("trackMuted")}}]),n}(af);Hf=new WeakMap,Gf([Gp.trace("VideoMediaHandler.setTransformedTrack")],qf.prototype,"setTransformedTrack",1),Gf([Gp.trace("VideoMediaHandler.onTrackEnded")],qf.prototype,"onTrackEnded",1);var $f,Kf,Jf,Qf,Xf,Yf=Object.defineProperty,eh=Object.getOwnPropertyDescriptor,th=function(e,t,n,r){for(var a,i=r>1?void 0:r?eh(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Yf(t,n,i),i},nh=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;return(0,y.Z)(this,n),r=t.call(this),Xo((0,v.Z)(r),$f,void 0),Xo((0,v.Z)(r),Kf,void 0),Xo((0,v.Z)(r),Jf,void 0),Xo((0,v.Z)(r),Qf,void 0),Xo((0,v.Z)(r),Xf,void 0),Yo((0,v.Z)(r),$f,new jf(e)),Yo((0,v.Z)(r),Kf,new uf(Qo((0,v.Z)(r),$f))),Yo((0,v.Z)(r),Jf,new qf(Qo((0,v.Z)(r),$f))),Yo((0,v.Z)(r),Xf,new Bf(Qo((0,v.Z)(r),$f))),Yo((0,v.Z)(r),Qf,new Ff(Qo((0,v.Z)(r),$f))),Qo((0,v.Z)(r),Kf).on("trackMuted",r.onAudioTrackMuted.bind((0,v.Z)(r))),Qo((0,v.Z)(r),Kf).on("trackChanged",r.onAudioTrackChanged.bind((0,v.Z)(r))),Qo((0,v.Z)(r),Jf).on("trackChanged",r.onVideoTrackChanged.bind((0,v.Z)(r))),Qo((0,v.Z)(r),Jf).on("trackEnded",r.onVideoTrackEnded.bind((0,v.Z)(r))),Qo((0,v.Z)(r),Xf).on("trackEnded",r.onScreenShareEnded.bind((0,v.Z)(r))),r}return(0,k.Z)(n,[{key:"setupStreams",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.audio,r=t.video,!n||!r){e.next=12;break}return e.prev=2,e.next=5,Qo(this,$f).getAudioAndVideoTrack();case 5:o=e.sent,a=o.audioTrack,i=o.videoTrack,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),qp.error("LocalMediaHandler::init::Failed to get audio video tracks",{error:{name:e.t0.name,message:e.t0.message}});case 12:if(a||!n){e.next=22;break}return e.prev=13,e.next=16,Qo(this,$f).getAudioTrack(!1);case 16:a=e.sent,e.next=22;break;case 19:e.prev=19,e.t1=e.catch(13),qp.error("LocalMediaHandler::init::Failed to get audio track",{error:{name:e.t1.name,message:e.t1.message}});case 22:if(i||!r){e.next=32;break}return e.prev=23,e.next=26,Qo(this,$f).getVideoTrack();case 26:i=e.sent,e.next=32;break;case 29:e.prev=29,e.t2=e.catch(23),qp.error("LocalMediaHandler::init::Failed to get video track",{error:{name:e.t2.name,message:e.t2.message}});case 32:return e.next=34,Qo(this,Kf).setMediaTrack(a);case 34:return e.next=36,Qo(this,Jf).setMediaTrack(i);case 36:return e.prev=36,e.next=39,Qo(this,Qf).setupSpeaker();case 39:e.next=43;break;case 41:e.prev=41,e.t3=e.catch(36);case 43:case"end":return e.stop()}}),e,this,[[2,9],[13,19],[23,29],[36,41]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getCurrentDevices",value:function(){return{audio:Qo(this,Kf).currentDevice,video:Qo(this,Jf).currentDevice,speaker:Qo(this,Qf).currentDevice}}},{key:"permissions",get:function(){return Qo(this,$f).permissions}},{key:"getAllDevices",value:function(){return Qo(this,$f).getAvailableDevices()}},{key:"getDeviceById",value:function(e,t){return Qo(this,$f).getDevice(e)}},{key:"onAudioTrackMuted",value:function(){this.emit("AUDIO_TRACK_SILENT")}},{key:"onAudioTrackChanged",value:function(){this.emit("AUDIO_TRACK_CHANGE")}},{key:"rawAudioTrack",get:function(){return Qo(this,Kf).mediaTrack}},{key:"audioTrack",get:function(){return Qo(this,Kf).transformedMediaTrack}},{key:"audioEnabled",get:function(){return Qo(this,Kf).trackEnabled}},{key:"enableAudio",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,Kf).unmuteTrack();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"disableAudio",value:function(){Qo(this,Kf).muteTrack()}},{key:"getAudioDevices",value:function(){return Qo(this,$f).getAudioInputDevices()}},{key:"setAudioDevice",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,Kf).setDevice(t);case 2:this.emit("AUDIO_TRACK_CHANGE");case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupSpeaker",value:function(){return Qo(this,Qf).setupSpeaker()}},{key:"setSpeakerDevice",value:function(e){return Qo(this,Qf).setupSpeaker(e)}},{key:"onVideoTrackChanged",value:function(){this.emit("VIDEO_TRACK_CHANGE")}},{key:"onVideoTrackEnded",value:function(){this.emit("VIDEO_TRACK_CHANGE")}},{key:"rawVideoTrack",get:function(){return Qo(this,Jf).mediaTrack}},{key:"videoTrack",get:function(){return Qo(this,Jf).transformedMediaTrack}},{key:"videoEnabled",get:function(){return Qo(this,Jf).trackEnabled}},{key:"enableVideo",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,Jf).unmuteTrack();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"disableVideo",value:function(){Qo(this,Jf).disableTrack()}},{key:"getVideoDevices",value:function(){return Qo(this,$f).getVideoInputDevices()}},{key:"setVideoDevice",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,Jf).setDevice(t);case 2:this.emit("VIDEO_TRACK_CHANGE");case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onScreenShareEnded",value:function(){this.emit("SCREENSHARE_ENDED")}},{key:"screenShareTracks",get:function(){return{audio:Qo(this,Xf).audioMediaTrack,video:Qo(this,Xf).videoMediaTrack}}},{key:"screenShareEnabled",get:function(){return Qo(this,Xf).trackEnabled}},{key:"enableScreenShare",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,Xf).enableScreenShare();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"disableScreenShare",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Qo(this,Xf).disableScreenShare();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getSpeakerDevices",value:function(){return Qo(this,$f).getAudioOutputDevices()}},{key:"addAudioMiddleware",value:function(e){return Qo(this,Kf).addMiddleware(e)}},{key:"removeAudioMiddleware",value:function(e){return Qo(this,Kf).removeMiddleware(e)}},{key:"addVideoMiddleware",value:function(e){return Qo(this,Jf).addMiddleware(e)}},{key:"removeVideoMiddleware",value:function(e){return Qo(this,Jf).removeMiddleware(e)}},{key:"destruct",value:function(){Qo(this,Kf).disableTrack(),Qo(this,Jf).disableTrack(),Qo(this,Jf).terminateMiddlewareWebWorker(),Qo(this,Xf).disableScreenShare()}},{key:"removeAllTracks",value:function(){this.destruct()}},{key:"removeDocumentEventListeners",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),n}(yp);$f=new WeakMap,Kf=new WeakMap,Jf=new WeakMap,Qf=new WeakMap,Xf=new WeakMap,th([Gp.trace("MediaHandler.setupStreams")],nh.prototype,"setupStreams",1),th([Gp.trace("MediaHandler.enableAudio")],nh.prototype,"enableAudio",1),th([Gp.trace("MediaHandler.disableAudio")],nh.prototype,"disableAudio",1),th([Gp.trace("MediaHandler.setAudioDevice")],nh.prototype,"setAudioDevice",1),th([Gp.trace("MediaHandler.enableVideo")],nh.prototype,"enableVideo",1),th([Gp.trace("MediaHandler.disableVideo")],nh.prototype,"disableVideo",1),th([Gp.trace("MediaHandler.setVideoDevice")],nh.prototype,"setVideoDevice",1),th([Gp.trace("MediaHandler.enableScreenShare")],nh.prototype,"enableScreenShare",1),th([Gp.trace("MediaHandler.disableScreenShare")],nh.prototype,"disableScreenShare",1),th([Gp.trace("MediaHandler.destruct")],nh.prototype,"destruct",1);var rh=function(){return tu.Date.now()},ah=/\s/;var ih=/^\s+/;function oh(e){return e&&e.slice(0,function(e){for(var t=e.length;t--&&ah.test(e.charAt(t)););return t}(e)+1).replace(ih,"")}var sh=NaN,ch=/^[-+]0x[0-9a-f]+$/i,uh=/^0b[01]+$/i,lh=/^0o[0-7]+$/i,dh=parseInt;function ph(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||qu(e)&&du(e)==ip}(e))return sh;if(pu(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=pu(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=oh(e);var n=uh.test(e);return n||lh.test(e)?dh(e.slice(2),n?2:8):ch.test(e)?sh:+e}var fh="Expected a function",hh=Math.max,vh=Math.min;function mh(e,t,n){var r,a,i,o,s,c,u=0,l=!1,d=!1,p=!0;if("function"!=typeof e)throw new TypeError(fh);function f(t){var n=r,i=a;return r=a=void 0,u=t,o=e.apply(i,n)}function h(e){var n=e-c;return void 0===c||n>=t||n<0||d&&e-u>=i}function v(){var e=rh();if(h(e))return m(e);s=setTimeout(v,function(e){var n=t-(e-c);return d?vh(n,i-(e-u)):n}(e))}function m(e){return s=void 0,p&&r?f(e):(r=a=void 0,o)}function g(){var e=rh(),n=h(e);if(r=arguments,a=this,c=e,n){if(void 0===s)return function(e){return u=e,s=setTimeout(v,t),l?f(e):o}(c);if(d)return clearTimeout(s),s=setTimeout(v,t),f(c)}return void 0===s&&(s=setTimeout(v,t)),o}return t=ph(t)||0,pu(n)&&(l=!!n.leading,i=(d="maxWait"in n)?hh(ph(n.maxWait)||0,t):i,p="trailing"in n?!!n.trailing:p),g.cancel=function(){void 0!==s&&clearTimeout(s),u=0,r=c=a=s=void 0},g.flush=function(){return void 0===s?o:m(rh())},g}var gh,yh,kh,bh=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e,r){var a;return(0,y.Z)(this,n),a=t.call(this,e),Ko((0,v.Z)(a),"code"),a.code=r,a}return(0,k.Z)(n)}((0,a.Z)(Error)),wh=Object.defineProperty,_h=Object.getOwnPropertyDescriptor,Sh=function(e,t,n,r){for(var a,i=r>1?void 0:r?_h(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&wh(t,n,i),i},Eh=(kh=function(){function e(t){(0,y.Z)(this,e),Xo(this,gh,void 0),Xo(this,yh,void 0),Yo(this,gh,t),Yo(this,yh,new AbortController)}return(0,k.Z)(e,[{key:"destruct",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(t=Qo(this,yh))||t.abort();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onDeviceChange",value:function(e){var t=this;zp.supportsDeviceChangeEvent()&&navigator.mediaDevices.addEventListener("devicechange",mh(function(){var n=(0,d.Z)((0,l.Z)().mark((function n(r){var a,i,o,s,c;return(0,l.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=t.availableDevices,i=new Set(a.map((function(e){return e.deviceId}))),n.next=3,t.repopulateAvailableDevices();case 3:o=t.availableDevices,s=new Set(o.map((function(e){return e.deviceId}))),c={added:o.filter((function(e){return!i.has(e.deviceId)})),removed:a.filter((function(e){return!s.has(e.deviceId)}))},t.repopulateAvailableDevices().then((function(){return e(r,c)}));case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),100),{signal:Qo(this,yh).signal})}},{key:"repopulateAvailableDevices",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Eh.enumerateDevices();case 2:t=e.sent,Yo(this,gh,t),Lc.devices("AUDIO",this.getAudioDevices()),Lc.devices("VIDEO",this.getVideoDevices()),Lc.devices("SPEAKER",this.getSpeakerDevices()),qp.info("repopulated_full_device_list",{devices:JSON.stringify(t)});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"availableDevices",get:function(){return Qo(this,gh)}},{key:"getAvailableDevicesByKind",value:function(e){return Qo(this,gh).filter((function(t){return t.kind===e}))}},{key:"getDeviceById",value:function(e,t){return Qo(this,gh).find((function(n){return n.deviceId===e&&n.kind===t}))}},{key:"getAudioDevices",value:function(){return this.getAvailableDevicesByKind("audioinput")}},{key:"getVideoDevices",value:function(){return this.getAvailableDevicesByKind("videoinput")}},{key:"getSpeakerDevices",value:function(){return this.getAvailableDevicesByKind("audiooutput")}}],[{key:"init",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],!Eh.isDeviceListAvailable()){e.next=8;break}return e.next=4,Eh.enumerateDevices();case 4:t=e.sent,qp.info("initial_full_device_list",{devices:JSON.stringify(t)}),e.next=9;break;case 8:qp.error("UnsupportedMediaAPI::navigator.mediaDevices.enumerateDevices",{disclaimer:"Try checking meetingMetadata.visitedUrl. It should be running on localhost/127.0.0.1 or HTTPS, if not, there would be issues."});case 9:return e.abrupt("return",new Eh(t));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"isDeviceListAvailable",value:function(){return!(!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)}},{key:"enumerateDevices",value:function(){try{return navigator.mediaDevices.enumerateDevices()}catch(Go){return qp.error("enumerate_devices_failed",{error:{name:Go.name,message:Go.message}}),Promise.resolve([])}}},{key:"getAudioConstraints",value:function(e){var t={},n=e.audioOptions||{},r=n.disableAP,a=void 0!==r&&r,i=n.disableAEC,o=void 0!==i&&i,s=n.disableNS,c=void 0!==s&&s,u=n.disableAGC,l=void 0!==u&&u,d=n.disableHPF,p=void 0!==d&&d;if(zp.isFirefox()||zp.isWebKitBased())t.audio={deviceId:e.audioDeviceId,autoGainControl:!l&&!a,echoCancellation:!o&&!a,noiseSuppression:!c&&!a};else{if("boolean"==typeof t.audio)return t;t.audio={},t.audio.optional=[e.audioDeviceId?{sourceId:e.audioDeviceId}:{sourceId:"default"},{echoCancellation:!o&&!a},{googEchoCancellation:!o&&!a},{googAutoGainControl:!l&&!a},{googNoiseSuppression:!c&&!a},{googHighpassFilter:!p&&!a},{googNoiseSuppression2:!c&&!a},{googEchoCancellation2:!o&&!a},{googAutoGainControl2:!l&&!a}]}return t}},{key:"getVideoConstraints",value:function(e){var t={},n=e.videoDeviceId,r=e.videoTrackConstraints,a=e.facingMode,i=void 0===a?"user":a,o=e.frameRate,s=void 0===o?{ideal:24,max:30}:o;return t.video=r||kf.vga,"boolean"==typeof t.video||(n&&(t.video.deviceId={exact:n}),t.video.facingMode=i,t.video.frameRate=s),t}},{key:"getUserMediaWithTimeout",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r,a,i=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]?i[0]:{},n=i.length>1&&void 0!==i[1]?i[1]:0,e.prev=2,qp.info("getUserMediaWithTimeout::requesting_user_media",{timeout:n,constraints:JSON.stringify(t)}),n){e.next=8;break}return e.next=6,navigator.mediaDevices.getUserMedia(t);case 6:return r=e.sent,e.abrupt("return",(qp.info("getUserMediaWithTimeout::received_user_media",{timeout:n,constraints:JSON.stringify(t)}),r));case 8:return e.next=10,Promise.race([navigator.mediaDevices.getUserMedia(t),new Promise((function(e,t){setTimeout((function(){return t(new bh("Get user media timed out","ERR_GUM_TIMEOUT"))}),n)}))]);case 10:return a=e.sent,e.abrupt("return",(qp.info("getUserMediaWithTimeout::received_user_media",{timeout:n,constraints:JSON.stringify(t)}),a));case 14:throw e.prev=14,e.t0=e.catch(2),qp.error("getUserMediaWithTimeout::failed_to_access_local_media",{message:e.t0.message,constraints:JSON.stringify(t)}),qp.error("Failed to get access to local media.",{err:{name:e.t0.name,message:e.t0.message},constraints:JSON.stringify(t)}),new pf(e.t0.name,e.t0.message,t);case 17:case"end":return e.stop()}}),e,null,[[2,14]])})));return function(){return e.apply(this,arguments)}}()},{key:"getAudioTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Eh.getUserMediaWithTimeout(t);case 2:return e.abrupt("return",e.sent.getAudioTracks()[0]);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getVideoTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Eh.getUserMediaWithTimeout(t);case 2:return e.abrupt("return",e.sent.getVideoTracks()[0]);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getScreenShareTracks",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getDisplayMedia(t);case 2:return n=e.sent,e.abrupt("return",{video:n.getVideoTracks()[0],audio:n.getAudioTracks()[0]});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAudioAndVideoTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Eh.getUserMediaWithTimeout(t);case 2:return n=e.sent,e.abrupt("return",{audioTrack:n.getAudioTracks()[0],videoTrack:n.getVideoTracks()[0]});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),gh=new WeakMap,yh=new WeakMap,kh),Th=Eh;Sh([Gp.trace("LocalMediaUtils.onDeviceChange")],Th.prototype,"onDeviceChange",1),Sh([Gp.trace("LocalMediaUtils.repopulateAvailableDevices")],Th.prototype,"repopulateAvailableDevices",1),Sh([Gp.trace("LocalMediaUtils.isDeviceListAvailable")],Th,"isDeviceListAvailable",1),Sh([Gp.trace("LocalMediaUtils.enumerateDevices")],Th,"enumerateDevices",1),Sh([Gp.trace("LocalMediaUtils.getUserMediaWithTimeout")],Th,"getUserMediaWithTimeout",1),Sh([Gp.trace("LocalMediaUtils.getAudioTrack")],Th,"getAudioTrack",1),Sh([Gp.trace("LocalMediaUtils.getVideoTrack")],Th,"getVideoTrack",1),Sh([Gp.trace("LocalMediaUtils.getScreenShareTracks")],Th,"getScreenShareTracks",1),Sh([Gp.trace("LocalMediaUtils.getAudioAndVideoTrack")],Th,"getAudioAndVideoTrack",1);var xh=["virtual","emulator","krisp","solstice conference"];function Zh(e){var t=e.label.toLowerCase();return"macOS"===zp._bowser.getOSName()&&t.includes("iphone")?(qp.log("isVirtualDevice::ignore_macos_continuity"),!0):xh.some((function(e){return t.includes(e)}))}var Ch,Rh,Ph=Object.defineProperty,Ih=Object.getOwnPropertyDescriptor,Oh=function(e,t,n,r){for(var a,i=r>1?void 0:r?Ih(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Ph(t,n,i),i},Dh=function(){function e(t){(0,y.Z)(this,e),Xo(this,Ch,void 0),Ko(this,"audioMiddlewares",[]),Ko(this,"videoMiddlewares",[]),Xo(this,Rh,void 0),Yo(this,Ch,t)}return(0,k.Z)(e,[{key:"terminateMiddlewareWebWorker",value:function(){if(Qo(this,Rh))try{_a(Qo(this,Rh)),Yo(this,Rh,void 0)}catch(e){qp.debug("WorkerTimers::terminateMiddlewareWebWorker::failed")}}},{key:"getTransformedVideoTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u,p=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(n=this.videoMiddlewares)&&n.length){e.next=2;break}return e.abrupt("return",t);case 2:return e.next=4,Promise.all(null==(r=this.videoMiddlewares)?void 0:r.map((function(e){return e()})));case 4:a=e.sent,(i=new MediaStream).addTrack(t),o=document.createElement("canvas"),s=o.getContext("2d"),(c=document.createElement("video")).srcObject=i,c.autoplay=!0,this.terminateMiddlewareWebWorker(),u=function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Qo(p,Ch).videoEnabled&&"ended"!==t.readyState){e.next=3;break}return p.terminateMiddlewareWebWorker(),c.remove(),o.remove(),e.abrupt("return");case 3:e.prev=3,s.drawImage(c,0,0),n=0;case 6:if(!(n<a.length)){e.next=12;break}return e.next=9,a[n](o,s);case 9:n+=1,e.next=6;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),qp.error("getTransformedVideoTrack::middleware_execution_failed",{});case 17:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(){return e.apply(this,arguments)}}();try{c.play()}catch(f){}return e.abrupt("return",(c.addEventListener("play",(function(){o.width=c.width||t.getSettings().width,o.height=c.width||t.getSettings().height,Yo(p,Rh,Sa(u,50))}),!1),o.captureStream().getVideoTracks()[0]));case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addVideoMiddleware",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!zp.isSafari()){e.next=4;break}e.t0={success:!1,message:"Video middlewares are not yet supported in Safari."},e.next=22;break;case 4:if(!this.videoMiddlewares.includes(t)){e.next=8;break}e.t1={success:!0,message:"This video middleware has been applied, already. Skipping."},e.next=21;break;case 8:if(this.videoMiddlewares.push(t),!Qo(this,Ch).videoEnabled){e.next=19;break}return e.t3=Qo(this,Ch),e.next=13,this.getTransformedVideoTrack(Qo(this,Ch).rawVideoTrack);case 13:e.t4=e.sent,e.t3.setVideoTrack.call(e.t3,e.t4),Qo(this,Ch).emit("VIDEO_TRACK_CHANGE"),e.t2={success:!0,message:"Successfully applied the video middleware."},e.next=20;break;case 19:e.t2={success:!0,message:"Successfully added the video middleware. It will be applied automatically once webcam is turned on."};case 20:e.t1=e.t2;case 21:e.t0=e.t1;case 22:return e.abrupt("return",e.t0);case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"removeVideoMiddleware",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((n=this.videoMiddlewares.indexOf(t,0))>-1)){e.next=14;break}if(this.videoMiddlewares.splice(n,1),e.t1=Qo(this,Ch).videoEnabled,!e.t1){e.next=11;break}return e.t2=Qo(this,Ch),e.next=8,this.getTransformedVideoTrack(Qo(this,Ch).rawVideoTrack);case 8:e.t3=e.sent,e.t2.setVideoTrack.call(e.t2,e.t3),Qo(this,Ch).emit("VIDEO_TRACK_CHANGE");case 11:e.t0={success:!0,message:"Successfully removed the video middleware."},e.next=15;break;case 14:e.t0={success:!0,message:"No such video middleware was found. Skipping."};case 15:return e.abrupt("return",e.t0);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTransformedAudioTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(n=this.audioMiddlewares)&&n.length){e.next=2;break}return e.abrupt("return",t);case 2:return a=new AudioContext,e.next=5,Promise.all(null==(r=this.audioMiddlewares)?void 0:r.map((function(e){return e(a)})));case 5:for(i=e.sent,o=a.createMediaStreamSource(new MediaStream([t])),s=a.createMediaStreamDestination(),e.prev=8,c=o,u=0;u<i.length;u+=1)c.connect(i[u]),c=i[u];c.connect(s),e.next=17;break;case 14:return e.prev=14,e.t0=e.catch(8),e.abrupt("return",(qp.error("getTransformedAudioTrack::middleware_execution_failed",{}),t));case 17:return e.abrupt("return",s.stream.getAudioTracks()[0]);case 18:case"end":return e.stop()}}),e,this,[[8,14]])})));return function(t){return e.apply(this,arguments)}}()},{key:"addAudioMiddleware",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!zp.isSafari()){e.next=4;break}e.t0={success:!1,message:"Audio middlewares are not yet supported in Safari."},e.next=22;break;case 4:if(!this.audioMiddlewares.includes(t)){e.next=8;break}e.t1={success:!0,message:"This audio middleware has been applied, already. Skipping."},e.next=21;break;case 8:if(this.audioMiddlewares.push(t),!Qo(this,Ch).audioEnabled){e.next=19;break}return e.t3=Qo(this,Ch),e.next=13,this.getTransformedAudioTrack(Qo(this,Ch).rawAudioTrack);case 13:e.t4=e.sent,e.t3.setAudioTrack.call(e.t3,e.t4),Qo(this,Ch).emit("AUDIO_TRACK_CHANGE"),e.t2={success:!0,message:"Successfully applied the audio middleware."},e.next=20;break;case 19:e.t2={success:!0,message:"Successfully added the audio middleware. It will be applied automatically once mic is turned on."};case 20:e.t1=e.t2;case 21:e.t0=e.t1;case 22:return e.abrupt("return",e.t0);case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"removeAudioMiddleware",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!((n=this.audioMiddlewares.indexOf(t,0))>-1)){e.next=14;break}if(this.audioMiddlewares.splice(n,1),e.t1=Qo(this,Ch).audioEnabled,!e.t1){e.next=11;break}return e.t2=Qo(this,Ch),e.next=8,this.getTransformedAudioTrack(Qo(this,Ch).rawAudioTrack);case 8:e.t3=e.sent,e.t2.setAudioTrack.call(e.t2,e.t3),Qo(this,Ch).emit("AUDIO_TRACK_CHANGE");case 11:e.t0={success:!0,message:"Successfully removed the audio middleware."},e.next=15;break;case 14:e.t0={success:!0,message:"No such audio middleware was found. Skipping."};case 15:return e.abrupt("return",e.t0);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();Ch=new WeakMap,Rh=new WeakMap,Oh([Gp.trace("MediaMiddlewareUtils.getTransformedVideoTrack")],Dh.prototype,"getTransformedVideoTrack",1),Oh([Gp.trace("MediaMiddlewareUtils.addVideoMiddleware")],Dh.prototype,"addVideoMiddleware",1),Oh([Gp.trace("MediaMiddlewareUtils.removeVideoMiddleware")],Dh.prototype,"removeVideoMiddleware",1),Oh([Gp.trace("MediaMiddlewareUtils.getTransformedAudioTrack")],Dh.prototype,"getTransformedAudioTrack",1),Oh([Gp.trace("MediaMiddlewareUtils.addAudioMiddleware")],Dh.prototype,"addAudioMiddleware",1),Oh([Gp.trace("MediaMiddlewareUtils.removeAudioMiddleware")],Dh.prototype,"removeAudioMiddleware",1);var Mh=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise((function(t){return setTimeout(t,e)}))},Ah=function(e,t,n){var r="number"==typeof n?n:250,a=e.createMediaStreamSource(t),i=e.createAnalyser();i.fftSize=2048,a.connect(i);var o=new Uint8Array(i.fftSize),s=!1;return setTimeout((function(){s=!0}),r),function e(){return s?Promise.resolve(!0):(i.getByteTimeDomainData(o),o.some((function(e){return 128!==e&&0!==e}))?Promise.resolve(!1):Mh().then(e))}().then((function(e){return a.disconnect(),e}),(function(e){throw a.disconnect(),e}))},Nh="undefined"!=typeof AudioContext?AudioContext:null,Lh=new(function(){function e(t){(0,y.Z)(this,e),Ko(this,"_AudioContext"),Ko(this,"audioContext"),Ko(this,"_audioContextRefContainers");var n=(0,s.Z)({AudioContext:Nh},t);Object.defineProperties(this,{_AudioContext:{value:n.AudioContext},audioContext:{value:null,writable:!0},_audioContextRefContainers:{value:new Set},AudioContextProvider:{enumerable:!0,value:e}})}return(0,k.Z)(e,[{key:"getOrCreate",value:function(e){if(!this._audioContextRefContainers.has(e)&&(this._audioContextRefContainers.add(e),this._AudioContext&&!this.audioContext))try{this.audioContext=new this._AudioContext}catch(t){}return this.audioContext}},{key:"release",value:function(e){this._audioContextRefContainers.has(e)&&(this._audioContextRefContainers.delete(e),!this._audioContextRefContainers.size&&this.audioContext&&(this.audioContext.close(),this.audioContext=null))}}]),e}()),jh=3,Fh=250;function Uh(e){var t={},n=Lh.getOrCreate(t),r=jh;return function t(){return r-=1,Ah(n,e.srcObject,Fh).then((function(e){return!!e&&(!(r>0)||t())})).catch((function(){return!0}))}().finally((function(){Lh.release(t)}))}function Bh(e){return Vh.apply(this,arguments)}function Vh(){return Vh=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=new Audio,(r=new MediaStream).addTrack(t),n.srcObject=r,a=!1,e.prev=3,i=n.play(),e.t0=i,!e.t0){e.next=9;break}return e.next=9,i;case 9:return e.next=11,Uh(n);case 11:(a=e.sent)&&qp.info("checkIfAudioTrackIsSilent::silence_detected"),e.next=18;break;case 15:e.prev=15,e.t1=e.catch(3),qp.error("checkIfAudioTrackIsSilent::failed_to_detect_silence",e.t1);case 18:return e.prev=18,n.pause(),n.remove(),e.finish(18);case 21:return e.abrupt("return",a);case 22:case"end":return e.stop()}}),e,null,[[3,15,18,21]])}))),Vh.apply(this,arguments)}var Hh=function(){function e(){(0,y.Z)(this,e),Ko(this,"mediaPermissionEvent"),this.mediaPermissionEvent=!0}return(0,k.Z)(e,[{key:"shouldEmitMediaPermissionEvent",get:function(){return this.mediaPermissionEvent}},{key:"setEmitMediaPermissionEvent",value:function(e){this.mediaPermissionEvent=e}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();Ko(Hh,"instance");var zh,Wh,Gh,qh=Hh.getInstance(),$h={setItem:function(e,t){try{localStorage.setItem(e,t)}catch(n){qp.error("LocalStorage::setItem::crashed",{ex:n,key:e,value:t})}},getItem:function(e){try{return localStorage.getItem(e)}catch(t){qp.error("LocalStorage::getItem::crashed",{ex:t,key:e})}return null}},Kh=Object.defineProperty,Jh=Object.getOwnPropertyDescriptor,Qh=function(e,t,n,r){for(var a,i=r>1?void 0:r?Jh(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Kh(t,n,i),i},Xh=(Gh=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e,r){var a;return(0,y.Z)(this,n),a=t.call(this),Xo((0,v.Z)(a),zh,void 0),Xo((0,v.Z)(a),Wh,void 0),Ko((0,v.Z)(a),"mediaMiddlewareUtils"),Ko((0,v.Z)(a),"audioTrack"),Ko((0,v.Z)(a),"rawAudioTrack"),Ko((0,v.Z)(a),"videoTrack"),Ko((0,v.Z)(a),"rawVideoTrack"),Ko((0,v.Z)(a),"screenShareTracks"),Ko((0,v.Z)(a),"audioEnabled"),Ko((0,v.Z)(a),"videoEnabled"),Ko((0,v.Z)(a),"screenShareEnabled"),Ko((0,v.Z)(a),"currentDevices"),Ko((0,v.Z)(a),"permissions"),Ko((0,v.Z)(a),"audioUpdateInProgress"),Ko((0,v.Z)(a),"videoUpdateInProgress"),Ko((0,v.Z)(a),"screenShareUpdateInProgress"),Yo((0,v.Z)(a),zh,e),Yo((0,v.Z)(a),Wh,new If(r)),a.audioEnabled=!0,a.videoEnabled=!0,a.audioUpdateInProgress=!1,a.videoUpdateInProgress=!1,a.screenShareUpdateInProgress=!1,a.screenShareEnabled=!1,a.permissions={audio:"NOT_REQUESTED",video:"NOT_REQUESTED",screenshare:"NOT_REQUESTED"},a.screenShareTracks={audio:void 0,video:void 0},a.currentDevices={audio:void 0,video:void 0,speaker:void 0},Qo((0,v.Z)(a),zh).onDeviceChange((function(e,t){return a.onDeviceChange(t,!1)})),a.updateDevices(),a.conditionallyRestartAudio=a.conditionallyRestartAudio.bind((0,v.Z)(a)),a.conditionallyRestartVideo=a.conditionallyRestartVideo.bind((0,v.Z)(a)),a.onVisibilityChange=a.onVisibilityChange.bind((0,v.Z)(a)),document.addEventListener("visibilitychange",a.onVisibilityChange),a.on("AUDIO_TRACK_CHANGE",(function(){a.notifyIfTrackSilent()})),a}return(0,k.Z)(n,[{key:"handlePermissionErrors",value:function(e,t){var n=mf(t.name,t.message);this.permissions[e]=n,vf.emit(ff.MEDIA_PERMISSION_ERROR,{message:n,constraints:t.constraints,kind:e})}},{key:"onVisibilityChange",value:function(e){"visible"===document.visibilityState&&(zp.isMobile()&&this.conditionallyRestartAudio(),this.conditionallyRestartVideo()),Lc.tabChanged("visible"===document.visibilityState),"visible"!==document.visibilityState?Lc.browserBackgrounded():Lc.browserForegrounded()}},{key:"conditionallyRestartAudio",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(n=this.currentDevices)&&n.audio&&this.audioEnabled){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Promise.race([new Promise((function(e){var t;return null==(t=i.rawAudioTrack)?void 0:t.addEventListener("unmute",(function(t){e(t)}))})),new Promise((function(e){return setTimeout(e,50)}))]);case 4:return qp.info("performingCheck::shouldReacquireAudioTrack",{type:null==t?void 0:t.type}),e.next=7,this.shouldReacquireTrack("audio");case 7:if(a=e.sent,qp.info("performedCheck::shouldReacquireAudioTrack",{reacquireTrack:a}),e.t0=a,!e.t0){e.next=21;break}if(qp.info("reacquiring_audio_track"),this.removeMediaStreamTrackListeners(this.rawAudioTrack),e.t1=zp.isChromiumBased(),!e.t1){e.next=17;break}return e.next=17,Qo(this,zh).repopulateAvailableDevices();case 17:return e.next=19,this.setupAudioStream(null==(r=this.currentDevices.audio)?void 0:r.deviceId);case 19:this.addMediaStreamTrackListeners(this.rawAudioTrack),this.emit("AUDIO_TRACK_CHANGE");case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"conditionallyRestartVideo",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(n=this.currentDevices)&&n.video&&this.videoEnabled){e.next=2;break}return e.abrupt("return");case 2:return qp.info("performingCheck::shouldReacquireVideoTrack",{type:null==t?void 0:t.type}),e.next=5,Promise.race([new Promise((function(e){var t;return null==(t=a.rawVideoTrack)?void 0:t.addEventListener("unmute",e)})),new Promise((function(e){return setTimeout(e,50)}))]);case 5:return e.next=7,this.shouldReacquireTrack("video");case 7:if(r=e.sent,qp.info("performedCheck::shouldReacquireVideoTrack",{reacquireTrack:r}),e.t0=r,!e.t0){e.next=19;break}return qp.info("reacquiring_video_track"),this.removeMediaStreamTrackListeners(this.rawVideoTrack),e.next=15,Qo(this,zh).repopulateAvailableDevices();case 15:return e.next=17,this.setupVideoStream(this.currentDevices.video.deviceId);case 17:this.addMediaStreamTrackListeners(this.rawVideoTrack),this.emit("VIDEO_TRACK_CHANGE");case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"shouldReacquireTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!1,"audio"===t?(n=this.rawAudioTrack,r=this.audioEnabled):"video"===t&&(n=this.rawVideoTrack,r=this.videoEnabled),n){e.next=3;break}return e.abrupt("return",!1);case 3:if(a="ended"===n.readyState&&r&&!0,i=!1,e.t0="audio"===t,!e.t0){e.next=10;break}return e.next=9,Bh(this.rawAudioTrack);case 9:i=e.sent;case 10:return e.abrupt("return","visible"===document.visibilityState&&(n.muted||a||i));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onAudioUnmute",value:function(e){qp.info("audio_track_unmuted",{eventType:e.type})}},{key:"onVideoUnmute",value:function(e){qp.info("video_track_unmuted",{eventType:e.type})}},{key:"removeMediaStreamTrackListeners",value:function(e){if(qp.info("Removing listerners: ",{mediaStreamTrackKind:e.kind}),e){var t="audio"===e.kind?this.conditionallyRestartAudio:this.conditionallyRestartVideo;return e.removeEventListener("ended",t),e.removeEventListener("mute",t),e.removeEventListener("unmute","audio"===e.kind?this.onAudioUnmute:this.onVideoUnmute),e}}},{key:"addMediaStreamTrackListeners",value:function(e){var t=this;if(!e)return null;qp.info("adding_".concat(e.kind,"_stream_listerners"));var n="audio"===e.kind,r=n?this.conditionallyRestartAudio:this.conditionallyRestartVideo;return e.addEventListener("ended",(0,d.Z)((0,l.Z)().mark((function a(){var i,o,s;return(0,l.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,r();case 2:i=n?t.audioEnabled:t.videoEnabled,o=n?t.audioTrack:t.videoTrack,s=n?"FORCE_MUTE_AUDIO":"FORCE_MUTE_VIDEO",i&&(!o||"live"!==o.readyState||!o.enabled)&&(qp.info("LocalMediaHandler::trackEnded::Failed to restart track",{kind:e.kind}),t.emit(s));case 4:case"end":return a.stop()}}),a)})))),e.addEventListener("mute",r),e.addEventListener("unmute",n?this.onAudioUnmute:this.onVideoUnmute),e}},{key:"notifyIfTrackSilent",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.audioEnabled&&this.audioTrack&&"ended"!==this.audioTrack.readyState&&this.audioTrack.enabled,!e.t0){e.next=7;break}return e.next=4,Bh(this.audioTrack);case 4:e.t1=e.sent,e.t2=!0,e.t0=e.t1===e.t2;case 7:if(e.t3=e.t0,!e.t3){e.next=10;break}qp.info("LocalMediaHandler:notifyIfTrackSilent:TrackSilent",{audioEnabled:this.audioEnabled,deviceId:null==(n=null==(t=this.audioTrack)?void 0:t.getSettings())?void 0:n.deviceId}),this.emit("AUDIO_TRACK_SILENT");case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setupAudioStream",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!(u.length>1&&void 0!==u[1])||u[1],this.audioUpdateInProgress){e.next=42;break}if(e.prev=2,this.audioUpdateInProgress=!0,(o=Qo(this,zh).getAudioDevices()).length){e.next=7;break}return e.abrupt("return");case 7:if(s=t,e.t0=!s||!o.find((function(e){return e.deviceId===s})),!e.t0){e.next=14;break}return e.next=12,this.getPreferredDeviceId("AUDIO");case 12:s=e.sent,qp.debug("setupAudioStream::AUDIO::getPreferredDeviceId",{audioDeviceId:s});case 14:return c=Th.getAudioConstraints({audioDeviceId:s}),n&&(null==(r=this.rawAudioTrack)||r.stop(),null==(a=this.audioTrack)||a.stop()),e.next=18,Th.getAudioTrack(c);case 18:return this.rawAudioTrack=e.sent,s=this.rawAudioTrack.getSettings().deviceId,(null==(i=this.currentDevices.audio)?void 0:i.deviceId)!==s&&(this.currentDevices.audio=Qo(this,zh).getDeviceById(s,"audioinput"),this.emit("DEVICE_CHANGE",{device:this.currentDevices.audio})),this.rawAudioTrack.enabled=this.audioEnabled,e.t1=this,e.next=25,this.mediaMiddlewareUtils.getTransformedAudioTrack(this.rawAudioTrack);case 25:return e.t2=e.sent,e.t1.setAudioTrack.call(e.t1,e.t2),this.addMediaStreamTrackListeners(this.rawAudioTrack),e.next=30,Qo(this,zh).repopulateAvailableDevices();case 30:this.permissions.audio="ACCEPTED",Lc.mediaPermission("AUDIO",Es.ACCEPTED),Lc.selectedDevice("AUDIO",this.currentDevices.audio),s&&$h.setItem("lastUsedAudioDeviceId",s),e.next=39;break;case 36:e.prev=36,e.t3=e.catch(2),this.handlePermissionErrors("audio",e.t3);case 39:return e.prev=39,this.audioUpdateInProgress=!1,e.finish(39);case 42:case"end":return e.stop()}}),e,this,[[2,36,39,42]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getPreferredDeviceId",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u,d;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("AUDIO"!==t){e.next=14;break}if(i=Qo(this,zh).getAudioDevices(),o=$h.getItem("lastUsedAudioDeviceId"),qp.debug("getPreferredDeviceId::lastUsedAudioDeviceId",{audioDeviceId:o}),o&&(s=i.find((function(e){return e.deviceId===o}))),!s){e.next=8;break}a=o,e.next=13;break;case 8:if(e.t0=Vc.hasFeature(Sp.REMOVE_OPERATIONAL_MIC),e.t0){e.next=13;break}return e.next=12,this.getOperationalMicDeviceId();case 12:a=e.sent.deviceId;case 13:a||(a=null==(n=i[0])?void 0:n.deviceId);case 14:if("VIDEO"!==t){e.next=27;break}if(c=$h.getItem("lastUsedVideoDeviceId"),qp.debug("getPreferredDeviceId::lastUsedVideoDeviceId",{videoDeviceId:c}),u=Qo(this,zh).getVideoDevices(),c&&(d=u.find((function(e){return e.deviceId===c}))),!d){e.next=23;break}a=c,e.next=26;break;case 23:return e.next=25,this.getOperationalWebcamDeviceId();case 25:a=e.sent.deviceId;case 26:a||(a=null==(r=u[0])?void 0:r.deviceId);case 27:return e.abrupt("return",a);case 28:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupVideoStream",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!(c.length>1&&void 0!==c[1])||c[1],this.videoUpdateInProgress){e.next=42;break}if(e.prev=2,this.videoUpdateInProgress=!0,(i=Qo(this,zh).getVideoDevices()).length){e.next=7;break}return e.abrupt("return");case 7:if(o=t,e.t0=!o||!i.find((function(e){return e.deviceId===o})),!e.t0){e.next=14;break}return e.next=12,this.getPreferredDeviceId("VIDEO");case 12:o=e.sent,qp.debug("setupVideoStream::VIDEO::getPreferredDeviceId",{videoDeviceId:o});case 14:if(n&&(null==(r=this.videoTrack)||r.stop()),!this.videoEnabled){e.next=27;break}return s=Qo(this,Wh).getVideoConstraints(o),e.next=19,Th.getVideoTrack(s);case 19:return this.rawVideoTrack=e.sent,o=this.rawVideoTrack.getSettings().deviceId,e.t1=this,e.next=24,this.mediaMiddlewareUtils.getTransformedVideoTrack(this.rawVideoTrack);case 24:e.t2=e.sent,e.t1.setVideoTrack.call(e.t1,e.t2),this.addMediaStreamTrackListeners(this.rawVideoTrack);case 27:return e.next=29,Qo(this,zh).repopulateAvailableDevices();case 29:(null==(a=this.currentDevices.video)?void 0:a.deviceId)!==o&&(this.currentDevices.video=Qo(this,zh).getDeviceById(o,"videoinput"),this.emit("DEVICE_CHANGE",{device:this.currentDevices.video})),this.permissions.video="ACCEPTED",Lc.mediaPermission("VIDEO",Es.ACCEPTED),Lc.selectedDevice("VIDEO",this.currentDevices.video),o&&$h.setItem("lastUsedVideoDeviceId",o),e.next=39;break;case 36:e.prev=36,e.t3=e.catch(2),this.handlePermissionErrors("video",e.t3);case 39:return e.prev=39,this.videoUpdateInProgress=!1,e.finish(39);case 42:case"end":return e.stop()}}),e,this,[[2,36,39,42]])})));return function(t){return e.apply(this,arguments)}}()},{key:"setupScreenShareStreams",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.screenShareUpdateInProgress){e.next=2;break}return e.abrupt("return");case 2:return t=Qo(this,Wh).getScreenShareConstraints(),Vc.hasFeature(Sp.SCREENSHARE_MAX_DIMENSIONS)&&(t.video.width.max=window.screen.width,t.video.height.max=window.screen.height),e.prev=4,this.screenShareUpdateInProgress=!0,e.next=8,Th.getScreenShareTracks(t);case 8:n=e.sent,this.setScreenShareTracks(n),e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(4),this.handlePermissionErrors("screenshare",new pf(e.t0.name,e.t0.message,t)),new Jp(e.t0.message);case 15:return e.prev=15,this.screenShareUpdateInProgress=!1,e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[4,12,15,18]])})));return function(){return e.apply(this,arguments)}}()},{key:"setupSpeaker",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=Qo(this,zh).getSpeakerDevices()).length){e.next=3;break}return e.abrupt("return");case 3:a=null!=t?t:r[0].deviceId,(null==(n=this.currentDevices.speaker)?void 0:n.deviceId)!==a&&(this.currentDevices.speaker=Qo(this,zh).getDeviceById(a,"audiooutput"),Lc.selectedDevice("SPEAKER",this.currentDevices.speaker),this.emit("DEVICE_CHANGE",{device:this.currentDevices.speaker})),document.querySelectorAll("audio").forEach(function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"==typeof t.sinkId||!i.currentDevices.speaker.deviceId||t.sinkId===i.currentDevices.speaker.deviceId){e.next=8;break}return e.prev=1,e.next=4,t.setSinkId(i.currentDevices.speaker.deviceId);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getOperationalWebcamDeviceId",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r,a,i,o,s=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=Qo(this,zh).getVideoDevices()).length){e.next=3;break}return e.abrupt("return",{isOperational:!1,deviceId:null});case 3:return qh.setEmitMediaPermissionEvent(!1),n=[],e.next=7,t.reduce(function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,r){var a,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:if(null===(a=e.sent)){e.next=5;break}return e.abrupt("return",a);case 5:return i=Qo(s,Wh).getVideoConstraints(r.deviceId),e.prev=6,e.next=9,Th.getVideoTrack(i);case 9:return e.sent.stop(),e.abrupt("return",r.deviceId);case 13:e.prev=13,e.t0=e.catch(6),qp.error("could_not_acquire_video_device",{deviceId:r.deviceId}),n.push({exception:e.t0,constraints:i});case 16:return e.abrupt("return",a);case 17:case"end":return e.stop()}}),e,null,[[6,13]])})));return function(t,n){return e.apply(this,arguments)}}(),Promise.resolve(null));case 7:if(r=e.sent,qh.setEmitMediaPermissionEvent(!0),r||!(n.length>0)||n.length!==t.length){e.next=11;break}throw a=n[0],i=a.exception,o=a.constraints,new pf(i.name,i.message,o);case 11:return e.abrupt("return",r?{isOperational:!0,deviceId:r}:{isOperational:!1,deviceId:t[0].deviceId});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getOperationalMicDeviceId",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r,a,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=Qo(this,zh).getAudioDevices()).length){e.next=3;break}return e.abrupt("return",{isOperational:!1,deviceId:null});case 3:return n=[],qh.setEmitMediaPermissionEvent(!1),e.next=7,t.reduce(function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,r){var a,i,o,s;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t;case 2:if(null===(a=e.sent)){e.next=5;break}return e.abrupt("return",a);case 5:return i=Th.getAudioConstraints({audioDeviceId:r.deviceId}),e.prev=6,e.next=9,Th.getAudioTrack(i);case 9:return o=e.sent,e.next=12,Bh(o);case 12:if(s=e.sent,null==o||o.stop(),s){e.next=15;break}return e.abrupt("return",r);case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(6),qp.error("could_not_acquire_audio_device",{deviceId:r.deviceId}),n.push({exception:e.t0,constraints:i});case 20:return e.abrupt("return",a);case 21:case"end":return e.stop()}}),e,null,[[6,17]])})));return function(t,n){return e.apply(this,arguments)}}(),Promise.resolve(null));case 7:if(r=e.sent,qh.setEmitMediaPermissionEvent(!0),r||!(n.length>0)||n.length!==t.length){e.next=11;break}throw a=n[0],i=a.exception,o=a.constraints,new pf(i.name,i.message,o);case 11:return e.abrupt("return",r?{isOperational:!0,deviceId:r.deviceId}:{isOperational:!1,deviceId:t[0].deviceId});case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setupStreams",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u,d,p,f;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.audio,r=t.video,i={},this.currentDevices||(this.currentDevices={audio:void 0,video:void 0,speaker:void 0}),e.prev=3,!n||this.audioUpdateInProgress||0===Qo(this,zh).getAudioDevices().length){e.next=11;break}return e.next=7,this.getPreferredDeviceId("AUDIO");case 7:o=e.sent,qp.debug("setupStreams::AUDIO::getPreferredDeviceId",{audioDeviceId:o}),s=Th.getAudioConstraints({audioDeviceId:o}),i.audio=s.audio;case 11:if(!r||this.videoUpdateInProgress||0===Qo(this,zh).getVideoDevices().length){e.next=18;break}return e.next=14,this.getPreferredDeviceId("VIDEO");case 14:c=e.sent,qp.debug("setupStreams::VIDEO::getPreferredDeviceId",{videoDeviceId:c}),u=Qo(this,Wh).getVideoConstraints(c),i.video=u.video;case 18:if(0!==(null==(a=Object.keys(i))?void 0:a.length)){e.next=21;break}return this.audioEnabled=null!=n?n:this.audioEnabled,this.videoEnabled=null!=r?r:this.videoEnabled,this.audioUpdateInProgress=!1,this.videoUpdateInProgress=!1,e.abrupt("return");case 21:return e.next=23,Th.getAudioAndVideoTrack(i);case 23:return d=e.sent,p=d.audioTrack,f=d.videoTrack,n&&p&&(this.audioTrack=p,this.rawAudioTrack=p,this.permissions.audio="ACCEPTED",this.currentDevices.audio=Qo(this,zh).getDeviceById(p.getSettings().deviceId,"audioinput"),$h.setItem("lastUsedAudioDeviceId",p.getSettings().deviceId)),r&&f&&(this.videoTrack=f,this.rawVideoTrack=f,this.permissions.video="ACCEPTED",this.currentDevices.video=Qo(this,zh).getDeviceById(f.getSettings().deviceId,"videoinput"),$h.setItem("lastUsedVideoDeviceId",f.getSettings().deviceId)),e.next=30,Qo(this,zh).repopulateAvailableDevices();case 30:e.next=44;break;case 32:if(e.prev=32,e.t0=e.catch(3),e.t1="NotAllowedError"===e.t0.name,!e.t1){e.next=44;break}if(e.t2=n,!e.t2){e.next=40;break}return e.next=40,this.setupAudioStream();case 40:if(e.t3=r,!e.t3){e.next=44;break}return e.next=44,this.setupVideoStream();case 44:return this.audioEnabled=!!this.audioTrack,this.videoEnabled=!!this.videoTrack,this.screenShareEnabled=!1,this.audioUpdateInProgress=!1,this.videoUpdateInProgress=!1,e.next=51,this.setupSpeaker();case 51:case"end":return e.stop()}}),e,this,[[3,32]])})));return function(t){return e.apply(this,arguments)}}()},{key:"stopAudioTrack",value:function(){var e,t;this.audioUpdateInProgress||(this.audioUpdateInProgress=!0,null==(e=this.audioTrack)||e.stop(),null==(t=this.rawAudioTrack)||t.stop(),this.audioEnabled=!1,this.audioUpdateInProgress=!1)}},{key:"stopVideoTrack",value:function(){var e,t;this.videoUpdateInProgress||(this.videoUpdateInProgress=!0,null==(e=this.videoTrack)||e.stop(),null==(t=this.rawVideoTrack)||t.stop(),this.videoEnabled=!1,this.videoUpdateInProgress=!1)}},{key:"stopScreenShareTracks",value:function(){var e,t,n,r,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.screenShareUpdateInProgress){this.screenShareUpdateInProgress=!0;var i=a.audio,o=void 0===i||i,s=a.video,c=void 0===s||s;o&&(null==(t=null==(e=this.screenShareTracks)?void 0:e.audio)||t.stop()),c&&(null==(r=null==(n=this.screenShareTracks)?void 0:n.video)||r.stop()),this.screenShareEnabled=!1,this.screenShareUpdateInProgress=!1}}},{key:"removeAudioTrack",value:function(){this.stopAudioTrack(),this.audioTrack=void 0,this.rawAudioTrack=void 0}},{key:"removeVideoTrack",value:function(){this.stopVideoTrack(),this.videoTrack=void 0,this.rawVideoTrack=void 0}},{key:"removeScreenShareTracks",value:function(e){var t;null==(t=this.screenShareTracks.video)||t.removeEventListener("ended",this.onScreenShareEnded),this.stopScreenShareTracks(e),this.screenShareTracks={audio:void 0,video:void 0}}},{key:"removeAllTracks",value:function(){this.removeAudioTrack(),this.removeVideoTrack(),this.removeScreenShareTracks({audio:!!this.screenShareTracks.audio,video:!!this.screenShareTracks.video})}},{key:"setAudioTrack",value:function(e){e!==this.audioTrack&&(void 0===e&&this.stopAudioTrack(),this.audioTrack=e,this.audioTrack&&(this.audioTrack.enabled=this.audioEnabled))}},{key:"setVideoTrack",value:function(e){e!==this.videoTrack&&(void 0===e&&this.stopVideoTrack(),this.videoTrack=e)}},{key:"setScreenShareTracks",value:function(e){var t,n=e.audio,r=e.video;(!n||!r)&&this.stopScreenShareTracks({audio:!!n,video:!!r}),this.screenShareTracks=e,null==(t=this.screenShareTracks.video)||t.addEventListener("ended",this.onScreenShareEnded.bind(this))}},{key:"onScreenShareEnded",value:function(){this.emit("SCREENSHARE_ENDED")}},{key:"disableAudio",value:function(){this.audioEnabled=!1,this.audioTrack&&(this.audioTrack.enabled=this.audioEnabled),this.rawAudioTrack&&(this.rawAudioTrack.enabled=this.audioEnabled)}},{key:"enableAudio",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("DENIED"!==this.permissions.audio){e.next=3;break}return this.audioEnabled=!1,e.abrupt("return");case 3:if(e.prev=3,e.t0=!this.audioTrack||"ended"===this.audioTrack.readyState,!e.t0){e.next=8;break}return e.next=8,this.setupAudioStream(null==(t=this.currentDevices.audio)?void 0:t.deviceId);case 8:if(this.audioTrack&&this.rawAudioTrack){e.next=11;break}return this.audioEnabled=!1,qp.error("LocalMediaHandler::enableAudio:Setting up audio stream failed while enabling audio",{permissions:this.permissions}),e.abrupt("return");case 11:this.audioEnabled=!0,e.next=17;break;case 14:e.prev=14,e.t1=e.catch(3),this.audioEnabled=!1,this.audioTrack=void 0,this.rawAudioTrack=void 0,qp.error("LocalMediaHandler::enableAudio",{message:e.t1.message,stack:e.t1.stack},!0);case 17:this.audioTrack&&(this.audioTrack.enabled=!0),this.rawAudioTrack&&(this.rawAudioTrack.enabled=!0);case 18:case"end":return e.stop()}}),e,this,[[3,14]])})));return function(){return e.apply(this,arguments)}}()},{key:"toggleAudio",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("DENIED"!==this.permissions.audio){e.next=3;break}return this.audioEnabled=!1,e.abrupt("return");case 3:if(e.prev=3,e.t0=!this.audioTrack||"ended"===this.audioTrack.readyState,!e.t0){e.next=8;break}return e.next=8,this.setupAudioStream(null==(t=this.currentDevices.audio)?void 0:t.deviceId);case 8:if(this.audioTrack&&this.rawAudioTrack){e.next=11;break}return this.audioEnabled=!1,e.abrupt("return");case 11:this.audioEnabled=!this.audioEnabled,e.next=17;break;case 14:e.prev=14,e.t1=e.catch(3),this.audioEnabled=!1,qp.error("LocalMediaHandler::toggleAudio",{message:e.t1.message,stack:e.t1.stack},!0);case 17:this.audioTrack&&(this.audioTrack.enabled=this.audioEnabled),this.rawAudioTrack&&(this.rawAudioTrack.enabled=this.audioEnabled);case 18:case"end":return e.stop()}}),e,this,[[3,14]])})));return function(){return e.apply(this,arguments)}}()},{key:"toggleVideo",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("DENIED"!==this.permissions.video){e.next=3;break}return this.videoEnabled=!1,e.abrupt("return");case 3:if(!this.videoEnabled){e.next=6;break}return this.removeVideoTrack(),e.abrupt("return");case 6:return this.videoEnabled=!0,e.prev=7,e.next=10,this.setupVideoStream(null==(t=this.currentDevices.video)?void 0:t.deviceId);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(7),this.videoEnabled=!1;case 15:this.videoTrack&&(this.videoTrack.enabled=this.videoEnabled),this.rawVideoTrack&&(this.rawVideoTrack.enabled=this.videoEnabled);case 16:case"end":return e.stop()}}),e,this,[[7,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"toggleScreenShare",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.screenShareEnabled){e.next=3;break}return this.removeScreenShareTracks({audio:!!this.screenShareTracks.audio,video:!!this.screenShareTracks.video}),e.abrupt("return");case 3:return e.prev=3,e.next=6,this.setupScreenShareStreams();case 6:this.screenShareEnabled=!0,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),this.screenShareEnabled=!1;case 12:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"getAllDevices",value:function(){return Qo(this,zh).availableDevices}},{key:"getDeviceById",value:function(e,t){return Qo(this,zh).getDeviceById(e,t)}},{key:"getAudioDevices",value:function(){return Qo(this,zh).getAudioDevices()}},{key:"getVideoDevices",value:function(){return Qo(this,zh).getVideoDevices()}},{key:"getSpeakerDevices",value:function(){return Qo(this,zh).getSpeakerDevices()}},{key:"onDeviceChange",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a,i=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(r=null==t?void 0:t.added)||r.forEach(function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t&&(n||!Zh(t)),!e.t0){e.next=18;break}if("audioinput"!==t.kind){e.next=8;break}return e.next=5,i.setupAudioStream(t.deviceId);case 5:i.emit("AUDIO_TRACK_CHANGE"),e.next=18;break;case 8:if("videoinput"!==t.kind){e.next=14;break}return e.next=11,i.setupVideoStream(t.deviceId);case 11:i.emit("VIDEO_TRACK_CHANGE"),e.next=18;break;case 14:if(e.t1="audiooutput"===t.kind,!e.t1){e.next=18;break}return e.next=18,i.setupSpeaker(t.deviceId);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),null==(a=null==t?void 0:t.removed)||a.forEach(function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t,!e.t0){e.next=19;break}if(e.t1=Vc.hasFeature(Sp.DEVICE_REMOVE_EXP)||!zp.isChromiumBased(),!e.t1){e.next=15;break}if("audioinput"!==t.kind||t.deviceId!==(null==(n=i.currentDevices.audio)?void 0:n.deviceId)){e.next=10;break}return e.next=7,i.setupAudioStream();case 7:i.emit("AUDIO_TRACK_CHANGE"),e.next=15;break;case 10:if(e.t2="videoinput"===t.kind&&t.deviceId===(null==(r=i.currentDevices.video)?void 0:r.deviceId),!e.t2){e.next=15;break}return e.next=14,i.setupVideoStream();case 14:i.emit("VIDEO_TRACK_CHANGE");case 15:if(e.t3="audiooutput"===t.kind&&t.deviceId===(null==(a=i.currentDevices.speaker)?void 0:a.deviceId),!e.t3){e.next=19;break}return e.next=19,i.setupSpeaker();case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateDevices",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r,a,i,o,s=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("firefox"!==zp.getName()){e.next=2;break}return e.abrupt("return");case 2:return"microphone",r="camera",e.next=6,null==(t=null==navigator?void 0:navigator.permissions)?void 0:t.query({name:"microphone"});case 6:return a=e.sent,e.next=9,null==(n=null==navigator?void 0:navigator.permissions)?void 0:n.query({name:r});case 9:i=e.sent,o=function(){Qo(s,zh).repopulateAvailableDevices()},a&&(a.onchange=o),i&&(i.onchange=o);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"emit",value:function(e){for(var t,r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return(t=f((0,p.Z)(n.prototype),"emit",this)).call.apply(t,[this,e].concat(a))}},{key:"on",value:function(e,t){return f((0,p.Z)(n.prototype),"on",this).call(this,e,t)}},{key:"removeDocumentEventListeners",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:document.removeEventListener("visibilitychange",this.onVisibilityChange);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addAudioMiddleware",value:function(e){return this.mediaMiddlewareUtils.addAudioMiddleware(e)}},{key:"removeAudioMiddleware",value:function(e){return this.mediaMiddlewareUtils.removeAudioMiddleware(e)}},{key:"addVideoMiddleware",value:function(e){return this.mediaMiddlewareUtils.addVideoMiddleware(e)}},{key:"removeVideoMiddleware",value:function(e){return this.mediaMiddlewareUtils.removeVideoMiddleware(e)}},{key:"enableVideo",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.toggleVideo();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"disableVideo",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.toggleVideo();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"enableScreenShare",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.toggleScreenShare();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"disableScreenShare",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.toggleScreenShare();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCurrentDevices",value:function(){return this.currentDevices}},{key:"destruct",value:function(){this.mediaMiddlewareUtils.terminateMiddlewareWebWorker(),Qo(this,zh).destruct()}}],[{key:"init",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Th.init();case 2:return n=e.sent,r=new Xh(n,t),a=new Dh(r),e.abrupt("return",(r.mediaMiddlewareUtils=a,r));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),n}(is.EventEmitter),zh=new WeakMap,Wh=new WeakMap,Gh),Yh=Xh;Qh([Gp.trace("OldMediaHandler.shouldReacquireTrack")],Yh.prototype,"shouldReacquireTrack",1),Qh([Gp.trace("OldMediaHandler.removeMediaStreamTrackListeners")],Yh.prototype,"removeMediaStreamTrackListeners",1),Qh([Gp.trace("OldMediaHandler.addMediaStreamTrackListeners")],Yh.prototype,"addMediaStreamTrackListeners",1),Qh([Gp.trace("OldMediaHandler.setupAudioStream")],Yh.prototype,"setupAudioStream",1),Qh([Gp.trace("OldMediaHandler.getPreferredDeviceId")],Yh.prototype,"getPreferredDeviceId",1),Qh([Gp.trace("OldMediaHandler.setupVideoStream")],Yh.prototype,"setupVideoStream",1),Qh([Gp.trace("OldMediaHandler.setupScreenShareStreams")],Yh.prototype,"setupScreenShareStreams",1),Qh([Gp.trace("OldMediaHandler.setupSpeaker")],Yh.prototype,"setupSpeaker",1),Qh([Gp.trace("OldMediaHandler.getOperationalWebcamDeviceId")],Yh.prototype,"getOperationalWebcamDeviceId",1),Qh([Gp.trace("OldMediaHandler.getOperationalMicDeviceId")],Yh.prototype,"getOperationalMicDeviceId",1),Qh([Gp.trace("OldMediaHandler.setupStreams")],Yh.prototype,"setupStreams",1),Qh([Gp.trace("OldMediaHandler.stopAudioTrack")],Yh.prototype,"stopAudioTrack",1),Qh([Gp.trace("OldMediaHandler.stopVideoTrack")],Yh.prototype,"stopVideoTrack",1),Qh([Gp.trace("OldMediaHandler.stopScreenShareTracks")],Yh.prototype,"stopScreenShareTracks",1),Qh([Gp.trace("OldMediaHandler.removeAudioTrack")],Yh.prototype,"removeAudioTrack",1),Qh([Gp.trace("OldMediaHandler.removeVideoTrack")],Yh.prototype,"removeVideoTrack",1),Qh([Gp.trace("OldMediaHandler.removeScreenShareTracks")],Yh.prototype,"removeScreenShareTracks",1),Qh([Gp.trace("OldMediaHandler.removeAllTracks")],Yh.prototype,"removeAllTracks",1),Qh([Gp.trace("OldMediaHandler.setAudioTrack")],Yh.prototype,"setAudioTrack",1),Qh([Gp.trace("OldMediaHandler.setVideoTrack")],Yh.prototype,"setVideoTrack",1),Qh([Gp.trace("OldMediaHandler.setScreenShareTracks")],Yh.prototype,"setScreenShareTracks",1),Qh([Gp.trace("OldMediaHandler::disableAudio")],Yh.prototype,"disableAudio",1),Qh([Gp.trace("OldMediaHandler::enableAudio")],Yh.prototype,"enableAudio",1),Qh([Gp.trace("OldMediaHandler.toggleAudio")],Yh.prototype,"toggleAudio",1),Qh([Gp.trace("OldMediaHandler.toggleVideo")],Yh.prototype,"toggleVideo",1),Qh([Gp.trace("OldMediaHandler.toggleScreenShare")],Yh.prototype,"toggleScreenShare",1);var ev,tv=function(e){return e.allowed="ALLOWED",e.notAllowed="NOT_ALLOWED",e.canRequest="CAN_REQUEST",e}(tv||{}),nv=Zf({view_type:op.GroupCall,accept_waiting_requests:!1,request_produce:!1,can_allow_participant_audio:!0,can_allow_participant_screensharing:!1,can_allow_participant_video:!0,request_kick_participant:!1,kick_participant:!0,pin_participant:!0,can_record:!1,waiting_room_type:"SKIP",plugins:{can_close:!0,can_start:!0,can_edit_acl:!1,config:{}},polls:{can_create:!0,can_vote:!0,can_view:!0},produce:{video:{allow:!0,quality:Pf.video.quality,frame_rate:Pf.video.frameRate},audio:!0,screenshare:{allow:!0,quality:Pf.screenshare.quality,frame_rate:Pf.screenshare.frameRate}},chat:{public:{can_send:!0,text:!0,files:!0},private:{can_send:!1,can_receive:!1,text:!1,files:!1}},reactions:!1,hidden_participant:!1,show_participant_list:!0,can_change_participant_role:!0,can_change_theme:!1,can_present:!1,accept_present_requests:!1,can_edit_display_name:!1,max_screenshare_count:1,is_recorder:!1,can_spotlight:!1}),rv=function(){function e(t){if((0,y.Z)(this,e),Xo(this,ev,void 0),!t)throw qp.error("DytePermissionsPresetV1::load_preset_permissions_failed"),new Jp("Could not load preset permissions.");Yo(this,ev,t)}return(0,k.Z)(e,[{key:"viewType",get:function(){return Qo(this,ev).viewType}},{key:"acceptWaitingRequests",get:function(){return Qo(this,ev).acceptWaitingRequests}},{key:"requestProduce",get:function(){return Qo(this,ev).requestProduce}},{key:"requestProduceAudio",get:function(){return this.requestProduce}},{key:"requestProduceScreenshare",get:function(){return this.requestProduce}},{key:"canAllowParticipantAudio",get:function(){return Qo(this,ev).canAllowParticipantAudio}},{key:"canAllowParticipantScreensharing",get:function(){return Qo(this,ev).canAllowParticipantScreensharing}},{key:"canAllowParticipantVideo",get:function(){return Qo(this,ev).canAllowParticipantVideo}},{key:"kickParticipant",get:function(){return Qo(this,ev).kickParticipant}},{key:"pinParticipant",get:function(){return Qo(this,ev).pinParticipant}},{key:"canRecord",get:function(){return Qo(this,ev).canRecord}},{key:"waitingRoomType",get:function(){return Qo(this,ev).waitingRoomType}},{key:"waitingRoomBehaviour",get:function(){return"SKIP"===Qo(this,ev).waitingRoomType?"SKIP":"SKIP_ON_PRIVILEGED_USER_ENTRY"===Qo(this,ev).waitingRoomType?"ON_PRIVILEGED_USER_ENTRY":"ON_ACCEPT"===Qo(this,ev).waitingRoomType?"SKIP_ON_ACCEPT":"SKIP"}},{key:"plugins",get:function(){return Qo(this,ev).plugins}},{key:"polls",get:function(){return(0,s.Z)((0,s.Z)({},Qo(this,ev).polls),{},{canViewResults:Qo(this,ev).polls.canView})}},{key:"produceVideo",get:function(){return(0,s.Z)((0,s.Z)({},Qo(this,ev).produce.video),{},{allow:Qo(this,ev).produce.video.allow?"ALLOWED":"NOT_ALLOWED"})}},{key:"canProduceVideo",get:function(){var e=Qo(this,ev).produce.video.allow;return this.requestProduce?"CAN_REQUEST":e?"ALLOWED":"NOT_ALLOWED"}},{key:"produceScreenshare",get:function(){return(0,s.Z)((0,s.Z)({},Qo(this,ev).produce.screenshare),{},{allow:Qo(this,ev).produce.screenshare.allow?"ALLOWED":"NOT_ALLOWED"})}},{key:"canProduceScreenshare",get:function(){var e=Qo(this,ev).produce.screenshare.allow;return this.requestProduce?"CAN_REQUEST":e?"ALLOWED":"NOT_ALLOWED"}},{key:"produceAudio",get:function(){return Qo(this,ev).produce.audio?"ALLOWED":"NOT_ALLOWED"}},{key:"canProduceAudio",get:function(){var e=Qo(this,ev).produce.audio;return this.requestProduce?"CAN_REQUEST":e?"ALLOWED":"NOT_ALLOWED"}},{key:"chatPublic",get:function(){return Qo(this,ev).chat.public}},{key:"chatPrivate",get:function(){return Qo(this,ev).chat.private}},{key:"connectedMeetings",get:function(){return{canAlterConnectedMeetings:!1,canSwitchConnectedMeetings:!1,canSwitchToParentMeeting:!1}}},{key:"reactions",get:function(){return Qo(this,ev).reactions}},{key:"hiddenParticipant",get:function(){return Qo(this,ev).hiddenParticipant}},{key:"showParticipantList",get:function(){return Qo(this,ev).showParticipantList}},{key:"canChangeParticipantRole",get:function(){return Qo(this,ev).canChangeParticipantRole}},{key:"canChangeTheme",get:function(){return Qo(this,ev).canChangeTheme}},{key:"canPresent",get:function(){return Qo(this,ev).canPresent}},{key:"acceptPresentRequests",get:function(){return Qo(this,ev).acceptPresentRequests}},{key:"canEditDisplayName",get:function(){return Qo(this,ev).canEditDisplayName}},{key:"maxScreenShareCount",get:function(){return Qo(this,ev).maxScreenshareCount}},{key:"isRecorder",get:function(){return Qo(this,ev).isRecorder}},{key:"canLivestream",get:function(){return!1}},{key:"canSpotlight",get:function(){return Qo(this,ev).canSpotlight}},{key:"isV2",get:function(){return!1}}],[{key:"fromResponse",value:function(t){return new e(t)}},{key:"default",value:function(){return new e(nv)}}]),e}();ev=new WeakMap;var av={isV2AuthToken:!1,meetingId:null,overrides:{}},iv={baseURL:"http://localhost:5000",createdAt:"2021-08-05T10:49:56.602Z",description:"Develop plugins locally",id:"09259e3b-7be8-46f6-9801-106bf1866e1c",name:"Localhost Dev",organizationId:"4ad15a19-80e2-4105-bf43-48039fd2963e",picture:"https://dyte-uploads.s3.ap-south-1.amazonaws.com/dyte.png",private:!1,published:!0,staggered:!1,tags:["#localhost","#dev"],type:"self_hosted",updatedAt:"2021-08-05T10:50:07.681Z"};function ov(e,t){if(t)av.isV2AuthToken=!1;else try{var n=JSON.parse(atob(e.split(".")[1])).meetingId;if(!n)throw Error("Received V1 auth token ".concat(e));av.isV2AuthToken=!0,av.meetingId=n}catch(n){throw qp.error("constants::setIsV2AuthToken",{reason:"Unable to decode auth token",authToken:e,exception:n},!0),new Jp("Invalid auth token")}}function sv(e){return av.isV2AuthToken&&e===op.Livestream||["socket-service","socket-service"].includes("socket-service")}function cv(e){av.overrides=e}function uv(e){return!(!av.overrides||!av.overrides[e])&&av.overrides[e]}var lv,dv,pv=function(e){return e.REQUESTED_BY_PARTICIPANT="REQUESTED_BY_PARTICIPANT",e.REQUESTED_BY_MODERATOR="REQUESTED_BY_MODERATOR",e}(pv||{}),fv=function(e){return e.PRESENT="REQUEST_TO_PRESENT",e}(fv||{});!function(e){e[e.PUBLISHER=0]="PUBLISHER",e[e.SUBSCRIBER=1]="SUBSCRIBER"}(lv||(lv={})),function(e){e[e.AUDIO=0]="AUDIO",e[e.VIDEO=1]="VIDEO"}(dv||(dv={})),new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.Pair",[{no:1,name:"key",kind:"scalar",T:9},{no:2,name:"value",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i)),new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.Codec",[])}return(0,k.Z)(n)}(_i)),new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.Fingerprint",[{no:1,name:"algorithm",kind:"scalar",T:9},{no:2,name:"value",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i));var hv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.SessionDescription",[{no:1,name:"target",kind:"enum",T:function(){return["media.Target",lv]}},{no:2,name:"type",kind:"scalar",T:9},{no:3,name:"sdp",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i)),vv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.CreateTransportRequest",[{no:1,name:"consuming",kind:"scalar",T:8},{no:2,name:"force_tcp",kind:"scalar",opt:!0,T:8},{no:3,name:"description",kind:"message",T:function(){return hv}}])}return(0,k.Z)(n)}(_i)),mv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.CreateTransportResponse",[{no:1,name:"transport_id",kind:"scalar",T:9},{no:2,name:"description",kind:"message",T:function(){return hv}}])}return(0,k.Z)(n)}(_i)),gv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.RenegotiateRequest",[{no:1,name:"transport_id",kind:"scalar",T:9},{no:2,name:"description",kind:"message",T:function(){return hv}}])}return(0,k.Z)(n)}(_i));new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.RenegotiateResponse",[{no:1,name:"transport_id",kind:"scalar",T:9},{no:2,name:"description",kind:"message",T:function(){return hv}}])}return(0,k.Z)(n)}(_i));var yv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.NestedScore",[{no:1,name:"encoding_idx",kind:"scalar",T:5},{no:2,name:"rid",kind:"scalar",T:9},{no:3,name:"score",kind:"scalar",T:5},{no:4,name:"ssrc",kind:"scalar",T:3,L:0}])}return(0,k.Z)(n)}(_i)),kv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.ProducerTrack",[{no:1,name:"track_id",kind:"scalar",T:9},{no:2,name:"producer_id",kind:"scalar",T:9},{no:3,name:"stream_id",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i));new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.ProducerEntry",[{no:1,name:"producing_transport_id",kind:"scalar",T:9},{no:2,name:"producer_id",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i)),new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.ConsumerEntry",[{no:1,name:"consuming_transport_id",kind:"scalar",T:9},{no:2,name:"consumer_id",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i));var bv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.ProducerState",[{no:1,name:"producer_id",kind:"scalar",T:9},{no:2,name:"kind",kind:"enum",T:function(){return["media.ProducerKind",dv]}},{no:3,name:"pause",kind:"scalar",T:8},{no:4,name:"screen_share",kind:"scalar",T:8}])}return(0,k.Z)(n)}(_i)),wv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.ConsumerState",[{no:1,name:"consumer_id",kind:"scalar",T:9},{no:2,name:"producer_state",kind:"message",T:function(){return bv}},{no:3,name:"producer_track",kind:"message",T:function(){return kv}}])}return(0,k.Z)(n)}(_i)),_v=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.ProducerIdToConsumerMap",[{no:1,name:"map",kind:"map",K:9,V:{kind:"message",T:function(){return wv}}}])}return(0,k.Z)(n)}(_i));new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.PeerPreJoinRequest",[])}return(0,k.Z)(n)}(_i));var Sv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.PeerJoinRequest",[{no:1,name:"display_name",kind:"scalar",opt:!0,T:9},{no:2,name:"prejoined",kind:"scalar",T:8},{no:3,name:"room_uuid",kind:"scalar",T:9},{no:4,name:"meeting_id",kind:"scalar",opt:!0,T:9},{no:5,name:"preset",kind:"scalar",opt:!0,T:12}])}return(0,k.Z)(n)}(_i)),Ev=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.PeerLeaveRequest",[{no:1,name:"close_room",kind:"scalar",T:8}])}return(0,k.Z)(n)}(_i));new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.ConsumeMultipleProducerRequest",[{no:1,name:"producer_ids",kind:"scalar",repeat:2,T:9},{no:2,name:"paused",kind:"scalar",opt:!0,T:8}])}return(0,k.Z)(n)}(_i));var Tv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.ConsumePeerRequest",[{no:1,name:"producing_peer_id",kind:"scalar",T:9},{no:2,name:"paused",kind:"scalar",opt:!0,T:8},{no:3,name:"producer_id",kind:"scalar",opt:!0,T:9}])}return(0,k.Z)(n)}(_i)),xv=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.ProducerCreateRequest",[{no:1,name:"kind",kind:"scalar",T:9},{no:2,name:"paused",kind:"scalar",T:8},{no:3,name:"screen_share",kind:"scalar",T:8},{no:4,name:"description",kind:"message",T:function(){return hv}},{no:5,name:"msid",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i),Zv=new xv;new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.SelectedPeersRequest",[])}return(0,k.Z)(n)}(_i));var Cv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.GlobalPeerPinningRequest",[{no:1,name:"participant_id",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i)),Rv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.ProducerToggleRequest",[{no:1,name:"producer_id",kind:"scalar",T:9},{no:2,name:"pause",kind:"scalar",T:8}])}return(0,k.Z)(n)}(_i)),Pv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.ConsumerToggleRequest",[{no:1,name:"consumer_id",kind:"scalar",T:9},{no:2,name:"pause",kind:"scalar",T:8}])}return(0,k.Z)(n)}(_i)),Iv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.ProducerCloseRequest",[{no:1,name:"producer_id",kind:"scalar",T:9},{no:2,name:"description",kind:"message",T:function(){return hv}}])}return(0,k.Z)(n)}(_i)),Ov=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.ConsumerCloseRequest",[{no:1,name:"consumer_ids",kind:"scalar",repeat:2,T:9},{no:2,name:"description",kind:"message",T:function(){return hv}}])}return(0,k.Z)(n)}(_i)),Dv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.GetRoomStateResponse",[{no:1,name:"display_title",kind:"scalar",T:9},{no:2,name:"locked_mode",kind:"scalar",T:8},{no:3,name:"room_uuid",kind:"scalar",T:9},{no:4,name:"room_name",kind:"scalar",T:9},{no:5,name:"current_peer_id",kind:"scalar",T:9},{no:6,name:"is_recording",kind:"scalar",opt:!0,T:8},{no:7,name:"recorder_participant_id",kind:"scalar",opt:!0,T:9}])}return(0,k.Z)(n)}(_i));new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.ErrorResponse",[{no:1,name:"error_message",kind:"scalar",T:9},{no:2,name:"event_id",kind:"scalar",T:5}])}return(0,k.Z)(n)}(_i)),new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.EmptyResponse",[])}return(0,k.Z)(n)}(_i));var Mv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.RoomParticipants",[{no:1,name:"peer_id",kind:"scalar",T:9},{no:2,name:"producer_states",kind:"message",repeat:1,T:function(){return bv}},{no:3,name:"display_name",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i));new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.PeerPreJoinResponse",[])}return(0,k.Z)(n)}(_i));var Av=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.SelectedPeersResponse",[{no:1,name:"audio_peers",kind:"scalar",repeat:2,T:9},{no:2,name:"compulsory_peers",kind:"scalar",repeat:2,T:9}])}return(0,k.Z)(n)}(_i)),Nv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.SelectedPeersDiffEntry",[{no:1,name:"peer_id",kind:"scalar",T:9},{no:2,name:"priority",kind:"scalar",T:5}])}return(0,k.Z)(n)}(_i)),Lv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.SelectedPeersDiffResponse",[{no:1,name:"entries",kind:"message",repeat:1,T:function(){return Nv}}])}return(0,k.Z)(n)}(_i)),jv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.PeerJoinResponse",[{no:1,name:"room_state",kind:"message",T:function(){return Dv}},{no:2,name:"participants",kind:"message",repeat:1,T:function(){return Mv}},{no:3,name:"selected_peers",kind:"message",T:function(){return Av}},{no:4,name:"max_preferred_streams",kind:"scalar",T:5}])}return(0,k.Z)(n)}(_i)),Fv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.PeerLeaveResponse",[{no:1,name:"closed",kind:"scalar",T:8}])}return(0,k.Z)(n)}(_i));new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.ConsumeMultipleProducerResponse",[{no:1,name:"status",kind:"scalar",T:8},{no:2,name:"consumer_ids_map",kind:"message",T:function(){return _v}},{no:3,name:"transport_details",kind:"message",T:function(){return mv}}])}return(0,k.Z)(n)}(_i));var Uv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.ConsumePeerResponse",[{no:1,name:"status",kind:"scalar",T:8},{no:2,name:"consumer_ids_map",kind:"message",T:function(){return _v}},{no:3,name:"transport_details",kind:"message",T:function(){return mv}}])}return(0,k.Z)(n)}(_i)),Bv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.ProducerCreateResponse",[{no:1,name:"status",kind:"scalar",T:8},{no:2,name:"producer_id",kind:"scalar",T:9},{no:3,name:"transport_details",kind:"message",T:function(){return mv}},{no:4,name:"description",kind:"message",T:function(){return hv}}])}return(0,k.Z)(n)}(_i));new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.ProducerScoreResponse",[{no:1,name:"responseid",kind:"scalar",T:9},{no:2,name:"score",kind:"message",T:function(){return yv}}])}return(0,k.Z)(n)}(_i)),new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.ActiveSpeakerResponse",[{no:1,name:"responsepeer_id",kind:"scalar",T:9},{no:2,name:"volume",kind:"scalar",T:5}])}return(0,k.Z)(n)}(_i)),new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.NoActiveSpeakerResponse",[])}return(0,k.Z)(n)}(_i)),new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.ProducerToggleResponse",[])}return(0,k.Z)(n)}(_i)),new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.ConsumerToggleResponse",[])}return(0,k.Z)(n)}(_i));var Vv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.ProducerClosingResponse",[{no:1,name:"description",kind:"message",T:function(){return hv}}])}return(0,k.Z)(n)}(_i)),Hv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.ConsumerClosingResponse",[])}return(0,k.Z)(n)}(_i));new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.GlobalPeerPinningResponse",[])}return(0,k.Z)(n)}(_i));var zv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.PeerJoinBroadcastResponse",[{no:1,name:"participant",kind:"message",T:function(){return Mv}}])}return(0,k.Z)(n)}(_i)),Wv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.PeerProducerCreateBroadcastResponse",[{no:1,name:"participant_id",kind:"scalar",T:9},{no:2,name:"producer_state",kind:"message",T:function(){return bv}}])}return(0,k.Z)(n)}(_i)),Gv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.PeerProducerToggleBroadcastResponse",[{no:1,name:"participant_id",kind:"scalar",T:9},{no:2,name:"producer_state",kind:"message",T:function(){return bv}}])}return(0,k.Z)(n)}(_i)),qv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.PeerProducerCloseBroadcastResponse",[{no:1,name:"participant_id",kind:"scalar",T:9},{no:2,name:"producer_state",kind:"message",T:function(){return bv}}])}return(0,k.Z)(n)}(_i)),$v=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.PeerLeaveBroadcastResponse",[{no:1,name:"participant_id",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i)),Kv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.GlobalPeerPinningBroadcastResponse",[{no:1,name:"participant_id",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i)),Jv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.RecordingStartedBroadcastResponse",[{no:1,name:"participant_id",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i)),Qv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"media.edge.RecordingStoppedBroadcastResponse",[{no:1,name:"participant_id",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i));new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.api.BaseSocketHubMessage",[{no:1,name:"event",kind:"scalar",T:5},{no:2,name:"id",kind:"scalar",T:9},{no:3,name:"peer_id",kind:"scalar",T:9},{no:4,name:"room_id",kind:"scalar",T:9},{no:5,name:"user_id",kind:"scalar",T:9},{no:6,name:"payload",kind:"scalar",T:12}])}return(0,k.Z)(n)}(_i)),new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.api.ErrorMessage",[{no:1,name:"code",kind:"scalar",opt:!0,T:5},{no:2,name:"message",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i)),new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.PeerPreset",[{no:1,name:"success",kind:"scalar",T:8},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"message",T:function(){return um}}])}return(0,k.Z)(n)}(_i));var Xv,Yv=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.PeerPreset.Plugins",[{no:1,name:"can_close",kind:"scalar",T:8},{no:2,name:"can_start",kind:"scalar",T:8}])}return(0,k.Z)(n)}(_i)),em=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.PeerPreset.Polls",[{no:1,name:"can_create",kind:"scalar",T:8},{no:2,name:"can_vote",kind:"scalar",T:8},{no:3,name:"can_view",kind:"scalar",T:8}])}return(0,k.Z)(n)}(_i)),tm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.PeerPreset.Video",[{no:1,name:"allow",kind:"scalar",T:8},{no:2,name:"quality",kind:"scalar",T:9},{no:3,name:"frame_rate",kind:"scalar",T:13}])}return(0,k.Z)(n)}(_i)),nm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.PeerPreset.Screenshare",[{no:1,name:"allow",kind:"scalar",T:8},{no:2,name:"quality",kind:"scalar",T:9},{no:3,name:"frame_rate",kind:"scalar",T:13}])}return(0,k.Z)(n)}(_i)),rm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.PeerPreset.Produce",[{no:1,name:"video",kind:"message",T:function(){return tm}},{no:2,name:"audio",kind:"scalar",T:8},{no:3,name:"screenshare",kind:"message",T:function(){return nm}}])}return(0,k.Z)(n)}(_i)),am=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.PeerPreset.Public",[{no:1,name:"can_send",kind:"scalar",T:8},{no:2,name:"text",kind:"scalar",T:8},{no:3,name:"files",kind:"scalar",T:8}])}return(0,k.Z)(n)}(_i)),im=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.PeerPreset.Private",[{no:1,name:"can_send",kind:"scalar",T:8},{no:2,name:"can_receive",kind:"scalar",T:8},{no:3,name:"text",kind:"scalar",T:8},{no:4,name:"files",kind:"scalar",T:8}])}return(0,k.Z)(n)}(_i)),om=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.PeerPreset.Chat",[{no:1,name:"public",kind:"message",T:function(){return am}},{no:2,name:"private",kind:"message",T:function(){return im}}])}return(0,k.Z)(n)}(_i)),sm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.PeerPreset.Permissions",[{no:1,name:"view_type",kind:"scalar",T:9},{no:2,name:"accept_waiting_requests",kind:"scalar",T:8},{no:3,name:"request_produce",kind:"scalar",T:8},{no:4,name:"can_allow_participant_audio",kind:"scalar",T:8},{no:5,name:"can_allow_participant_screensharing",kind:"scalar",T:8},{no:6,name:"can_allow_participant_video",kind:"scalar",T:8},{no:7,name:"request_kick_participant",kind:"scalar",T:8},{no:8,name:"kick_participant",kind:"scalar",T:8},{no:9,name:"pin_participant",kind:"scalar",T:8},{no:10,name:"can_record",kind:"scalar",T:8},{no:11,name:"waiting_room_type",kind:"scalar",T:9},{no:12,name:"plugins",kind:"message",T:function(){return Yv}},{no:13,name:"polls",kind:"message",T:function(){return em}},{no:14,name:"produce",kind:"message",T:function(){return rm}},{no:15,name:"chat",kind:"message",T:function(){return om}},{no:16,name:"reactions",kind:"scalar",T:8},{no:17,name:"hidden_participant",kind:"scalar",T:8},{no:18,name:"show_participant_list",kind:"scalar",T:8},{no:19,name:"can_change_participant_role",kind:"scalar",T:8},{no:20,name:"can_change_theme",kind:"scalar",T:8},{no:21,name:"can_present",kind:"scalar",T:8},{no:22,name:"is_recorder",kind:"scalar",opt:!0,T:8}])}return(0,k.Z)(n)}(_i)),cm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.PeerPreset.Preset",[{no:1,name:"permissions",kind:"message",T:function(){return sm}},{no:3,name:"version",kind:"scalar",T:9},{no:4,name:"preset_name",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i)),um=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.PeerPreset.Data",[{no:1,name:"preset",kind:"message",T:function(){return cm}}])}return(0,k.Z)(n)}(_i)),lm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.chat.ChatMessage",[{no:1,name:"chat_id",kind:"scalar",T:9},{no:2,name:"peer_id",kind:"scalar",T:9},{no:3,name:"user_id",kind:"scalar",T:9},{no:4,name:"display_name",kind:"scalar",T:9},{no:5,name:"pinned",kind:"scalar",T:8},{no:6,name:"is_edited",kind:"scalar",T:8},{no:7,name:"payload_type",kind:"scalar",T:5},{no:8,name:"payload",kind:"scalar",T:9},{no:10,name:"target_user_ids",kind:"scalar",repeat:2,T:9},{no:11,name:"created_at",kind:"scalar",T:4,L:2}])}return(0,k.Z)(n)}(_i)),dm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.chat.GetChatMessagesResponse",[{no:1,name:"messages",kind:"message",repeat:1,T:function(){return lm}}])}return(0,k.Z)(n)}(_i)),pm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.chat.SendChatMessageToRoomRequest",[{no:1,name:"payload_type",kind:"scalar",T:5},{no:2,name:"payload",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i)),fm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.chat.SendChatMessageToRoomResponse",[{no:1,name:"message",kind:"message",T:function(){return lm}}])}return(0,k.Z)(n)}(_i)),hm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.chat.SendChatMessageToPeersRequest",[{no:1,name:"peer_ids",kind:"scalar",repeat:2,T:9},{no:2,name:"payload_type",kind:"scalar",T:5},{no:3,name:"payload",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i)),vm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.chat.SendChatMessageToPeersResponse",[{no:1,name:"message",kind:"message",T:function(){return lm}}])}return(0,k.Z)(n)}(_i)),mm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.chat.EditChatMessageRequest",[{no:1,name:"chat_id",kind:"scalar",T:9},{no:2,name:"payload_type",kind:"scalar",opt:!0,T:5},{no:3,name:"payload",kind:"scalar",opt:!0,T:9},{no:4,name:"pinned",kind:"scalar",opt:!0,T:8}])}return(0,k.Z)(n)}(_i)),gm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.chat.EditChatMessageResponse",[{no:1,name:"message",kind:"message",T:function(){return lm}}])}return(0,k.Z)(n)}(_i)),ym=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.chat.DeleteChatMessageRequest",[{no:1,name:"chat_id",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i)),km=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.chat.DeleteChatMessageResponse",[{no:1,name:"chat_id",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i));!function(e){e[e.HIVE=0]="HIVE",e[e.CHAT=1]="CHAT",e[e.PING=2]="PING"}(Xv||(Xv={}));var bm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.room.Peer",[{no:1,name:"peer_id",kind:"scalar",T:9},{no:2,name:"user_id",kind:"scalar",T:9},{no:3,name:"display_name",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i));new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.room.PeerInfoResponse",[{no:1,name:"peer",kind:"message",T:function(){return bm}}])}return(0,k.Z)(n)}(_i)),new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.room.RoomPeersInfoResponse",[{no:1,name:"peers",kind:"message",repeat:1,T:function(){return bm}}])}return(0,k.Z)(n)}(_i));var wm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.room.RoomPeerCountResponse",[{no:1,name:"count",kind:"scalar",T:4,L:2}])}return(0,k.Z)(n)}(_i)),_m=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.room.Room",[{no:1,name:"room_id",kind:"scalar",T:9},{no:2,name:"title",kind:"scalar",T:9},{no:4,name:"created_at",kind:"scalar",T:4,L:2}])}return(0,k.Z)(n)}(_i)),Sm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.room.RoomInfoResponse",[{no:1,name:"room",kind:"message",T:function(){return _m}}])}return(0,k.Z)(n)}(_i));new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.room.GetPeerInfoRequest",[{no:1,name:"peer_id",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i)),new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.room.UpdatePeerInfoRequest",[{no:1,name:"peer_id",kind:"scalar",T:9},{no:2,name:"display_name",kind:"scalar",opt:!0,T:9}])}return(0,k.Z)(n)}(_i));var Em=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.room.JoinRoomRequest",[{no:1,name:"peer",kind:"message",T:function(){return bm}},{no:3,name:"room_uuid",kind:"scalar",T:9},{no:4,name:"organization_id",kind:"scalar",opt:!0,T:9},{no:5,name:"use_hive",kind:"scalar",opt:!0,T:8},{no:6,name:"preset",kind:"scalar",opt:!0,T:12},{no:7,name:"capabilities",kind:"enum",repeat:1,T:function(){return["socket.room.Capabilities",Xv,"CAPABILITIES_"]}}])}return(0,k.Z)(n)}(_i)),Tm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.room.LeaveRoomRequest",[{no:1,name:"peer",kind:"message",T:function(){return bm}}])}return(0,k.Z)(n)}(_i));new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.room.UpdateRoomInfoRequest",[{no:1,name:"room",kind:"message",T:function(){return _m}}])}return(0,k.Z)(n)}(_i));var xm,Zm,Cm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.plugin.AddPluginRequest",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"staggered",kind:"scalar",T:8}])}return(0,k.Z)(n)}(_i)),Rm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.plugin.RemovePluginRequest",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"staggered",kind:"scalar",T:8}])}return(0,k.Z)(n)}(_i)),Pm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.plugin.EnablePluginForRoomRequest",[{no:1,name:"plugin_id",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i)),Im=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.plugin.DisablePluginForRoomRequest",[{no:1,name:"plugin_id",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i)),Om=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.plugin.EnablePluginForPeersRequest",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"peer_ids",kind:"scalar",repeat:2,T:9}])}return(0,k.Z)(n)}(_i)),Dm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.plugin.DisablePluginForPeersRequest",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"peer_ids",kind:"scalar",repeat:2,T:9}])}return(0,k.Z)(n)}(_i)),Mm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.plugin.PluginEventToRoomRequest",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"plugin_data",kind:"scalar",T:12}])}return(0,k.Z)(n)}(_i)),Am=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.plugin.PluginEventToPeersRequest",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"peer_ids",kind:"scalar",repeat:2,T:9},{no:3,name:"plugin_data",kind:"scalar",T:12}])}return(0,k.Z)(n)}(_i)),Nm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.plugin.StoreKeys",[{no:1,name:"store_key",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",opt:!0,T:12}])}return(0,k.Z)(n)}(_i)),Lm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.plugin.PluginStoreInsertKeysRequest",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"store_name",kind:"scalar",T:9},{no:3,name:"insert_keys",kind:"message",repeat:1,T:function(){return Nm}}])}return(0,k.Z)(n)}(_i)),jm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.plugin.PluginStoreGetKeysRequest",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"store_name",kind:"scalar",T:9},{no:3,name:"get_keys",kind:"message",repeat:1,T:function(){return Nm}}])}return(0,k.Z)(n)}(_i)),Fm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.plugin.PluginStoreDeleteKeysRequest",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"store_name",kind:"scalar",T:9},{no:3,name:"delete_keys",kind:"message",repeat:1,T:function(){return Nm}}])}return(0,k.Z)(n)}(_i)),Um=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.plugin.PluginStoreDeleteRequest",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"store_name",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i)),Bm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.plugin.EnablePluginResponse",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"enabled_by",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i)),Vm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.plugin.EnablePluginsResponse",[{no:1,name:"plugins",kind:"message",repeat:1,T:function(){return Bm}}])}return(0,k.Z)(n)}(_i)),Hm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.plugin.DisablePluginResponse",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"disabled_by",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i)),zm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.plugin.PluginStoreItem",[{no:1,name:"timestamp",kind:"scalar",T:9},{no:2,name:"peer_id",kind:"scalar",T:9},{no:3,name:"store_key",kind:"scalar",T:9},{no:4,name:"payload",kind:"scalar",T:12}])}return(0,k.Z)(n)}(_i)),Wm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.plugin.PluginStoreResponse",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"store_name",kind:"scalar",T:9},{no:3,name:"store_items",kind:"message",repeat:1,T:function(){return zm}}])}return(0,k.Z)(n)}(_i)),Gm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.plugin.PluginEventResponse",[{no:1,name:"plugin_id",kind:"scalar",T:9},{no:2,name:"plugin_data",kind:"scalar",T:12}])}return(0,k.Z)(n)}(_i)),qm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.livestreaming.LiveStreamingEvent",[{no:1,name:"livestream_id",kind:"scalar",T:9},{no:2,name:"err_message",kind:"scalar",T:9},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"meeting_id",kind:"scalar",T:9},{no:5,name:"playback_url",kind:"scalar",T:9},{no:6,name:"org_id",kind:"scalar",T:9},{no:7,name:"room_name",kind:"scalar",T:9},{no:8,name:"room_uuid",kind:"scalar",T:9},{no:9,name:"status",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i));new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.livestreaming.GetStagePeersResponse",[{no:1,name:"stage_peers",kind:"scalar",repeat:2,T:9}])}return(0,k.Z)(n)}(_i)),new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.livestreaming.GetStageRequestsResponse",[{no:1,name:"stage_requests",kind:"scalar",repeat:2,T:9}])}return(0,k.Z)(n)}(_i)),new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.livestreaming.GrantStageAccessRequest",[{no:1,name:"user_ids",kind:"scalar",repeat:2,T:9}])}return(0,k.Z)(n)}(_i)),new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"socket.livestreaming.DenyStageAccessRequest",[{no:1,name:"user_ids",kind:"scalar",repeat:2,T:9}])}return(0,k.Z)(n)}(_i)),function(e){e[e.ACTION=0]="ACTION",e[e.RESPONSE=1]="RESPONSE",e[e.EVENT=2]="EVENT"}(xm||(xm={})),function(e){e[e.SERVICE_NOT_FOUND=0]="SERVICE_NOT_FOUND",e[e.PARAMETER_VALIDATION_ERROR=1]="PARAMETER_VALIDATION_ERROR",e[e.TIMEOUT_ERROR=2]="TIMEOUT_ERROR",e[e.APPLICATION_ERROR=3]="APPLICATION_ERROR"}(Zm||(Zm={})),new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"bridge.BridgeMessage",[{no:1,name:"type",kind:"enum",T:function(){return["bridge.BridgeMessageType",xm]}},{no:2,name:"action",kind:"message",oneof:"data",T:function(){return $m}},{no:3,name:"response",kind:"message",oneof:"data",T:function(){return Km}},{no:4,name:"event",kind:"message",oneof:"data",T:function(){return Qm}}])}return(0,k.Z)(n)}(_i));var $m=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"bridge.BridgeAction",[{no:1,name:"action",kind:"scalar",T:9},{no:2,name:"params",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i)),Km=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"bridge.BridgeResponse",[{no:1,name:"success",kind:"scalar",T:8},{no:2,name:"response",kind:"scalar",T:9},{no:3,name:"error",kind:"message",T:function(){return Jm}}])}return(0,k.Z)(n)}(_i)),Jm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"bridge.BridgeError",[{no:1,name:"type",kind:"enum",T:function(){return["bridge.ErrorType",Zm]}},{no:2,name:"message",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i)),Qm=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"bridge.BridgeEvent",[{no:1,name:"event",kind:"scalar",T:9},{no:2,name:"params",kind:"scalar",T:9}])}return(0,k.Z)(n)}(_i)),Xm=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"google.protobuf.Timestamp",[{no:1,name:"seconds",kind:"scalar",T:3,L:0},{no:2,name:"nanos",kind:"scalar",T:5}])}return(0,k.Z)(n,[{key:"now",value:function(){var e=this.create(),t=Date.now();return e.seconds=Wa.from(Math.floor(t/1e3)).toBigInt(),e.nanos=t%1e3*1e6,e}},{key:"toDate",value:function(e){return new Date(1e3*Wa.from(e.seconds).toNumber()+Math.ceil(e.nanos/1e6))}},{key:"fromDate",value:function(e){var t=this.create(),n=e.getTime();return t.seconds=Wa.from(Math.floor(n/1e3)).toBigInt(),t.nanos=n%1e3*1e6,t}},{key:"internalJsonWrite",value:function(e,t){var n=1e3*Wa.from(e.seconds).toNumber();if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("Unable to encode Timestamp to JSON. Must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive.");if(e.nanos<0)throw new Error("Unable to encode invalid Timestamp to JSON. Nanos must not be negative.");var r="Z";if(e.nanos>0){var a=(e.nanos+1e9).toString().substring(1);r="000000"===a.substring(3)?"."+a.substring(0,3)+"Z":"000"===a.substring(6)?"."+a.substring(0,6)+"Z":"."+a+"Z"}return new Date(n).toISOString().replace(".000Z",r)}},{key:"internalJsonRead",value:function(e,t,n){if("string"!=typeof e)throw new Error("Unable to parse Timestamp from JSON "+Za(e)+".");var r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("Unable to parse Timestamp from JSON. Invalid format.");var a=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(a))throw new Error("Unable to parse Timestamp from JSON. Invalid value.");if(a<Date.parse("0001-01-01T00:00:00Z")||a>Date.parse("9999-12-31T23:59:59Z"))throw new globalThis.Error("Unable to parse Timestamp from JSON. Must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive.");return n||(n=this.create()),n.seconds=Wa.from(a/1e3).toBigInt(),n.nanos=0,r[7]&&(n.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),n}}]),n}(_i);new Xm;var Ym=3,eg=30,tg=8e3,ng=function(){function e(t){var n=this;(0,y.Z)(this,e),Ko(this,"axios"),Ko(this,"requests"),Ko(this,"roomName"),Ko(this,"roomUUID"),Ko(this,"peerId"),Ko(this,"authToken"),Ko(this,"organizationId");var r=t||{},a=r.timeout,i=void 0===a?tg:a,o=r.retry,s=void 0===o?Ym:o,c=r.retryDelay,u=void 0===c?eg:c,p=r.baseURL,f=void 0===p?"https://api.cluster.dyte.in":p,h=r.authToken;this.requests=R().create({baseURL:f,responseType:"json",timeout:i,retry:s,retryDelay:u}),this.axios=R(),this.setAuthToken(h,{bearer:!0}),this.requests.interceptors.request.use((function(e){return Gp.injectContext(n.requests.defaults.headers.common),e}),function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:qp.error("xhr::axios::otelRequestInterceptor",{error:{message:t.message,name:t.name}});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.requests.interceptors.response.use((function(e){return e.config.url!==Gp.logsEndpoint&&qp.debug("xhr::axios",{status:e.status,statusText:e.statusText,baseURL:e.config.baseURL,url:e.config.url}),e}),function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var r,a,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",Promise.reject(new Error("Unknown error occurred")));case 2:return t&&t.config&&(null==(r=t.config)?void 0:r.url)!==Gp.logsEndpoint&&qp.error("xhr::axios",{message:t.message,status:t.status,statusText:t.statusText,stack:t.stack,baseUrl:t.config.baseURL,url:t.config.url,retry:t.config.retry}),a=t.config,i=t.message,e.abrupt("return",a&&i&&void 0!==a.retry&&a.retry>0&&(i.includes("timeout")||i.includes("Network Error"))?(a.retry-=1,new Promise((function(e){setTimeout((function(){e(!0),n.fetchRetryExp(a)}),a.retryDelay||eg)})).then((function(){return n.requests(a)}))):Promise.reject(t));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}return(0,k.Z)(e,[{key:"setAuthToken",value:function(e,t){var n=(t||{}).bearer;this.authToken=e,this.requests.defaults.headers.common.Authorization=n?"Bearer ".concat(e):e}},{key:"setHeader",value:function(e,t){this.requests.defaults.headers.common[e]=t}},{key:"setRoomName",value:function(e){this.roomName=e}},{key:"setRoomUUID",value:function(e){this.roomUUID=e}},{key:"setPeerId",value:function(e){this.peerId=e}},{key:"setOrganizationId",value:function(e){this.organizationId=e}},{key:"fetchRetryExp",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Vc.hasFeature(Sp.FETCH_RETRY)){e.next=2;break}return e.abrupt("return");case 2:return r=new AbortController,a=setTimeout((function(){qp.log("fetch_experiment_timeout",{retries:t.retry}),r.abort()}),5e3),e.prev=3,e.next=6,fetch(t.url,{method:t.method,headers:t.headers,body:null!=(n=t.data)?n:null,signal:r.signal});case 6:qp.log("fetch_experiment_success",{retries:t.retry}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),qp.log("fetch_experiment_failure",{retries:t.retry});case 12:return e.prev=12,clearTimeout(a),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[3,9,12,15]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),rg=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;return(0,y.Z)(this,n),(r=t.call(this,e)).setHeader("x-dyte-web-core-version",wp),r}return(0,k.Z)(n,[{key:"getICEServers",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requests.get("/iceservers");case 2:if(t=e.sent.data,n=t.success,r=t.iceServers,!n){e.next=7;break}return e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getPlugins",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,c,u,d,p,f,h,v=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requests.get("/v2/plugins/user");case 2:return p=e.sent.data.data.plugins,f=(null==(r=null==(n=Vc.getValue(Sp.V1_PLUGINS))?void 0:n.toString())?void 0:r.split(","))||[],h=p.reduce((function(e,t){return e[f.includes(t.id)?"v1":"v2"].push(t),e}),{v1:[],v2:[]}),e.abrupt("return",(p="socket-service"===t?h.v2:h.v1,null!=(c=null==(i=null==(a=kp.modules)?void 0:a.devTools)?void 0:i.plugins)&&c.length&&(null==(d=null==(u=kp.modules)?void 0:u.devTools)||d.plugins.forEach((function(e){var t,n,r,a=(0,s.Z)((0,s.Z)({},iv),{},{tags:(0,o.Z)(iv.tags)});a.baseURL="http://localhost:".concat(e.port),a.name=e.name,a.picture=null!=(t=e.picture)?t:iv.picture,a.description=null!=(n=e.description)?n:iv.description,a.staggered=null!=(r=e.staggered)?r:iv.staggered,a.createdAt=(new Date).toISOString(),a.updatedAt=(new Date).toISOString(),a.id=e.id,a.organizationId=v.organizationId,p.push(a)}))),p));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPluginDetails",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requests.get("/v2/plugins/view/".concat(t));case 2:return n=e.sent.data.data.plugin,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPluginConfig",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.axios.get("".concat(t,"/dyte-config.json"));case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"authorizePlugin",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={peerId:this.peerId},av.isV2AuthToken||(n.roomName=this.roomName),e.next=4,this.requests.post("/v2/plugins/authorize/".concat(t),n);case 4:return r=e.sent.data.data.token,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPresignedUrls",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requests.post("/v1/meetings/genPreSignedUploadUrl",{roomUUID:this.roomUUID,filename:t});case 2:return n=e.sent.data.data,r=n.getLocation,a=n.putLocation,e.abrupt("return",{getLocation:r,putLocation:a});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"uploadFile",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.axios.put(n,t,{headers:{"Content-Type":t.type}});case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}],[{key:"getIPDetails",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.peerId,e.prev=1,e.next=4,gc.getIPDetails({peerId:n});case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(1),qp.warn("ApiClient.getRoomNodeLinkAndTitleV1 Failed to get ip details",{error:{name:e.t0.name,message:e.t0.message}}),e.abrupt("return");case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()}]),n}(ng),ag=Object.defineProperty,ig=Object.getOwnPropertyDescriptor,og=function(e,t,n,r){for(var a,i=r>1?void 0:r?ig(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&ag(t,n,i),i},sg=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.apply(this,arguments)}return(0,k.Z)(n,[{key:"startLivestreaming",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requests.post("/v2/meetings/".concat(av.meetingId,"/livestreams"));case 2:return e.abrupt("return",e.sent.data.data.id);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stopLivestreaming",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.requests.post("/v2/meetings/".concat(av.meetingId,"/active-livestream/stop")));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getActiveLivestream",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Zf,e.next=3,this.requests.get("/v2/meetings/".concat(av.meetingId,"/active-livestream"));case 3:return e.t1=e.sent.data.data,t=(0,e.t0)(e.t1),n=t.playbackUrl,r=t.status,e.abrupt("return",{status:r,playbackUrl:n});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getUserDetails",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requests.get("v2/internals/participant-details");case 2:return t=e.sent.data.data,e.abrupt("return",Zf(t));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getUserPreset",value:function(e){throw new Error("getUserPreset does not exist for v2")}},{key:"startRecording",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requests.post("/v2/recordings",{meeting_id:av.meetingId});case 2:return e.abrupt("return",e.sent.data.id);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stopRecording",value:function(e){return this.requests.put("v2/recordings/".concat(e),{action:"stop"})}},{key:"getActiveRecording",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requests.get("v2/recordings/active-recording/".concat(av.meetingId));case 2:return t=e.sent.data.data,n=t.status,r=t.id,e.abrupt("return",{status:n,id:r});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getRoomNodeData",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var r,a,i,o,s,c;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.peerId,e.next=3,n.getIPDetails({peerId:r});case 3:return a=e.sent,e.t0=Zf,e.next=7,this.requests.post("v2/internals/rooms",{ip_information:a});case 7:return e.t1=e.sent.data.data,i=(0,e.t0)(e.t1),o=i.roomNodeLink,s=i.title,c=i.useHiveMedia,e.abrupt("return",{roomNodeUrl:o,meetingTitle:s,useHiveMedia:null!=c&&c});case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(rg),cg=sg;og([Gp.trace("APIClient.getUserDetails")],cg.prototype,"getUserDetails",1),og([Gp.trace("APIClient.getUserPreset")],cg.prototype,"getUserPreset",1),og([Gp.trace("APIClient.startRecording")],cg.prototype,"startRecording",1),og([Gp.trace("APIClient.stopRecording")],cg.prototype,"stopRecording",1),og([Gp.trace("APIClient.getActiveRecording")],cg.prototype,"getActiveRecording",1),og([Gp.trace("APIClient.getRoomNodeData")],cg.prototype,"getRoomNodeData",1);var ug,lg=Object.defineProperty,dg=Object.getOwnPropertyDescriptor,pg=function(e,t,n,r){for(var a,i=r>1?void 0:r?dg(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&lg(t,n,i),i},fg=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.apply(this,arguments)}return(0,k.Z)(n,[{key:"startLivestreaming",value:function(){throw new Error("Method not implemented.")}},{key:"stopLivestreaming",value:function(){throw new Error("Method not implemented.")}},{key:"getActiveLivestream",value:function(){throw new Error("Method not implemented.")}},{key:"getUserDetails",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requests.get("/auth/basicUserDetails");case 2:return t=e.sent.data.user,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getUserPreset",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requests.post("/v1/userpreset",{roomName:t,authToken:this.authToken,clientType:"CLIENT_APP",version:"0.5.0"});case 2:return n=e.sent.data.data.preset,e.abrupt("return",Zf(n));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"startRecording",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requests.post("/v1/organizations/".concat(this.organizationId,"/rooms/").concat(this.roomName,"/recording"));case 2:if(201===(t=e.sent).status){e.next=5;break}throw new Error("Recording failed to start");case 5:return e.abrupt("return",t.data.data.recording.id);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stopRecording",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.requests.put("/v1/organizations/".concat(this.organizationId,"/rooms/").concat(this.roomName,"/recordings/").concat(t),{recordingAction:"stop"});case 2:if(e.t0=e.sent.status,201===e.t0){e.next=5;break}throw new Error("Recording failed to stop");case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getActiveRecording",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.organizationId){e.next=6;break}return e.next=3,this.requests.get("/v1/organizations/".concat(this.organizationId,"/rooms/").concat(this.roomName,"/active-recording?limit=50"));case 3:e.t0=e.sent.data.data.recording,e.next=7;break;case 6:e.t0={};case 7:return e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getRoomNodeData",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.roomName,r=t.peerId,a="\n        query Session($roomName: String!, $password: String, $ipInformation: String) {\n            session(roomName: $roomName, password: $password) {\n              title,\n              roomNodeLink(ipInformation: $ipInformation),\n              useHiveMedia,\n              roomName,\n              password\n            }\n          }\n        ",e.next=4,rg.getIPDetails({peerId:r});case 4:return i=e.sent,e.next=7,this.requests.post("/graphql",{query:a,variables:{roomName:n,ipInformation:JSON.stringify(i)}});case 7:return o=e.sent.data.data.session,s=o.roomNodeLink,c=o.title,u=o.useHiveMedia,e.abrupt("return",{roomNodeUrl:s,meetingTitle:c,useHiveMedia:null!=u&&u});case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(rg);function hg(e){return ug=av.isV2AuthToken?new cg(e):new fg(e)}function vg(){return ug}pg([Gp.trace("APIClientV1.getUserDetails")],fg.prototype,"getUserDetails",1),pg([Gp.trace("APIClientV1.getUserPreset")],fg.prototype,"getUserPreset",1),pg([Gp.trace("APIClientV1.startRecording")],fg.prototype,"startRecording",1),pg([Gp.trace("APIClientV1.stopRecording")],fg.prototype,"stopRecording",1),pg([Gp.trace("APIClientV1.getActiveRecording")],fg.prototype,"getActiveRecording",1),pg([Gp.trace("APIClientV1.getRoomNodeData")],fg.prototype,"getRoomNodeData",1);function mg(e,t){return Object.keys(t).reduce((function(n,r){return n[r]=(e<<16)+t[r],n}),{})}var gg=mg(0,{getPeerInfo:0,updatePeerInfo:1,getRoomPeersInfo:2,joinRoom:3,leaveRoom:4,getRoomInfo:5,updateRoomInfo:6,closeRoom:7,startedLivestream:8,stoppedLivestream:9,erroredLivestream:10,roomPeerCount:17}),yg=mg(1,{getMessages:0,sendMessageToRoom:1,sendMessageToPeers:2,editMessage:3,deleteMessage:4}),kg=mg(2,{getPlugins:0,addPlugin:1,enablePluginForRoom:2,disablePluginForPeers:3,enablePluginForPeers:4,disablePluginForRoom:5,removePlugin:6,customPluginEventToRoom:7,customPluginEventToPeers:8,storeInsertKeys:9,storeGetKeys:10,storeDeleteKeys:11,storeDelete:12});mg(3,{});var bg,wg=function(e){return Object.keys(e).reduce((function(t,n){return t[n]=16777216|e[n],t}),{})}({unknown:0,createWebRTCTransport:1,produce:2,consume:3,toggleProducer:4,toggleConsumer:5,closeProducer:6,closeConsumer:7,joinRoom:16,leaveRoom:17,selectedPeer:18,globalPinPeer:19,trickleIceCandidate:20,peerJoinedBroadcast:25,peerLeaveBroadcast:26,peerProducerCreateBroadcast:27,peerProducerToggleBroadcast:28,peerProducerCloseBroadcast:29,globalPeerPinBroadcast:30,recordingStartedBroadcast:31,recordingStoppedBroadcast:32,selectedPeerDiff:40,renegotiateSessionDescription:50}),_g=function(){function e(){(0,y.Z)(this,e),Ko(this,"meetingTitle"),Ko(this,"roomName"),Ko(this,"roomUUID"),Ko(this,"isDisconnected"),Ko(this,"roomJoined"),Xo(this,bg,void 0),Ko(this,"peerId"),Ko(this,"authToken"),Ko(this,"maxPreferredStreams")}return(0,k.Z)(e,[{key:"sfuHandler",get:function(){return Qo(this,bg)}},{key:"reconnect",value:function(){throw new Jp("Method not implemented.")}},{key:"joinRoom",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n,r,a){var i=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw i.length>4&&void 0!==i[4]?i[4]:{},new Jp("Method not implemented.");case 2:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"leaveRoom",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"handleSocketCallbacks",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleSockets",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"shareMic",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"shareWebcam",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"shareScreen",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"unmuteSelf",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"muteSelf",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"pauseWebcam",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"disableScreenShare",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"acceptWaitingRequest",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"rejectWaitingRequest",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"muteAll",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"muteAllVideo",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"disableAudio",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"disableVideo",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"kickAll",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"kick",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"pinPeer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getChatMessages",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"requestRemoteControl",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"acceptRemoteControl",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"terminateRemoteControl",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"sendEventRemoteControl",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n,r){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getPolls",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"newPoll",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"votePoll",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConsumers",value:function(){throw new Jp("Method not implemented.")}},{key:"sendMessage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getRoomState",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"addRoomPlugin",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"removeRoomPlugin",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"unpinChatMessage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"pinChatMessage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendChatMessage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"broadcastMessage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"acceptAllRequestToJoinStage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopPresenting",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"startPresenting",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"requestToJoinStage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"rejectRequestToJoinStage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"removePeerFromStage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Jp("Method not implemented.");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"stopAllProducers",value:function(){throw new Jp("Method not implemented.")}}]),e}();bg=new WeakMap;var Sg=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.apply(this,arguments)}return(0,k.Z)(n)}(is.EventEmitter),Eg=function(){function e(t){(0,y.Z)(this,e),Ko(this,"_name"),this._name=t}return(0,k.Z)(e,[{key:"info",value:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];var i=e.format.apply(e,[t].concat(r));this._name&&(i="".concat(this._name,"::").concat(i)),qp.info(i)}},{key:"debug",value:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];var i=e.format.apply(e,[t].concat(r));this._name&&(i="".concat(this._name,"::").concat(i)),qp.info(i)}},{key:"warn",value:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];var i=e.format.apply(e,[t].concat(r));this._name&&(i="".concat(this._name,"::").concat(i)),qp.info(i)}},{key:"error",value:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];var i=e.format.apply(e,[t].concat(r));this._name&&(i="".concat(this._name,"::").concat(i)),qp.error(i)}}],[{key:"getLogger",value:function(t){return new e(t)}},{key:"format",value:function(e){for(var t,n,r=e.split("%"),a=e,i=arguments.length,o=new Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];r.length&&(t=r,n=(0,u.Z)(t,1),a=n[0]),o.reverse();for(var c=1;c<r.length&&o.length;c+=1){var l=o.pop(),d=r[c];switch(d.at(0)){case"s":d=d.replace("s",l);break;case"d":d=d.replace("d",l.toString());break;case"o":d=d.replace("o",JSON.stringify(l,null,2))}a="".concat(a).concat(d)}return o.length&&o.reverse().forEach((function(e){a="".concat(a," ").concat(e instanceof Object?JSON.stringify(e,null,2):e)})),a}}]),e}(),Tg=Eg.getLogger("EnhancedEventEmitter"),xg=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;return(0,y.Z)(this,n),(e=t.call(this)).setMaxListeners(1/0),e}return(0,k.Z)(n,[{key:"safeEmit",value:function(e){var t=this.listenerCount(e);try{for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return this.emit.apply(this,[e].concat(r))}catch(T){return Tg.error("safeEmit() | event listener threw an error [event:%s]:%o",e,T),Boolean(t)}}},{key:"safeEmitAsPromise",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n={}.EVENT_PROMISE_TIMEOUT?parseInt({}.EVENT_PROMISE_TIMEOUT,10):1e4,r=o.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=o[i];return e.abrupt("return",this.safeEmitAsPromiseWithTimeout.apply(this,[t,n].concat(a)));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"safeEmitAsPromiseWithTimeout",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o=this,s=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=s.length,a=new Array(r>2?r-2:0),i=2;i<r;i++)a[i-2]=s[i];return e.abrupt("return",new Promise((function(e,r){setTimeout(r,n,"event request timeout");try{o.emit.apply(o,[t].concat(a,[e,r]))}catch(i){Tg.error("safeEmitAsPromise() | event listener threw an error [event:%s]:%o",t,i),r(i)}})));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(is.EventEmitter),Zg=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;return(0,y.Z)(this,n),e=t.call(this),Ko((0,v.Z)(e),"_mapMidTransceiver",new Map),e._mapMidTransceiver=new Map,e}return(0,k.Z)(n,[{key:"midTransceiverMap",get:function(){return this._mapMidTransceiver}}]),n}(xg),Cg=Eg.getLogger("Chrome74"),Rg=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;return(0,y.Z)(this,n),e=t.call(this),Ko((0,v.Z)(e),"_direction"),Ko((0,v.Z)(e),"_pc"),Ko((0,v.Z)(e),"_sendWebStream",new MediaStream),Ko((0,v.Z)(e),"_sendScreenShareStream",new MediaStream),Ko((0,v.Z)(e),"_transportReady",!1),e}return(0,k.Z)(n,[{key:"name",get:function(){return"Chrome74"}},{key:"pc",get:function(){return this._pc}},{key:"close",value:function(){if(Cg.debug("close()"),this._pc)try{this._pc.close()}catch(e){Cg.error("pc.close()",e)}}},{key:"init",value:function(e){var t=e.direction,n=e.iceServers,r=e.iceTransportPolicy,a=e.additionalSettings,i=e.proprietaryConstraints,o=e.onTrackHandler;Cg.debug("init()"),this._direction=t,this._pc=new RTCPeerConnection((0,s.Z)({iceServers:n||[],iceTransportPolicy:r||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"},a),i),o&&this._pc.addEventListener("track",(function(e){o(e)})),this._addEventListeners()}},{key:"connect",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._pc.createDataChannel("dyte"),e.next=3,this._pc.createOffer();case 3:return n=e.sent,Cg.info("connect offer",n),e.next=7,this._pc.setLocalDescription(n);case 7:return e.abrupt("return",{offerSdp:n,callback:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Cg.debug("connect() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=3,r._pc.setRemoteDescription(n);case 3:t.close();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateIceServers",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Cg.debug("updateIceServers()"),(n=this._pc.getConfiguration()).iceServers=t,this._pc.setConfiguration(n);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"restartIce",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Cg.debug("restartIce()"),e.next=3,this.pc.createOffer({iceRestart:!0});case 3:return t=e.sent,e.abrupt("return",(Cg.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",t),{offerSdp:t,callback:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Cg.info("restartIce() | calling pc.setRemoteDescription() [answer:%o]",t),e.next=3,n._pc.setRemoteDescription(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getTransportStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,s,c,u,p,f,h,v,m,g=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.track,r=t.encodings,a=t.codecOption,i=t.screenShare,this._assertSendDirection(),Cg.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),Cg.debug("creating new transceiver"),c=this._pc.addTransceiver(n,{direction:"sendonly",streams:[i?this._sendScreenShareStream:this._sendWebStream],sendEncodings:r}),u=RTCRtpSender.getCapabilities(n.kind),Cg.info("senders available params:",u),p=[],a&&(f=u.codecs.find((function(e){return e.mimeType.includes(a.name)})),a.parameters&&(Cg.info("codecOption.parameters:",a.parameters),(h=(null==(s=f.sdpFmtpLine)?void 0:s.split(";"))||[]).push.apply(h,(0,o.Z)(a.parameters)),v=(0,o.Z)(new Set(h).values()),f.sdpFmtpLine=v.join(";")),p.push(f)),Cg.info("selected codecs:",p),c.setCodecPreferences(p),e.next=9,this._pc.createOffer();case 9:if(m=e.sent,this._transportReady){e.next=12;break}throw new Error("webrtc transport not connected");case 12:return e.next=14,this._pc.setLocalDescription(m);case 14:return m.sdp=m.sdp.replace("minptime=10;useinbandfec=1","minptime=10;useinbandfec=1;usedtx=1;maxaveragebitrate=16000"),e.abrupt("return",{offerSdp:m,callback:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Cg.debug("send() | calling pc.setRemoteDescription() [answer:%o]",t),e.next=3,g._pc.setRemoteDescription(t);case 3:return g.midTransceiverMap.set(c.mid,c),e.abrupt("return",c.mid);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()});case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._assertSendDirection(),Cg.debug("stopSending() [localId:%s]",t),n=this.midTransceiverMap.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),n.direction="inactive",e.next=7,this._pc.createOffer();case 7:return r=e.sent,Cg.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return e.abrupt("return",{offerSdp:r,callback:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Cg.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=3,a._pc.setRemoteDescription(n);case 3:a.midTransceiverMap.delete(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()});case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"replaceTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._assertSendDirection(),n?Cg.debug("replaceTrack() [localId:%s, track.id:%s]",t,n.id):Cg.debug("replaceTrack() [localId:%s, no track]",t),r=this.midTransceiverMap.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.next=6,r.sender.replaceTrack(n);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setMaxSpatialLayer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._assertSendDirection(),Cg.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,n),r=this.midTransceiverMap.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return(a=r.sender.getParameters()).encodings.forEach((function(e,t){e.active=t<=n})),e.next=8,r.sender.setParameters(a);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setRtpEncodingParameters",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._assertSendDirection(),Cg.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,n),r=this.midTransceiverMap.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return(a=r.sender.getParameters()).encodings.forEach((function(e,t){a.encodings[t]=(0,s.Z)((0,s.Z)({},e),n)})),e.next=8,r.sender.setParameters(a);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getSenderStats",value:function(e){this._assertSendDirection();var t=this.midTransceiverMap.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}},{key:"stopReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw this._assertRecvDirection(),Cg.debug("stopReceiving() [localId:%s]",t),Error("method not implemented");case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw this._assertRecvDirection(),Cg.debug("pauseReceiving() [localId:%s]",t),Error("method not implemented");case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw this._assertRecvDirection(),Cg.debug("resumeReceiving() [localId:%s]",t),Error("method not implemented");case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getReceiverStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._assertRecvDirection(),n=this.midTransceiverMap.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.abrupt("return",n.receiver.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"_assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}},{key:"_generateOffer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._pc.createOffer();case 2:return t=e.sent,e.next=5,this._pc.setLocalDescription(t);case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_setAnswer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Cg.debug("_setAnswer() | calling pc.setRemoteDescription() [answer:%o]",t),e.next=3,this._pc.setRemoteDescription(t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_addEventListeners",value:function(){var e=this;this._pc.addEventListener("iceconnectionstatechange",(function(){switch(e._pc.iceConnectionState){case"checking":e.emit("@connectionstatechange","connecting");break;case"connected":case"completed":e.emit("@connectionstatechange","connected"),e._transportReady=!0;break;case"failed":e.emit("@connectionstatechange","failed");break;case"disconnected":e.emit("@connectionstatechange","disconnected");break;case"closed":e.emit("@connectionstatechange","closed");break;default:Cg.warn("unknown state")}})),this._pc.addEventListener("icecandidate",(function(t){t.candidate&&e.emit("@icecandidate",{candidate:t.candidate})})),this._pc.addEventListener("negotiationneeded",(function(){e.emit("@negotiationneeded",{}),Cg.debug("negotiationneeded")})),this._pc.addEventListener("icegatheringstatechange",(function(){switch(e._pc.iceGatheringState){case"gathering":Cg.debug("icegatheringstatechange | gathering"),e.emit("@icegatheringstatechange","gathering");break;case"complete":Cg.debug("icegatheringstatechange | complete"),e.emit("@icegatheringstatechange","complete");break;default:Cg.warn("unknown state")}})),this._pc.addEventListener("icecandidateerror",(function(e){Cg.info("icecandidateerror",e)})),this._pc.addEventListener("datachannel",(function(t){Cg.info("data channel created: ",t.channel.label);var n=t.channel;n.onopen=function(){Cg.info("data channel open: ",t.channel.label)},n.onclose=function(){Cg.warn("data channel closed: ",t.channel.label)},n.onerror=function(e){Cg.error("data channel error: ",t.channel.label,e)},n.onmessage=function(n){Cg.info("data channel message: ",t.channel.label,n),e.safeEmit("datachannel",t.channel,String.fromCharCode.apply(null,new Uint8Array(n.data)))}}))}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(Zg),Pg=Eg.getLogger("Firefox60"),Ig=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;return(0,y.Z)(this,n),e=t.call(this),Ko((0,v.Z)(e),"_direction"),Ko((0,v.Z)(e),"_pc"),Ko((0,v.Z)(e),"_sendWebStream",new MediaStream),Ko((0,v.Z)(e),"_sendScreenShareStream",new MediaStream),Ko((0,v.Z)(e),"_transportReady",!1),e}return(0,k.Z)(n,[{key:"name",get:function(){return"Firefox60"}},{key:"pc",get:function(){return this._pc}},{key:"close",value:function(){if(Pg.debug("close()"),this._pc)try{this._pc.close()}catch(e){Pg.error("pc.close()",e)}}},{key:"init",value:function(e){var t=e.direction,n=e.iceServers,r=e.iceTransportPolicy,a=e.additionalSettings,i=e.proprietaryConstraints,o=e.onTrackHandler;Pg.debug("init()"),this._direction=t,this._pc=new RTCPeerConnection((0,s.Z)({iceServers:n||[],iceTransportPolicy:r||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},a),i),o&&this._pc.addEventListener("track",(function(e){o(e)})),this._addEventListeners()}},{key:"connect",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._pc.createDataChannel("dyte"),e.next=3,this._pc.createOffer();case 3:return n=e.sent,Pg.info("connect offer",n),e.next=7,this._pc.setLocalDescription(n);case 7:return e.abrupt("return",{offerSdp:n,callback:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Pg.debug("connect() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=3,r._pc.setRemoteDescription(n);case 3:t.close();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateIceServers",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw Pg.debug("updateIceServers()"),new Error("not supported");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"restartIce",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Pg.debug("restartIce()"),e.next=3,this.pc.createOffer({iceRestart:!0});case 3:return t=e.sent,e.abrupt("return",(Pg.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",t),{offerSdp:t,callback:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Pg.info("restartIce() | calling pc.setRemoteDescription() [answer:%o]",t),e.next=3,n._pc.setRemoteDescription(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getTransportStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.track,r=t.encodings,a=t.screenShare,this._assertSendDirection(),Pg.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),Pg.debug("creating new transceiver"),i=this._pc.addTransceiver(n,{direction:"sendonly",streams:[a?this._sendScreenShareStream:this._sendWebStream]}),!r){e.next=9;break}return r.reverse(),(o=i.sender.getParameters()).encodings=r,e.next=9,i.sender.setParameters(o);case 9:return e.next=11,this._pc.createOffer();case 11:if(s=e.sent,this._transportReady){e.next=14;break}throw new Error("webrtc transport not connected");case 14:return e.next=16,this._pc.setLocalDescription(s);case 16:return s.sdp=s.sdp.replace("minptime=10;useinbandfec=1","minptime=10;useinbandfec=1;usedtx=1;maxaveragebitrate=16000"),e.abrupt("return",{offerSdp:s,callback:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Pg.debug("send() | calling pc.setRemoteDescription() [answer:%o]",t),e.next=3,c._pc.setRemoteDescription(t);case 3:return c.midTransceiverMap.set(i.mid,i),e.abrupt("return",i.mid);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()});case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._assertSendDirection(),Pg.debug("stopSending() [localId:%s]",t),n=this.midTransceiverMap.get(t)){e.next=4;break}throw new Error("associated transceiver not found");case 4:return n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),n.direction="inactive",e.next=7,this._pc.createOffer();case 7:return r=e.sent,Pg.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return e.abrupt("return",{offerSdp:r,callback:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Pg.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=3,a._pc.setRemoteDescription(n);case 3:a.midTransceiverMap.delete(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()});case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"replaceTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._assertSendDirection(),n?Pg.debug("replaceTrack() [localId:%s, track.id:%s]",t,n.id):Pg.debug("replaceTrack() [localId:%s, no track]",t),r=this.midTransceiverMap.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.next=6,r.sender.replaceTrack(n);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setMaxSpatialLayer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._assertSendDirection(),Pg.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,n),r=this.midTransceiverMap.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return a=r.sender.getParameters(),i=a.encodings.length-1-n,a.encodings.forEach((function(e,t){e.active=t>=i})),e.next=8,r.sender.setParameters(a);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setRtpEncodingParameters",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._assertSendDirection(),Pg.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,n),r=this.midTransceiverMap.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return(a=r.sender.getParameters()).encodings.forEach((function(e,t){a.encodings[t]=(0,s.Z)((0,s.Z)({},e),n)})),e.next=8,r.sender.setParameters(a);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getSenderStats",value:function(e){this._assertSendDirection();var t=this.midTransceiverMap.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}},{key:"stopReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._assertRecvDirection(),Pg.debug("stopReceiving() [localId:%s]",t),n=this.midTransceiverMap.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return n.direction="inactive",Pg.info("active transcievers: %o",this._pc.getTransceivers()),e.next=7,this._pc.createOffer();case 7:return r=e.sent,Pg.debug("stopRecieving() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return e.abrupt("return",{offerSdp:r,callback:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Pg.debug("stopRecieving() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=3,a._pc.setRemoteDescription(n);case 3:a.midTransceiverMap.delete(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()});case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._assertRecvDirection(),Pg.debug("pauseReceiving() [localId:%s]",t),n=this.midTransceiverMap.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return n.direction="inactive",e.next=7,this._pc.createOffer();case 7:return r=e.sent,Pg.debug("pauseReceiving() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return e.abrupt("return",{offerSdp:r,callback:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Pg.debug("pauseReceiving() | calling pc.setRemoteDescription() [answer:%o]",t),e.next=3,a._pc.setRemoteDescription(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()});case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._assertRecvDirection(),Pg.debug("resumeReceiving() [localId:%s]",t),n=this.midTransceiverMap.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return n.direction="recvonly",e.next=7,this._generateOffer();case 7:return r=e.sent,e.abrupt("return",(Pg.debug("resumeReceiving() | calling pc.setLocalDescription() [offer:%o]",r),{offerSdp:r,callback:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Pg.debug("resumeReceiving() | calling pc.setRemoteDescription() [answer:%o]",t),e.next=3,a._pc.setRemoteDescription(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getReceiverStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._assertRecvDirection(),n=this.midTransceiverMap.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.abrupt("return",n.receiver.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"_assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}},{key:"_generateOffer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._pc.createOffer();case 2:return t=e.sent,e.next=5,this._pc.setLocalDescription(t);case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_setAnswer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Pg.debug("_setAnswer() | calling pc.setRemoteDescription() [answer:%o]",t),e.next=3,this._pc.setRemoteDescription(t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_addEventListeners",value:function(){var e=this;this._pc.addEventListener("datachannel",(function(t){Pg.info("data channel created: ",t.channel.label);var n=t.channel;n.onopen=function(){Pg.info("data channel open: ",t.channel.label)},n.onclose=function(){Pg.warn("data channel closed: ",t.channel.label)},n.onerror=function(e){Pg.error("data channel error: ",t.channel.label,e)},n.onmessage=function(){var n=(0,d.Z)((0,l.Z)().mark((function n(r){var a;return(0,l.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return Pg.debug("data channel message: ",t.channel.label,r),n.next=3,r.data.arrayBuffer();case 3:a=n.sent,e.safeEmit("datachannel",t.channel,String.fromCharCode.apply(null,new Uint8Array(a)));case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()})),this._pc.addEventListener("iceconnectionstatechange",(function(){switch(e._pc.iceConnectionState){case"checking":e.emit("@connectionstatechange","connecting");break;case"connected":case"completed":e.emit("@connectionstatechange","connected"),e._transportReady=!0;break;case"failed":e.emit("@connectionstatechange","failed");break;case"disconnected":e.emit("@connectionstatechange","disconnected");break;case"closed":e.emit("@connectionstatechange","closed");break;default:Pg.warn("unknown state")}})),this._pc.addEventListener("icecandidate",(function(t){t.candidate&&e.emit("@icecandidate",{candidate:t.candidate})})),this._pc.addEventListener("negotiationneeded",(function(){e.emit("@negotiationneeded",{}),Pg.debug("negotiationneeded")})),this._pc.addEventListener("icegatheringstatechange",(function(){switch(e._pc.iceGatheringState){case"gathering":Pg.debug("icegatheringstatechange | gathering"),e.emit("@icegatheringstatechange","gathering");break;case"complete":Pg.debug("icegatheringstatechange | complete"),e.emit("@icegatheringstatechange","complete");break;default:Pg.warn("unknown state")}})),this._pc.addEventListener("icecandidateerror",(function(e){Pg.info("chrome74::icecandidateerror",e)}))}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(Zg),Og=Eg.getLogger("Safari12"),Dg=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;return(0,y.Z)(this,n),e=t.call(this),Ko((0,v.Z)(e),"_direction"),Ko((0,v.Z)(e),"_pc"),Ko((0,v.Z)(e),"_sendWebStream",new MediaStream),Ko((0,v.Z)(e),"_sendScreenShareStream",new MediaStream),Ko((0,v.Z)(e),"_transportReady",!1),e}return(0,k.Z)(n,[{key:"name",get:function(){return"Chrome74"}},{key:"pc",get:function(){return this._pc}},{key:"close",value:function(){if(Og.debug("close()"),this._pc)try{this._pc.close()}catch(e){Og.error("pc.close()",e)}}},{key:"init",value:function(e){var t=e.direction,n=e.iceServers,r=e.iceTransportPolicy,a=e.additionalSettings,i=e.proprietaryConstraints,o=e.onTrackHandler;Og.debug("init()"),this._direction=t,this._pc=new RTCPeerConnection((0,s.Z)({iceServers:n||[],iceTransportPolicy:r||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},a),i),o&&this._pc.addEventListener("track",(function(e){o(e)})),this._addEventListeners()}},{key:"connect",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this._pc.createDataChannel("dyte"),e.next=3,this._pc.createOffer();case 3:return n=e.sent,Og.info("connect offer",n),e.next=7,this._pc.setLocalDescription(n);case 7:return e.abrupt("return",{offerSdp:n,callback:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Og.debug("connect() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=3,r._pc.setRemoteDescription(n);case 3:t.close();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateIceServers",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Og.debug("updateIceServers()"),(n=this._pc.getConfiguration()).iceServers=t,this._pc.setConfiguration(n);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"restartIce",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Og.debug("restartIce()"),e.next=3,this.pc.createOffer({iceRestart:!0});case 3:return t=e.sent,e.abrupt("return",(Og.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",t),{offerSdp:t,callback:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Og.info("restartIce() | calling pc.setRemoteDescription() [answer:%o]",t),e.next=3,n._pc.setRemoteDescription(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getTransportStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,s,c,u,p,f,h,v,m,g=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.track,r=t.encodings,a=t.codecOption,i=t.screenShare,this._assertSendDirection(),Og.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),Og.debug("creating new transceiver"),c=this._pc.addTransceiver(n,{direction:"sendonly",streams:[i?this._sendScreenShareStream:this._sendWebStream],sendEncodings:r}),u=RTCRtpSender.getCapabilities(n.kind),Og.info("senders available params:",u),p=[],a&&(f=u.codecs.find((function(e){return e.mimeType.includes(a.name)})),a.parameters&&(Og.info("codecOption.parameters:",a.parameters),(h=(null==(s=f.sdpFmtpLine)?void 0:s.split(";"))||[]).push.apply(h,(0,o.Z)(a.parameters)),v=(0,o.Z)(new Set(h).values()),f.sdpFmtpLine=v.join(";")),p.push(f)),Og.info("selected codecs:",p),c.setCodecPreferences(p),e.next=9,this._pc.createOffer();case 9:if(m=e.sent,this._transportReady){e.next=12;break}throw new Error("webrtc transport not connected");case 12:return e.next=14,this._pc.setLocalDescription(m);case 14:return m.sdp=m.sdp.replace("minptime=10;useinbandfec=1","minptime=10;useinbandfec=1;usedtx=1;maxaveragebitrate=16000"),e.abrupt("return",{offerSdp:m,callback:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Og.debug("send() | calling pc.setRemoteDescription() [answer:%o]",t),e.next=3,g._pc.setRemoteDescription(t);case 3:return g.midTransceiverMap.set(c.mid,c),e.abrupt("return",c.mid);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()});case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._assertSendDirection(),Og.debug("stopSending() [localId:%s]",t),n=this.midTransceiverMap.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),n.direction="inactive",e.next=7,this._pc.createOffer();case 7:return r=e.sent,Og.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return e.abrupt("return",{offerSdp:r,callback:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Og.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=3,a._pc.setRemoteDescription(n);case 3:a.midTransceiverMap.delete(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()});case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"replaceTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._assertSendDirection(),n?Og.debug("replaceTrack() [localId:%s, track.id:%s]",t,n.id):Og.debug("replaceTrack() [localId:%s, no track]",t),r=this.midTransceiverMap.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.next=6,r.sender.replaceTrack(n);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setMaxSpatialLayer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._assertSendDirection(),Og.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,n),r=this.midTransceiverMap.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return(a=r.sender.getParameters()).encodings.forEach((function(e,t){e.active=t<=n})),e.next=8,r.sender.setParameters(a);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setRtpEncodingParameters",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._assertSendDirection(),Og.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,n),r=this.midTransceiverMap.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return(a=r.sender.getParameters()).encodings.forEach((function(e,t){a.encodings[t]=(0,s.Z)((0,s.Z)({},e),n)})),e.next=8,r.sender.setParameters(a);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getSenderStats",value:function(e){this._assertSendDirection();var t=this.midTransceiverMap.get(e);if(!t)throw new Error("associated RTCRtpTransceiver not found");return t.sender.getStats()}},{key:"receive",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._assertRecvDirection(),Og.debug("recieve() | calling pc.setLocalDescription() [answer:%o]",t),n=this._pc.getTransceivers().at(-1),e.abrupt("return",(Og.info("Transceiver is now receiving",n,this._pc.getTransceivers()),this.midTransceiverMap.set(n.mid,n),{track:n.receiver.track,localId:n.mid}));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._assertRecvDirection(),Og.debug("stopReceiving() [localId:%s]",t),n=this.midTransceiverMap.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return n.direction="inactive",Og.info("active transcievers: %o",this._pc.getTransceivers()),e.next=7,this._pc.createOffer();case 7:return r=e.sent,Og.debug("stopRecieving() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return e.abrupt("return",{offerSdp:r,callback:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Og.debug("stopRecieving() | calling pc.setRemoteDescription() [answer:%o]",n),e.next=3,a._pc.setRemoteDescription(n);case 3:a.midTransceiverMap.delete(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()});case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._assertRecvDirection(),Og.debug("pauseReceiving() [localId:%s]",t),n=this.midTransceiverMap.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return n.direction="inactive",e.next=7,this._pc.createOffer();case 7:return r=e.sent,Og.debug("pauseReceiving() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return e.abrupt("return",{offerSdp:r,callback:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Og.debug("pauseReceiving() | calling pc.setRemoteDescription() [answer:%o]",t),e.next=3,a._pc.setRemoteDescription(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()});case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._assertRecvDirection(),Og.debug("resumeReceiving() [localId:%s]",t),n=this.midTransceiverMap.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return n.direction="recvonly",e.next=7,this._generateOffer();case 7:return r=e.sent,e.abrupt("return",(Og.debug("resumeReceiving() | calling pc.setLocalDescription() [offer:%o]",r),{offerSdp:r,callback:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Og.debug("resumeReceiving() | calling pc.setRemoteDescription() [answer:%o]",t),e.next=3,a._pc.setRemoteDescription(t);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getReceiverStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._assertRecvDirection(),n=this.midTransceiverMap.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.abrupt("return",n.receiver.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"_assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}},{key:"_generateOffer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._pc.createOffer();case 2:return t=e.sent,e.next=5,this._pc.setLocalDescription(t);case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_setAnswer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Og.debug("_setAnswer() | calling pc.setRemoteDescription() [answer:%o]",t),e.next=3,this._pc.setRemoteDescription(t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_addEventListeners",value:function(){var e=this;this._pc.addEventListener("iceconnectionstatechange",(function(){switch(e._pc.iceConnectionState){case"checking":e.emit("@connectionstatechange","connecting");break;case"connected":case"completed":e.emit("@connectionstatechange","connected"),e._transportReady=!0;break;case"failed":e.emit("@connectionstatechange","failed");break;case"disconnected":e.emit("@connectionstatechange","disconnected");break;case"closed":e.emit("@connectionstatechange","closed");break;default:Og.warn("unknown state")}})),this._pc.addEventListener("icecandidate",(function(t){t.candidate&&e.emit("@icecandidate",{candidate:t.candidate})})),this._pc.addEventListener("negotiationneeded",(function(){e.emit("@negotiationneeded",{}),Og.debug("negotiationneeded")})),this._pc.addEventListener("icegatheringstatechange",(function(){switch(e._pc.iceGatheringState){case"gathering":Og.debug("icegatheringstatechange | gathering"),e.emit("@icegatheringstatechange","gathering");break;case"complete":Og.debug("icegatheringstatechange | complete"),e.emit("@icegatheringstatechange","complete");break;default:Og.warn("unknown state")}})),this._pc.addEventListener("icecandidateerror",(function(e){Og.info("chrome74::icecandidateerror",e)})),this._pc.ondatachannel=function(t){Og.info("data channel created: ",t.channel.label);var n=t.channel;n.onopen=function(){Og.info("data channel open: ",t.channel.label)},n.onclose=function(){Og.warn("data channel closed: ",t.channel.label)},n.onerror=function(e){Og.error("data channel error: ",t.channel.label,e)},n.onmessage=function(){var n=(0,d.Z)((0,l.Z)().mark((function n(r){var a;return(0,l.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:Og.debug("data channel message: ",t.channel.label,r),a=String.fromCharCode.apply(null,new Uint8Array(r.data)),e.safeEmit("datachannel",t.channel,a);case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(Zg);var Mg="transport closed",Ag=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;return(0,y.Z)(this,n),(r=t.call(this,e)).name="UnsupportedError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace((0,v.Z)(r),n):r.stack=new Error(e).stack,r}return(0,k.Z)(n)}((0,a.Z)(Error)),Ng=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;return(0,y.Z)(this,n),(r=t.call(this,e)).name="InvalidStateError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace((0,v.Z)(r),n):r.stack=new Error(e).stack,r}return(0,k.Z)(n)}((0,a.Z)(Error)),Lg=Eg.getLogger("Producer"),jg=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r,a=e.id,i=e.localId,o=e.track,s=e.stopTracks,c=e.disableTrackOnPause,u=e.zeroRtpOnPause,l=e.handler,d=e.appData;return(0,y.Z)(this,n),r=t.call(this),Ko((0,v.Z)(r),"_id"),Ko((0,v.Z)(r),"_localId"),Ko((0,v.Z)(r),"_closed",!1),Ko((0,v.Z)(r),"_handler"),Ko((0,v.Z)(r),"_track"),Ko((0,v.Z)(r),"_kind"),Ko((0,v.Z)(r),"_paused"),Ko((0,v.Z)(r),"_maxSpatialLayer"),Ko((0,v.Z)(r),"_stopTracks"),Ko((0,v.Z)(r),"_disableTrackOnPause"),Ko((0,v.Z)(r),"_zeroRtpOnPause"),Ko((0,v.Z)(r),"_appData"),Ko((0,v.Z)(r),"observer"),r._id=a,r._localId=i,r._track=o,r._kind=o.kind,r._paused=!!c&&!o.enabled,r._maxSpatialLayer=void 0,r._stopTracks=s,r._disableTrackOnPause=c,r._zeroRtpOnPause=u,r._appData=d||{},r._onTrackEnded=r._onTrackEnded.bind((0,v.Z)(r)),r._handler=l,r.observer=new xg,r._handleTrack(),r}return(0,k.Z)(n,[{key:"id",get:function(){return this._id}},{key:"localId",get:function(){return this._localId}},{key:"closed",get:function(){return this._closed}},{key:"kind",get:function(){return this._kind}},{key:"track",get:function(){return this._track}},{key:"paused",get:function(){return this._paused}},{key:"maxSpatialLayer",get:function(){return this._maxSpatialLayer}},{key:"appData",get:function(){return this._appData},set:function(e){throw new Error("cannot override appData object")}},{key:"close",value:function(e){var t=this;if(!this._closed){if(Lg.debug("close() with reason:",e),this._closed=!0,this._destroyTrack(),e===Mg)return void this.observer.emit("close");this._handler.stopSending(this.localId).then((function(n){var r=n.offerSdp,a=n.callback;t.safeEmit("close",r,a,e)})).finally((function(){t.observer.emit("close")}))}}},{key:"getStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=2;break}throw new Ng("closed");case 2:return e.abrupt("return",this._handler.getSenderStats(this.localId));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pause",value:function(){Lg.debug("producer(".concat(this.id,"):pause()")),this._closed&&Lg.error("pause() | Producer closed"),this._paused=!0,this._track&&this._disableTrackOnPause&&(this._track.enabled=!1),this._zeroRtpOnPause&&this._handler.replaceTrack(this.localId,null),this.observer.emit("pause")}},{key:"resume",value:function(){Lg.debug("producer(".concat(this.id,"):resume()")),this._closed?Lg.error("resume() | Producer closed"):(this._paused=!1,this._track&&this._disableTrackOnPause&&(this._track.enabled=!0),this._zeroRtpOnPause&&this._handler.replaceTrack(this.localId,this._track),this.observer.emit("resume"))}},{key:"replaceTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.track,Lg.debug("replaceTrack() [track:%o]",n),!this._closed){e.next=6;break}if(n&&this._stopTracks)try{n.stop()}catch(r){Lg.error(r)}throw new Ng("closed");case 6:if(!n||"ended"!==n.readyState){e.next=8;break}throw new Ng("track ended");case 8:if(n!==this._track){e.next=11;break}return Lg.debug("replaceTrack() | same track, ignored"),e.abrupt("return");case 11:if(e.t0=!this._zeroRtpOnPause||!this._paused,!e.t0){e.next=15;break}return e.next=15,this._handler.replaceTrack(this.localId,n);case 15:this._destroyTrack(),this._track=n,this._track&&this._disableTrackOnPause&&(this._paused?this._paused&&(this._track.enabled=!1):this._track.enabled=!0),this._handleTrack();case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setMaxSpatialLayer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=2;break}throw new Ng("closed");case 2:if("video"===this._kind){e.next=4;break}throw new Ag("not a video Producer");case 4:if("number"==typeof t){e.next=6;break}throw new TypeError("invalid spatialLayer");case 6:if(e.t0=t!==this._maxSpatialLayer,!e.t0){e.next=11;break}return e.next=10,this._handler.setMaxSpatialLayer(this.localId,t);case 10:this._maxSpatialLayer=t;case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setRtpEncodingParameters",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=2;break}throw new Ng("closed");case 2:if("object"==typeof t){e.next=4;break}throw new TypeError("invalid params");case 4:return e.next=6,this._handler.setRtpEncodingParameters(this.localId,t);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_onTrackEnded",value:function(){Lg.debug('track "ended" event'),this.observer.emit("trackended"),this.safeEmit("trackended",this.track.id)}},{key:"_handleTrack",value:function(){this._track&&this._track.addEventListener("ended",this._onTrackEnded)}},{key:"_destroyTrack",value:function(){if(this._track)try{this._track.removeEventListener("ended",this._onTrackEnded),this._stopTracks&&this._track.stop()}catch(e){Lg.error(e)}}}]),n}(xg),Fg=Eg.getLogger("Consumer"),Ug=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r,a=e.id,i=e.localId,o=e.producerId,s=e.producingPeerId,c=e.handler,u=e.track,l=e.appData,d=e.paused;return(0,y.Z)(this,n),r=t.call(this),Ko((0,v.Z)(r),"_id"),Ko((0,v.Z)(r),"_localId"),Ko((0,v.Z)(r),"_producerId"),Ko((0,v.Z)(r),"_closed",!1),Ko((0,v.Z)(r),"_handler"),Ko((0,v.Z)(r),"_track"),Ko((0,v.Z)(r),"_paused"),Ko((0,v.Z)(r),"_peerId"),Ko((0,v.Z)(r),"_appData"),Ko((0,v.Z)(r),"observer"),r._id=a,r._localId=i,r._handler=c,r._appData=l,r._peerId=s,r._producerId=o,r._onTrackEnded=r._onTrackEnded.bind((0,v.Z)(r)),r._track=u,r._paused=null!=d&&d,r.observer=new xg,r._handleTrack(),r}return(0,k.Z)(n,[{key:"id",get:function(){return this._id}},{key:"peerId",get:function(){return this._peerId}},{key:"localId",get:function(){return this._localId}},{key:"producerId",get:function(){return this._producerId}},{key:"closed",get:function(){return this._closed}},{key:"kind",get:function(){return this._track.kind}},{key:"track",get:function(){return this._track}},{key:"paused",get:function(){return this._paused}},{key:"remotelyPaused",get:function(){return this.paused}},{key:"appData",get:function(){return this._appData},set:function(e){throw new Error("cannot override appData object")}},{key:"close",value:function(e){this._closed||(Fg.debug("close() with reason:",e),this._closed=!0,this._destroyTrack(),this.emit("close",e),this.observer.safeEmit("close",e))}},{key:"getStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=2;break}throw new Ng("closed");case 2:return e.abrupt("return",this._handler.getReceiverStats(this.localId));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pause",value:function(){Fg.debug("consumer(".concat(this.id,"):pause()")),this._closed?Fg.error("pause() | Consumer closed"):(this._paused=!0,this._track.enabled=!1,this.observer.safeEmit("pause"))}},{key:"resume",value:function(){Fg.debug("consumer(".concat(this.id,"):resume()")),this._closed?Fg.error("resume() | Consumer closed"):(this._paused=!1,this._track.enabled=!0,this.observer.safeEmit("resume"))}},{key:"_onTrackEnded",value:function(){Fg.debug('track "ended" event'),this.safeEmit("trackended"),this.observer.safeEmit("trackended")}},{key:"_handleTrack",value:function(){this._track.addEventListener("ended",this._onTrackEnded)}},{key:"_destroyTrack",value:function(){try{this._track.removeEventListener("ended",this._onTrackEnded),this._track.stop()}catch(e){Fg.error(e)}}}]),n}(xg),Bg=Eg.getLogger("Transport"),Vg=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r,a=e.id,i=e.direction,o=e.handlerFactory,s=e.iceServers,c=e.iceTransportPolicy,u=e.proprietaryConstraints,l=e.additionalSettings,d=e.appData;(0,y.Z)(this,n),r=t.call(this),Ko((0,v.Z)(r),"_id"),Ko((0,v.Z)(r),"_serverId"),Ko((0,v.Z)(r),"_closed",!1),Ko((0,v.Z)(r),"_direction"),Ko((0,v.Z)(r),"_maxSctpMessageSize"),Ko((0,v.Z)(r),"_handler"),Ko((0,v.Z)(r),"_connectionState","new"),Ko((0,v.Z)(r),"_producers"),Ko((0,v.Z)(r),"_consumers"),Ko((0,v.Z)(r),"_connected",!1),Ko((0,v.Z)(r),"_transportConnectionPromise",null),Ko((0,v.Z)(r),"awaitQueue"),Ko((0,v.Z)(r),"observer"),Ko((0,v.Z)(r),"consumerTrackEvents"),Ko((0,v.Z)(r),"unknownTracksMap"),Ko((0,v.Z)(r),"_appData"),Ko((0,v.Z)(r),"datachannelCache",new Map),Bg.debug("constructor() [id: %s, direction: %s]",a,i),r._id=a,r._direction=i;var p=function(e,t){return"undefined"==typeof e?t:JSON.parse(JSON.stringify(e))}(l,{});return delete p.iceServers,delete p.iceTransportPolicy,delete p.bundlePolicy,delete p.rtcpMuxPolicy,delete p.sdpSemantics,r._producers=new Map,r._consumers=new Map,r.consumerTrackEvents=new Map,r.unknownTracksMap=new Map,r.awaitQueue=new Ei.Cg,r.observer=new xg,r._handler=o(),r._handler.init({onTrackHandler:r._ontrack.bind((0,v.Z)(r)),direction:i,iceServers:s,iceTransportPolicy:c,additionalSettings:l,proprietaryConstraints:u}),r._appData=d||{},r._transportConnectionPromise=new Promise((function(e){r.observer.once("connected",(function(){e(!0)})),r.observer.once("disconnect",(function(){e(!1)})),r.observer.once("close",(function(){e(!1)}))})),r._handler.on("@connectionstatechange",(function(e){e!==r._connectionState&&(Bg.debug("connection state changed to %s",e),r._connectionState=e,"connected"===e&&(r._connected=!0,r.observer.emit("connected")),"disconnected"===e&&(r._connected=!1,r.observer.emit("disconnect")),"failed"===e&&(r._connected=!1,r.observer.emit("close")),r._closed||r.safeEmit("connectionstatechange",e))})),r._handler.on("@icecandidate",(function(e){var t=e.candidate;r._closed||r.safeEmit("icecandidate",t)})),r._handler.on("datachannel",(function(e,t){var n,a,i=JSON.parse(t);if(r.datachannelCache.has(i.id)||r.datachannelCache.set(i.id,[]),null==(n=r.datachannelCache.get(i.id))||n.push(i),(null==(a=r.datachannelCache.get(i.id))?void 0:a.length)===i.count){var o=r.datachannelCache.get(i.id),s=null==o?void 0:o.reduce((function(e,t){return e+t.chunk}),"");r.datachannelCache.delete(i.id);try{var c=JSON.parse(s);r.safeEmit("datachannel:".concat(e.label),e,c)}catch(c){Bg.error("error parsing message",c)}}})),r}return(0,k.Z)(n,[{key:"id",get:function(){return this._id}},{key:"serverId",get:function(){return this._serverId}},{key:"connected",get:function(){return this._connected}},{key:"isConnected",get:function(){return this._transportConnectionPromise}},{key:"closed",get:function(){return this._closed}},{key:"direction",get:function(){return this._direction}},{key:"handler",get:function(){return this._handler}},{key:"connectionState",get:function(){return this._connectionState}},{key:"appData",get:function(){return this._appData},set:function(e){throw new Error("cannot override appData object")}},{key:"setServerId",value:function(e){this._serverId=e}},{key:"close",value:function(){this._closed||(Bg.debug("close()"),this._connected=!1,this._closed=!0,this._handler.close(),(0,o.Z)(this._producers.values()).forEach((function(e){return e.close(Mg)})),this._producers.clear(),(0,o.Z)(this._consumers.values()).forEach((function(e){return e.close(Mg)})),this._consumers.clear(),this.emit("close"),this.observer.emit("close"))}},{key:"getStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=2;break}throw new Ng("closed");case 2:return e.abrupt("return",this._handler.getTransportStats());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"connect",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r,a,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Bg.info("connecting transport:",this.id),e.prev=1,e.next=4,this._handler.connect();case 4:return t=e.sent,n=t.offerSdp,r=t.callback,e.next=9,this.safeEmitAsPromise("connect",{offer:n});case 9:return a=e.sent,i=a.answer,e.next=13,r(i);case 13:e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(1),Bg.error("transport failed to connect:",e.t0),e.t0;case 18:case"end":return e.stop()}}),e,this,[[1,15]])})));return function(){return e.apply(this,arguments)}}()},{key:"restartIce",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Bg.debug("restartIce()"),!this._closed){e.next=2;break}throw new Ng("closed");case 2:return e.abrupt("return",this._handler.restartIce());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateIceServers",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(n.length>0&&void 0!==n[0]?n[0]:{}).iceServers,Bg.debug("updateIceServers()"),!this._closed){e.next=3;break}throw new Ng("closed");case 3:this._handler.updateIceServers(t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"produce",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r,a,i,o,s,c,u,p,f,h,v,m,g,y,k=this,b=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(t=b.length>0&&void 0!==b[0]?b[0]:{}).track,r=t.encodings,a=t.codecOptions,i=t.stopTracks,o=void 0===i||i,s=t.disableTrackOnPause,c=void 0===s||s,u=t.zeroRtpOnPause,p=void 0!==u&&u,f=t.appData,h=void 0===f?{}:f,Bg.debug("produce() [track:".concat(n.id,"]")),!n){e.next=14;break}if("send"===this._direction){e.next=4;break}throw new Ag("not a sending Transport");case 4:if("ended"!==n.readyState){e.next=6;break}throw new Ng("track ended");case 6:if(0!==this.listenerCount("connect")||"new"!==this._connectionState){e.next=8;break}throw new TypeError('no "connect" listener set into this transport');case 8:if(0!==this.listenerCount("produce")){e.next=10;break}throw new TypeError('no "produce" listener set into this transport');case 10:if(!h||"object"==typeof h){e.next=12;break}throw new TypeError("if given, appData must be an object");case 12:e.next=15;break;case 14:throw new TypeError("missing track");case 15:return e.next=17,this.isConnected;case 17:if(e.sent){e.next=19;break}return e.abrupt("return",Promise.reject(new Error("Transport not connected")));case 19:return e.next=21,this.awaitQueue.push((0,d.Z)((0,l.Z)().mark((function e(){var t,i,o,s,u,d,p;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k._handler.send({track:n,encodings:r,codecOption:a,screenShare:null==h?void 0:h.screenShare});case 2:return t=e.sent,i=t.offerSdp,o=t.callback,e.next=7,k.safeEmitAsPromise("produce",{offer:i,kind:n.kind,paused:!!c&&!n.enabled,appData:h});case 7:return s=e.sent,u=s.answer,d=s.producerId,e.next=12,o(u);case 12:return p=e.sent,e.abrupt("return",{producerId:d,localId:p});case 14:case"end":return e.stop()}}),e)}))));case 21:return v=e.sent,m=v.producerId,g=v.localId,y=new jg({id:m,localId:g,track:n,stopTracks:o,disableTrackOnPause:c,zeroRtpOnPause:p,appData:h,handler:this.handler}),e.abrupt("return",(this._producers.set(m,y),y.observer.on("close",(function(){k._producers.delete(y.id)})),this.emit("newproducer",y),this.observer.emit("newproducer",y),y));case 26:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"consumePeer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o=this,s=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.length>1&&void 0!==s[1]?s[1]:{},Bg.debug("consumePeer() producingPeerId:",t),!this._closed){e.next=3;break}throw new Ng("closed");case 3:if("recv"===this._direction){e.next=5;break}throw new Ag("not a receiving Transport");case 5:if("string"==typeof t){e.next=7;break}throw new TypeError("missing producingPeerId");case 7:if(0!==this.listenerCount("connect")||"new"!==this._connectionState){e.next=9;break}throw new TypeError('no "connect" listener set into this transport');case 9:if(!n||"object"==typeof n){e.next=11;break}throw new TypeError("if given, appData must be an object");case 11:return e.next=13,this.isConnected;case 13:if(e.sent){e.next=15;break}return e.abrupt("return",Promise.reject(new Error("Transport not connected")));case 15:return r=[],e.next=18,this.safeEmitAsPromise("consumePeer",{producingPeerId:t});case 18:return a=e.sent,i=a.consumersMap,e.abrupt("return",(i.forEach((function(e,a){var i=e.consumerId,s=e.trackId,c=e.screenShare,u=e.paused,l=e.streamId,d=e.kind;r.push(o._consumerCreationTask({consumerId:i,trackId:s,streamId:l,kind:d,producerId:a,producingPeerId:t,paused:u,screenShare:c,appData:n}))})),Bg.info("promises",r),Promise.allSettled(r)));case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"consume",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u,d,p,f;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.producerId,r=t.producingPeerId,a=t.appData,i=void 0===a?{}:a,Bg.debug("consume()"),!this._closed){e.next=3;break}throw new Ng("closed");case 3:if("recv"===this._direction){e.next=5;break}throw new Ag("not a receiving Transport");case 5:if("string"==typeof n){e.next=7;break}throw new TypeError("missing producerId");case 7:if(0!==this.listenerCount("connect")||"new"!==this._connectionState){e.next=9;break}throw new TypeError('no "connect" listener set into this transport');case 9:if(!i||"object"==typeof i){e.next=11;break}throw new TypeError("if given, appData must be an object");case 11:return e.next=13,this.isConnected;case 13:if(e.sent){e.next=15;break}return e.abrupt("return",Promise.reject(new Error("Transport not connected")));case 15:return e.prev=15,e.next=18,this.safeEmitAsPromise("consume",{producerId:n,producingPeerId:r});case 18:return o=e.sent,s=o.consumerId,c=o.screenShare,u=o.trackId,d=o.paused,p=o.streamId,f=o.kind,e.abrupt("return",this._consumerCreationTask({consumerId:s,screenShare:c,trackId:u,streamId:p,kind:f,paused:d,producerId:n,producingPeerId:r,appData:i}));case 28:throw e.prev=28,e.t0=e.catch(15),Bg.error("consume failed:",e.t0),e.t0;case 31:case"end":return e.stop()}}),e,this,[[15,28]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_consumerCreationTask",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,c,u,p,f,h,v,m=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.consumerId,r=t.producerId,a=t.producingPeerId,i=t.streamId,o=t.trackId,c=t.paused,u=t.screenShare,p=t.appData,f=t.kind,h="".concat(i,":").concat(f),v={consumerId:n,producerId:r,producingPeerId:a,streamId:i,trackId:o,appData:p,kind:f,paused:c,screenShare:u,name:"consumer creation task error",message:"consumer creation failed"},e.abrupt("return",new Promise((function(e,t){var i=setTimeout((function(){m.consumerTrackEvents.delete(h),v.isTimedout=!0,m.consumerTrackEvents.delete(h),t(v)}),5e3),f=function(){var f=(0,d.Z)((0,l.Z)().mark((function d(f){var h,g;return(0,l.Z)().wrap((function(l){for(;;)switch(l.prev=l.next){case 0:try{"ended"===f.track.readyState?(clearTimeout(i),t(v)):(h=f.transceiver,m.handler.midTransceiverMap.set(h.mid,h),g=new Ug({id:n,localId:f.transceiver.mid,track:f.track,paused:c,producerId:r,producingPeerId:a,handler:m._handler,appData:(0,s.Z)((0,s.Z)({},p),{},{screenShare:u})}),m._consumers.set(n,g),g.once("close",(function(){m._consumers.delete(g.id),m.handler.midTransceiverMap.delete(h.mid)})),Bg.info("consumer created for ",{producerId:r,trackId:o,producingPeerId:a}),m.observer.emit("newconsumer",g),clearTimeout(i),e(g))}catch(h){Bg.warn("error while creating consumer:",h),clearTimeout(i),t(v)}case 1:case"end":return l.stop()}}),d)})));return function(e){return f.apply(this,arguments)}}(),g=m.unknownTracksMap.get(h);g?(m.unknownTracksMap.delete(h),f(g)):m.consumerTrackEvents.set(h,f)})));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"_ontrack",value:function(e){Bg.info("track event received",e);var t="".concat(e.streams[0].id,":").concat(e.track.kind),n=this.consumerTrackEvents.get(t);n?(n(e),this.consumerTrackEvents.delete(t)):(Bg.warn("track event handler not found ".concat(t)),this.unknownTracksMap.set(t,e))}},{key:"setRemoteDescription",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._handler.pc.setRemoteDescription(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setLocalDescription",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Bg.debug("".concat(this.direction,"() {transportId: ").concat(this.serverId,"} | calling pc.setLocalDescription() [offer:%o]"),t),e.next=3,this._handler.pc.setLocalDescription(t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setRemoteOffer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setRemoteDescription(t);case 2:return e.next=4,this._handler.pc.createAnswer();case 4:return n=e.sent,e.next=7,this.setLocalDescription(n);case 7:return e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"retryFailedConsumerCreationTasks",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.allSettled(t.map((function(e){return Bg.warn("retrying failed consumer creation task",e),n._consumerCreationTask((0,s.Z)({},e))}))));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),n}(xg);function Hg(e){return"name"in e&&"consumer creation task error"===e.name}var zg=Eg.getLogger("Device");var Wg,Gg=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.handlerName,r=t.handlerFactory;if((0,y.Z)(this,e),Ko(this,"_handlerFactory"),Ko(this,"_handlerName"),Ko(this,"_observer"),zg.debug("constructor()"),n&&r)throw new TypeError("just one of handlerName or handlerInterface can be given");if(r)this._handlerFactory=r;else{if(n)zg.debug("constructor() | handler given: %s",n);else{if(n=function(){if("object"==typeof navigator&&"ReactNative"===navigator.product)return"undefined"==typeof RTCPeerConnection?void zg.warn("this._detectDevice() | unsupported ReactNative without RTCPeerConnection"):(zg.debug("this._detectDevice() | ReactNative handler chosen"),"ReactNative");if("object"!=typeof navigator||"string"!=typeof navigator.userAgent)zg.warn("this._detectDevice() | unknown device");else{var e=navigator.userAgent,t=ka().getParser(e),n=t.getEngine();if(t.satisfies({chrome:">=74",chromium:">=74","microsoft edge":">=88"}))return"Chrome74";if(t.satisfies({chrome:">=70",chromium:">=70"}))return"Chrome70";if(t.satisfies({chrome:">=67",chromium:">=67"}))return"Chrome67";if(t.satisfies({chrome:">=55",chromium:">=55"}))return"Chrome55";if(t.satisfies({firefox:">=60"}))return"Firefox60";if(t.satisfies({ios:{OS:">=14.3",firefox:">=30.0"}})||t.satisfies({safari:">=12.0"})&&"undefined"!=typeof RTCRtpTransceiver&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(t.satisfies({safari:">=11"}))return"Safari11";if(t.satisfies({"microsoft edge":">=11"})&&t.satisfies({"microsoft edge":"<=18"}))return"Edge11";if(n.name&&"blink"===n.name.toLowerCase()){var r=e.match(/(?:(?:Chrome|Chromium))[ /](\w+)/i);if(r){var a=Number(r[1]);return a>=74?"Chrome74":a>=70?"Chrome70":a>=67?"Chrome67":"Chrome55"}return"Chrome74"}zg.warn("this._detectDevice() | browser not supported [name:%s, version:%s]",t.getBrowserName(),t.getBrowserVersion())}}(),!n)throw new Error("device not supported");zg.debug("constructor() | detected handler: %s",n)}switch(n){case"Chrome74":this._handlerFactory=Rg.createFactory();break;case"Safari12":this._handlerFactory=Dg.createFactory();break;case"Firefox60":this._handlerFactory=Ig.createFactory();break;default:throw new TypeError('unknown handlerName "'.concat(n,'"'))}}var a=this._handlerFactory();this._handlerName=a.name,a.close(),this._observer=new is}return(0,k.Z)(e,[{key:"handlerName",get:function(){return this._handlerName}},{key:"createSendTransport",value:function(e){var t=e.iceServers,n=e.iceTransportPolicy,r=e.additionalSettings,a=e.proprietaryConstraints,i=e.appData;return zg.debug("createSendTransport()"),this._createTransport({direction:"send",iceServers:t,iceTransportPolicy:n,additionalSettings:r,proprietaryConstraints:a,appData:i})}},{key:"createRecvTransport",value:function(e){var t=e.iceServers,n=e.iceTransportPolicy,r=e.additionalSettings,a=e.proprietaryConstraints,i=e.appData;return zg.debug("createRecvTransport()"),this._createTransport({direction:"recv",iceServers:t,iceTransportPolicy:n,additionalSettings:r,proprietaryConstraints:a,appData:i})}},{key:"_createTransport",value:function(e){var t=e.direction,n=e.iceServers,r=e.iceTransportPolicy,a=e.additionalSettings,i=e.proprietaryConstraints,o=e.appData,s=Z(),c=new Vg({id:s,direction:t,iceServers:n,iceTransportPolicy:r,additionalSettings:a,proprietaryConstraints:i,appData:o,handlerFactory:this._handlerFactory});return zg.info("transport created",c),this._observer.emit("newtransport",c),c}}]),e}(),qg=function(){function e(t){(0,y.Z)(this,e),Xo(this,Wg,void 0),Yo(this,Wg,t)}return(0,k.Z)(e,[{key:"connectTransport",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,Wg).sendMessagePromise(wg.createWebRTCTransport,vv.toBinary(t));case 2:return n=e.sent.payload,r=mv.fromBinary(n),a=r.transportId,i=r.description,o={sdp:null==i?void 0:i.sdp,type:i.type},e.abrupt("return",{transportId:a,answer:o});case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"produce",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,Wg).sendMessagePromise(wg.produce,Zv.toBinary(t));case 2:return a=e.sent.payload,i=Bv.fromBinary(a),e.abrupt("return",{answer:{sdp:null==(n=null==i?void 0:i.description)?void 0:n.sdp,type:null==(r=null==i?void 0:i.description)?void 0:r.type},producerId:i.producerId});case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"consume",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,Wg).sendMessagePromise(wg.consume,Tv.toBinary(t));case 2:return n=e.sent.payload,r=Uv.fromBinary(n),a=r.consumerIdsMap.map,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"closeProducer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,Wg).sendMessagePromise(wg.closeProducer,Iv.toBinary(t));case 2:return n=e.sent.payload,r=Vv.fromBinary(n),a=r.description,e.abrupt("return",a);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"closeConsumer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,Wg).sendMessagePromise(wg.closeConsumer,Ov.toBinary(t));case 2:return n=e.sent.payload,e.abrupt("return",Hv.fromBinary(n));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();Wg=new WeakMap;var $g,Kg,Jg,Qg,Xg=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;return(0,y.Z)(this,n),r=t.call(this),Ko((0,v.Z)(r),"_device"),Ko((0,v.Z)(r),"_sendTransport"),Ko((0,v.Z)(r),"_recvTransport"),Ko((0,v.Z)(r),"_consumers"),Ko((0,v.Z)(r),"_producers"),Ko((0,v.Z)(r),"_producerIdToConsumerIdMap"),Ko((0,v.Z)(r),"_logger"),Ko((0,v.Z)(r),"_socket"),Ko((0,v.Z)(r),"_socketHandler"),r._producers=new Map,r._consumers=new Map,r._producerIdToConsumerIdMap=new Map,r._device=new Gg,r._logger=Eg.getLogger("HiveSFUHandler"),r._socket=e,r._socketHandler=new qg(e),r}return(0,k.Z)(n,[{key:"socket",get:function(){return this._socket}},{key:"producers",get:function(){return this._producers}},{key:"consumers",get:function(){return this._consumers}},{key:"producerIdToConsumerIdMap",get:function(){return this._producerIdToConsumerIdMap}},{key:"setupTransports",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vg().getICEServers();case 2:return t=e.sent,e.next=5,Promise.all([this.createRecvTransport({iceServers:t}),this.createSendTransport({iceServers:t})]);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stopAllTransports",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._logger.info("closing all the transports"),this._sendTransport.close(),this._recvTransport.close();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createSendTransport",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._sendTransport||!this._sendTransport.connected){e.next=2;break}return e.abrupt("return");case 2:return qp.info("sendTransport::initializing_transport"),n=this._device.createSendTransport(t),qp.info("sendTransport::initialized_transport"),this.handleTransport(n,!1),qp.info("sendTransport::connecting_transport"),e.next=9,n.connect();case 9:qp.info("sendTransport::connected_transport"),this._sendTransport=n,Lc.onSafeInitialization((function(){Lc.configureSendTransport(n)})),Object.assign(window,{sendTransport:n});case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createRecvTransport",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._recvTransport||!this._recvTransport.connected){e.next=2;break}return e.abrupt("return");case 2:return qp.info("recvTransport::initializing_transport"),n=this._device.createRecvTransport(t),Lc.onSafeInitialization((function(){Lc.configureRecvTransport(n)})),qp.info("recvTransport::initialized_transport"),this.handleTransport(n,!0),qp.info("recvTransport::connecting_transport"),e.next=10,n.connect();case 10:qp.info("recvTransport::connected_transport"),this._recvTransport=n;case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleTransport",value:function(e,t){var n=this;e.on("connect",function(){var r=(0,d.Z)((0,l.Z)().mark((function r(a,i,o){var s,c,u,d,p;return(0,l.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return s=a.offer,r.prev=1,c={consuming:t,description:{sdp:s.sdp,type:s.type,target:t?lv.SUBSCRIBER:lv.PUBLISHER}},r.next=5,n._socketHandler.connectTransport(c);case 5:u=r.sent,d=u.transportId,p=u.answer,e.setServerId(d),i({answer:p}),r.next=14;break;case 11:r.prev=11,r.t0=r.catch(1),n._logger.error("".concat(t?"consumer":"producer"," transport connection error:"),r.t0),o(r.t0);case 14:case"end":return r.stop()}}),r,null,[[1,11]])})));return function(e,t,n){return r.apply(this,arguments)}}()),e.on("connectionstatechange",function(){var r=(0,d.Z)((0,l.Z)().mark((function r(a){return(0,l.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:r.t0=(n._logger.info("".concat(t?"consumer":"producer"," transport connectionState:"),a),a),r.next="failed"===r.t0||"disconnected"===r.t0?3:7;break;case 3:if(!e.closed){r.next=5;break}return r.abrupt("return");case 5:return n._logger.info("".concat(t?"consumer":"producer"," transport disconnected or failed, reconnecting...")),Vc.hasFeature(Sp.ENABLE_HIVE_TRANSPORT_RECONNECTION_ON_ICE_FAILED)&&n.emit("reconnect_transport",e),r.abrupt("break",7);case 7:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()),e.on("icecandidate",function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n._logger.debug("sending icecandidate:",t.toJSON());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.on("datachannel:events",function(){var t=(0,d.Z)((0,l.Z)().mark((function t(r,a){var i,o,s,c,u,d,p;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n._logger.debug("got data channel message on event:",a),t.prev=1,t.t0=a.type,t.next="offer"===t.t0?5:"consumer_toggle"===t.t0?18:26;break;case 5:return i={sdp:a.payload.sdp,type:"offer"},t.prev=6,t.next=9,e.setRemoteOffer(i);case 9:s=t.sent,o={type:"answer",payload:{type:s.type,sdp:s.sdp}},t.next=16;break;case 13:t.prev=13,t.t1=t.catch(6),n._logger.error("datachannel:events::Error:",t.t1),o={type:"error",payload:{type:"answer",sdp:t.t1.message}};case 16:return n._logger.debug("datachannel answer:",o),r.send(JSON.stringify(o)),t.abrupt("break",28);case 18:if(c=a.payload,u=c.mute,d=c.trackId,n._logger.info("consumer toggled for",d,"muted:",u),p=n.consumers.get(d)){t.next=24;break}return n._logger.warn("consumer with id",d," not found"),t.abrupt("return");case 24:return p.paused!==u&&(n._logger.debug("consumer state is not same",{consumerPaused:p.paused,mute:u}),u?(p.pause(),vf.emit(ff.CONSUMER_PAUSED,{id:p.id})):(p.resume(),vf.emit(ff.CONSUMER_RESUMED,{id:p.id}))),t.abrupt("break",28);case 26:return n._logger.warn("unknown event received from hive node, event:",a.type),t.abrupt("break",28);case 28:t.next=33;break;case 30:t.prev=30,t.t2=t.catch(1),n._logger.error("Unable to handle the incoming datachannel message on",r.label);case 33:case"end":return t.stop()}}),t,null,[[1,30],[6,13]])})));return function(e,n){return t.apply(this,arguments)}}()),e.on("negotiate",function(){var t=(0,d.Z)((0,l.Z)().mark((function t(r,a,i){var o,s,c;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=r.description,t.prev=1,s={sdp:null==o?void 0:o.sdp,type:null==o?void 0:o.type},t.next=5,n.negotiate(e,s);case 5:c=t.sent,a({answer:c}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),n._logger.error("negotiate error:",t.t0),i(t.t0);case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e,n,r){return t.apply(this,arguments)}}()),e.on("close",(function(){n._logger.info("".concat(t?"consumer":"producer"," transport closed"),e.id),t?n._recvTransport=void 0:n._sendTransport=void 0})),t?(e.on("datachannel:negotiation",function(){var t=(0,d.Z)((0,l.Z)().mark((function t(r,a){var i,o;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n._logger.info("datachannel message recieved:",r.label,a),i={sdp:a,type:"offer"},t.next=5,e.setRemoteOffer(i);case 5:o=t.sent,n._logger.info("datachannel answer:",o),r.send(o.sdp),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),n._logger.error("datachannel:negotiation::Error:",t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,n){return t.apply(this,arguments)}}()),e.on("consumePeer",function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,r,a){var i,o,s,c;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.producingPeerId,n._logger.info("consumePeer:",i),o={producingPeerId:i},e.prev=3,e.next=6,n._socketHandler.consume(o);case 6:s=e.sent,n._logger.debug("consumePeer response for ".concat(i,":"),{consumerStateMap:s}),c=new Map,Object.entries(s).forEach((function(e){var t,n,r,a=(0,u.Z)(e,2),i=a[0],o=a[1];c.set(i,{consumerId:o.consumerId,trackId:null==(t=o.producerTrack)?void 0:t.trackId,streamId:o.producerTrack.streamId,kind:o.producerState.kind===dv.VIDEO?"video":"audio",screenShare:null==(n=o.producerState)?void 0:n.screenShare,paused:null==(r=o.producerState)?void 0:r.pause})})),r({consumersMap:c}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),n._logger.error("consumePeer error:",e.t0),a(e.t0);case 15:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t,n,r){return e.apply(this,arguments)}}()),e.on("consume",function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,r,a){var i,o,s,c,u,d,p,f;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.producerId,o=t.producingPeerId,p={producingPeerId:o,producerId:i},e.prev=2,e.next=5,n._socketHandler.consume(p);case 5:e.t0=i,f=e.sent[e.t0],n._logger.info("consumer create response:",{consumerState:f,paused:null==(s=f.producerState)?void 0:s.pause}),r({consumerId:f.consumerId,screenShare:null==(c=f.producerState)?void 0:c.screenShare,trackId:null==(u=f.producerTrack)?void 0:u.trackId,streamId:f.producerTrack.streamId,kind:f.producerState.kind===dv.VIDEO?"video":"audio",paused:null==(d=f.producerState)?void 0:d.pause}),e.next=13;break;case 10:e.prev=10,e.t1=e.catch(2),n._logger.error("error during consuming on server:",e.t1),a(e.t1);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n,r){return e.apply(this,arguments)}}())):e.on("produce",function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,r,a){var i,o,s,c,u,d,p,f,h,v;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.offer,o=t.kind,s=t.paused,c=t.appData,d=Si.Qc(i.sdp).media.filter((function(e){return"video"===o?"video"===e.type:"audio"===e.type})).at(-1).msid,p={description:{sdp:i.sdp,type:i.type,target:lv.PUBLISHER},paused:s,kind:o,msid:d,screenShare:null!=(u=c.screenShare)&&u},e.prev=2,e.next=5,n._socketHandler.produce(p);case 5:f=e.sent,h=f.answer,v=f.producerId,r({answer:h,producerId:v}),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),n._logger.error("create producer error:",e.t0),a(e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t,n,r){return e.apply(this,arguments)}}())}},{key:"createProducer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n,r){var a,i=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this._sendTransport&&!this._sendTransport.closed){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this._sendTransport.produce(n);case 4:(a=e.sent).on("close",function(){var e=(0,d.Z)((0,l.Z)().mark((function e(n,o,s){var c,u,d;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i._logger.info("producer id:",a.id,"closed with reason:",s),c={producerId:a.id,description:{sdp:n.sdp,type:n.type,target:lv.PUBLISHER}},e.prev=2,e.next=5,i._socketHandler.closeProducer(c);case 5:u=e.sent,i._logger.info("response",u),d={sdp:null==u?void 0:u.sdp,type:null==u?void 0:u.type},o(d),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),i._logger.error("producer close error:",e.t0);case 14:i._producers.delete(t),r();case 15:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t,n,r){return e.apply(this,arguments)}}()),a.on("trackended",(function(){qp.info("producer::trackended",{producerType:t}),[xf.MIC,xf.WEBCAM].includes(t)||r()})),this._producers.set(t,a);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_initConsumer",value:function(e){var t=this;e&&(e.observer.on("close",(0,d.Z)((0,l.Z)().mark((function n(){return(0,l.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t._consumers.delete(e.id),vf.emit(ff.CONSUMER_CLOSED,{id:e.id});case 1:case"end":return n.stop()}}),n)})))),this._consumers.set(e.id,e),this.producerIdToConsumerIdMap.set(e.producerId,e.id),vf.emit(ff.NEW_CONSUMER,{id:e.id}))}},{key:"consumePeer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this._recvTransport&&!this._recvTransport.closed){e.next=2;break}throw Error("Receiving transport not connected");case 2:return e.prev=2,e.next=5,this._recvTransport.consumePeer(t);case 5:n=e.sent,r=[],n.forEach((function(e){"rejected"===e.status?r.push(e.reason):a._initConsumer(e.value)})),this._recvTransport.retryFailedConsumerCreationTasks(r).then((function(e){e.forEach((function(e){"rejected"===e.status?a._logger.error("consumer creation failed 2nd time, this should never happen second time.",e.reason):a._initConsumer(e.value)}))})),e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(2),this._logger.error("got error in consumePeer",e.t0),e.t0;case 13:case"end":return e.stop()}}),e,this,[[2,10]])})));return function(t){return e.apply(this,arguments)}}()},{key:"createConsumer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this._recvTransport&&!this._recvTransport.closed){e.next=2;break}return e.abrupt("return");case 2:if(n=t.producerId,r=t.producingPeerId,a=t.appData,!this.getProducer(n)){e.next=6;break}return this._logger.warn("why are you creating a consumer for local producer?"),e.abrupt("return");case 6:return e.prev=6,e.next=9,this._recvTransport.consume({producerId:n,producingPeerId:r,appData:a});case 9:i=e.sent,this._initConsumer(i),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(6),Hg(e.t0)&&this._recvTransport.retryFailedConsumerCreationTasks([e.t0]).then((function(e){var t=(0,u.Z)(e,1)[0];"fulfilled"===t.status?o._initConsumer(t.value):o._logger.error("failed to complete consumer creation task again.","this should not happen",t.reason)}));case 16:Object.assign(window,{consumers:this._consumers});case 17:case"end":return e.stop()}}),e,this,[[6,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseProducer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._producers.get(t)){e.next=4;break}return this._logger.warn("producer type:",t,"not found"),e.abrupt("return");case 4:n.pause(),this._logger.info(t,"producer id:",n.id,"paused");case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeProducer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._producers.get(t)){e.next=4;break}return this._logger.warn("producer type:",t,"not found"),e.abrupt("return");case 4:n.resume(),this._logger.info(t,"producer id:",n.id,"resumed");case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"replaceTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._producers.get(t)){e.next=4;break}return this._logger.warn("producer type:",t,"not found"),e.abrupt("return");case 4:return e.next=6,r.replaceTrack({track:n});case 6:this._logger.info("track replaced with id:",n.id,"on producer:",t);case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"removeProducer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._producers.get(t)){e.next=4;break}return this._logger.warn("producer type:",t,"not found"),e.abrupt("return");case 4:n&&r.track.stop(),r.close();case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"pauseConsumer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._consumers.get(t)){e.next=4;break}return this._logger.warn("consumer id:",t,"not found"),e.abrupt("return");case 4:return e.prev=4,r={consumerId:t,pause:!0},e.next=8,this.socket.sendMessagePromise(wg.toggleConsumer,Pv.toBinary(r));case 8:n.pause(),vf.emit(ff.CONSUMER_PAUSED,{id:n.id}),this._logger.info("consumer:",t,"paused"),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(4),this._logger.error("error on pausing consumer",e.t0);case 16:case"end":return e.stop()}}),e,this,[[4,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeConsumer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._consumers.get(t)){e.next=4;break}return this._logger.warn("consumer id:",t,"not found"),e.abrupt("return");case 4:return e.prev=4,r={consumerId:t,pause:!1},e.next=8,this.socket.sendMessagePromise(wg.toggleConsumer,Pv.toBinary(r));case 8:n.resume(),vf.emit(ff.CONSUMER_RESUMED,{id:n.id}),this._logger.info("consumer:",t,"resumed"),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(4),this._logger.error("error on resuming consumer",e.t0);case 16:case"end":return e.stop()}}),e,this,[[4,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"closeConsumer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.closeConsumers([t],n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"closeConsumers",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o,s=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._logger.debug("Closing consumers:",t,"with force:",n),r=!0,a=t.filter((function(e){return!!s._consumers.get(e)||(s._logger.warn("consumer id:",e,"not found"),!1)})),i={consumerIds:a},o=function(){return s._recvTransport.awaitQueue.push((0,d.Z)((0,l.Z)().mark((function e(){var t,n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.socket.sendMessagePromise(wg.closeConsumer,Ov.toBinary(i));case 2:t=e.sent.payload,n=Hv.fromBinary(t),s._logger.debug("consumer close response:",n);case 5:case"end":return e.stop()}}),e)})))).catch((function(e){s._logger.warn("error on closing consumer:",e),r=n}))},!n){e.next=7;break}o(),e.next=9;break;case 7:return e.next=9,o();case 9:r&&a.forEach((function(e){var t=s.consumers.get(e);s.producerIdToConsumerIdMap.delete(t.producerId),t.close("manually closed")}));case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"cleanupConsumers",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(n=this._consumers)||n.forEach((function(e){t?e.peerId===t&&r.closeConsumer(e.id,!0):r.closeConsumer(e.id,!0)}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopAllProducers",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._logger.info("stopping all available producers"),this._producers.forEach((function(e,n){t._logger.debug("closing producer type",n),e.close()}));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getProducer",value:function(e){return(0,o.Z)(this.producers.values()).filter((function(t){return t.id===e})).at(0)}},{key:"negotiate",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._logger.info("initiating negotiation",n),this._logger.info("setting remote offer :",n,"on transport",t.serverId),e.next=3,t.setRemoteOffer(n);case 3:return r=e.sent,a={transportId:t.serverId,description:{sdp:r.sdp,type:r.type,target:lv.SUBSCRIBER}},this._logger.info("sending renegotiate request",a),e.next=8,this.socket.sendMessagePromise(wg.renegotiateSessionDescription,gv.toBinary(a));case 8:return this._logger.info("renegotiation done",t.serverId),e.abrupt("return",r);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(Sg),Yg=Object.defineProperty,ey=Object.getOwnPropertyDescriptor,ty=function(e,t,n,r){for(var a,i=r>1?void 0:r?ey(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Yg(t,n,i),i},ny=(Qg=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;(0,y.Z)(this,n),r=t.call(this),Xo((0,v.Z)(r),$g,void 0),Xo((0,v.Z)(r),Kg,void 0),Xo((0,v.Z)(r),Jg,void 0),Ko((0,v.Z)(r),"legacyMode"),Ko((0,v.Z)(r),"roomNodeUrl"),Ko((0,v.Z)(r),"peerDisplayName"),Ko((0,v.Z)(r),"activatedProducingPeerIds"),Ko((0,v.Z)(r),"logger");var a=e.roomName,i=e.peerId,o=e.authToken,s=e.legacyMode,c=e.socketClient,u=e.meetingTitle;return r.roomName=a,r.peerId=i,r.authToken=o,r.legacyMode=s,r.roomJoined=!1,r.meetingTitle=u,Yo((0,v.Z)(r),$g,c),Yo((0,v.Z)(r),Kg,new Xg(c)),r.maxPreferredStreams=6,r.activatedProducingPeerIds=new Set,r.logger=Eg.getLogger("HiveNodeClient()"),Lc.legacySwitch(s),r.handleSocketEvents(),r.handleSFUEvents(),Yo((0,v.Z)(r),Jg,(function(){r.logger.info("noop reconnection handler")})),r}return(0,k.Z)(n,[{key:"sfuHandler",get:function(){return Qo(this,Kg)}},{key:"onSocketReconnection",set:function(e){Yo(this,Jg,e)}},{key:"reconnectTransport",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=Qo(this,$g).isConnected,e.t0){e.next=4;break}return e.next=4,Qo(this,$g).connect();case 4:if(t){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,vg().getICEServers();case 8:if(n=e.sent,t.close(),"send"!==t.direction){e.next=15;break}return e.next=12,this.sfuHandler.createSendTransport({iceServers:n});case 12:return this.logger.info("tranport connected now need to start creating producers"),vf.emit(ff.RESET_PRODUCER_STATE),e.abrupt("return");case 15:return this.sfuHandler.cleanupConsumers(),e.next=18,this.sfuHandler.createRecvTransport({iceServers:n});case 18:return r=(0,o.Z)(this.activatedProducingPeerIds),this.logger.info("activePeers",this.activatedProducingPeerIds),this.activatedProducingPeerIds=new Set,a=[],this.logger.info("to activate",r),r.forEach((function(e){a.push(i.consumePeer(e,!0))})),e.next=25,Promise.all(a);case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupTransports",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,Kg).setupTransports();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"joinRoom",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n,r,a){var i,o,c,u,p,f,h,v,m,g,y,k,b,w=this,_=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=_.length>4&&void 0!==_[4]?_[4]:{},this.peerDisplayName=t,o={roomUuid:r,displayName:t,prejoined:!1},e.prev=3,e.next=6,Qo(this,$g).sendMessagePromise(wg.joinRoom,Sv.toBinary(o));case 6:return c=e.sent,u=jv.fromBinary(c.payload),p=u.participants,f=u.roomState,h=u.maxPreferredStreams,v=u.selectedPeers,this.logger.debug("peerJoinResponse",{participants:p,roomState:f,selectedPeers:v}),this.roomUUID=f.roomUuid,this.maxPreferredStreams=h,m=p.map((function(e){var t=e.producerStates,n={id:e.peerId,isHost:!1,displayName:e.displayName,flags:{},userId:e.peerId,audioMuted:!0,videoEnabled:!1,audioTrack:null,videoTrack:null,producers:[]};return t.forEach((function(e){e.kind===dv.AUDIO?n.audioMuted=e.pause:n.videoEnabled=!e.pause,n.producers.push({producerId:e.producerId,kind:e.kind===dv.AUDIO?"audio":"video",pause:e.pause,screenShare:e.screenShare})})),n})),y=(g=null!=v?v:{}).audioPeers,k=g.compulsoryPeers,b=m.filter((function(e){return e.id!==w.peerId})),this.logger.debug("audioPeers: ",y,"compulsoryPeer",k),e.next=17,this.setupTransports();case 17:return this.roomJoined=!0,qp.info("RoomNodeClient::joinRoom::pre_emitasync_room_joined"),e.next=21,vf.emitAsync(ff.ROOM_JOINED,{peers:b});case 21:return f.isRecording&&vf.emit(ff.HIVE_RECORDING_STARTED,f.recorderParticipantId),qp.info("RoomNodeClient::joinRoom::post_emitasync_room_joined"),vf.emit(ff.SELF_ROOM_JOINED),vf.emit(ff.SELECTED_PEERS,{peerIds:null!=y?y:[],compulsoryPeers:k}),vf.emit(ff.REFRESH_GRID),Vc.hasFeature(Sp.INTERNAL_CALL_STATS)&&"ReactNative"!==navigator.product&&setTimeout((0,d.Z)((0,l.Z)().mark((function e(){var n,r,a,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vg().getUserDetails();case 2:r=e.sent,a=av.isV2AuthToken?r.participant:r,o={userId:null!=(n=a.id)?n:a.participant.id,peerId:w.peerId,displayName:t,roomUUID:w.roomUUID,roomViewType:"groupCall",roomName:w.roomName,deviceInfo:(0,s.Z)((0,s.Z)({},zp.getDeviceInfo()),{},{userAgent:navigator.userAgent,memory:navigator.deviceMemory,cpus:navigator.hardwareConcurrency}),metaData:{},permissions:{}},Lc.roomJoined(o),null!=i&&i.audio?Lc.audioOn():Lc.audioOff(),null!=i&&i.video?Lc.videoOn():Lc.videoOff();case 6:case"end":return e.stop()}}),e)})))),e.abrupt("return",{roomJoined:!0});case 30:return e.prev=30,e.t0=e.catch(3),e.abrupt("return",(this.logger.error("error on sending join room request",e.t0),{roomJoined:!1}));case 33:case"end":return e.stop()}}),e,this,[[3,30]])})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"leaveRoom",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,Kg).stopAllTransports();case 2:return n={closeRoom:!1},e.prev=3,e.next=6,Qo(this,$g).sendMessagePromise(wg.leaveRoom,Ev.toBinary(n));case 6:r=e.sent,(null==(t=Fv.fromBinary(r.payload))?void 0:t.closed)||this.logger.warn("weird state on peer closed and should not happen"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),this.logger.error("error on sending leave room request",e.t0);case 13:Lc.callEnded(),Gp.destruct();case 14:case"end":return e.stop()}}),e,this,[[3,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"getConsumers",value:function(){return Qo(this,Kg).consumers}},{key:"activatePeers",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],t.filter((function(e){return 0!==e.producers.length})).forEach((function(e){var t=e.peerId,a=e.producers,i=e.force,o=!1;a.forEach((function(e){var t=r.sfuHandler.producerIdToConsumerIdMap.get(e.producerId);t?r.sfuHandler.consumers.get(t).paused!==e.pause&&(o=!0):o=!0})),n.push(r.consumePeer(t,i||o))})),e.next=4,Promise.all(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"deactivatePeers",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.logger.info("deactivating producers",t),n=[],t.producers.forEach((function(e){var t=e.producerId,a=e.kind,i=e.screenShare;if("audio"===a||"video"===a&&i)r.logger.debug("we don't want to pause audio or screenshare");else{var o=r.sfuHandler.producerIdToConsumerIdMap.get(t);o?n.push(o):r.logger.warn("consumer not found in deactivate producers:",t)}})),this.sfuHandler.closeConsumers(n),this.activatedProducingPeerIds.delete(t.peerId);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createConsumer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.producerId,r=t.producingPeerId,a=t.screenShare,e.abrupt("return",this.sfuHandler.createConsumer({producerId:n,producingPeerId:r,appData:{screenShare:a}}));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseConsumer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.forEach((function(e){n.sfuHandler.pauseConsumer(e)}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"closeConsumers",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,o.Z)(this.getConsumers().values()).filter((function(e){return t.includes(e.peerId)})).map((function(e){return e.id})),e.abrupt("return",(t.forEach((function(e){r.activatedProducingPeerIds.delete(e)})),this.sfuHandler.closeConsumers(n)));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"consumePeer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.logger.info("current activated Peer ids",this.activatedProducingPeerIds),this.activatedProducingPeerIds.has(t)&&!n){e.next=12;break}return e.prev=1,e.next=4,Qo(this,Kg).consumePeer(t);case 4:this.activatedProducingPeerIds.add(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),this.logger.error("consumePeer failed in HiveNodeClient.ts",e.t0);case 10:e.next=13;break;case 12:this.logger.info("not creating consumer for this peerId",t);case 13:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"shareWebcam",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}return e.abrupt("return");case 2:if(!Qo(this,Kg).producers.has(xf.WEBCAM)){e.next=12;break}if((n=Qo(this,Kg).producers.get(xf.WEBCAM)).closed){e.next=10;break}return e.next=7,n.replaceTrack({track:t});case 7:return e.next=9,this.resumeWebcam();case 9:return e.abrupt("return");case 10:return e.next=12,Qo(this,Kg).removeProducer(n.id);case 12:return r={track:t,codecOptions:{name:"VP8"},appData:{screenShare:!1},stopTracks:!1},Vc.hasFeature(Sp.ENABLE_HIVE_SIMULCAST)&&(r.encodings=Ef),a=function(){i.disableWebcam()},e.next=17,Qo(this,Kg).createProducer(xf.WEBCAM,r,a);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"shareScreen",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.video,r=t.audio,void 0!==n){e.next=3;break}return e.abrupt("return");case 3:return a={track:n,codecOptions:{name:"VP8"},appData:{screenShare:!0,supportsRemoteControl:zp.isElectron()},stopTracks:!1},i=function(){s.disableScreenShare()},Lc.screenShareRequested(),e.next=8,Qo(this,Kg).createProducer(xf.SCREENSHARE_VIDEO,a,i);case 8:if(!r){e.next=13;break}return o={track:r,codecOptions:{name:"opus"},appData:{screenShare:!0,supportsRemoteControl:zp.isElectron()},stopTracks:!1},i=function(){},e.next=13,Qo(this,Kg).createProducer(xf.SCREENSHARE_AUDIO,o,i);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"shareMic",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}return e.abrupt("return");case 2:if(!Qo(this,Kg).producers.has(xf.MIC)){e.next=12;break}if((n=Qo(this,Kg).producers.get(xf.MIC)).closed){e.next=10;break}return e.next=7,n.replaceTrack({track:t});case 7:return e.next=9,this.resumeMic();case 9:return e.abrupt("return");case 10:return e.next=12,Qo(this,Kg).removeProducer(xf.MIC,!1);case 12:return r={track:t,codecOptions:{name:"opus"},stopTracks:!1},a=function(){i.disableMic()},e.next=15,Qo(this,Kg).createProducer(xf.MIC,r,a);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseMic",value:function(){var e=Qo(this,Kg).producers.get(xf.MIC);if(e)if(e.paused)qp.info("pauseMic::mic_producer_already_paused");else{e.pause();var t={producerId:e.id,pause:!0};Qo(this,$g).sendMessage(wg.toggleProducer,Rv.toBinary(t))}else qp.error("pauseMic::could_not_find_mic_producer")}},{key:"pauseWebcam",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Qo(this,Kg).producers.get(xf.WEBCAM)){e.next=4;break}return qp.error("pauseWebcam::could_not_find_webcam_producer"),e.abrupt("return");case 4:t.pause(),n={producerId:t.id,pause:!0},Qo(this,$g).sendMessage(wg.toggleProducer,Rv.toBinary(n));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resumeMic",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Qo(this,Kg).producers.get(xf.MIC)){e.next=4;break}return qp.error("resumeMic::could_not_find_mic_producer"),e.abrupt("return");case 4:if(t.pause){e.next=7;break}return qp.info("resumeMic::mic_producer_already_resumed"),e.abrupt("return");case 7:t.resume(),n={producerId:t.id,pause:!1},Qo(this,$g).sendMessage(wg.toggleProducer,Rv.toBinary(n));case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resumeWebcam",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Qo(this,Kg).producers.get(xf.WEBCAM)){e.next=4;break}return qp.error("resumeWebcam::could_not_find_webcam_producer"),e.abrupt("return");case 4:t.resume(),n={producerId:t.id,pause:!1},Qo(this,$g).sendMessage(wg.toggleProducer,Rv.toBinary(n));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"disableWebcam",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,Kg).removeProducer(xf.WEBCAM);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"disableMic",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,Kg).removeProducer(xf.MIC);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"disableScreenShare",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return qp.info("screen_sharing_stopped"),e.next=3,Qo(this,Kg).removeProducer(xf.SCREENSHARE_VIDEO);case 3:return e.next=5,Qo(this,Kg).removeProducer(xf.SCREENSHARE_AUDIO);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"muteSelf",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.pauseMic();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"unmuteSelf",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resumeMic();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resetVideoProducers",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t,!e.t0){e.next=5;break}return e.next=4,Qo(this,Kg).removeProducer(xf.WEBCAM,!1);case 4:this.shareWebcam(t);case 5:if(e.t1=n,!e.t1){e.next=10;break}return e.next=9,Qo(this,Kg).removeProducer(xf.SCREENSHARE_VIDEO,!1);case 9:this.shareScreen({video:n});case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getPolls",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{payload:{polls:{}}});case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"pinPeer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={participantId:null!=t?t:""},e.prev=1,e.next=4,Qo(this,$g).sendMessagePromise(wg.globalPinPeer,Cv.toBinary(n));case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),this.logger.error("Error in pinning peer: ".concat(e.t0));case 9:case"end":return e.stop()}}),e,this,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()},{key:"handleSocketEvents",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Qo(this,$g).on(wg.peerJoinedBroadcast,(function(e){var n=e.id,r=e.payload;if(t.roomJoined){t.logger.debug("got peer joined with id",n);try{var a=zv.fromBinary(r).participant,i=a.peerId,o=a.displayName,s=a.producerStates;if(i===t.peerId)return;t.logger.info("peer-joined",{peerId:i,displayName:o,producerStates:s});var c={id:i,isHost:!1,displayName:o,flags:{},userId:i,audioMuted:!0,videoEnabled:!1,audioTrack:null,videoTrack:null,producers:[]};s.forEach((function(e){e.kind===dv.AUDIO?c.audioMuted=e.pause:c.videoEnabled=!e.pause,c.producers.push({producerId:e.producerId,kind:e.kind===dv.AUDIO?"audio":"video",pause:e.pause,screenShare:e.screenShare})})),vf.emit(ff.PEER_JOINED,c),vf.emit(ff.REFRESH_GRID)}catch(u){t.logger.error("error in peer-joined-broadcast",u)}}})),Qo(this,$g).on(wg.peerProducerCreateBroadcast,(function(e){var n=e.payload;if(t.roomJoined)try{var r=Wv.fromBinary(n),a=r.participantId,i=r.producerState;if(a===t.peerId)return;t.logger.info("producer created broadcast:",a,"producer state",i),vf.emit(ff.NEW_PRODUCER,{peerId:a,producer:{producerId:i.producerId,kind:i.kind===dv.AUDIO?"audio":"video",pause:i.pause,screenShare:i.screenShare}})}catch(o){t.logger.error("error in peer-producer-create-broadcast",o)}})),Qo(this,$g).on(wg.peerProducerToggleBroadcast,(function(e){var n=e.payload;if(t.roomJoined)try{var r=Gv.fromBinary(n),a=r.participantId,i=r.producerState,s=i.kind,c=i.pause,u=i.producerId;if(a===t.peerId)return;var l=s===dv.AUDIO?"audio":"video";t.logger.info("producer toggle broadcast:",a,"producerId",u,"kind",s,"paused",c),vf.emit(ff.PRODUCER_TOGGLE,{peerId:a,producerId:u,paused:c,kind:l}),(0,o.Z)(t.getConsumers().values()).filter((function(e){return e.producerId===u})).forEach((function(e){e.paused!==c&&(t.logger.debug("consumer state mismatched for",e.id,". updating consumer pause state",e.paused,"to",c),c?(e.pause(),vf.emit(ff.CONSUMER_PAUSED,{id:e.id})):(e.resume(),vf.emit(ff.CONSUMER_RESUMED,{id:e.id})))}))}catch(d){t.logger.error("error in producer toggle broadcast handler",d)}})),Qo(this,$g).on(wg.selectedPeer,(function(e){var n=e.payload;if(t.roomJoined)try{var r=Av.fromBinary(n),a=r.audioPeers,i=r.compulsoryPeers;t.logger.info("selected peers:",a,i),vf.emit(ff.SELECTED_PEERS,{peerIds:i.concat(a)})}catch(o){t.logger.error("error in selected-peer",o)}})),Qo(this,$g).on(wg.selectedPeerDiff,(function(e){var n=e.payload;if(t.roomJoined)try{var r=Lv.fromBinary(n).entries;t.logger.debug("selected peers diff:",r);var a=r.map((function(e){return{peerId:e.peerId,priority:e.priority}}));vf.emit(ff.SELECTED_PEERS_DIFF,{entries:a})}catch(i){t.logger.error("error in selected-peer-diff",i)}})),Qo(this,$g).on(wg.peerLeaveBroadcast,(function(e){var n=e.payload;if(t.roomJoined)try{var r=$v.fromBinary(n).participantId;if(r===t.peerId)return;t.logger.info("peer left broadcast:",r),t.sfuHandler.cleanupConsumers(r),vf.emit(ff.PEER_CLOSED,{id:r})}catch(a){t.logger.error("error in peer left broadcast",a)}})),Qo(this,$g).on(wg.peerProducerCloseBroadcast,(function(e){var n=e.payload;if(t.roomJoined)try{var r=qv.fromBinary(n),a=r.participantId,i=r.producerState.producerId;if(a===t.peerId)return;t.logger.info("producer closed broadcast:",a),vf.emit(ff.PRODUCER_CLOSED,{peerId:a,producerId:i});var o=t.sfuHandler.producerIdToConsumerIdMap.get(i);if(!o)return void t.logger.warn("no consumer found for producer",i);t.logger.info("closing consumer",o,"producer id ",i),t.sfuHandler.closeConsumer(o).then((function(){t.logger.info("closed consumer",o),t.sfuHandler.producerIdToConsumerIdMap.delete(i),vf.emit(ff.CONSUMER_CLOSED,{id:o})})).catch((function(e){t.logger.error("error closing consumer",e)}))}catch(s){t.logger.error("error on producer close broadcast",s)}})),Qo(this,$g).on(wg.globalPeerPinBroadcast,(function(e){var n=e.payload;if(t.roomJoined)try{var r;if(n){var a=Kv.fromBinary(n);t.logger.info("pinning peerId: ",a),r=a.participantId}vf.emit(ff.PEER_PINNED,{peerId:r})}catch(i){t.logger.error("error on global peer pin broadcast",i)}})),Qo(this,$g).on(wg.recordingStartedBroadcast,(function(e){var n=e.payload;if(t.roomJoined)try{var r;if(n){var a=Jv.fromBinary(n);t.logger.info("recording started. peerId: ",a),r=a.participantId}vf.emit(ff.HIVE_RECORDING_STARTED,r)}catch(i){t.logger.error("error on recording started broadcast",i)}})),Qo(this,$g).on(wg.recordingStoppedBroadcast,(function(e){var n=e.payload;if(t.roomJoined)try{if(n){var r=Qv.fromBinary(n);t.logger.info("recording stopped. peerId: ",r)}vf.emit(ff.HIVE_RECORDING_STOPPED,undefined)}catch(a){t.logger.error("error on recording started broadcast",a)}}));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleSFUEvents",value:function(){var e=this;Qo(this,Kg).on("reconnect_transport",function(){var t=(0,d.Z)((0,l.Z)().mark((function t(n){return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.reconnectTransport(n);case 3:e.logger.info("transport reconnected [id:%s]",n.id),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),e.logger.error("error on reconnection transports",t.t0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}())}}],[{key:"init",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.legacyMode,r=void 0===n||n,a=t.roomName,i=t.peerId,o=t.authToken,s=t.meetingTitle,c=t.socket,u=new ny({legacyMode:r,authToken:o,socketClient:c,peerId:i,roomName:a,meetingTitle:s}),e.abrupt("return",(c.onStateEvent("disconnected",(function(e){var t;u.isDisconnected=!0,null==(t=Qo(u,Kg))||t.cleanupConsumers(),vf.emit(ff.ROOM_NODE_DISCONNECTED,e),u.roomJoined=!1,qp.info("HIVE_NODE_DISCONNECTED")})),c.onStateEvent("reconnected",(0,d.Z)((0,l.Z)().mark((function e(){var t,n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return qp.info("HIVE_NODE_RECONNECTED"),e.next=3,null==(t=Qo(u,Kg))?void 0:t.cleanupConsumers();case 3:Qo(n=u,Jg).call(n);case 4:case"end":return e.stop()}}),e)})))),c.onStateEvent("connected",function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:vf.emit(ff.ROOM_NODE_CONNECTED,t),qp.info("HIVE_NODE_CONNECTED");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),u));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),n}(_g),$g=new WeakMap,Kg=new WeakMap,Jg=new WeakMap,Qg),ry=ny;function ay(e,t){switch(t.viewType){case"GROUP_CALL":case"AUDIO_ROOM":return"ON_STAGE";case"WEBINAR":return e.canPresent?"ON_STAGE":"OFF_STAGE";case"LIVESTREAM":if(!av.isV2AuthToken)return"OFF_STAGE";var n=e;return[n.canProduceAudio,n.canProduceScreenshare,n.canProduceVideo].includes(cp.Allowed)?"ON_STAGE":"OFF_STAGE";default:return"OFF_STAGE"}}function iy(e,t,n){return!n||"LIVESTREAM"!==t.viewType||"ON_STAGE"===ay(e,t)}ty([Gp.trace("HiveClient.reconnect")],ry.prototype,"reconnectTransport",1),ty([Gp.trace("HiveClient.setupTransport")],ry.prototype,"setupTransports",1),ty([Gp.trace("HiveClient.joinRoom")],ry.prototype,"joinRoom",1),ty([Gp.trace("HiveClient.leaveRoom")],ry.prototype,"leaveRoom",1),ty([Gp.trace("HiveClient.activatePeers")],ry.prototype,"activatePeers",1),ty([Gp.trace("HiveClient.deactivatePeers")],ry.prototype,"deactivatePeers",1),ty([Gp.trace("HiveClient.createConsumer")],ry.prototype,"createConsumer",1),ty([Gp.trace("HiveClient.pauseConsumer")],ry.prototype,"pauseConsumer",1),ty([Gp.trace("HiveClient.closeConsumers")],ry.prototype,"closeConsumers",1),ty([Gp.trace("HiveClient.consumePeer")],ry.prototype,"consumePeer",1),ty([Gp.trace("HiveClient.shareWebcam")],ry.prototype,"shareWebcam",1),ty([Gp.trace("HiveClient.shareScreen")],ry.prototype,"shareScreen",1),ty([Gp.trace("HiveClient.shareMic")],ry.prototype,"shareMic",1),ty([Gp.trace("HiveClient.pauseMic")],ry.prototype,"pauseMic",1),ty([Gp.trace("HiveClient.pauseWebcam")],ry.prototype,"pauseWebcam",1),ty([Gp.trace("HiveClient.resumeMic")],ry.prototype,"resumeMic",1),ty([Gp.trace("HiveClient.resumeWebcam")],ry.prototype,"resumeWebcam",1),ty([Gp.trace("HiveClient.disableWebcam")],ry.prototype,"disableWebcam",1),ty([Gp.trace("HiveClient.disableMic")],ry.prototype,"disableMic",1),ty([Gp.trace("HiveClient.disableScreenShare")],ry.prototype,"disableScreenShare",1),ty([Gp.trace("HiveClient.muteSelf")],ry.prototype,"muteSelf",1),ty([Gp.trace("HiveClient.unmuteSelf")],ry.prototype,"unmuteSelf",1),ty([Gp.trace("HiveClient.resetVideoProducers")],ry.prototype,"resetVideoProducers",1),ty([Gp.trace("HiveClient.pinPeer")],ry.prototype,"pinPeer",1),ty([Gp.trace("HiveClient.init")],ry,"init",1);var oy=function(e){return e.SOCKET_CONNECTED="SOCKET_CONNECTED",e.SOCKET_DISCONNECTED="SOCKET_DISCONNECTED",e.SOCKET_CONNECTION_ERROR="SOCKET_CONNECTION_ERROR",e.SOCKET_MESSAGE="SOCKET_MESSAGE",e}(oy||{}),sy=function(e){return e[e.NOT_STARTED=0]="NOT_STARTED",e[e.CONNECTED=1]="CONNECTED",e[e.DISCONNECTED=2]="DISCONNECTED",e[e.ERRORED=3]="ERRORED",e}(sy||{}),cy=Object.defineProperty,uy=Object.getOwnPropertyDescriptor,ly=function(e,t,n,r){for(var a,i=r>1?void 0:r?uy(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&cy(t,n,i),i},dy=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;return(0,y.Z)(this,n),r=t.call(this),Ko((0,v.Z)(r),"socket"),Ko((0,v.Z)(r),"socketState"),Ko((0,v.Z)(r),"callbackHandler",null),r.socketState=sy.NOT_STARTED,e.callbackHandler&&(r.callbackHandler=e.callbackHandler),r}return(0,k.Z)(n,[{key:"connect",value:function(e){this.socket&&(this.socket.removeAllListeners(),this.socket.disconnect()),this.socket=zo(e,{closeOnBeforeunload:!1}),this.setupSocket()}},{key:"disconnect",value:function(){this.socket.disconnect()}},{key:"reconnect",value:function(){this.socket.connect()}},{key:"setupSocket",value:function(){var e=this;this.socket.on("disconnect",(function(t){e.socketState=sy.DISCONNECTED,qp.warn("SocketClient::socket_disconnected",{reason:t}),e.emit(oy.SOCKET_DISCONNECTED,{reason:t})})),this.socket.on("connect_error",(function(t){e.socketState=sy.ERRORED,Vc.hasFeature(Sp.SOCKET_POLLING)&&(e.socket.io.opts.transports=["polling","websocket"]),qp.error("SocketClient::socket_connection_errored",{error:Tp(t)}),e.emit(oy.SOCKET_CONNECTION_ERROR,{err:t})})),this.socket.on("connect",(function(){e.socketState=sy.CONNECTED,qp.info("SocketClient::socket_connected"),e.emit(oy.SOCKET_CONNECTED)})),this.socket.on("event://server-simple-message",function(){var t=(0,d.Z)((0,l.Z)().mark((function t(n,r){var a,i;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=JSON.parse(n),(!Gp.logExclusionList.includes(null==a?void 0:a.type)||Vc.hasFeature(Sp.BYPASS_LOG_EXCLUSION_LIST))&&qp.info("SocketClient::SIMPLE_SERVER_MESSAGE_EVENT::".concat(null==a?void 0:a.type),{type:null==a?void 0:a.type}),!r){t.next=11;break}if(i="OK",t.t0=e.callbackHandler,!t.t0){t.next=8;break}return t.next=7,e.callbackHandler(a);case 7:i=t.sent;case 8:r(i),t.next=12;break;case 11:e.emit(oy.SOCKET_MESSAGE,a);case 12:Object.values(ff).find((function(e){return e===a.type}))&&vf.emit(a.type,a.payload);case 13:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}},{key:"sendMessage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",((!Gp.logExclusionList.includes(null==t?void 0:t.type)||Vc.hasFeature(Sp.BYPASS_LOG_EXCLUSION_LIST))&&qp.info("SocketClient::sendMessage::".concat(null==t?void 0:t.type),{type:null==t?void 0:t.type}),Object.assign(t,{metadata:t.metadata||{}}),Gp.injectContext(t.metadata),new Promise((function(e){n.socket.emit("event://send-message",JSON.stringify(t),(function(t){if(t){var n=JSON.parse(t);e(n)}else e(void 0)}))}))));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),n}(is);ly([Gp.trace("SocketClient.connect")],dy.prototype,"connect",1),ly([Gp.trace("SocketClient.disconnect")],dy.prototype,"disconnect",1),ly([Gp.trace("SocketClient.reconnect")],dy.prototype,"reconnect",1),ly([Gp.trace("SocketClient.setupSocket")],dy.prototype,"setupSocket",1);var py,fy,hy={},vy={get exports(){return hy},set exports(e){hy=e}};function my(){if(fy)return py;fy=1;var e=1e3,t=60*e,n=60*t,r=24*n,a=7*r,i=365.25*r;function o(e,t,n,r){var a=t>=1.5*n;return Math.round(e/n)+" "+r+(a?"s":"")}return py=function(s,c){c=c||{};var u=typeof s;if("string"===u&&s.length>0)return function(o){if(o=String(o),!(o.length>100)){var s=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(o);if(s){var c=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*i;case"weeks":case"week":case"w":return c*a;case"days":case"day":case"d":return c*r;case"hours":case"hour":case"hrs":case"hr":case"h":return c*n;case"minutes":case"minute":case"mins":case"min":case"m":return c*t;case"seconds":case"second":case"secs":case"sec":case"s":return c*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}}}(s);if("number"===u&&isFinite(s))return c.long?function(a){var i=Math.abs(a);return i>=r?o(a,i,r,"day"):i>=n?o(a,i,n,"hour"):i>=t?o(a,i,t,"minute"):i>=e?o(a,i,e,"second"):a+" ms"}(s):function(a){var i=Math.abs(a);return i>=r?Math.round(a/r)+"d":i>=n?Math.round(a/n)+"h":i>=t?Math.round(a/t)+"m":i>=e?Math.round(a/e)+"s":a+"ms"}(s);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(s))}}var gy=function(e){function t(e){var r,a,i,o=null;function s(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];if(s.enabled){var i=s,o=Number(new Date),c=o-(r||o);i.diff=c,i.prev=r,i.curr=o,r=o,n[0]=t.coerce(n[0]),"string"!=typeof n[0]&&n.unshift("%O");var u=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,(function(e,r){if("%%"===e)return"%";u++;var a=t.formatters[r];if("function"==typeof a){var o=n[u];e=a.call(i,o),n.splice(u,1),u--}return e})),t.formatArgs.call(i,n),(i.log||t.log).apply(i,n)}}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=n,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:function(){return null!==o?o:(a!==t.namespaces&&(a=t.namespaces,i=t.enabled(e)),i)},set:function(e){o=e}}),"function"==typeof t.init&&t.init(s),s}function n(e,n){var r=t(this.namespace+("undefined"==typeof n?":":n)+e);return r.log=this.log,r}function r(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){var e=[].concat((0,o.Z)(t.names.map(r)),(0,o.Z)(t.skips.map(r).map((function(e){return"-"+e})))).join(",");return t.enable(""),e},t.enable=function(e){var n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),a=r.length;for(n=0;n<a;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=my(),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((function(n){t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){for(var n=0,r=0;r<e.length;r++)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t};!function(e,t){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var r=0,a=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(r++,"%c"===e&&(a=r))})),t.splice(a,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(n){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(n){}return!e&&"undefined"!=typeof process&&"env"in process&&(e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=function(){var e=!1;return function(){e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||function(){},e.exports=gy(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}(vy,hy);var yy="mediasoup-client",ky=function(){function e(t){(0,y.Z)(this,e),t?(this._debug=hy("".concat(yy,":").concat(t)),this._warn=hy("".concat(yy,":WARN:").concat(t)),this._error=hy("".concat(yy,":ERROR:").concat(t))):(this._debug=hy(yy),this._warn=hy("".concat(yy,":WARN")),this._error=hy("".concat(yy,":ERROR"))),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}return(0,k.Z)(e,[{key:"debug",get:function(){return this._debug}},{key:"warn",get:function(){return this._warn}},{key:"error",get:function(){return this._error}}]),e}(),by=new ky("EnhancedEventEmitter"),wy=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;return(0,y.Z)(this,n),(e=t.call(this)).setMaxListeners(1/0),e}return(0,k.Z)(n,[{key:"emit",value:function(e){for(var t,r=arguments.length,a=new Array(r>1?r-1:0),i=1;i<r;i++)a[i-1]=arguments[i];return(t=f((0,p.Z)(n.prototype),"emit",this)).call.apply(t,[this,e].concat(a))}},{key:"safeEmit",value:function(e){var t=f((0,p.Z)(n.prototype),"listenerCount",this).call(this,e);try{for(var r,a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];return(r=f((0,p.Z)(n.prototype),"emit",this)).call.apply(r,[this,e].concat(i))}catch(T){return by.error("safeEmit() | event listener threw an error [eventName:%s]:%o",e,T),Boolean(t)}}},{key:"on",value:function(e,t){return f((0,p.Z)(n.prototype),"on",this).call(this,e,t),this}},{key:"off",value:function(e,t){return f((0,p.Z)(n.prototype),"off",this).call(this,e,t),this}},{key:"addListener",value:function(e,t){return f((0,p.Z)(n.prototype),"on",this).call(this,e,t),this}},{key:"prependListener",value:function(e,t){return f((0,p.Z)(n.prototype),"prependListener",this).call(this,e,t),this}},{key:"once",value:function(e,t){return f((0,p.Z)(n.prototype),"once",this).call(this,e,t),this}},{key:"prependOnceListener",value:function(e,t){return f((0,p.Z)(n.prototype),"prependOnceListener",this).call(this,e,t),this}},{key:"removeListener",value:function(e,t){return f((0,p.Z)(n.prototype),"off",this).call(this,e,t),this}},{key:"removeAllListeners",value:function(e){return f((0,p.Z)(n.prototype),"removeAllListeners",this).call(this,e),this}},{key:"listenerCount",value:function(e){return f((0,p.Z)(n.prototype),"listenerCount",this).call(this,e)}},{key:"listeners",value:function(e){return f((0,p.Z)(n.prototype),"listeners",this).call(this,e)}},{key:"rawListeners",value:function(e){return f((0,p.Z)(n.prototype),"rawListeners",this).call(this,e)}}]),n}(is.EventEmitter),_y=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;return(0,y.Z)(this,n),(r=t.call(this,e)).name="UnsupportedError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace((0,v.Z)(r),n):r.stack=new Error(e).stack,r}return(0,k.Z)(n)}((0,a.Z)(Error)),Sy=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;return(0,y.Z)(this,n),(r=t.call(this,e)).name="InvalidStateError",Error.hasOwnProperty("captureStackTrace")?Error.captureStackTrace((0,v.Z)(r),n):r.stack=new Error(e).stack,r}return(0,k.Z)(n)}((0,a.Z)(Error));function Ey(e,t){return"undefined"==typeof e?t:JSON.parse(JSON.stringify(e))}function Ty(){return Math.round(1e7*Math.random())}var xy={};!function(e){var t=hy("h264-profile-level-id");t.log=console.info.bind(console);e.ProfileConstrainedBaseline=1,e.ProfileBaseline=2,e.ProfileMain=3,e.ProfileConstrainedHigh=4,e.ProfileHigh=5;var n=0,r=10;e.Level1_b=n,e.Level1=r,e.Level1_1=11,e.Level1_2=12,e.Level1_3=13,e.Level2=20,e.Level2_1=21,e.Level2_2=22,e.Level3=30,e.Level3_1=31,e.Level3_2=32,e.Level4=40,e.Level4_1=41,e.Level4_2=42,e.Level5=50,e.Level5_1=51,e.Level5_2=52;var a=(0,k.Z)((function e(t,n){(0,y.Z)(this,e),this.profile=t,this.level=n}));e.ProfileLevelId=a;var i=new a(1,31),o=function(){function e(t){(0,y.Z)(this,e),this._mask=~u("x",t),this._maskedValue=u("1",t)}return(0,k.Z)(e,[{key:"isMatch",value:function(e){return this._maskedValue===(e&this._mask)}}]),e}(),s=(0,k.Z)((function e(t,n,r){(0,y.Z)(this,e),this.profile_idc=t,this.profile_iop=n,this.profile=r})),c=[new s(66,new o("x1xx0000"),1),new s(77,new o("1xxx0000"),1),new s(88,new o("11xx0000"),1),new s(66,new o("x0xx0000"),2),new s(88,new o("10xx0000"),2),new s(77,new o("0x0x0000"),3),new s(100,new o("00000000"),5),new s(100,new o("00001100"),4)];function u(e,t){return(t[0]===e)<<7|(t[1]===e)<<6|(t[2]===e)<<5|(t[3]===e)<<4|(t[4]===e)<<3|(t[5]===e)<<2|(t[6]===e)<<1|(t[7]===e)<<0}function l(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})["level-asymmetry-allowed"];return 1===e||"1"===e}e.parseProfileLevelId=function(e){if("string"!=typeof e||6!==e.length)return null;var i=parseInt(e,16);if(0===i)return null;var o,s=255&i,u=i>>8&255,l=i>>16&255;switch(s){case 11:o=16&u?n:11;break;case r:case 12:case 13:case 20:case 21:case 22:case 30:case 31:case 32:case 40:case 41:case 42:case 50:case 51:case 52:o=s;break;default:return t("parseProfileLevelId() | unrecognized level_idc:%s",s),null}for(var d=0,p=c;d<p.length;d++){var f=p[d];if(l===f.profile_idc&&f.profile_iop.isMatch(u))return new a(f.profile,o)}return t("parseProfileLevelId() | unrecognized profile_idc/profile_iop combination"),null},e.profileLevelIdToString=function(e){if(e.level==n)switch(e.profile){case 1:return"42f00b";case 2:return"42100b";case 3:return"4d100b";default:return t("profileLevelIdToString() | Level 1_b not is allowed for profile:%s",e.profile),null}var r;switch(e.profile){case 1:r="42e0";break;case 2:r="4200";break;case 3:r="4d00";break;case 4:r="640c";break;case 5:r="6400";break;default:return t("profileLevelIdToString() | unrecognized profile:%s",e.profile),null}var a=e.level.toString(16);return 1===a.length&&(a="0".concat(a)),"".concat(r).concat(a)},e.parseSdpProfileLevelId=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})["profile-level-id"];return t?e.parseProfileLevelId(t):i},e.isSameProfile=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.parseSdpProfileLevelId(t),a=e.parseSdpProfileLevelId(n);return Boolean(r&&a&&r.profile===a.profile)},e.generateProfileLevelIdForAnswer=function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!i["profile-level-id"]&&!o["profile-level-id"])return t("generateProfileLevelIdForAnswer() | no profile-level-id in local and remote params"),null;var s=e.parseSdpProfileLevelId(i),c=e.parseSdpProfileLevelId(o);if(!s)throw new TypeError("invalid local_profile_level_id");if(!c)throw new TypeError("invalid remote_profile_level_id");if(s.profile!==c.profile)throw new TypeError("H264 Profile mismatch");var u=l(i)&&l(o),d=s.level,p=function(e,t){return function(e,t){return e===n?t!==r&&t!==n:t===n?e!==r:e<t}(e,t)?e:t}(d,c.level),f=u?d:p;return t("generateProfileLevelIdForAnswer() | result: [profile:%s, level:%s]",s.profile,f),e.profileLevelIdToString(new a(s.profile,f))}}(xy);var Zy="probator",Cy=1234,Ry=127;function Py(e){if("object"!=typeof e)throw new TypeError("caps is not an object");if(e.codecs&&!Array.isArray(e.codecs))throw new TypeError("caps.codecs is not an array");e.codecs||(e.codecs=[]);var t,n=(0,c.Z)(e.codecs);try{for(n.s();!(t=n.n()).done;){Iy(t.value)}}catch(Cx){n.e(Cx)}finally{n.f()}if(e.headerExtensions&&!Array.isArray(e.headerExtensions))throw new TypeError("caps.headerExtensions is not an array");e.headerExtensions||(e.headerExtensions=[]);var r,a=(0,c.Z)(e.headerExtensions);try{for(a.s();!(r=a.n()).done;){Dy(r.value)}}catch(Cx){a.e(Cx)}finally{a.f()}}function Iy(e){var t=new RegExp("^(audio|video)/(.+)","i");if("object"!=typeof e)throw new TypeError("codec is not an object");if(!e.mimeType||"string"!=typeof e.mimeType)throw new TypeError("missing codec.mimeType");var n=t.exec(e.mimeType);if(!n)throw new TypeError("invalid codec.mimeType");if(e.kind=n[1].toLowerCase(),e.preferredPayloadType&&"number"!=typeof e.preferredPayloadType)throw new TypeError("invalid codec.preferredPayloadType");if("number"!=typeof e.clockRate)throw new TypeError("missing codec.clockRate");"audio"===e.kind?"number"!=typeof e.channels&&(e.channels=1):delete e.channels,(!e.parameters||"object"!=typeof e.parameters)&&(e.parameters={});for(var r=0,a=Object.keys(e.parameters);r<a.length;r++){var i=a[r],o=e.parameters[i];if(void 0===o&&(e.parameters[i]="",o=""),"string"!=typeof o&&"number"!=typeof o)throw new TypeError("invalid codec parameter [key:".concat(i,"s, value:").concat(o,"]"));if("apt"===i&&"number"!=typeof o)throw new TypeError("invalid codec apt parameter")}(!e.rtcpFeedback||!Array.isArray(e.rtcpFeedback))&&(e.rtcpFeedback=[]);var s,u=(0,c.Z)(e.rtcpFeedback);try{for(u.s();!(s=u.n()).done;){Oy(s.value)}}catch(Cx){u.e(Cx)}finally{u.f()}}function Oy(e){if("object"!=typeof e)throw new TypeError("fb is not an object");if(!e.type||"string"!=typeof e.type)throw new TypeError("missing fb.type");(!e.parameter||"string"!=typeof e.parameter)&&(e.parameter="")}function Dy(e){if("object"!=typeof e)throw new TypeError("ext is not an object");if("audio"!==e.kind&&"video"!==e.kind)throw new TypeError("invalid ext.kind");if(!e.uri||"string"!=typeof e.uri)throw new TypeError("missing ext.uri");if("number"!=typeof e.preferredId)throw new TypeError("missing ext.preferredId");if(e.preferredEncrypt&&"boolean"!=typeof e.preferredEncrypt)throw new TypeError("invalid ext.preferredEncrypt");if(e.preferredEncrypt||(e.preferredEncrypt=!1),e.direction&&"string"!=typeof e.direction)throw new TypeError("invalid ext.direction");e.direction||(e.direction="sendrecv")}function My(e){if("object"!=typeof e)throw new TypeError("params is not an object");if(e.mid&&"string"!=typeof e.mid)throw new TypeError("params.mid is not a string");if(!Array.isArray(e.codecs))throw new TypeError("missing params.codecs");var t,n=(0,c.Z)(e.codecs);try{for(n.s();!(t=n.n()).done;){Ay(t.value)}}catch(Cx){n.e(Cx)}finally{n.f()}if(e.headerExtensions&&!Array.isArray(e.headerExtensions))throw new TypeError("params.headerExtensions is not an array");e.headerExtensions||(e.headerExtensions=[]);var r,a=(0,c.Z)(e.headerExtensions);try{for(a.s();!(r=a.n()).done;){Ny(r.value)}}catch(Cx){a.e(Cx)}finally{a.f()}if(e.encodings&&!Array.isArray(e.encodings))throw new TypeError("params.encodings is not an array");e.encodings||(e.encodings=[]);var i,o=(0,c.Z)(e.encodings);try{for(o.s();!(i=o.n()).done;){Ly(i.value)}}catch(Cx){o.e(Cx)}finally{o.f()}if(e.rtcp&&"object"!=typeof e.rtcp)throw new TypeError("params.rtcp is not an object");e.rtcp||(e.rtcp={}),function(e){if("object"!=typeof e)throw new TypeError("rtcp is not an object");if(e.cname&&"string"!=typeof e.cname)throw new TypeError("invalid rtcp.cname");(!e.reducedSize||"boolean"!=typeof e.reducedSize)&&(e.reducedSize=!0)}(e.rtcp)}function Ay(e){var t=new RegExp("^(audio|video)/(.+)","i");if("object"!=typeof e)throw new TypeError("codec is not an object");if(!e.mimeType||"string"!=typeof e.mimeType)throw new TypeError("missing codec.mimeType");var n=t.exec(e.mimeType);if(!n)throw new TypeError("invalid codec.mimeType");if("number"!=typeof e.payloadType)throw new TypeError("missing codec.payloadType");if("number"!=typeof e.clockRate)throw new TypeError("missing codec.clockRate");"audio"===n[1].toLowerCase()?"number"!=typeof e.channels&&(e.channels=1):delete e.channels,(!e.parameters||"object"!=typeof e.parameters)&&(e.parameters={});for(var r=0,a=Object.keys(e.parameters);r<a.length;r++){var i=a[r],o=e.parameters[i];if(void 0===o&&(e.parameters[i]="",o=""),"string"!=typeof o&&"number"!=typeof o)throw new TypeError("invalid codec parameter [key:".concat(i,"s, value:").concat(o,"]"));if("apt"===i&&"number"!=typeof o)throw new TypeError("invalid codec apt parameter")}(!e.rtcpFeedback||!Array.isArray(e.rtcpFeedback))&&(e.rtcpFeedback=[]);var s,u=(0,c.Z)(e.rtcpFeedback);try{for(u.s();!(s=u.n()).done;){Oy(s.value)}}catch(Cx){u.e(Cx)}finally{u.f()}}function Ny(e){if("object"!=typeof e)throw new TypeError("ext is not an object");if(!e.uri||"string"!=typeof e.uri)throw new TypeError("missing ext.uri");if("number"!=typeof e.id)throw new TypeError("missing ext.id");if(e.encrypt&&"boolean"!=typeof e.encrypt)throw new TypeError("invalid ext.encrypt");e.encrypt||(e.encrypt=!1),(!e.parameters||"object"!=typeof e.parameters)&&(e.parameters={});for(var t=0,n=Object.keys(e.parameters);t<n.length;t++){var r=n[t],a=e.parameters[r];if(void 0===a&&(e.parameters[r]="",a=""),"string"!=typeof a&&"number"!=typeof a)throw new TypeError("invalid header extension parameter")}}function Ly(e){if("object"!=typeof e)throw new TypeError("encoding is not an object");if(e.ssrc&&"number"!=typeof e.ssrc)throw new TypeError("invalid encoding.ssrc");if(e.rid&&"string"!=typeof e.rid)throw new TypeError("invalid encoding.rid");if(e.rtx&&"object"!=typeof e.rtx)throw new TypeError("invalid encoding.rtx");if(e.rtx&&"number"!=typeof e.rtx.ssrc)throw new TypeError("missing encoding.rtx.ssrc");if((!e.dtx||"boolean"!=typeof e.dtx)&&(e.dtx=!1),e.scalabilityMode&&"string"!=typeof e.scalabilityMode)throw new TypeError("invalid encoding.scalabilityMode")}function jy(e){if("object"!=typeof e)throw new TypeError("caps is not an object");if(!e.numStreams||"object"!=typeof e.numStreams)throw new TypeError("missing caps.numStreams");!function(e){if("object"!=typeof e)throw new TypeError("numStreams is not an object");if("number"!=typeof e.OS)throw new TypeError("missing numStreams.OS");if("number"!=typeof e.MIS)throw new TypeError("missing numStreams.MIS")}(e.numStreams)}function Fy(e){if("object"!=typeof e)throw new TypeError("params is not an object");if("number"!=typeof e.streamId)throw new TypeError("missing params.streamId");var t=!1;if("boolean"==typeof e.ordered?t=!0:e.ordered=!0,e.maxPacketLifeTime&&"number"!=typeof e.maxPacketLifeTime)throw new TypeError("invalid params.maxPacketLifeTime");if(e.maxRetransmits&&"number"!=typeof e.maxRetransmits)throw new TypeError("invalid params.maxRetransmits");if(e.maxPacketLifeTime&&e.maxRetransmits)throw new TypeError("cannot provide both maxPacketLifeTime and maxRetransmits");if(t&&e.ordered&&(e.maxPacketLifeTime||e.maxRetransmits))throw new TypeError("cannot be ordered with maxPacketLifeTime or maxRetransmits");if(!t&&(e.maxPacketLifeTime||e.maxRetransmits)&&(e.ordered=!1),e.label&&"string"!=typeof e.label)throw new TypeError("invalid params.label");if(e.protocol&&"string"!=typeof e.protocol)throw new TypeError("invalid params.protocol")}function Uy(e,t){var n,r={codecs:[],headerExtensions:[]},a=(0,c.Z)(t.codecs||[]);try{var i=function(){var t=n.value;if($y(t))return"continue";var a=(e.codecs||[]).find((function(e){return Ky(e,t,{strict:!0,modify:!0})}));if(!a)return"continue";var i={mimeType:a.mimeType,kind:a.kind,clockRate:a.clockRate,channels:a.channels,localPayloadType:a.preferredPayloadType,localRtxPayloadType:void 0,remotePayloadType:t.preferredPayloadType,remoteRtxPayloadType:void 0,localParameters:a.parameters,remoteParameters:t.parameters,rtcpFeedback:Jy(a,t)};r.codecs.push(i)};for(a.s();!(n=a.n()).done;)i()}catch(Cx){a.e(Cx)}finally{a.f()}var o,s=(0,c.Z)(r.codecs);try{var u=function(){var n=o.value,r=e.codecs.find((function(e){return $y(e)&&e.parameters.apt===n.localPayloadType})),a=t.codecs.find((function(e){return $y(e)&&e.parameters.apt===n.remotePayloadType}));r&&a&&(n.localRtxPayloadType=r.preferredPayloadType,n.remoteRtxPayloadType=a.preferredPayloadType)};for(s.s();!(o=s.n()).done;)u()}catch(Cx){s.e(Cx)}finally{s.f()}var l,d=(0,c.Z)(t.headerExtensions);try{var p=function(){var t=l.value,n=e.headerExtensions.find((function(e){return function(e,t){return!(e.kind&&t.kind&&e.kind!==t.kind||e.uri!==t.uri)}(e,t)}));if(!n)return"continue";var a={kind:t.kind,uri:t.uri,sendId:n.preferredId,recvId:t.preferredId,encrypt:n.preferredEncrypt,direction:"sendrecv"};switch(t.direction){case"sendrecv":a.direction="sendrecv";break;case"recvonly":a.direction="sendonly";break;case"sendonly":a.direction="recvonly";break;case"inactive":a.direction="inactive"}r.headerExtensions.push(a)};for(d.s();!(l=d.n()).done;)p()}catch(Cx){d.e(Cx)}finally{d.f()}return r}function By(e){var t,n={codecs:[],headerExtensions:[]},r=(0,c.Z)(e.codecs);try{for(r.s();!(t=r.n()).done;){var a=t.value,i={mimeType:a.mimeType,kind:a.kind,preferredPayloadType:a.remotePayloadType,clockRate:a.clockRate,channels:a.channels,parameters:a.localParameters,rtcpFeedback:a.rtcpFeedback};if(n.codecs.push(i),a.remoteRtxPayloadType){var o={mimeType:"".concat(a.kind,"/rtx"),kind:a.kind,preferredPayloadType:a.remoteRtxPayloadType,clockRate:a.clockRate,parameters:{apt:a.remotePayloadType},rtcpFeedback:[]};n.codecs.push(o)}}}catch(Cx){r.e(Cx)}finally{r.f()}var s,u=(0,c.Z)(e.headerExtensions);try{for(u.s();!(s=u.n()).done;){var l=s.value;if("sendrecv"===l.direction||"recvonly"===l.direction){var d={kind:l.kind,uri:l.uri,preferredId:l.recvId,preferredEncrypt:l.encrypt,direction:l.direction};n.headerExtensions.push(d)}}}catch(Cx){u.e(Cx)}finally{u.f()}return n}function Vy(e,t){var n,r={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}},a=(0,c.Z)(t.codecs);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i.kind===e){var o={mimeType:i.mimeType,payloadType:i.localPayloadType,clockRate:i.clockRate,channels:i.channels,parameters:i.localParameters,rtcpFeedback:i.rtcpFeedback};if(r.codecs.push(o),i.localRtxPayloadType){var s={mimeType:"".concat(i.kind,"/rtx"),payloadType:i.localRtxPayloadType,clockRate:i.clockRate,parameters:{apt:i.localPayloadType},rtcpFeedback:[]};r.codecs.push(s)}}}}catch(Cx){a.e(Cx)}finally{a.f()}var u,l=(0,c.Z)(t.headerExtensions);try{for(l.s();!(u=l.n()).done;){var d=u.value;if(!(d.kind&&d.kind!==e||"sendrecv"!==d.direction&&"sendonly"!==d.direction)){var p={uri:d.uri,id:d.sendId,encrypt:d.encrypt,parameters:{}};r.headerExtensions.push(p)}}}catch(Cx){l.e(Cx)}finally{l.f()}return r}function Hy(e,t){var n,r={mid:void 0,codecs:[],headerExtensions:[],encodings:[],rtcp:{}},a=(0,c.Z)(t.codecs);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i.kind===e){var o={mimeType:i.mimeType,payloadType:i.localPayloadType,clockRate:i.clockRate,channels:i.channels,parameters:i.remoteParameters,rtcpFeedback:i.rtcpFeedback};if(r.codecs.push(o),i.localRtxPayloadType){var s={mimeType:"".concat(i.kind,"/rtx"),payloadType:i.localRtxPayloadType,clockRate:i.clockRate,parameters:{apt:i.localPayloadType},rtcpFeedback:[]};r.codecs.push(s)}}}}catch(Cx){a.e(Cx)}finally{a.f()}var u,l=(0,c.Z)(t.headerExtensions);try{for(l.s();!(u=l.n()).done;){var d=u.value;if(!(d.kind&&d.kind!==e||"sendrecv"!==d.direction&&"sendonly"!==d.direction)){var p={uri:d.uri,id:d.sendId,encrypt:d.encrypt,parameters:{}};r.headerExtensions.push(p)}}}catch(Cx){l.e(Cx)}finally{l.f()}if(r.headerExtensions.some((function(e){return"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"===e.uri}))){var f,h=(0,c.Z)(r.codecs);try{for(h.s();!(f=h.n()).done;){var v=f.value;v.rtcpFeedback=(v.rtcpFeedback||[]).filter((function(e){return"goog-remb"!==e.type}))}}catch(Cx){h.e(Cx)}finally{h.f()}}else if(r.headerExtensions.some((function(e){return"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"===e.uri}))){var m,g=(0,c.Z)(r.codecs);try{for(g.s();!(m=g.n()).done;){var y=m.value;y.rtcpFeedback=(y.rtcpFeedback||[]).filter((function(e){return"transport-cc"!==e.type}))}}catch(Cx){g.e(Cx)}finally{g.f()}}else{var k,b=(0,c.Z)(r.codecs);try{for(b.s();!(k=b.n()).done;){var w=k.value;w.rtcpFeedback=(w.rtcpFeedback||[]).filter((function(e){return"transport-cc"!==e.type&&"goog-remb"!==e.type}))}}catch(Cx){b.e(Cx)}finally{b.f()}}return r}function zy(e,t){var n=[];if(t){for(var r=0;r<e.length;++r)if(Ky(e[r],t)){n.push(e[r]),$y(e[r+1])&&n.push(e[r+1]);break}if(0===n.length)throw new TypeError("no matching codec found")}else n.push(e[0]),$y(e[1])&&n.push(e[1]);return n}function Wy(e){My(e=Ey(e,{}));var t={mid:Zy,codecs:[],headerExtensions:[],encodings:[{ssrc:Cy}],rtcp:{cname:"probator"}};return t.codecs.push(e.codecs[0]),t.codecs[0].payloadType=Ry,t.headerExtensions=e.headerExtensions,t}function Gy(e,t){return t.codecs.some((function(t){return t.kind===e}))}function qy(e,t){if(My(e),0===e.codecs.length)return!1;var n=e.codecs[0];return t.codecs.some((function(e){return e.remotePayloadType===n.payloadType}))}function $y(e){return!!e&&/.+\/rtx$/i.test(e.mimeType)}function Ky(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.strict,a=void 0!==r&&r,i=n.modify,o=void 0!==i&&i,s=e.mimeType.toLowerCase();if(s!==t.mimeType.toLowerCase()||e.clockRate!==t.clockRate||e.channels!==t.channels)return!1;switch(s){case"video/h264":if(a){var c;if((e.parameters["packetization-mode"]||0)!==(t.parameters["packetization-mode"]||0)||!xy.isSameProfile(e.parameters,t.parameters))return!1;try{c=xy.generateProfileLevelIdForAnswer(e.parameters,t.parameters)}catch(u){return!1}o&&(c?(e.parameters["profile-level-id"]=c,t.parameters["profile-level-id"]=c):(delete e.parameters["profile-level-id"],delete t.parameters["profile-level-id"]))}break;case"video/vp9":if(a)if((e.parameters["profile-id"]||0)!==(t.parameters["profile-id"]||0))return!1}return!0}function Jy(e,t){var n,r=[],a=(0,c.Z)(e.rtcpFeedback||[]);try{var i=function(){var e=n.value,a=(t.rtcpFeedback||[]).find((function(t){return t.type===e.type&&(t.parameter===e.parameter||!t.parameter&&!e.parameter)}));a&&r.push(a)};for(a.s();!(n=a.n()).done;)i()}catch(Cx){a.e(Cx)}finally{a.f()}return r}var Qy={},Xy={},Yy=ns&&ns.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Xy,"__esModule",{value:!0}),Xy.Logger=void 0;var ek=Yy(hy),tk="awaitqueue",nk=function(){function e(t){(0,y.Z)(this,e),t?(this._debug=(0,ek.default)("".concat(tk,":").concat(t)),this._warn=(0,ek.default)("".concat(tk,":WARN:").concat(t)),this._error=(0,ek.default)("".concat(tk,":ERROR:").concat(t))):(this._debug=(0,ek.default)(tk),this._warn=(0,ek.default)("".concat(tk,":WARN")),this._error=(0,ek.default)("".concat(tk,":ERROR"))),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}return(0,k.Z)(e,[{key:"debug",get:function(){return this._debug}},{key:"warn",get:function(){return this._warn}},{key:"error",get:function(){return this._error}}]),e}();Xy.Logger=nk,Object.defineProperty(Qy,"__esModule",{value:!0});var rk=Qy.AwaitQueue=Qy.AwaitQueueRemovedTaskError=Qy.AwaitQueueStoppedError=void 0,ak=new Xy.Logger,ik=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;return(0,y.Z)(this,n),(r=t.call(this,null!=e?e:"AwaitQueue stopped")).name="AwaitQueueStoppedError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace((0,v.Z)(r),n),r}return(0,k.Z)(n)}((0,a.Z)(Error));Qy.AwaitQueueStoppedError=ik;var ok=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;return(0,y.Z)(this,n),(r=t.call(this,null!=e?e:"AwaitQueue task removed")).name="AwaitQueueRemovedTaskError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace((0,v.Z)(r),n),r}return(0,k.Z)(n)}((0,a.Z)(Error));Qy.AwaitQueueRemovedTaskError=ok;var sk,ck=function(){function e(){(0,y.Z)(this,e),this.pendingTasks=new Map,this.nextTaskId=0,this.stopping=!1}return(0,k.Z)(e,[{key:"size",get:function(){return this.pendingTasks.size}},{key:"push",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null!=n?n:t.name,ak.debug("push() [name:".concat(n,"]")),"function"==typeof t){e.next=2;break}throw new TypeError("given task is not a function");case 2:if(n)try{Object.defineProperty(t,"name",{value:n})}catch(a){}return e.abrupt("return",new Promise((function(e,a){var i={id:r.nextTaskId++,task:t,name:n,enqueuedAt:Date.now(),executedAt:void 0,completed:!1,resolve:function(t){if(!i.completed){i.completed=!0,r.pendingTasks.delete(i.id),ak.debug("resolving task [name:".concat(i.name,"]")),e(t);var n=r.pendingTasks.values(),a=(0,u.Z)(n,1)[0];a&&!a.executedAt&&r.execute(a)}},reject:function(e){if(!i.completed&&(i.completed=!0,r.pendingTasks.delete(i.id),ak.debug("rejecting task [name:".concat(i.name,"]: %s"),String(e)),a(e),!r.stopping)){var t=r.pendingTasks.values(),n=(0,u.Z)(t,1)[0];n&&!n.executedAt&&r.execute(n)}}};r.pendingTasks.set(i.id,i),1===r.pendingTasks.size&&r.execute(i)})));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"stop",value:function(){ak.debug("stop()"),this.stopping=!0;var e,t=(0,c.Z)(this.pendingTasks.values());try{for(t.s();!(e=t.n()).done;){var n=e.value;ak.debug("stop() | stopping task [name:".concat(n.name,"]"))}}catch(Cx){t.e(Cx)}finally{t.f()}this.stopping=!1}},{key:"remove",value:function(e){ak.debug("remove() [taskIdx:".concat(e,"]"));var t=Array.from(this.pendingTasks.values())[e];t?t.reject(new ok):ak.debug("stop() | no task with given idx [taskIdx:".concat(e,"]"))}},{key:"dump",value:function(){var e=Date.now(),t=0;return Array.from(this.pendingTasks.values()).map((function(n){return{idx:t++,task:n.task,name:n.name,enqueuedTime:n.executedAt?n.executedAt-n.enqueuedAt:e-n.enqueuedAt,executionTime:n.executedAt?e-n.executedAt:0}}))}},{key:"execute",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ak.debug("execute() [name:".concat(t.name,"]")),!t.executedAt){e.next=2;break}throw new Error("task already being executed");case 2:return t.executedAt=Date.now(),e.prev=3,e.next=6,t.task();case 6:n=e.sent,t.resolve(n),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),t.reject(e.t0);case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}()}]),e}();rk=Qy.AwaitQueue=ck;var uk="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:ns):function(e){return(sk||(sk=Promise.resolve())).then(e).catch((function(e){return setTimeout((function(){throw e}),0)}))},lk=new ky("Producer"),dk=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r,a=e.id,i=e.localId,o=e.rtpSender,s=e.track,c=e.rtpParameters,u=e.stopTracks,l=e.disableTrackOnPause,d=e.zeroRtpOnPause,p=e.appData;return(0,y.Z)(this,n),(r=t.call(this))._closed=!1,r._observer=new wy,lk.debug("constructor()"),r._id=a,r._localId=i,r._rtpSender=o,r._track=s,r._kind=s.kind,r._rtpParameters=c,r._paused=!!l&&!s.enabled,r._maxSpatialLayer=void 0,r._stopTracks=u,r._disableTrackOnPause=l,r._zeroRtpOnPause=d,r._appData=p||{},r.onTrackEnded=r.onTrackEnded.bind((0,v.Z)(r)),r.handleTrack(),r}return(0,k.Z)(n,[{key:"id",get:function(){return this._id}},{key:"localId",get:function(){return this._localId}},{key:"closed",get:function(){return this._closed}},{key:"kind",get:function(){return this._kind}},{key:"rtpSender",get:function(){return this._rtpSender}},{key:"track",get:function(){return this._track}},{key:"rtpParameters",get:function(){return this._rtpParameters}},{key:"paused",get:function(){return this._paused}},{key:"maxSpatialLayer",get:function(){return this._maxSpatialLayer}},{key:"appData",get:function(){return this._appData},set:function(e){throw new Error("cannot override appData object")}},{key:"observer",get:function(){return this._observer}},{key:"close",value:function(){this._closed||(lk.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}},{key:"transportClosed",value:function(){this._closed||(lk.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}},{key:"getStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=2;break}throw new Sy("closed");case 2:return e.abrupt("return",new Promise((function(e,n){t.safeEmit("@getstats",e,n)})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pause",value:function(){var e=this;lk.debug("pause()"),this._closed?lk.error("pause() | Producer closed"):(this._paused=!0,this._track&&this._disableTrackOnPause&&(this._track.enabled=!1),this._zeroRtpOnPause&&new Promise((function(t,n){e.safeEmit("@pause",t,n)})).catch((function(){})),this._observer.safeEmit("pause"))}},{key:"resume",value:function(){var e=this;lk.debug("resume()"),this._closed?lk.error("resume() | Producer closed"):(this._paused=!1,this._track&&this._disableTrackOnPause&&(this._track.enabled=!0),this._zeroRtpOnPause&&new Promise((function(t,n){e.safeEmit("@resume",t,n)})).catch((function(){})),this._observer.safeEmit("resume"))}},{key:"replaceTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.track,lk.debug("replaceTrack() [track:%o]",n),!this._closed){e.next=6;break}if(n&&this._stopTracks)try{n.stop()}catch(a){}throw new Sy("closed");case 6:if(!n||"ended"!==n.readyState){e.next=8;break}throw new Sy("track ended");case 8:if(n!==this._track){e.next=11;break}return lk.debug("replaceTrack() | same track, ignored"),e.abrupt("return");case 11:return e.next=13,new Promise((function(e,t){r.safeEmit("@replacetrack",n,e,t)}));case 13:this.destroyTrack(),this._track=n,this._track&&this._disableTrackOnPause&&(this._paused?this._paused&&(this._track.enabled=!1):this._track.enabled=!0),this.handleTrack();case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setMaxSpatialLayer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=2;break}throw new Sy("closed");case 2:if("video"===this._kind){e.next=4;break}throw new _y("not a video Producer");case 4:if("number"==typeof t){e.next=6;break}throw new TypeError("invalid spatialLayer");case 6:if(e.t0=t!==this._maxSpatialLayer,!e.t0){e.next=11;break}return e.next=10,new Promise((function(e,r){n.safeEmit("@setmaxspatiallayer",t,e,r)})).catch((function(){}));case 10:this._maxSpatialLayer=t;case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setRtpEncodingParameters",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=2;break}throw new Sy("closed");case 2:if("object"==typeof t){e.next=4;break}throw new TypeError("invalid params");case 4:return e.next=6,new Promise((function(e,r){n.safeEmit("@setrtpencodingparameters",t,e,r)}));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onTrackEnded",value:function(){lk.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}},{key:"handleTrack",value:function(){this._track&&this._track.addEventListener("ended",this.onTrackEnded)}},{key:"destroyTrack",value:function(){if(this._track)try{this._track.removeEventListener("ended",this.onTrackEnded),this._stopTracks&&this._track.stop()}catch(e){}}}]),n}(wy),pk=new ky("Consumer"),fk=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r,a=e.id,i=e.localId,o=e.producerId,s=e.rtpReceiver,c=e.track,u=e.rtpParameters,l=e.appData;return(0,y.Z)(this,n),(r=t.call(this))._closed=!1,r._observer=new wy,pk.debug("constructor()"),r._id=a,r._localId=i,r._producerId=o,r._rtpReceiver=s,r._track=c,r._rtpParameters=u,r._paused=!c.enabled,r._appData=l||{},r.onTrackEnded=r.onTrackEnded.bind((0,v.Z)(r)),r.handleTrack(),r}return(0,k.Z)(n,[{key:"id",get:function(){return this._id}},{key:"localId",get:function(){return this._localId}},{key:"producerId",get:function(){return this._producerId}},{key:"closed",get:function(){return this._closed}},{key:"kind",get:function(){return this._track.kind}},{key:"rtpReceiver",get:function(){return this._rtpReceiver}},{key:"track",get:function(){return this._track}},{key:"rtpParameters",get:function(){return this._rtpParameters}},{key:"paused",get:function(){return this._paused}},{key:"appData",get:function(){return this._appData},set:function(e){throw new Error("cannot override appData object")}},{key:"observer",get:function(){return this._observer}},{key:"close",value:function(){this._closed||(pk.debug("close()"),this._closed=!0,this.destroyTrack(),this.emit("@close"),this._observer.safeEmit("close"))}},{key:"transportClosed",value:function(){this._closed||(pk.debug("transportClosed()"),this._closed=!0,this.destroyTrack(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}},{key:"getStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=2;break}throw new Sy("closed");case 2:return e.abrupt("return",new Promise((function(e,n){t.safeEmit("@getstats",e,n)})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pause",value:function(){pk.debug("pause()"),this._closed?pk.error("pause() | Consumer closed"):this._paused?pk.debug("pause() | Consumer is already paused"):(this._paused=!0,this._track.enabled=!1,this.emit("@pause"),this._observer.safeEmit("pause"))}},{key:"resume",value:function(){pk.debug("resume()"),this._closed?pk.error("resume() | Consumer closed"):this._paused?(this._paused=!1,this._track.enabled=!0,this.emit("@resume"),this._observer.safeEmit("resume")):pk.debug("resume() | Consumer is already resumed")}},{key:"onTrackEnded",value:function(){pk.debug('track "ended" event'),this.safeEmit("trackended"),this._observer.safeEmit("trackended")}},{key:"handleTrack",value:function(){this._track.addEventListener("ended",this.onTrackEnded)}},{key:"destroyTrack",value:function(){try{this._track.removeEventListener("ended",this.onTrackEnded),this._track.stop()}catch(e){}}}]),n}(wy),hk=new ky("DataProducer"),vk=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r,a=e.id,i=e.dataChannel,o=e.sctpStreamParameters,s=e.appData;return(0,y.Z)(this,n),(r=t.call(this))._closed=!1,r._observer=new wy,hk.debug("constructor()"),r._id=a,r._dataChannel=i,r._sctpStreamParameters=o,r._appData=s||{},r.handleDataChannel(),r}return(0,k.Z)(n,[{key:"id",get:function(){return this._id}},{key:"closed",get:function(){return this._closed}},{key:"sctpStreamParameters",get:function(){return this._sctpStreamParameters}},{key:"readyState",get:function(){return this._dataChannel.readyState}},{key:"label",get:function(){return this._dataChannel.label}},{key:"protocol",get:function(){return this._dataChannel.protocol}},{key:"bufferedAmount",get:function(){return this._dataChannel.bufferedAmount}},{key:"bufferedAmountLowThreshold",get:function(){return this._dataChannel.bufferedAmountLowThreshold},set:function(e){this._dataChannel.bufferedAmountLowThreshold=e}},{key:"appData",get:function(){return this._appData},set:function(e){throw new Error("cannot override appData object")}},{key:"observer",get:function(){return this._observer}},{key:"close",value:function(){this._closed||(hk.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}},{key:"transportClosed",value:function(){this._closed||(hk.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}},{key:"send",value:function(e){if(hk.debug("send()"),this._closed)throw new Sy("closed");this._dataChannel.send(e)}},{key:"handleDataChannel",value:function(){var e=this;this._dataChannel.addEventListener("open",(function(){e._closed||(hk.debug('DataChannel "open" event'),e.safeEmit("open"))})),this._dataChannel.addEventListener("error",(function(t){if(!e._closed){var n=t.error;n||(n=new Error("unknown DataChannel error")),"sctp-failure"===n.errorDetail?hk.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",n.sctpCauseCode,n.message):hk.error('DataChannel "error" event: %o',n),e.safeEmit("error",n)}})),this._dataChannel.addEventListener("close",(function(){e._closed||(hk.warn('DataChannel "close" event'),e._closed=!0,e.emit("@close"),e.safeEmit("close"),e._observer.safeEmit("close"))})),this._dataChannel.addEventListener("message",(function(){e._closed||hk.warn('DataChannel "message" event in a DataProducer, message discarded')})),this._dataChannel.addEventListener("bufferedamountlow",(function(){e._closed||e.safeEmit("bufferedamountlow")}))}}]),n}(wy),mk=new ky("DataConsumer"),gk=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r,a=e.id,i=e.dataProducerId,o=e.dataChannel,s=e.sctpStreamParameters,c=e.appData;return(0,y.Z)(this,n),(r=t.call(this))._closed=!1,r._observer=new wy,mk.debug("constructor()"),r._id=a,r._dataProducerId=i,r._dataChannel=o,r._sctpStreamParameters=s,r._appData=c||{},r.handleDataChannel(),r}return(0,k.Z)(n,[{key:"id",get:function(){return this._id}},{key:"dataProducerId",get:function(){return this._dataProducerId}},{key:"closed",get:function(){return this._closed}},{key:"sctpStreamParameters",get:function(){return this._sctpStreamParameters}},{key:"readyState",get:function(){return this._dataChannel.readyState}},{key:"label",get:function(){return this._dataChannel.label}},{key:"protocol",get:function(){return this._dataChannel.protocol}},{key:"binaryType",get:function(){return this._dataChannel.binaryType},set:function(e){this._dataChannel.binaryType=e}},{key:"appData",get:function(){return this._appData},set:function(e){throw new Error("cannot override appData object")}},{key:"observer",get:function(){return this._observer}},{key:"close",value:function(){this._closed||(mk.debug("close()"),this._closed=!0,this._dataChannel.close(),this.emit("@close"),this._observer.safeEmit("close"))}},{key:"transportClosed",value:function(){this._closed||(mk.debug("transportClosed()"),this._closed=!0,this._dataChannel.close(),this.safeEmit("transportclose"),this._observer.safeEmit("close"))}},{key:"handleDataChannel",value:function(){var e=this;this._dataChannel.addEventListener("open",(function(){e._closed||(mk.debug('DataChannel "open" event'),e.safeEmit("open"))})),this._dataChannel.addEventListener("error",(function(t){if(!e._closed){var n=t.error;n||(n=new Error("unknown DataChannel error")),"sctp-failure"===n.errorDetail?mk.error("DataChannel SCTP error [sctpCauseCode:%s]: %s",n.sctpCauseCode,n.message):mk.error('DataChannel "error" event: %o',n),e.safeEmit("error",n)}})),this._dataChannel.addEventListener("close",(function(){e._closed||(mk.warn('DataChannel "close" event'),e._closed=!0,e.emit("@close"),e.safeEmit("close"),e._observer.safeEmit("close"))})),this._dataChannel.addEventListener("message",(function(t){e._closed||e.safeEmit("message",t.data)}))}}]),n}(wy),yk=new ky("Transport"),kk=(0,k.Z)((function e(t){var n=this;(0,y.Z)(this,e),this.consumerOptions=t,this.promise=new Promise((function(e,t){n.resolve=e,n.reject=t}))})),bk=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r,a=e.direction,i=e.id,o=e.iceParameters,s=e.iceCandidates,c=e.dtlsParameters,u=e.sctpParameters,l=e.iceServers,d=e.iceTransportPolicy,p=e.additionalSettings,f=e.proprietaryConstraints,h=e.appData,v=e.handlerFactory,m=e.extendedRtpCapabilities,g=e.canProduceByKind;return(0,y.Z)(this,n),(r=t.call(this))._closed=!1,r._connectionState="new",r._producers=new Map,r._consumers=new Map,r._dataProducers=new Map,r._dataConsumers=new Map,r._probatorConsumerCreated=!1,r._awaitQueue=new rk,r._pendingConsumerTasks=[],r._consumerCreationInProgress=!1,r._pendingPauseConsumers=new Map,r._consumerPauseInProgress=!1,r._pendingResumeConsumers=new Map,r._consumerResumeInProgress=!1,r._pendingCloseConsumers=new Map,r._consumerCloseInProgress=!1,r._observer=new wy,yk.debug("constructor() [id:%s, direction:%s]",i,a),r._id=i,r._direction=a,r._extendedRtpCapabilities=m,r._canProduceByKind=g,r._maxSctpMessageSize=u?u.maxMessageSize:null,delete(p=Ey(p,{})).iceServers,delete p.iceTransportPolicy,delete p.bundlePolicy,delete p.rtcpMuxPolicy,delete p.sdpSemantics,r._handler=v(),r._handler.run({direction:a,iceParameters:o,iceCandidates:s,dtlsParameters:c,sctpParameters:u,iceServers:l,iceTransportPolicy:d,additionalSettings:p,proprietaryConstraints:f,extendedRtpCapabilities:m}),r._appData=h||{},r.handleHandler(),r}return(0,k.Z)(n,[{key:"id",get:function(){return this._id}},{key:"closed",get:function(){return this._closed}},{key:"direction",get:function(){return this._direction}},{key:"handler",get:function(){return this._handler}},{key:"connectionState",get:function(){return this._connectionState}},{key:"appData",get:function(){return this._appData},set:function(e){throw new Error("cannot override appData object")}},{key:"producers",get:function(){return this._producers}},{key:"observer",get:function(){return this._observer}},{key:"close",value:function(){if(!this._closed){yk.debug("close()"),this._closed=!0,this._awaitQueue.stop(),this._handler.close();var e,t=(0,c.Z)(this._producers.values());try{for(t.s();!(e=t.n()).done;){e.value.transportClosed()}}catch(Cx){t.e(Cx)}finally{t.f()}this._producers.clear();var n,r=(0,c.Z)(this._consumers.values());try{for(r.s();!(n=r.n()).done;){n.value.transportClosed()}}catch(Cx){r.e(Cx)}finally{r.f()}this._consumers.clear();var a,i=(0,c.Z)(this._dataProducers.values());try{for(i.s();!(a=i.n()).done;){a.value.transportClosed()}}catch(Cx){i.e(Cx)}finally{i.f()}this._dataProducers.clear();var o,s=(0,c.Z)(this._dataConsumers.values());try{for(s.s();!(o=s.n()).done;){o.value.transportClosed()}}catch(Cx){s.e(Cx)}finally{s.f()}this._dataConsumers.clear(),this._observer.safeEmit("close")}}},{key:"getStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=2;break}throw new Sy("closed");case 2:return e.abrupt("return",this._handler.getTransportStats());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"restartIce",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.iceParameters,yk.debug("restartIce()"),!this._closed){e.next=3;break}throw new Sy("closed");case 3:if(n){e.next=5;break}throw new TypeError("missing iceParameters");case 5:return e.abrupt("return",this._awaitQueue.push((0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",r._handler.restartIce(n));case 1:case"end":return e.stop()}}),e)}))),"transport.restartIce()"));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateIceServers",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n=this,r=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(r.length>0&&void 0!==r[0]?r[0]:{}).iceServers,yk.debug("updateIceServers()"),!this._closed){e.next=3;break}throw new Sy("closed");case 3:if(Array.isArray(t)){e.next=5;break}throw new TypeError("missing iceServers");case 5:return e.abrupt("return",this._awaitQueue.push((0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n._handler.updateIceServers(t));case 1:case"end":return e.stop()}}),e)}))),"transport.updateIceServers()"));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"produce",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r,a,i,o,s,c,u,p,f,h,v,m=this,g=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(t=g.length>0&&void 0!==g[0]?g[0]:{}).track,r=t.encodings,a=t.codecOptions,i=t.codec,o=t.stopTracks,s=void 0===o||o,c=t.disableTrackOnPause,u=void 0===c||c,p=t.zeroRtpOnPause,f=void 0!==p&&p,h=t.appData,v=void 0===h?{}:h,yk.debug("produce() [track:%o]",n),!this._closed){e.next=3;break}throw new Sy("closed");case 3:if(!n){e.next=20;break}if("send"===this._direction){e.next=6;break}throw new _y("not a sending Transport");case 6:if(!this._canProduceByKind[n.kind]){e.next=17;break}if("ended"!==n.readyState){e.next=9;break}throw new Sy("track ended");case 9:if(0!==this.listenerCount("connect")||"new"!==this._connectionState){e.next=11;break}throw new TypeError('no "connect" listener set into this transport');case 11:if(0!==this.listenerCount("produce")){e.next=13;break}throw new TypeError('no "produce" listener set into this transport');case 13:if(!v||"object"==typeof v){e.next=15;break}throw new TypeError("if given, appData must be an object");case 15:e.next=18;break;case 17:throw new _y("cannot produce ".concat(n.kind));case 18:e.next=21;break;case 20:throw new TypeError("missing track");case 21:return e.abrupt("return",this._awaitQueue.push((0,d.Z)((0,l.Z)().mark((function e(){var t,o,c,d,p,h,g,y;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r||Array.isArray(r)){e.next=2;break}throw TypeError("encodings must be an array");case 2:return r&&0===r.length?t=void 0:r&&(t=r.map((function(e){var t={active:!0};return!1===e.active&&(t.active=!1),"boolean"==typeof e.dtx&&(t.dtx=e.dtx),"string"==typeof e.scalabilityMode&&(t.scalabilityMode=e.scalabilityMode),"number"==typeof e.scaleResolutionDownBy&&(t.scaleResolutionDownBy=e.scaleResolutionDownBy),"number"==typeof e.maxBitrate&&(t.maxBitrate=e.maxBitrate),"number"==typeof e.maxFramerate&&(t.maxFramerate=e.maxFramerate),"boolean"==typeof e.adaptivePtime&&(t.adaptivePtime=e.adaptivePtime),"string"==typeof e.priority&&(t.priority=e.priority),"string"==typeof e.networkPriority&&(t.networkPriority=e.networkPriority),t}))),e.next=5,m._handler.send({track:n,encodings:t,codecOptions:a,codec:i});case 5:return o=e.sent,c=o.localId,d=o.rtpParameters,p=o.rtpSender,e.prev=9,My(d),e.next=13,new Promise((function(e,t){m.safeEmit("produce",{kind:n.kind,rtpParameters:d,appData:v},e,t)}));case 13:return h=e.sent,g=h.id,y=new dk({id:g,localId:c,rtpSender:p,track:n,rtpParameters:d,stopTracks:s,disableTrackOnPause:u,zeroRtpOnPause:f,appData:v}),e.abrupt("return",(m._producers.set(y.id,y),m.handleProducer(y),m._observer.safeEmit("newproducer",y),y));case 19:throw e.prev=19,e.t0=e.catch(9),m._handler.stopSending(c).catch((function(){})),e.t0;case 22:case"end":return e.stop()}}),e,null,[[9,19]])}))),"transport.produce()").catch((function(e){if(s)try{n.stop()}catch(t){}throw e})));case 22:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"consume",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u,d=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.id,r=t.producerId,a=t.kind,i=t.rtpParameters,o=t.streamId,s=t.appData,c=void 0===s?{}:s,yk.debug("consume()"),i=Ey(i,void 0),!this._closed){e.next=3;break}throw new Sy("closed");case 3:if("recv"===this._direction){e.next=5;break}throw new _y("not a receiving Transport");case 5:if("string"==typeof n){e.next=7;break}throw new TypeError("missing id");case 7:if("string"==typeof r){e.next=9;break}throw new TypeError("missing producerId");case 9:if("audio"===a||"video"===a){e.next=11;break}throw new TypeError("invalid kind '".concat(a,"'"));case 11:if(0!==this.listenerCount("connect")||"new"!==this._connectionState){e.next=13;break}throw new TypeError('no "connect" listener set into this transport');case 13:if(!c||"object"==typeof c){e.next=15;break}throw new TypeError("if given, appData must be an object");case 15:if(qy(i,this._extendedRtpCapabilities)){e.next=17;break}throw new _y("cannot consume this Producer");case 17:return u=new kk({id:n,producerId:r,kind:a,rtpParameters:i,streamId:o,appData:c}),e.abrupt("return",(this._pendingConsumerTasks.push(u),uk((function(){if(d._closed)throw new Sy("closed");!1===d._consumerCreationInProgress&&d.createPendingConsumers()})),u.promise));case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"produceData",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r,a,i,o,s,c,u,p,f,h=this,v=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(t=v.length>0&&void 0!==v[0]?v[0]:{}).ordered,r=void 0===n||n,a=t.maxPacketLifeTime,i=t.maxRetransmits,o=t.label,s=void 0===o?"":o,c=t.protocol,u=void 0===c?"":c,p=t.appData,f=void 0===p?{}:p,yk.debug("produceData()"),!this._closed){e.next=3;break}throw new Sy("closed");case 3:if("send"===this._direction){e.next=5;break}throw new _y("not a sending Transport");case 5:if(!this._maxSctpMessageSize){e.next=14;break}if(0!==this.listenerCount("connect")||"new"!==this._connectionState){e.next=8;break}throw new TypeError('no "connect" listener set into this transport');case 8:if(0!==this.listenerCount("producedata")){e.next=10;break}throw new TypeError('no "producedata" listener set into this transport');case 10:if(!f||"object"==typeof f){e.next=12;break}throw new TypeError("if given, appData must be an object");case 12:e.next=15;break;case 14:throw new _y("SCTP not enabled by remote Transport");case 15:return e.abrupt("return",((a||i)&&(r=!1),this._awaitQueue.push((0,d.Z)((0,l.Z)().mark((function e(){var t,n,o,c,d,p;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h._handler.sendDataChannel({ordered:r,maxPacketLifeTime:a,maxRetransmits:i,label:s,protocol:u});case 2:return t=e.sent,n=t.dataChannel,Fy(o=t.sctpStreamParameters),e.next=8,new Promise((function(e,t){h.safeEmit("producedata",{sctpStreamParameters:o,label:s,protocol:u,appData:f},e,t)}));case 8:return c=e.sent,d=c.id,p=new vk({id:d,dataChannel:n,sctpStreamParameters:o,appData:f}),e.abrupt("return",(h._dataProducers.set(p.id,p),h.handleDataProducer(p),h._observer.safeEmit("newdataproducer",p),p));case 12:case"end":return e.stop()}}),e)}))),"transport.produceData()")));case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"consumeData",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u,p,f=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.id,r=t.dataProducerId,a=t.sctpStreamParameters,i=t.label,o=void 0===i?"":i,s=t.protocol,c=void 0===s?"":s,u=t.appData,p=void 0===u?{}:u,yk.debug("consumeData()"),a=Ey(a,void 0),!this._closed){e.next=3;break}throw new Sy("closed");case 3:if("recv"===this._direction){e.next=5;break}throw new _y("not a receiving Transport");case 5:if(!this._maxSctpMessageSize){e.next=16;break}if("string"==typeof n){e.next=8;break}throw new TypeError("missing id");case 8:if("string"==typeof r){e.next=10;break}throw new TypeError("missing dataProducerId");case 10:if(0!==this.listenerCount("connect")||"new"!==this._connectionState){e.next=12;break}throw new TypeError('no "connect" listener set into this transport');case 12:if(!p||"object"==typeof p){e.next=14;break}throw new TypeError("if given, appData must be an object");case 14:e.next=17;break;case 16:throw new _y("SCTP not enabled by remote Transport");case 17:return e.abrupt("return",(Fy(a),this._awaitQueue.push((0,d.Z)((0,l.Z)().mark((function e(){var t,i,s;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f._handler.receiveDataChannel({sctpStreamParameters:a,label:o,protocol:c});case 2:return t=e.sent,i=t.dataChannel,s=new gk({id:n,dataProducerId:r,dataChannel:i,sctpStreamParameters:a,appData:p}),e.abrupt("return",(f._dataConsumers.set(s.id,s),f.handleDataConsumer(s),f._observer.safeEmit("newdataconsumer",s),s));case 6:case"end":return e.stop()}}),e)}))),"transport.consumeData()")));case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createPendingConsumers",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._consumerCreationInProgress=!0,this._awaitQueue.push((0,d.Z)((0,l.Z)().mark((function e(){var n,r,a,i,s,u,d,p,f,h,v,m,g,y,k,b,w,_,S,E,T,x,Z,C,R,P,I,O;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t._pendingConsumerTasks.length){e.next=3;break}return yk.debug("createPendingConsumers() | there is no Consumer to be created"),e.abrupt("return");case 3:n=(0,o.Z)(t._pendingConsumerTasks),t._pendingConsumerTasks=[],a=[],i=(0,c.Z)(n);try{for(i.s();!(s=i.n()).done;)u=s.value,d=u.consumerOptions,p=d.id,f=d.kind,h=d.rtpParameters,v=d.streamId,a.push({trackId:p,kind:f,rtpParameters:h,streamId:v})}catch(Cx){i.e(Cx)}finally{i.f()}return e.prev=8,e.next=11,t._handler.receive(a);case 11:for(m=e.sent,g=0;g<m.length;g++)y=n[g],k=m[g],b=y.consumerOptions,w=b.id,_=b.producerId,S=b.kind,E=b.rtpParameters,T=b.appData,x=k.localId,Z=k.rtpReceiver,C=k.track,R=new fk({id:w,localId:x,producerId:_,rtpReceiver:Z,track:C,rtpParameters:E,appData:T}),t._consumers.set(R.id,R),t.handleConsumer(R),!t._probatorConsumerCreated&&!r&&"video"===S&&(r=R),t._observer.safeEmit("newconsumer",R),y.resolve(R);e.next=19;break;case 15:e.prev=15,e.t0=e.catch(8),P=(0,c.Z)(n);try{for(P.s();!(I=P.n()).done;)I.value.reject(e.t0)}catch(Cx){P.e(Cx)}finally{P.f()}case 19:if(!r){e.next=31;break}return e.prev=20,O=Wy(r.rtpParameters),e.next=24,t._handler.receive([{trackId:"probator",kind:"video",rtpParameters:O}]);case 24:yk.debug("createPendingConsumers() | Consumer for RTP probation created"),t._probatorConsumerCreated=!0,e.next=31;break;case 28:e.prev=28,e.t1=e.catch(20),yk.error("createPendingConsumers() | failed to create Consumer for RTP probation:%o",e.t1);case 31:case"end":return e.stop()}}),e,null,[[8,15],[20,28]])}))),"transport.createPendingConsumers()").then((function(){t._consumerCreationInProgress=!1,t._pendingConsumerTasks.length>0&&t.createPendingConsumers()})).catch((function(){}));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pausePendingConsumers",value:function(){var e=this;this._consumerPauseInProgress=!0,this._awaitQueue.push((0,d.Z)((0,l.Z)().mark((function t(){var n,r;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==e._pendingPauseConsumers.size){t.next=3;break}return yk.debug("pausePendingConsumers() | there is no Consumer to be paused"),t.abrupt("return");case 3:return n=Array.from(e._pendingPauseConsumers.values()),e._pendingPauseConsumers.clear(),t.prev=5,r=n.map((function(e){return e.localId})),t.next=9,e._handler.pauseReceiving(r);case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(5),yk.error("pausePendingConsumers() | failed to pause Consumers:",t.t0);case 14:case"end":return t.stop()}}),t,null,[[5,11]])}))),"transport.pausePendingConsumers").then((function(){e._consumerPauseInProgress=!1,e._pendingPauseConsumers.size>0&&e.pausePendingConsumers()})).catch((function(){}))}},{key:"resumePendingConsumers",value:function(){var e=this;this._consumerResumeInProgress=!0,this._awaitQueue.push((0,d.Z)((0,l.Z)().mark((function t(){var n,r;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==e._pendingResumeConsumers.size){t.next=3;break}return yk.debug("resumePendingConsumers() | there is no Consumer to be resumed"),t.abrupt("return");case 3:return n=Array.from(e._pendingResumeConsumers.values()),e._pendingResumeConsumers.clear(),t.prev=5,r=n.map((function(e){return e.localId})),t.next=9,e._handler.resumeReceiving(r);case 9:t.next=14;break;case 11:t.prev=11,t.t0=t.catch(5),yk.error("resumePendingConsumers() | failed to resume Consumers:",t.t0);case 14:case"end":return t.stop()}}),t,null,[[5,11]])}))),"transport.resumePendingConsumers").then((function(){e._consumerResumeInProgress=!1,e._pendingResumeConsumers.size>0&&e.resumePendingConsumers()})).catch((function(){}))}},{key:"closePendingConsumers",value:function(){var e=this;this._consumerCloseInProgress=!0,this._awaitQueue.push((0,d.Z)((0,l.Z)().mark((function t(){var n;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==e._pendingCloseConsumers.size){t.next=3;break}return yk.debug("closePendingConsumers() | there is no Consumer to be closed"),t.abrupt("return");case 3:return n=Array.from(e._pendingCloseConsumers.values()),e._pendingCloseConsumers.clear(),t.prev=5,t.next=8,e._handler.stopReceiving(n.map((function(e){return e.localId})));case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(5),yk.error("closePendingConsumers() | failed to close Consumers:",t.t0);case 13:case"end":return t.stop()}}),t,null,[[5,10]])}))),"transport.closePendingConsumers").then((function(){e._consumerCloseInProgress=!1,e._pendingCloseConsumers.size>0&&e.closePendingConsumers()})).catch((function(){}))}},{key:"handleHandler",value:function(){var e=this,t=this._handler;t.on("@connect",(function(t,n,r){var a=t.dtlsParameters;e._closed?r(new Sy("closed")):e.safeEmit("connect",{dtlsParameters:a},n,r)})),t.on("@connectionstatechange",(function(t){t!==e._connectionState&&(yk.debug("connection state changed to %s",t),e._connectionState=t,e._closed||e.safeEmit("connectionstatechange",t))}))}},{key:"handleProducer",value:function(e){var t=this;e.on("@close",(function(){t._producers.delete(e.id),!t._closed&&t._awaitQueue.push((0,d.Z)((0,l.Z)().mark((function n(){return(0,l.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t._handler.stopSending(e.localId));case 1:case"end":return n.stop()}}),n)}))),"producer @close event").catch((function(e){return yk.warn("producer.close() failed:%o",e)}))})),e.on("@pause",(function(n,r){t._awaitQueue.push((0,d.Z)((0,l.Z)().mark((function n(){return(0,l.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t._handler.pauseSending(e.localId));case 1:case"end":return n.stop()}}),n)}))),"producer @pause event").then(n).catch(r)})),e.on("@resume",(function(n,r){t._awaitQueue.push((0,d.Z)((0,l.Z)().mark((function n(){return(0,l.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",t._handler.resumeSending(e.localId));case 1:case"end":return n.stop()}}),n)}))),"producer @resume event").then(n).catch(r)})),e.on("@replacetrack",(function(n,r,a){t._awaitQueue.push((0,d.Z)((0,l.Z)().mark((function r(){return(0,l.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",t._handler.replaceTrack(e.localId,n));case 1:case"end":return r.stop()}}),r)}))),"producer @replacetrack event").then(r).catch(a)})),e.on("@setmaxspatiallayer",(function(n,r,a){t._awaitQueue.push((0,d.Z)((0,l.Z)().mark((function r(){return(0,l.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",t._handler.setMaxSpatialLayer(e.localId,n));case 1:case"end":return r.stop()}}),r)}))),"producer @setmaxspatiallayer event").then(r).catch(a)})),e.on("@setrtpencodingparameters",(function(n,r,a){t._awaitQueue.push((0,d.Z)((0,l.Z)().mark((function r(){return(0,l.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",t._handler.setRtpEncodingParameters(e.localId,n));case 1:case"end":return r.stop()}}),r)}))),"producer @setrtpencodingparameters event").then(r).catch(a)})),e.on("@getstats",(function(n,r){if(t._closed)return r(new Sy("closed"));t._handler.getSenderStats(e.localId).then(n).catch(r)}))}},{key:"handleConsumer",value:function(e){var t=this;e.on("@close",(function(){t._consumers.delete(e.id),t._pendingPauseConsumers.delete(e.id),t._pendingResumeConsumers.delete(e.id),!t._closed&&(t._pendingCloseConsumers.set(e.id,e),!1===t._consumerCloseInProgress&&t.closePendingConsumers())})),e.on("@pause",(function(){t._pendingResumeConsumers.has(e.id)&&t._pendingResumeConsumers.delete(e.id),t._pendingPauseConsumers.set(e.id,e),uk((function(){t._closed||!1===t._consumerPauseInProgress&&t.pausePendingConsumers()}))})),e.on("@resume",(function(){t._pendingPauseConsumers.has(e.id)&&t._pendingPauseConsumers.delete(e.id),t._pendingResumeConsumers.set(e.id,e),uk((function(){t._closed||!1===t._consumerResumeInProgress&&t.resumePendingConsumers()}))})),e.on("@getstats",(function(n,r){if(t._closed)return r(new Sy("closed"));t._handler.getReceiverStats(e.localId).then(n).catch(r)}))}},{key:"handleDataProducer",value:function(e){var t=this;e.on("@close",(function(){t._dataProducers.delete(e.id)}))}},{key:"handleDataConsumer",value:function(e){var t=this;e.on("@close",(function(){t._dataConsumers.delete(e.id)}))}}]),n}(wy),wk=new ky("Device");var _k=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.handlerName,r=t.handlerFactory,a=t.Handler;if((0,y.Z)(this,e),this._loaded=!1,this._observer=new wy,wk.debug("constructor()"),a){if(wk.warn("constructor() | Handler option is DEPRECATED, use handlerName or handlerFactory instead"),"string"!=typeof a)throw new TypeError("non string Handler option no longer supported, use handlerFactory instead");n=a}if(n&&r)throw new TypeError("just one of handlerName or handlerInterface can be given");if(r)this._handlerFactory=r;else{if(n)wk.debug("constructor() | handler given: %s",n);else{if(n=function(){var e,t,n,r;if("object"==typeof navigator&&"ReactNative"===navigator.product)return"undefined"==typeof RTCPeerConnection?void wk.warn("this._detectDevice() | unsupported react-native-webrtc without RTCPeerConnection, forgot to call registerGlobals()?"):"undefined"!=typeof RTCRtpTransceiver?(wk.debug("this._detectDevice() | ReactNative UnifiedPlan handler chosen"),"ReactNativeUnifiedPlan"):(wk.debug("this._detectDevice() | ReactNative PlanB handler chosen"),"ReactNative");if("object"==typeof navigator&&"string"==typeof navigator.userAgent){var a=navigator.userAgent;a=null==a?void 0:a.replace("motorola edge","motorola x");var i=ka().getParser(a),o=i.getEngine();if(i.satisfies({chrome:">=74",chromium:">=74","microsoft edge":">=88"}))return"Chrome74";if(i.satisfies({chrome:">=70",chromium:">=70"}))return"Chrome70";if(i.satisfies({chrome:">=67",chromium:">=67"}))return"Chrome67";if(i.satisfies({chrome:">=55",chromium:">=55"}))return"Chrome55";if(i.satisfies({firefox:">=60"}))return"Firefox60";if(i.satisfies({ios:{OS:">=14.3",firefox:">=30.0"}}))return"Safari12";if(i.satisfies({safari:">=12.0"})&&"undefined"!=typeof RTCRtpTransceiver&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(i.satisfies({safari:">=11"}))return"Safari11";if("iOS"===(null===(t=null===(e=i.parsedResult)||void 0===e?void 0:e.os)||void 0===t?void 0:t.name)&&"undefined"!=typeof RTCRtpTransceiver&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection"))return"Safari12";if(i.satisfies({"microsoft edge":">=11"})&&i.satisfies({"microsoft edge":"<=18"}))return"Edge11";if(o.name&&"blink"===o.name.toLowerCase()){var s=a.match(/(?:(?:Chrome|Chromium))[ /](\w+)/i);if(s){var c=Number(s[1]);return c>=74?"Chrome74":c>=70?"Chrome70":c>=67?"Chrome67":"Chrome55"}return"Chrome74"}return"iOS"===(null===(r=null===(n=i.parsedResult)||void 0===n?void 0:n.os)||void 0===r?void 0:r.name)&&"undefined"!=typeof RTCRtpTransceiver&&RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection")?"Safari12":void wk.warn("this._detectDevice() | browser not supported [name:%s, version:%s]",i.getBrowserName(),i.getBrowserVersion())}wk.warn("this._detectDevice() | unknown device")}(),!n)throw new _y("device not supported");wk.debug("constructor() | detected handler: %s",n)}this.switchDevice(n)}var i=this._handlerFactory();this._handlerName=i.name,i.close(),this._extendedRtpCapabilities=void 0,this._recvRtpCapabilities=void 0,this._canProduceByKind={audio:!1,video:!1},this._sctpCapabilities=void 0}return(0,k.Z)(e,[{key:"handlerName",get:function(){return this._handlerName}},{key:"loaded",get:function(){return this._loaded}},{key:"rtpCapabilities",get:function(){if(!this._loaded)throw new Sy("not loaded");return this._recvRtpCapabilities}},{key:"sctpCapabilities",get:function(){if(!this._loaded)throw new Sy("not loaded");return this._sctpCapabilities}},{key:"observer",get:function(){return this._observer}},{key:"load",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.routerRtpCapabilities,wk.debug("load() [routerRtpCapabilities:%o]",n),n=Ey(n,void 0),e.prev=2,!this._loaded){e.next=5;break}throw new Sy("already loaded");case 5:return Py(n),r=this._handlerFactory(),e.next=8,r.getNativeRtpCapabilities();case 8:return a=e.sent,wk.debug("load() | got native RTP capabilities:%o",a),Py(a),this._extendedRtpCapabilities=Uy(a,n),wk.debug("load() | got extended RTP capabilities:%o",this._extendedRtpCapabilities),this._canProduceByKind.audio=Gy("audio",this._extendedRtpCapabilities),this._canProduceByKind.video=Gy("video",this._extendedRtpCapabilities),this._recvRtpCapabilities=By(this._extendedRtpCapabilities),Py(this._recvRtpCapabilities),wk.debug("load() | got receiving RTP capabilities:%o",this._recvRtpCapabilities),e.next=20,r.getNativeSctpCapabilities();case 20:this._sctpCapabilities=e.sent,wk.debug("load() | got native SCTP capabilities:%o",this._sctpCapabilities),jy(this._sctpCapabilities),wk.debug("load() succeeded"),this._loaded=!0,r.close(),e.next=31;break;case 28:throw e.prev=28,e.t0=e.catch(2),r&&r.close(),e.t0;case 31:case"end":return e.stop()}}),e,this,[[2,28]])})));return function(t){return e.apply(this,arguments)}}()},{key:"canProduce",value:function(e){if(!this._loaded)throw new Sy("not loaded");if("audio"!==e&&"video"!==e)throw new TypeError('invalid kind "'.concat(e,'"'));return this._canProduceByKind[e]}},{key:"createSendTransport",value:function(e){var t=e.id,n=e.iceParameters,r=e.iceCandidates,a=e.dtlsParameters,i=e.sctpParameters,o=e.iceServers,s=e.iceTransportPolicy,c=e.additionalSettings,u=e.proprietaryConstraints,l=e.appData;return wk.debug("createSendTransport()"),this.createTransport({direction:"send",id:t,iceParameters:n,iceCandidates:r,dtlsParameters:a,sctpParameters:i,iceServers:o,iceTransportPolicy:s,additionalSettings:c,proprietaryConstraints:u,appData:l})}},{key:"createRecvTransport",value:function(e){var t=e.id,n=e.iceParameters,r=e.iceCandidates,a=e.dtlsParameters,i=e.sctpParameters,o=e.iceServers,s=e.iceTransportPolicy,c=e.additionalSettings,u=e.proprietaryConstraints,l=e.appData;return wk.debug("createRecvTransport()"),this.createTransport({direction:"recv",id:t,iceParameters:n,iceCandidates:r,dtlsParameters:a,sctpParameters:i,iceServers:o,iceTransportPolicy:s,additionalSettings:c,proprietaryConstraints:u,appData:l})}},{key:"createTransport",value:function(e){var t=e.direction,n=e.id,r=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,o=e.sctpParameters,s=e.iceServers,c=e.iceTransportPolicy,u=e.additionalSettings,l=e.proprietaryConstraints,d=e.appData;if(!this._loaded)throw new Sy("not loaded");if("string"!=typeof n)throw new TypeError("missing id");if("object"!=typeof r)throw new TypeError("missing iceParameters");if(!Array.isArray(a))throw new TypeError("missing iceCandidates");if("object"!=typeof i)throw new TypeError("missing dtlsParameters");if(o&&"object"!=typeof o)throw new TypeError("wrong sctpParameters");if(d&&"object"!=typeof d)throw new TypeError("if given, appData must be an object");var p=new bk({direction:t,id:n,iceParameters:r,iceCandidates:a,dtlsParameters:i,sctpParameters:o,iceServers:s,iceTransportPolicy:c,additionalSettings:u,proprietaryConstraints:l,appData:d,handlerFactory:this._handlerFactory,extendedRtpCapabilities:this._extendedRtpCapabilities,canProduceByKind:this._canProduceByKind});return this._observer.safeEmit("newtransport",p),p}}]),e}();function Sk(e){var t,n=e.sdpObject,r=new Map,a=[],i=!1,o=!1,s=(0,c.Z)(n.media);try{for(s.s();!(t=s.n()).done;){var u=t.value,l=u.type;switch(l){case"audio":if(i)continue;i=!0;break;case"video":if(o)continue;o=!0;break;default:continue}var d,p=(0,c.Z)(u.rtp);try{for(p.s();!(d=p.n()).done;){var f=d.value,h={kind:l,mimeType:"".concat(l,"/").concat(f.codec),preferredPayloadType:f.payload,clockRate:f.rate,channels:f.encoding,parameters:{},rtcpFeedback:[]};r.set(h.preferredPayloadType,h)}}catch(Cx){p.e(Cx)}finally{p.f()}var v,m=(0,c.Z)(u.fmtp||[]);try{for(m.s();!(v=m.n()).done;){var g=v.value,y=Si.rz(g.config),k=r.get(g.payload);k&&(y&&y.hasOwnProperty("profile-level-id")&&(y["profile-level-id"]=String(y["profile-level-id"])),k.parameters=y)}}catch(Cx){m.e(Cx)}finally{m.f()}var b,w=(0,c.Z)(u.rtcpFb||[]);try{for(w.s();!(b=w.n()).done;){var _=b.value,S={type:_.type,parameter:_.subtype};if(S.parameter||delete S.parameter,"*"!==_.payload){var E=r.get(_.payload);if(!E)continue;E.rtcpFeedback.push(S)}else{var T,x=(0,c.Z)(r.values());try{for(x.s();!(T=x.n()).done;){var Z=T.value;Z.kind===l&&!/.+\/rtx$/i.test(Z.mimeType)&&Z.rtcpFeedback.push(S)}}catch(Cx){x.e(Cx)}finally{x.f()}}}}catch(Cx){w.e(Cx)}finally{w.f()}var C,R=(0,c.Z)(u.ext||[]);try{for(R.s();!(C=R.n()).done;){var P=C.value;if(!P["encrypt-uri"]){var I={kind:l,uri:P.uri,preferredId:P.value};a.push(I)}}}catch(Cx){R.e(Cx)}finally{R.f()}}}catch(Cx){s.e(Cx)}finally{s.f()}return{codecs:Array.from(r.values()),headerExtensions:a}}function Ek(e){var t=e.sdpObject,n=(t.media||[]).find((function(e){return e.iceUfrag&&0!==e.port}));if(!n)throw new Error("no active media section found");var r,a=n.fingerprint||t.fingerprint;switch(n.setup){case"active":r="client";break;case"passive":r="server";break;case"actpass":r="auto"}return{role:r,fingerprints:[{algorithm:a.type,value:a.hash}]}}function Tk(e){var t=(e.offerMediaObject.ssrcs||[]).find((function(e){return"cname"===e.attribute}));return t?t.value:""}function xk(e){var t,n=e.offerRtpParameters,r=e.answerMediaObject,a=(0,c.Z)(n.codecs);try{var i=function(){var e=t.value,n=e.mimeType.toLowerCase();if("audio/opus"!==n||!(r.rtp||[]).find((function(t){return t.payload===e.payloadType})))return"continue";r.fmtp=r.fmtp||[];var a=r.fmtp.find((function(t){return t.payload===e.payloadType}));a||(a={payload:e.payloadType,config:""},r.fmtp.push(a));var i=Si.rz(a.config);if("audio/opus"===n){var o=e.parameters["sprop-stereo"];void 0!==o&&(i.stereo=o?1:0)}a.config="";for(var s=0,c=Object.keys(i);s<c.length;s++){var u=c[s];a.config&&(a.config+=";"),a.config+="".concat(u,"=").concat(i[u])}};for(a.s();!(t=a.n()).done;)i()}catch(Cx){a.e(Cx)}finally{a.f()}}function Zk(e){var t,n=e.offerMediaObject,r=e.track,a=new Set,i=(0,c.Z)(n.ssrcs||[]);try{for(i.s();!(t=i.n()).done;){var o=t.value;if("msid"===o.attribute&&o.value.split(" ")[1]===r.id){var s=o.id;a.add(s)}}}catch(Cx){i.e(Cx)}finally{i.f()}if(0===a.size)throw new Error("a=ssrc line with msid information not found [track.id:".concat(r.id,"]"));var l,d=new Map,p=(0,c.Z)(n.ssrcGroups||[]);try{for(p.s();!(l=p.n()).done;){var f=l.value;if("FID"===f.semantics){var h=f.ssrcs.split(/\s+/),v=(0,u.Z)(h,2),m=v[0],g=v[1];m=Number(m),g=Number(g),a.has(m)&&(a.delete(m),a.delete(g),d.set(m,g))}}}catch(Cx){p.e(Cx)}finally{p.f()}var y,k=(0,c.Z)(a);try{for(k.s();!(y=k.n()).done;){var b=y.value;d.set(b,null)}}catch(Cx){k.e(Cx)}finally{k.f()}var w,_=[],S=(0,c.Z)(d);try{for(S.s();!(w=S.n()).done;){var E=(0,u.Z)(w.value,2),T=E[0],x=E[1],Z={ssrc:T};x&&(Z.rtx={ssrc:x}),_.push(Z)}}catch(Cx){S.e(Cx)}finally{S.f()}return _}function Ck(e){var t,n,r,a=e.offerMediaObject,i=e.track,o=e.numStreams;if(o<=1)throw new TypeError("numStreams must be greater than 1");if(!(a.ssrcs||[]).find((function(e){return"msid"===e.attribute&&(e.value.split(" ")[1]===i.id&&(t=e.id,r=e.value.split(" ")[0],!0))})))throw new Error("a=ssrc line with msid information not found [track.id:".concat(i.id,"]"));(a.ssrcGroups||[]).some((function(e){if("FID"!==e.semantics)return!1;var r=e.ssrcs.split(/\s+/);return Number(r[0])===t&&(n=Number(r[1]),!0)}));var s=a.ssrcs.find((function(e){return"cname"===e.attribute&&e.id===t}));if(!s)throw new Error("a=ssrc line with cname information not found [track.id:".concat(i.id,"]"));for(var c=s.value,u=[],l=[],d=0;d<o;++d)u.push(t+d),n&&l.push(n+d);a.ssrcGroups=a.ssrcGroups||[],a.ssrcs=a.ssrcs||[],a.ssrcGroups.push({semantics:"SIM",ssrcs:u.join(" ")});for(var p=0;p<u.length;++p){var f=u[p];a.ssrcs.push({id:f,attribute:"cname",value:c}),a.ssrcs.push({id:f,attribute:"msid",value:"".concat(r," ").concat(i.id)})}for(var h=0;h<l.length;++h){var v=u[h],m=l[h];a.ssrcs.push({id:m,attribute:"cname",value:c}),a.ssrcs.push({id:m,attribute:"msid",value:"".concat(r," ").concat(i.id)}),a.ssrcGroups.push({semantics:"FID",ssrcs:"".concat(v," ").concat(m)})}}var Rk=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this)}return(0,k.Z)(n)}(wy),Pk=function(){function e(t){var n=t.iceParameters,r=t.iceCandidates,a=t.dtlsParameters,i=t.planB,o=void 0!==i&&i;if((0,y.Z)(this,e),this._mediaObject={},this._planB=o,n&&this.setIceParameters(n),r){this._mediaObject.candidates=[];var s,u=(0,c.Z)(r);try{for(u.s();!(s=u.n()).done;){var l=s.value,d={component:1};d.foundation=l.foundation,d.ip=l.ip,d.port=l.port,d.priority=l.priority,d.transport=l.protocol,d.type=l.type,l.tcpType&&(d.tcptype=l.tcpType),this._mediaObject.candidates.push(d)}}catch(Cx){u.e(Cx)}finally{u.f()}this._mediaObject.endOfCandidates="end-of-candidates",this._mediaObject.iceOptions="renomination"}a&&this.setDtlsRole(a.role)}return(0,k.Z)(e,[{key:"mid",get:function(){return String(this._mediaObject.mid)}},{key:"closed",get:function(){return 0===this._mediaObject.port}},{key:"getObject",value:function(){return this._mediaObject}},{key:"setIceParameters",value:function(e){this._mediaObject.iceUfrag=e.usernameFragment,this._mediaObject.icePwd=e.password}},{key:"pause",value:function(){this._mediaObject.direction="inactive"}},{key:"disable",value:function(){this.pause(),delete this._mediaObject.ext,delete this._mediaObject.ssrcs,delete this._mediaObject.ssrcGroups,delete this._mediaObject.simulcast,delete this._mediaObject.simulcast_03,delete this._mediaObject.rids,delete this._mediaObject.extmapAllowMixed}},{key:"close",value:function(){this.disable(),this._mediaObject.port=0}},{key:"muxSimulcastStreams",value:function(e){if(this._mediaObject.simulcast&&this._mediaObject.simulcast.list1){var t={};e.forEach((function(e){e.rid&&(t[e.rid]=e)}));var n=this._mediaObject.simulcast.list1,r=Si.fj(n);r.forEach((function(e){e.forEach((function(e){var n;e.paused=!(null!==(n=t[e.scid])&&void 0!==n&&n.active)}))})),this._mediaObject.simulcast.list1=r.map((function(e){return e.map((function(e){return"".concat(e.paused?"~":"").concat(e.scid)})).join(",")})).join(";")}}}]),e}(),Ik=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r,a=e.iceParameters,i=e.iceCandidates,o=e.dtlsParameters,s=e.sctpParameters,u=e.plainRtpParameters,l=e.planB,d=void 0!==l&&l,p=e.offerMediaObject,f=e.offerRtpParameters,h=e.answerRtpParameters,v=e.codecOptions,m=e.extmapAllowMixed,g=void 0!==m&&m,k=e.forceGoogConference,b=void 0!==k&&k;switch((0,y.Z)(this,n),(r=t.call(this,{iceParameters:a,iceCandidates:i,dtlsParameters:o,planB:d}))._mediaObject.mid=String(p.mid),r._mediaObject.type=p.type,r._mediaObject.protocol=p.protocol,u?(r._mediaObject.connection={ip:u.ip,version:u.ipVersion},r._mediaObject.port=u.port):(r._mediaObject.connection={ip:"127.0.0.1",version:4},r._mediaObject.port=7),p.type){case"audio":case"video":r._mediaObject.direction="recvonly",r._mediaObject.rtp=[],r._mediaObject.rtcpFb=[],r._mediaObject.fmtp=[];var w,_=(0,c.Z)(h.codecs);try{var S=function(){var e=w.value,t={payload:e.payloadType,codec:Dk(e),rate:e.clockRate};e.channels>1&&(t.encoding=e.channels),r._mediaObject.rtp.push(t);var n=Ey(e.parameters,{});if(v){var a=v.opusStereo,i=v.opusFec,o=v.opusDtx,s=v.opusMaxPlaybackRate,u=v.opusMaxAverageBitrate,l=v.opusPtime,d=v.videoGoogleStartBitrate,p=v.videoGoogleMaxBitrate,h=v.videoGoogleMinBitrate,m=f.codecs.find((function(t){return t.payloadType===e.payloadType}));switch(e.mimeType.toLowerCase()){case"audio/opus":void 0!==a&&(m.parameters["sprop-stereo"]=a?1:0,n.stereo=a?1:0),void 0!==i&&(m.parameters.useinbandfec=i?1:0,n.useinbandfec=i?1:0),void 0!==o&&(m.parameters.usedtx=o?1:0,n.usedtx=o?1:0),void 0!==s&&(n.maxplaybackrate=s),void 0!==u&&(n.maxaveragebitrate=u),void 0!==l&&(m.parameters.ptime=l,n.ptime=l);break;case"video/vp8":case"video/vp9":case"video/h264":case"video/h265":void 0!==d&&(n["x-google-start-bitrate"]=d),void 0!==p&&(n["x-google-max-bitrate"]=p),void 0!==h&&(n["x-google-min-bitrate"]=h)}}for(var g={payload:e.payloadType,config:""},y=0,k=Object.keys(n);y<k.length;y++){var b=k[y];g.config&&(g.config+=";"),g.config+="".concat(b,"=").concat(n[b])}g.config&&r._mediaObject.fmtp.push(g);var _,S=(0,c.Z)(e.rtcpFeedback);try{for(S.s();!(_=S.n()).done;){var E=_.value;r._mediaObject.rtcpFb.push({payload:e.payloadType,type:E.type,subtype:E.parameter})}}catch(Cx){S.e(Cx)}finally{S.f()}};for(_.s();!(w=_.n()).done;)S()}catch(Cx){_.e(Cx)}finally{_.f()}r._mediaObject.payloads=h.codecs.map((function(e){return e.payloadType})).join(" "),r._mediaObject.ext=[];var E,T=(0,c.Z)(h.headerExtensions);try{var x=function(){var e=E.value;(p.ext||[]).some((function(t){return t.uri===e.uri}))&&r._mediaObject.ext.push({uri:e.uri,value:e.id})};for(T.s();!(E=T.n()).done;)x()}catch(Cx){T.e(Cx)}finally{T.f()}if(g&&"extmap-allow-mixed"===p.extmapAllowMixed&&(r._mediaObject.extmapAllowMixed="extmap-allow-mixed"),p.simulcast){r._mediaObject.simulcast={dir1:"recv",list1:p.simulcast.list1},r._mediaObject.rids=[];var Z,C=(0,c.Z)(p.rids||[]);try{for(C.s();!(Z=C.n()).done;){var R=Z.value;"send"===R.direction&&r._mediaObject.rids.push({id:R.id,direction:"recv"})}}catch(Cx){C.e(Cx)}finally{C.f()}}else if(p.simulcast_03){r._mediaObject.simulcast_03={value:p.simulcast_03.value.replace(/send/g,"recv")},r._mediaObject.rids=[];var P,I=(0,c.Z)(p.rids||[]);try{for(I.s();!(P=I.n()).done;){var O=P.value;"send"===O.direction&&r._mediaObject.rids.push({id:O.id,direction:"recv"})}}catch(Cx){I.e(Cx)}finally{I.f()}}r._mediaObject.rtcpMux="rtcp-mux",r._mediaObject.rtcpRsize="rtcp-rsize",(r._planB||b)&&"video"===r._mediaObject.type&&(r._mediaObject.xGoogleFlag="conference");break;case"application":"number"==typeof p.sctpPort?(r._mediaObject.payloads="webrtc-datachannel",r._mediaObject.sctpPort=s.port,r._mediaObject.maxMessageSize=s.maxMessageSize):p.sctpmap&&(r._mediaObject.payloads=s.port,r._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:s.port,maxMessageSize:s.maxMessageSize})}return r}return(0,k.Z)(n,[{key:"setDtlsRole",value:function(e){switch(e){case"client":this._mediaObject.setup="active";break;case"server":this._mediaObject.setup="passive";break;case"auto":this._mediaObject.setup="actpass"}}},{key:"resume",value:function(){this._mediaObject.direction="recvonly"}},{key:"muxSimulcastStreams",value:function(e){var t;if(this._mediaObject.simulcast&&this._mediaObject.simulcast.list1){var n,r={},a=(0,c.Z)(e);try{for(a.s();!(n=a.n()).done;){var i=n.value;i.rid&&(r[i.rid]=i)}}catch(Cx){a.e(Cx)}finally{a.f()}var o,s=this._mediaObject.simulcast.list1,u=Si.fj(s),l=(0,c.Z)(u);try{for(l.s();!(o=l.n()).done;){var d,p=o.value,f=(0,c.Z)(p);try{for(f.s();!(d=f.n()).done;){var h=d.value;h.paused=!(null!==(t=r[h.scid])&&void 0!==t&&t.active)}}catch(Cx){f.e(Cx)}finally{f.f()}}}catch(Cx){l.e(Cx)}finally{l.f()}this._mediaObject.simulcast.list1=u.map((function(e){return e.map((function(e){return"".concat(e.paused?"~":"").concat(e.scid)})).join(",")})).join(";")}}}]),n}(Pk),Ok=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r,a=e.iceParameters,i=e.iceCandidates,o=e.dtlsParameters,s=e.sctpParameters,u=e.plainRtpParameters,l=e.planB,d=void 0!==l&&l,p=e.mid,f=e.kind,h=e.offerRtpParameters,v=e.streamId,m=e.trackId,g=e.oldDataChannelSpec,k=void 0!==g&&g;switch((0,y.Z)(this,n),(r=t.call(this,{iceParameters:a,iceCandidates:i,dtlsParameters:o,planB:d}))._mediaObject.mid=String(p),r._mediaObject.type=f,u?(r._mediaObject.connection={ip:u.ip,version:u.ipVersion},r._mediaObject.protocol="RTP/AVP",r._mediaObject.port=u.port):(r._mediaObject.connection={ip:"127.0.0.1",version:4},r._mediaObject.protocol=s?"UDP/DTLS/SCTP":"UDP/TLS/RTP/SAVPF",r._mediaObject.port=7),f){case"audio":case"video":r._mediaObject.direction="sendonly",r._mediaObject.rtp=[],r._mediaObject.rtcpFb=[],r._mediaObject.fmtp=[],r._planB||(r._mediaObject.msid="".concat(v||"-"," ").concat(m));var b,w=(0,c.Z)(h.codecs);try{for(w.s();!(b=w.n()).done;){var _=b.value,S={payload:_.payloadType,codec:Dk(_),rate:_.clockRate};_.channels>1&&(S.encoding=_.channels),r._mediaObject.rtp.push(S);for(var E={payload:_.payloadType,config:""},T=0,x=Object.keys(_.parameters);T<x.length;T++){var Z=x[T];E.config&&(E.config+=";"),E.config+="".concat(Z,"=").concat(_.parameters[Z])}E.config&&r._mediaObject.fmtp.push(E);var C,R=(0,c.Z)(_.rtcpFeedback);try{for(R.s();!(C=R.n()).done;){var P=C.value;r._mediaObject.rtcpFb.push({payload:_.payloadType,type:P.type,subtype:P.parameter})}}catch(Cx){R.e(Cx)}finally{R.f()}}}catch(Cx){w.e(Cx)}finally{w.f()}r._mediaObject.payloads=h.codecs.map((function(e){return e.payloadType})).join(" "),r._mediaObject.ext=[];var I,O=(0,c.Z)(h.headerExtensions);try{for(O.s();!(I=O.n()).done;){var D=I.value;r._mediaObject.ext.push({uri:D.uri,value:D.id})}}catch(Cx){O.e(Cx)}finally{O.f()}r._mediaObject.rtcpMux="rtcp-mux",r._mediaObject.rtcpRsize="rtcp-rsize";var M=h.encodings[0],A=M.ssrc,N=M.rtx&&M.rtx.ssrc?M.rtx.ssrc:void 0;r._mediaObject.ssrcs=[],r._mediaObject.ssrcGroups=[],h.rtcp.cname&&r._mediaObject.ssrcs.push({id:A,attribute:"cname",value:h.rtcp.cname}),r._planB&&r._mediaObject.ssrcs.push({id:A,attribute:"msid",value:"".concat(v||"-"," ").concat(m)}),N&&(h.rtcp.cname&&r._mediaObject.ssrcs.push({id:N,attribute:"cname",value:h.rtcp.cname}),r._planB&&r._mediaObject.ssrcs.push({id:N,attribute:"msid",value:"".concat(v||"-"," ").concat(m)}),r._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:"".concat(A," ").concat(N)}));break;case"application":k?(r._mediaObject.payloads=s.port,r._mediaObject.sctpmap={app:"webrtc-datachannel",sctpmapNumber:s.port,maxMessageSize:s.maxMessageSize}):(r._mediaObject.payloads="webrtc-datachannel",r._mediaObject.sctpPort=s.port,r._mediaObject.maxMessageSize=s.maxMessageSize)}return r}return(0,k.Z)(n,[{key:"setDtlsRole",value:function(e){this._mediaObject.setup="actpass"}},{key:"resume",value:function(){this._mediaObject.direction="sendonly"}},{key:"planBReceive",value:function(e){var t,n=this,r=e.offerRtpParameters,a=e.streamId,i=e.trackId,o=r.encodings[0],s=o.ssrc,u=o.rtx&&o.rtx.ssrc?o.rtx.ssrc:void 0,l=this._mediaObject.payloads.split(" "),d=(0,c.Z)(r.codecs);try{for(d.s();!(t=d.n()).done;){var p=t.value;if(!l.includes(String(p.payloadType))){var f={payload:p.payloadType,codec:Dk(p),rate:p.clockRate};p.channels>1&&(f.encoding=p.channels),this._mediaObject.rtp.push(f);for(var h={payload:p.payloadType,config:""},v=0,m=Object.keys(p.parameters);v<m.length;v++){var g=m[v];h.config&&(h.config+=";"),h.config+="".concat(g,"=").concat(p.parameters[g])}h.config&&this._mediaObject.fmtp.push(h);var y,k=(0,c.Z)(p.rtcpFeedback);try{for(k.s();!(y=k.n()).done;){var b=y.value;this._mediaObject.rtcpFb.push({payload:p.payloadType,type:b.type,subtype:b.parameter})}}catch(Cx){k.e(Cx)}finally{k.f()}}}}catch(Cx){d.e(Cx)}finally{d.f()}this._mediaObject.payloads+=" ".concat(r.codecs.filter((function(e){return!n._mediaObject.payloads.includes(e.payloadType)})).map((function(e){return e.payloadType})).join(" ")),this._mediaObject.payloads=this._mediaObject.payloads.trim(),r.rtcp.cname&&this._mediaObject.ssrcs.push({id:s,attribute:"cname",value:r.rtcp.cname}),this._mediaObject.ssrcs.push({id:s,attribute:"msid",value:"".concat(a||"-"," ").concat(i)}),u&&(r.rtcp.cname&&this._mediaObject.ssrcs.push({id:u,attribute:"cname",value:r.rtcp.cname}),this._mediaObject.ssrcs.push({id:u,attribute:"msid",value:"".concat(a||"-"," ").concat(i)}),this._mediaObject.ssrcGroups.push({semantics:"FID",ssrcs:"".concat(s," ").concat(u)}))}},{key:"planBStopReceiving",value:function(e){var t=e.offerRtpParameters.encodings[0],n=t.ssrc,r=t.rtx&&t.rtx.ssrc?t.rtx.ssrc:void 0;this._mediaObject.ssrcs=this._mediaObject.ssrcs.filter((function(e){return e.id!==n&&e.id!==r})),r&&(this._mediaObject.ssrcGroups=this._mediaObject.ssrcGroups.filter((function(e){return e.ssrcs!=="".concat(n," ").concat(r)})))}}]),n}(Pk);function Dk(e){var t=new RegExp("^(audio|video)/(.+)","i").exec(e.mimeType);if(!t)throw new TypeError("invalid codec.mimeType");return t[2]}var Mk=new ky("RemoteSdp"),Ak=function(){function e(t){var n=t.iceParameters,r=t.iceCandidates,a=t.dtlsParameters,i=t.sctpParameters,o=t.plainRtpParameters,s=t.planB,c=void 0!==s&&s;if((0,y.Z)(this,e),this._mediaSections=[],this._midToIndex=new Map,this._iceParameters=n,this._iceCandidates=r,this._dtlsParameters=a,this._sctpParameters=i,this._plainRtpParameters=o,this._planB=c,this._sdpObject={version:0,origin:{address:"0.0.0.0",ipVer:4,netType:"IN",sessionId:1e4,sessionVersion:0,username:"mediasoup-client"},name:"-",timing:{start:0,stop:0},media:[]},n&&n.iceLite&&(this._sdpObject.icelite="ice-lite"),a){this._sdpObject.msidSemantic={semantic:"WMS",token:"*"};var u=this._dtlsParameters.fingerprints.length;this._sdpObject.fingerprint={type:a.fingerprints[u-1].algorithm,hash:a.fingerprints[u-1].value},this._sdpObject.groups=[{type:"BUNDLE",mids:""}]}o&&(this._sdpObject.origin.address=o.ip,this._sdpObject.origin.ipVer=o.ipVersion)}return(0,k.Z)(e,[{key:"updateIceParameters",value:function(e){Mk.debug("updateIceParameters() [iceParameters:%o]",e),this._iceParameters=e,this._sdpObject.icelite=e.iceLite?"ice-lite":void 0;var t,n=(0,c.Z)(this._mediaSections);try{for(n.s();!(t=n.n()).done;){t.value.setIceParameters(e)}}catch(Cx){n.e(Cx)}finally{n.f()}}},{key:"updateDtlsRole",value:function(e){Mk.debug("updateDtlsRole() [role:%s]",e),this._dtlsParameters.role=e;var t,n=(0,c.Z)(this._mediaSections);try{for(n.s();!(t=n.n()).done;){t.value.setDtlsRole(e)}}catch(Cx){n.e(Cx)}finally{n.f()}}},{key:"getNextMediaSectionIdx",value:function(){for(var e=0;e<this._mediaSections.length;++e){var t=this._mediaSections[e];if(t.closed)return{idx:e,reuseMid:t.mid}}return{idx:this._mediaSections.length}}},{key:"send",value:function(e){var t=e.offerMediaObject,n=e.reuseMid,r=e.offerRtpParameters,a=e.answerRtpParameters,i=e.codecOptions,o=e.extmapAllowMixed,s=void 0!==o&&o,c=e.forceGoogConference,u=void 0!==c&&c,l=new Ik({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,offerMediaObject:t,offerRtpParameters:r,answerRtpParameters:a,codecOptions:i,extmapAllowMixed:s,forceGoogConference:u});n?this._replaceMediaSection(l,n):this._midToIndex.has(l.mid)?this._replaceMediaSection(l):this._addMediaSection(l)}},{key:"receive",value:function(e){var t,n=e.mid,r=e.kind,a=e.offerRtpParameters,i=e.streamId,o=e.trackId,s=this._midToIndex.get(n);if(void 0!==s&&(t=this._mediaSections[s]),t)t.planBReceive({offerRtpParameters:a,streamId:i,trackId:o}),this._replaceMediaSection(t);else{t=new Ok({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,plainRtpParameters:this._plainRtpParameters,planB:this._planB,mid:n,kind:r,offerRtpParameters:a,streamId:i,trackId:o});var c=this._mediaSections.find((function(e){return e.closed}));c?this._replaceMediaSection(t,c.mid):this._addMediaSection(t)}}},{key:"pauseMediaSection",value:function(e){this._findMediaSection(e).pause()}},{key:"resumeSendingMediaSection",value:function(e){this._findMediaSection(e).resume()}},{key:"resumeReceivingMediaSection",value:function(e){this._findMediaSection(e).resume()}},{key:"disableMediaSection",value:function(e){this._findMediaSection(e).disable()}},{key:"closeMediaSection",value:function(e){var t=this._findMediaSection(e);return e===this._firstMid?(Mk.debug("closeMediaSection() | cannot close first media section, disabling it instead [mid:%s]",e),this.disableMediaSection(e),!1):(t.close(),this._regenerateBundleMids(),!0)}},{key:"muxMediaSectionSimulcast",value:function(e,t){var n=this._midToIndex.get(e);if(void 0===n)throw new Error("no media section found with mid '".concat(e,"'"));var r=this._mediaSections[n];if(void 0===r)throw new Error("no media section found with idx '".concat(n,"'"));r.muxSimulcastStreams(t),this._replaceMediaSection(r)}},{key:"planBStopReceiving",value:function(e){var t=e.mid,n=e.offerRtpParameters,r=this._findMediaSection(t);r.planBStopReceiving({offerRtpParameters:n}),this._replaceMediaSection(r)}},{key:"sendSctpAssociation",value:function(e){var t=e.offerMediaObject,n=new Ik({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,offerMediaObject:t});this._addMediaSection(n)}},{key:"receiveSctpAssociation",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).oldDataChannelSpec,t=void 0!==e&&e,n=new Ok({iceParameters:this._iceParameters,iceCandidates:this._iceCandidates,dtlsParameters:this._dtlsParameters,sctpParameters:this._sctpParameters,plainRtpParameters:this._plainRtpParameters,mid:"datachannel",kind:"application",oldDataChannelSpec:t});this._addMediaSection(n)}},{key:"getSdp",value:function(){return this._sdpObject.origin.sessionVersion++,Si.cW(this._sdpObject)}},{key:"_addMediaSection",value:function(e){this._firstMid||(this._firstMid=e.mid),this._mediaSections.push(e),this._midToIndex.set(e.mid,this._mediaSections.length-1),this._sdpObject.media.push(e.getObject()),this._regenerateBundleMids()}},{key:"_replaceMediaSection",value:function(e,t){if("string"==typeof t){var n=this._midToIndex.get(t);if(void 0===n)throw new Error("no media section found for reuseMid '".concat(t,"'"));var r=this._mediaSections[n];this._mediaSections[n]=e,this._midToIndex.delete(r.mid),this._midToIndex.set(e.mid,n),this._sdpObject.media[n]=e.getObject(),this._regenerateBundleMids()}else{var a=this._midToIndex.get(e.mid);if(void 0===a)throw new Error("no media section found with mid '".concat(e.mid,"'"));this._mediaSections[a]=e,this._sdpObject.media[a]=e.getObject()}}},{key:"_findMediaSection",value:function(e){var t=this._midToIndex.get(e);if(void 0===t)throw new Error("no media section found with mid '".concat(e,"'"));return this._mediaSections[t]}},{key:"_regenerateBundleMids",value:function(){this._dtlsParameters&&(this._sdpObject.groups[0].mids=this._mediaSections.filter((function(e){return!e.closed})).map((function(e){return e.mid})).join(" "))}}]),e}(),Nk=new ky("Chrome55"),Lk={OS:1024,MIS:1024},jk=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;return(0,y.Z)(this,n),(e=t.call(this))._sendStream=new MediaStream,e._mapSendLocalIdTrack=new Map,e._nextSendLocalId=0,e._mapRecvLocalIdInfo=new Map,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return(0,k.Z)(n,[{key:"name",get:function(){return"Chrome55"}},{key:"close",value:function(){if(Nk.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}},{key:"getNativeRtpCapabilities",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Nk.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"}),e.prev=2,e.next=5,t.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});case 5:n=e.sent;try{t.close()}catch(a){}return r=Si.Qc(n.sdp),e.abrupt("return",Sk({sdpObject:r}));case 11:e.prev=11,e.t0=e.catch(2);try{t.close()}catch(i){}throw e.t0;case 15:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"getNativeSctpCapabilities",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(Nk.debug("getNativeSctpCapabilities()"),{numStreams:Lk}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"run",value:function(e){var t=this,n=e.direction,r=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,o=e.sctpParameters,c=e.iceServers,u=e.iceTransportPolicy,l=e.additionalSettings,d=e.proprietaryConstraints,p=e.extendedRtpCapabilities;Nk.debug("run()"),this._direction=n,this._remoteSdp=new Ak({iceParameters:r,iceCandidates:a,dtlsParameters:i,sctpParameters:o,planB:!0}),this._sendingRtpParametersByKind={audio:Vy("audio",p),video:Vy("video",p)},this._sendingRemoteRtpParametersByKind={audio:Hy("audio",p),video:Hy("video",p)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection((0,s.Z)({iceServers:c||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"},l),d),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(function(){switch(Nk.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Nk.debug("updateIceServers()"),(n=this._pc.getConfiguration()).iceServers=t,this._pc.setConfiguration(n);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"restartIce",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Nk.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),!this._transportReady){e.next=24;break}if("send"!==this._direction){e.next=14;break}return e.next=4,this._pc.createOffer({iceRestart:!0});case 4:return n=e.sent,Nk.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),e.next=8,this._pc.setLocalDescription(n);case 8:return r={type:"answer",sdp:this._remoteSdp.getSdp()},Nk.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),e.next=12,this._pc.setRemoteDescription(r);case 12:e.next=24;break;case 14:return a={type:"offer",sdp:this._remoteSdp.getSdp()},Nk.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),e.next=18,this._pc.setRemoteDescription(a);case 18:return e.next=20,this._pc.createAnswer();case 20:return i=e.sent,Nk.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),e.next=24,this._pc.setLocalDescription(i);case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTransportStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,u,d,p,f,h,v,m,g,y;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.track,r=t.encodings,a=t.codecOptions,i=t.codec,this.assertSendDirection(),Nk.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),i&&Nk.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(n),this._pc.addStream(this._sendStream),e.next=4,this._pc.createOffer();case 4:if(s=e.sent,u=Si.Qc(s.sdp),(p=Ey(this._sendingRtpParametersByKind[n.kind],{})).codecs=zy(p.codecs),(f=Ey(this._sendingRemoteRtpParametersByKind[n.kind],{})).codecs=zy(f.codecs),e.t0=this._transportReady,e.t0){e.next=14;break}return e.next=14,this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:u});case 14:return"video"===n.kind&&r&&r.length>1&&(Nk.debug("send() | enabling simulcast"),u=Si.Qc(s.sdp),d=u.media.find((function(e){return"video"===e.type})),Ck({offerMediaObject:d,track:n,numStreams:r.length}),s={type:"offer",sdp:Si.cW(u)}),Nk.debug("send() | calling pc.setLocalDescription() [offer:%o]",s),e.next=18,this._pc.setLocalDescription(s);case 18:if(u=Si.Qc(this._pc.localDescription.sdp),d=u.media.find((function(e){return e.type===n.kind})),p.rtcp.cname=Tk({offerMediaObject:d}),p.encodings=Zk({offerMediaObject:d,track:n}),!r){e.next=24;break}for(h=0;h<p.encodings.length;++h)r[h]&&Object.assign(p.encodings[h],r[h]);case 24:if(p.encodings.length>1&&"video/vp8"===p.codecs[0].mimeType.toLowerCase()){v=(0,c.Z)(p.encodings);try{for(v.s();!(m=v.n()).done;)m.value.scalabilityMode="S1T3"}catch(Cx){v.e(Cx)}finally{v.f()}}return this._remoteSdp.send({offerMediaObject:d,offerRtpParameters:p,answerRtpParameters:f,codecOptions:a}),g={type:"answer",sdp:this._remoteSdp.getSdp()},Nk.debug("send() | calling pc.setRemoteDescription() [answer:%o]",g),e.next=30,this._pc.setRemoteDescription(g);case 30:return y=String(this._nextSendLocalId),e.abrupt("return",(this._nextSendLocalId++,this._mapSendLocalIdTrack.set(y,n),{localId:y,rtpParameters:p}));case 32:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),Nk.debug("stopSending() [localId:%s]",t),n=this._mapSendLocalIdTrack.get(t)){e.next=4;break}throw new Error("track not found");case 4:return this._mapSendLocalIdTrack.delete(t),this._sendStream.removeTrack(n),this._pc.addStream(this._sendStream),e.next=7,this._pc.createOffer();case 7:return r=e.sent,Nk.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),e.prev=9,e.next=12,this._pc.setLocalDescription(r);case 12:e.next=20;break;case 14:if(e.prev=14,e.t0=e.catch(9),0!==this._sendStream.getTracks().length){e.next=19;break}return Nk.warn("stopSending() | ignoring expected error due no sending tracks: %s",e.t0.toString()),e.abrupt("return");case 19:throw e.t0;case 20:if("stable"!==this._pc.signalingState){e.next=22;break}return e.abrupt("return");case 22:return a={type:"answer",sdp:this._remoteSdp.getSdp()},Nk.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=26,this._pc.setRemoteDescription(a);case 26:case"end":return e.stop()}}),e,this,[[9,14]])})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"replaceTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new _y("not implemented");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setMaxSpatialLayer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new _y(" not implemented");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setRtpEncodingParameters",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new _y("not supported");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getSenderStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new _y("not implemented");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendDataChannel",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u,d,p,f,h,v;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.ordered,r=t.maxPacketLifeTime,a=t.maxRetransmits,i=t.label,o=t.protocol,this.assertSendDirection(),c={negotiated:!0,id:this._nextSendSctpStreamId,ordered:n,maxPacketLifeTime:r,maxRetransmitTime:r,maxRetransmits:a,protocol:o},Nk.debug("sendDataChannel() [options:%o]",c),u=this._pc.createDataChannel(i,c),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Lk.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=8,this._pc.createOffer();case 8:if(d=e.sent,p=Si.Qc(d.sdp),f=p.media.find((function(e){return"application"===e.type})),e.t0=this._transportReady,e.t0){e.next=15;break}return e.next=15,this.setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:p});case 15:return Nk.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",d),e.next=18,this._pc.setLocalDescription(d);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:f}),h={type:"answer",sdp:this._remoteSdp.getSdp()},Nk.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),e.next=23,this._pc.setRemoteDescription(h);case 23:this._hasDataChannelMediaSection=!0;case 24:return v={streamId:c.id,ordered:c.ordered,maxPacketLifeTime:c.maxPacketLifeTime,maxRetransmits:c.maxRetransmits},e.abrupt("return",{dataChannel:u,sctpStreamParameters:v});case 26:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receive",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,u,d,p,f,h,v,m,g,y,k,b,w,_,S=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=[],a=(0,c.Z)(t);try{for(a.s();!(i=a.n()).done;)o=i.value,s=o.trackId,u=o.kind,d=o.rtpParameters,p=o.streamId,Nk.debug("receive() [trackId:%s, kind:%s]",s,u),f=u,this._remoteSdp.receive({mid:f,kind:u,offerRtpParameters:d,streamId:p||d.rtcp.cname,trackId:s})}catch(Cx){a.e(Cx)}finally{a.f()}return h={type:"offer",sdp:this._remoteSdp.getSdp()},Nk.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",h),e.next=8,this._pc.setRemoteDescription(h);case 8:return e.next=10,this._pc.createAnswer();case 10:v=e.sent,m=Si.Qc(v.sdp),g=(0,c.Z)(t),e.prev=13,k=(0,l.Z)().mark((function e(){var t,n,r,a,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=y.value,n=t.kind,r=t.rtpParameters,a=n,i=m.media.find((function(e){return String(e.mid)===a})),xk({offerRtpParameters:r,answerMediaObject:i});case 3:case"end":return e.stop()}}),e)})),g.s();case 16:if((y=g.n()).done){e.next=20;break}return e.delegateYield(k(),"t0",18);case 18:e.next=16;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(13),g.e(e.t1);case 25:return e.prev=25,g.f(),e.finish(25);case 28:if(v={type:"answer",sdp:Si.cW(m)},e.t2=this._transportReady,e.t2){e.next=33;break}return e.next=33,this.setupTransport({localDtlsRole:null!==(n=this._forcedLocalDtlsRole)&&void 0!==n?n:"client",localSdpObject:m});case 33:return Nk.debug("receive() | calling pc.setLocalDescription() [answer:%o]",v),e.next=36,this._pc.setLocalDescription(v);case 36:b=(0,c.Z)(t),e.prev=37,_=(0,l.Z)().mark((function e(){var t,n,a,i,o,s,c,u;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=w.value,n=t.kind,a=t.trackId,i=t.rtpParameters,o=n,s=a,c=t.streamId||i.rtcp.cname,u=S._pc.getRemoteStreams().find((function(e){return e.id===c})).getTrackById(s)){e.next=4;break}throw new Error("remote track not found");case 4:S._mapRecvLocalIdInfo.set(s,{mid:o,rtpParameters:i}),r.push({localId:s,track:u});case 5:case"end":return e.stop()}}),e)})),b.s();case 40:if((w=b.n()).done){e.next=44;break}return e.delegateYield(_(),"t3",42);case 42:e.next=40;break;case 44:e.next=49;break;case 46:e.prev=46,e.t4=e.catch(37),b.e(e.t4);case 49:return e.prev=49,b.f(),e.finish(49);case 52:return e.abrupt("return",r);case 53:case"end":return e.stop()}}),e,this,[[13,22,25,28],[37,46,49,52]])})));return function(t){return e.apply(this,arguments)}}()},{key:"stopReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,u,d;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),n=(0,c.Z)(t);try{for(n.s();!(r=n.n()).done;)a=r.value,Nk.debug("stopReceiving() [localId:%s]",a),i=this._mapRecvLocalIdInfo.get(a)||{},o=i.mid,s=i.rtpParameters,this._mapRecvLocalIdInfo.delete(a),this._remoteSdp.planBStopReceiving({mid:o,offerRtpParameters:s})}catch(Cx){n.e(Cx)}finally{n.f()}return u={type:"offer",sdp:this._remoteSdp.getSdp()},Nk.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",u),e.next=7,this._pc.setRemoteDescription(u);case 7:return e.next=9,this._pc.createAnswer();case 9:return d=e.sent,Nk.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",d),e.next=13,this._pc.setLocalDescription(d);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getReceiverStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new _y("not implemented");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"receiveDataChannel",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u,d,p,f,h,v;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sctpStreamParameters,r=t.label,a=t.protocol,this.assertRecvDirection(),o=n.streamId,s=n.ordered,c=n.maxPacketLifeTime,u=n.maxRetransmits,d={negotiated:!0,id:o,ordered:s,maxPacketLifeTime:c,maxRetransmitTime:c,maxRetransmits:u,protocol:a},Nk.debug("receiveDataChannel() [options:%o]",d),p=this._pc.createDataChannel(r,d),this._hasDataChannelMediaSection){e.next=22;break}return this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0}),f={type:"offer",sdp:this._remoteSdp.getSdp()},Nk.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",f),e.next=11,this._pc.setRemoteDescription(f);case 11:return e.next=13,this._pc.createAnswer();case 13:if(h=e.sent,this._transportReady){e.next=18;break}return v=Si.Qc(h.sdp),e.next=18,this.setupTransport({localDtlsRole:null!==(i=this._forcedLocalDtlsRole)&&void 0!==i?i:"client",localSdpObject:v});case 18:return Nk.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),e.next=21,this._pc.setLocalDescription(h);case 21:this._hasDataChannelMediaSection=!0;case 22:return e.abrupt("return",{dataChannel:p});case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupTransport",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.localDtlsRole,(r=t.localSdpObject)||(r=Si.Qc(this._pc.localDescription.sdp)),(a=Ek({sdpObject:r})).role=n,this._remoteSdp.updateDtlsRole("client"===n?"server":"client"),e.next=7,new Promise((function(e,t){i.safeEmit("@connect",{dtlsParameters:a},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(Rk),Fk=new ky("Chrome67"),Uk={OS:1024,MIS:1024},Bk=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;return(0,y.Z)(this,n),(e=t.call(this))._sendStream=new MediaStream,e._mapSendLocalIdRtpSender=new Map,e._nextSendLocalId=0,e._mapRecvLocalIdInfo=new Map,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return(0,k.Z)(n,[{key:"name",get:function(){return"Chrome67"}},{key:"close",value:function(){if(Fk.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}},{key:"getNativeRtpCapabilities",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Fk.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"}),e.prev=2,e.next=5,t.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});case 5:n=e.sent;try{t.close()}catch(a){}return r=Si.Qc(n.sdp),e.abrupt("return",Sk({sdpObject:r}));case 11:e.prev=11,e.t0=e.catch(2);try{t.close()}catch(i){}throw e.t0;case 15:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"getNativeSctpCapabilities",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(Fk.debug("getNativeSctpCapabilities()"),{numStreams:Uk}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"run",value:function(e){var t=this,n=e.direction,r=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,o=e.sctpParameters,c=e.iceServers,u=e.iceTransportPolicy,l=e.additionalSettings,d=e.proprietaryConstraints,p=e.extendedRtpCapabilities;Fk.debug("run()"),this._direction=n,this._remoteSdp=new Ak({iceParameters:r,iceCandidates:a,dtlsParameters:i,sctpParameters:o,planB:!0}),this._sendingRtpParametersByKind={audio:Vy("audio",p),video:Vy("video",p)},this._sendingRemoteRtpParametersByKind={audio:Hy("audio",p),video:Hy("video",p)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection((0,s.Z)({iceServers:c||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"},l),d),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(function(){switch(Fk.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Fk.debug("updateIceServers()"),(n=this._pc.getConfiguration()).iceServers=t,this._pc.setConfiguration(n);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"restartIce",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Fk.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),!this._transportReady){e.next=24;break}if("send"!==this._direction){e.next=14;break}return e.next=4,this._pc.createOffer({iceRestart:!0});case 4:return n=e.sent,Fk.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),e.next=8,this._pc.setLocalDescription(n);case 8:return r={type:"answer",sdp:this._remoteSdp.getSdp()},Fk.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),e.next=12,this._pc.setRemoteDescription(r);case 12:e.next=24;break;case 14:return a={type:"offer",sdp:this._remoteSdp.getSdp()},Fk.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),e.next=18,this._pc.setRemoteDescription(a);case 18:return e.next=20,this._pc.createAnswer();case 20:return i=e.sent,Fk.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),e.next=24,this._pc.setLocalDescription(i);case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTransportStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,u,d,p,f,h,v,m,g,y,k;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.track,r=t.encodings,a=t.codecOptions,i=t.codec,this.assertSendDirection(),Fk.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),i&&Fk.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(n),this._pc.addTrack(n,this._sendStream),e.next=4,this._pc.createOffer();case 4:if(s=e.sent,u=Si.Qc(s.sdp),(p=Ey(this._sendingRtpParametersByKind[n.kind],{})).codecs=zy(p.codecs),(f=Ey(this._sendingRemoteRtpParametersByKind[n.kind],{})).codecs=zy(f.codecs),e.t0=this._transportReady,e.t0){e.next=14;break}return e.next=14,this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:u});case 14:return"video"===n.kind&&r&&r.length>1&&(Fk.debug("send() | enabling simulcast"),u=Si.Qc(s.sdp),d=u.media.find((function(e){return"video"===e.type})),Ck({offerMediaObject:d,track:n,numStreams:r.length}),s={type:"offer",sdp:Si.cW(u)}),Fk.debug("send() | calling pc.setLocalDescription() [offer:%o]",s),e.next=18,this._pc.setLocalDescription(s);case 18:if(u=Si.Qc(this._pc.localDescription.sdp),d=u.media.find((function(e){return e.type===n.kind})),p.rtcp.cname=Tk({offerMediaObject:d}),p.encodings=Zk({offerMediaObject:d,track:n}),!r){e.next=24;break}for(h=0;h<p.encodings.length;++h)r[h]&&Object.assign(p.encodings[h],r[h]);case 24:if(p.encodings.length>1&&"video/vp8"===p.codecs[0].mimeType.toLowerCase()){v=(0,c.Z)(p.encodings);try{for(v.s();!(m=v.n()).done;)m.value.scalabilityMode="S1T3"}catch(Cx){v.e(Cx)}finally{v.f()}}return this._remoteSdp.send({offerMediaObject:d,offerRtpParameters:p,answerRtpParameters:f,codecOptions:a}),g={type:"answer",sdp:this._remoteSdp.getSdp()},Fk.debug("send() | calling pc.setRemoteDescription() [answer:%o]",g),e.next=30,this._pc.setRemoteDescription(g);case 30:return y=String(this._nextSendLocalId),this._nextSendLocalId++,k=this._pc.getSenders().find((function(e){return e.track===n})),e.abrupt("return",(this._mapSendLocalIdRtpSender.set(y,k),{localId:y,rtpParameters:p,rtpSender:k}));case 34:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),Fk.debug("stopSending() [localId:%s]",t),n=this._mapSendLocalIdRtpSender.get(t)){e.next=4;break}throw new Error("associated RTCRtpSender not found");case 4:return this._pc.removeTrack(n),n.track&&this._sendStream.removeTrack(n.track),this._mapSendLocalIdRtpSender.delete(t),e.next=7,this._pc.createOffer();case 7:return r=e.sent,Fk.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),e.prev=9,e.next=12,this._pc.setLocalDescription(r);case 12:e.next=20;break;case 14:if(e.prev=14,e.t0=e.catch(9),0!==this._sendStream.getTracks().length){e.next=19;break}return Fk.warn("stopSending() | ignoring expected error due no sending tracks: %s",e.t0.toString()),e.abrupt("return");case 19:throw e.t0;case 20:if("stable"!==this._pc.signalingState){e.next=22;break}return e.abrupt("return");case 22:return a={type:"answer",sdp:this._remoteSdp.getSdp()},Fk.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=26,this._pc.setRemoteDescription(a);case 26:case"end":return e.stop()}}),e,this,[[9,14]])})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"replaceTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),n?Fk.debug("replaceTrack() [localId:%s, track.id:%s]",t,n.id):Fk.debug("replaceTrack() [localId:%s, no track]",t),r=this._mapSendLocalIdRtpSender.get(t)){e.next=4;break}throw new Error("associated RTCRtpSender not found");case 4:return a=r.track,e.next=7,r.replaceTrack(n);case 7:a&&this._sendStream.removeTrack(a),n&&this._sendStream.addTrack(n);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setMaxSpatialLayer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),Fk.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,n),r=this._mapSendLocalIdRtpSender.get(t)){e.next=4;break}throw new Error("associated RTCRtpSender not found");case 4:return(a=r.getParameters()).encodings.forEach((function(e,t){e.active=t<=n})),e.next=8,r.setParameters(a);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setRtpEncodingParameters",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),Fk.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,n),r=this._mapSendLocalIdRtpSender.get(t)){e.next=4;break}throw new Error("associated RTCRtpSender not found");case 4:return(a=r.getParameters()).encodings.forEach((function(e,t){a.encodings[t]=(0,s.Z)((0,s.Z)({},e),n)})),e.next=8,r.setParameters(a);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getSenderStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),n=this._mapSendLocalIdRtpSender.get(t)){e.next=4;break}throw new Error("associated RTCRtpSender not found");case 4:return e.abrupt("return",n.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendDataChannel",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u,d,p,f,h,v;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.ordered,r=t.maxPacketLifeTime,a=t.maxRetransmits,i=t.label,o=t.protocol,this.assertSendDirection(),c={negotiated:!0,id:this._nextSendSctpStreamId,ordered:n,maxPacketLifeTime:r,maxRetransmitTime:r,maxRetransmits:a,protocol:o},Fk.debug("sendDataChannel() [options:%o]",c),u=this._pc.createDataChannel(i,c),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Uk.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=8,this._pc.createOffer();case 8:if(d=e.sent,p=Si.Qc(d.sdp),f=p.media.find((function(e){return"application"===e.type})),e.t0=this._transportReady,e.t0){e.next=15;break}return e.next=15,this.setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:p});case 15:return Fk.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",d),e.next=18,this._pc.setLocalDescription(d);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:f}),h={type:"answer",sdp:this._remoteSdp.getSdp()},Fk.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),e.next=23,this._pc.setRemoteDescription(h);case 23:this._hasDataChannelMediaSection=!0;case 24:return v={streamId:c.id,ordered:c.ordered,maxPacketLifeTime:c.maxPacketLifeTime,maxRetransmits:c.maxRetransmits},e.abrupt("return",{dataChannel:u,sctpStreamParameters:v});case 26:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receive",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,u,d,p,f,h,v,m,g,y,k,b,w,_,S=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=[],a=(0,c.Z)(t);try{for(a.s();!(i=a.n()).done;)o=i.value,s=o.trackId,u=o.kind,d=o.rtpParameters,p=o.streamId,Fk.debug("receive() [trackId:%s, kind:%s]",s,u),f=u,this._remoteSdp.receive({mid:f,kind:u,offerRtpParameters:d,streamId:p||d.rtcp.cname,trackId:s})}catch(Cx){a.e(Cx)}finally{a.f()}return h={type:"offer",sdp:this._remoteSdp.getSdp()},Fk.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",h),e.next=8,this._pc.setRemoteDescription(h);case 8:return e.next=10,this._pc.createAnswer();case 10:v=e.sent,m=Si.Qc(v.sdp),g=(0,c.Z)(t),e.prev=13,k=(0,l.Z)().mark((function e(){var t,n,r,a,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=y.value,n=t.kind,r=t.rtpParameters,a=n,i=m.media.find((function(e){return String(e.mid)===a})),xk({offerRtpParameters:r,answerMediaObject:i});case 3:case"end":return e.stop()}}),e)})),g.s();case 16:if((y=g.n()).done){e.next=20;break}return e.delegateYield(k(),"t0",18);case 18:e.next=16;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(13),g.e(e.t1);case 25:return e.prev=25,g.f(),e.finish(25);case 28:if(v={type:"answer",sdp:Si.cW(m)},e.t2=this._transportReady,e.t2){e.next=33;break}return e.next=33,this.setupTransport({localDtlsRole:null!==(n=this._forcedLocalDtlsRole)&&void 0!==n?n:"client",localSdpObject:m});case 33:return Fk.debug("receive() | calling pc.setLocalDescription() [answer:%o]",v),e.next=36,this._pc.setLocalDescription(v);case 36:b=(0,c.Z)(t),e.prev=37,_=(0,l.Z)().mark((function e(){var t,n,a,i,o,s,c;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=w.value,n=t.kind,a=t.trackId,i=t.rtpParameters,o=a,s=n,c=S._pc.getReceivers().find((function(e){return e.track&&e.track.id===o}))){e.next=4;break}throw new Error("new RTCRtpReceiver not");case 4:S._mapRecvLocalIdInfo.set(o,{mid:s,rtpParameters:i,rtpReceiver:c}),r.push({localId:o,track:c.track,rtpReceiver:c});case 5:case"end":return e.stop()}}),e)})),b.s();case 40:if((w=b.n()).done){e.next=44;break}return e.delegateYield(_(),"t3",42);case 42:e.next=40;break;case 44:e.next=49;break;case 46:e.prev=46,e.t4=e.catch(37),b.e(e.t4);case 49:return e.prev=49,b.f(),e.finish(49);case 52:return e.abrupt("return",r);case 53:case"end":return e.stop()}}),e,this,[[13,22,25,28],[37,46,49,52]])})));return function(t){return e.apply(this,arguments)}}()},{key:"stopReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,u,d;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),n=(0,c.Z)(t);try{for(n.s();!(r=n.n()).done;)a=r.value,Fk.debug("stopReceiving() [localId:%s]",a),i=this._mapRecvLocalIdInfo.get(a)||{},o=i.mid,s=i.rtpParameters,this._mapRecvLocalIdInfo.delete(a),this._remoteSdp.planBStopReceiving({mid:o,offerRtpParameters:s})}catch(Cx){n.e(Cx)}finally{n.f()}return u={type:"offer",sdp:this._remoteSdp.getSdp()},Fk.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",u),e.next=7,this._pc.setRemoteDescription(u);case 7:return e.next=9,this._pc.createAnswer();case 9:return d=e.sent,Fk.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",d),e.next=13,this._pc.setLocalDescription(d);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getReceiverStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertRecvDirection(),n=this._mapRecvLocalIdInfo.get(t)||{},r=n.rtpReceiver){e.next=4;break}throw new Error("associated RTCRtpReceiver not found");case 4:return e.abrupt("return",r.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receiveDataChannel",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u,d,p,f,h,v;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sctpStreamParameters,r=t.label,a=t.protocol,this.assertRecvDirection(),o=n.streamId,s=n.ordered,c=n.maxPacketLifeTime,u=n.maxRetransmits,d={negotiated:!0,id:o,ordered:s,maxPacketLifeTime:c,maxRetransmitTime:c,maxRetransmits:u,protocol:a},Fk.debug("receiveDataChannel() [options:%o]",d),p=this._pc.createDataChannel(r,d),this._hasDataChannelMediaSection){e.next=22;break}return this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0}),f={type:"offer",sdp:this._remoteSdp.getSdp()},Fk.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",f),e.next=11,this._pc.setRemoteDescription(f);case 11:return e.next=13,this._pc.createAnswer();case 13:if(h=e.sent,this._transportReady){e.next=18;break}return v=Si.Qc(h.sdp),e.next=18,this.setupTransport({localDtlsRole:null!==(i=this._forcedLocalDtlsRole)&&void 0!==i?i:"client",localSdpObject:v});case 18:return Fk.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),e.next=21,this._pc.setLocalDescription(h);case 21:this._hasDataChannelMediaSection=!0;case 22:return e.abrupt("return",{dataChannel:p});case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupTransport",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.localDtlsRole,(r=t.localSdpObject)||(r=Si.Qc(this._pc.localDescription.sdp)),(a=Ek({sdpObject:r})).role=n,this._remoteSdp.updateDtlsRole("client"===n?"server":"client"),e.next=7,new Promise((function(e,t){i.safeEmit("@connect",{dtlsParameters:a},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(Rk);function Vk(e){var t,n=e.offerMediaObject,r=new Set,a=(0,c.Z)(n.ssrcs||[]);try{for(a.s();!(t=a.n()).done;){var i=t.value.id;r.add(i)}}catch(Cx){a.e(Cx)}finally{a.f()}if(0===r.size)throw new Error("no a=ssrc lines found");var o,s=new Map,l=(0,c.Z)(n.ssrcGroups||[]);try{for(l.s();!(o=l.n()).done;){var d=o.value;if("FID"===d.semantics){var p=d.ssrcs.split(/\s+/),f=(0,u.Z)(p,2),h=f[0],v=f[1];h=Number(h),v=Number(v),r.has(h)&&(r.delete(h),r.delete(v),s.set(h,v))}}}catch(Cx){l.e(Cx)}finally{l.f()}var m,g=(0,c.Z)(r);try{for(g.s();!(m=g.n()).done;){var y=m.value;s.set(y,null)}}catch(Cx){g.e(Cx)}finally{g.f()}var k,b=[],w=(0,c.Z)(s);try{for(w.s();!(k=w.n()).done;){var _=(0,u.Z)(k.value,2),S=_[0],E=_[1],T={ssrc:S};E&&(T.rtx={ssrc:E}),b.push(T)}}catch(Cx){w.e(Cx)}finally{w.f()}return b}function Hk(e){var t=e.offerMediaObject,n=e.numStreams;if(n<=1)throw new TypeError("numStreams must be greater than 1");var r=(t.ssrcs||[]).find((function(e){return"msid"===e.attribute}));if(!r)throw new Error("a=ssrc line with msid information not found");var a,i=r.value.split(" "),o=(0,u.Z)(i,2),s=o[0],c=o[1],l=r.id;(t.ssrcGroups||[]).some((function(e){if("FID"!==e.semantics)return!1;var t=e.ssrcs.split(/\s+/);return Number(t[0])===l&&(a=Number(t[1]),!0)}));var d=t.ssrcs.find((function(e){return"cname"===e.attribute}));if(!d)throw new Error("a=ssrc line with cname information not found");for(var p=d.value,f=[],h=[],v=0;v<n;++v)f.push(l+v),a&&h.push(a+v);t.ssrcGroups=[],t.ssrcs=[],t.ssrcGroups.push({semantics:"SIM",ssrcs:f.join(" ")});for(var m=0;m<f.length;++m){var g=f[m];t.ssrcs.push({id:g,attribute:"cname",value:p}),t.ssrcs.push({id:g,attribute:"msid",value:"".concat(s," ").concat(c)})}for(var y=0;y<h.length;++y){var k=f[y],b=h[y];t.ssrcs.push({id:b,attribute:"cname",value:p}),t.ssrcs.push({id:b,attribute:"msid",value:"".concat(s," ").concat(c)}),t.ssrcGroups.push({semantics:"FID",ssrcs:"".concat(k," ").concat(b)})}}var zk=new RegExp("^[LS]([1-9]\\d{0,1})T([1-9]\\d{0,1})");function Wk(e){var t=zk.exec(e||"");return t?{spatialLayers:Number(t[1]),temporalLayers:Number(t[2])}:{spatialLayers:1,temporalLayers:1}}var Gk=new ky("Chrome70"),qk={OS:1024,MIS:1024},$k=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;return(0,y.Z)(this,n),(e=t.call(this))._mapMidTransceiver=new Map,e._sendStream=new MediaStream,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return(0,k.Z)(n,[{key:"name",get:function(){return"Chrome70"}},{key:"close",value:function(){if(Gk.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}},{key:"getNativeRtpCapabilities",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Gk.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"}),e.prev=2,t.addTransceiver("audio"),t.addTransceiver("video"),e.next=6,t.createOffer();case 6:n=e.sent;try{t.close()}catch(a){}return r=Si.Qc(n.sdp),e.abrupt("return",Sk({sdpObject:r}));case 12:e.prev=12,e.t0=e.catch(2);try{t.close()}catch(i){}throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"getNativeSctpCapabilities",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(Gk.debug("getNativeSctpCapabilities()"),{numStreams:qk}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"run",value:function(e){var t=this,n=e.direction,r=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,o=e.sctpParameters,c=e.iceServers,u=e.iceTransportPolicy,l=e.additionalSettings,d=e.proprietaryConstraints,p=e.extendedRtpCapabilities;Gk.debug("run()"),this._direction=n,this._remoteSdp=new Ak({iceParameters:r,iceCandidates:a,dtlsParameters:i,sctpParameters:o}),this._sendingRtpParametersByKind={audio:Vy("audio",p),video:Vy("video",p)},this._sendingRemoteRtpParametersByKind={audio:Hy("audio",p),video:Hy("video",p)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection((0,s.Z)({iceServers:c||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"},l),d),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(function(){switch(Gk.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Gk.debug("updateIceServers()"),(n=this._pc.getConfiguration()).iceServers=t,this._pc.setConfiguration(n);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"restartIce",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Gk.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),!this._transportReady){e.next=24;break}if("send"!==this._direction){e.next=14;break}return e.next=4,this._pc.createOffer({iceRestart:!0});case 4:return n=e.sent,Gk.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),e.next=8,this._pc.setLocalDescription(n);case 8:return r={type:"answer",sdp:this._remoteSdp.getSdp()},Gk.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),e.next=12,this._pc.setRemoteDescription(r);case 12:e.next=24;break;case 14:return a={type:"offer",sdp:this._remoteSdp.getSdp()},Gk.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),e.next=18,this._pc.setRemoteDescription(a);case 18:return e.next=20,this._pc.createAnswer();case 20:return i=e.sent,Gk.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),e.next=24,this._pc.setLocalDescription(i);case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTransportStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,u,d,p,f,h,v,m,g,y,k,b,w,_,S,E,T,x;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.track,r=t.encodings,a=t.codecOptions,i=t.codec,this.assertSendDirection(),Gk.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),(s=Ey(this._sendingRtpParametersByKind[n.kind],{})).codecs=zy(s.codecs,i),(u=Ey(this._sendingRemoteRtpParametersByKind[n.kind],{})).codecs=zy(u.codecs,i),d=this._remoteSdp.getNextMediaSectionIdx(),p=this._pc.addTransceiver(n,{direction:"sendonly",streams:[this._sendStream]}),e.next=9,this._pc.createOffer();case 9:if(f=e.sent,h=Si.Qc(f.sdp),e.t0=this._transportReady,e.t0){e.next=15;break}return e.next=15,this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:h});case 15:return r&&r.length>1&&(Gk.debug("send() | enabling legacy simulcast"),h=Si.Qc(f.sdp),Hk({offerMediaObject:v=h.media[d.idx],numStreams:r.length}),f={type:"offer",sdp:Si.cW(h)}),m=!1,g=Wk((r||[{}])[0].scalabilityMode),r&&1===r.length&&g.spatialLayers>1&&"video/vp9"===s.codecs[0].mimeType.toLowerCase()&&(Gk.debug("send() | enabling legacy simulcast for VP9 SVC"),m=!0,h=Si.Qc(f.sdp),Hk({offerMediaObject:v=h.media[d.idx],numStreams:g.spatialLayers}),f={type:"offer",sdp:Si.cW(h)}),Gk.debug("send() | calling pc.setLocalDescription() [offer:%o]",f),e.next=22,this._pc.setLocalDescription(f);case 22:if(!r){e.next=36;break}Gk.debug("send() | applying given encodings"),y=p.sender.getParameters(),k=0;case 26:if(!(k<(y.encodings||[]).length)){e.next=34;break}if(b=y.encodings[k],w=r[k]){e.next=30;break}return e.abrupt("break",34);case 30:y.encodings[k]=Object.assign(b,w);case 31:++k,e.next=26;break;case 34:return e.next=36,p.sender.setParameters(y);case 36:if(_=p.mid,s.mid=_,h=Si.Qc(this._pc.localDescription.sdp),v=h.media[d.idx],s.rtcp.cname=Tk({offerMediaObject:v}),s.encodings=Vk({offerMediaObject:v}),r)for(S=0;S<s.encodings.length;++S)r[S]&&Object.assign(s.encodings[S],r[S]);if(m&&(s.encodings=[s.encodings[0]]),s.encodings.length>1&&("video/vp8"===s.codecs[0].mimeType.toLowerCase()||"video/h264"===s.codecs[0].mimeType.toLowerCase())){E=(0,c.Z)(s.encodings);try{for(E.s();!(T=E.n()).done;)T.value.scalabilityMode="S1T3"}catch(Cx){E.e(Cx)}finally{E.f()}}return this._remoteSdp.send({offerMediaObject:v,reuseMid:d.reuseMid,offerRtpParameters:s,answerRtpParameters:u,codecOptions:a}),x={type:"answer",sdp:this._remoteSdp.getSdp()},Gk.debug("send() | calling pc.setRemoteDescription() [answer:%o]",x),e.next=44,this._pc.setRemoteDescription(x);case 44:return this._mapMidTransceiver.set(_,p),e.abrupt("return",{localId:_,rtpParameters:s,rtpSender:p.sender});case 46:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),Gk.debug("stopSending() [localId:%s]",t),n=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:if(n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.closeMediaSection(n.mid))try{n.stop()}catch(i){}return e.next=7,this._pc.createOffer();case 7:return r=e.sent,Gk.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return a={type:"answer",sdp:this._remoteSdp.getSdp()},Gk.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=15,this._pc.setRemoteDescription(a);case 15:this._mapMidTransceiver.delete(t);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"replaceTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),n?Gk.debug("replaceTrack() [localId:%s, track.id:%s]",t,n.id):Gk.debug("replaceTrack() [localId:%s, no track]",t),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.next=6,r.sender.replaceTrack(n);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setMaxSpatialLayer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),Gk.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,n),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return(a=r.sender.getParameters()).encodings.forEach((function(e,t){e.active=t<=n})),e.next=8,r.sender.setParameters(a);case 8:return this._remoteSdp.muxMediaSectionSimulcast(t,a.encodings),e.next=11,this._pc.createOffer();case 11:return i=e.sent,Gk.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),e.next=15,this._pc.setLocalDescription(i);case 15:return o={type:"answer",sdp:this._remoteSdp.getSdp()},Gk.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=19,this._pc.setRemoteDescription(o);case 19:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setRtpEncodingParameters",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),Gk.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,n),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return(a=r.sender.getParameters()).encodings.forEach((function(e,t){a.encodings[t]=(0,s.Z)((0,s.Z)({},e),n)})),e.next=8,r.sender.setParameters(a);case 8:return this._remoteSdp.muxMediaSectionSimulcast(t,a.encodings),e.next=11,this._pc.createOffer();case 11:return i=e.sent,Gk.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),e.next=15,this._pc.setLocalDescription(i);case 15:return o={type:"answer",sdp:this._remoteSdp.getSdp()},Gk.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=19,this._pc.setRemoteDescription(o);case 19:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getSenderStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),n=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.abrupt("return",n.sender.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendDataChannel",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u,d,p,f,h,v;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.ordered,r=t.maxPacketLifeTime,a=t.maxRetransmits,i=t.label,o=t.protocol,this.assertSendDirection(),c={negotiated:!0,id:this._nextSendSctpStreamId,ordered:n,maxPacketLifeTime:r,maxRetransmitTime:r,maxRetransmits:a,protocol:o},Gk.debug("sendDataChannel() [options:%o]",c),u=this._pc.createDataChannel(i,c),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%qk.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=8,this._pc.createOffer();case 8:if(d=e.sent,p=Si.Qc(d.sdp),f=p.media.find((function(e){return"application"===e.type})),e.t0=this._transportReady,e.t0){e.next=15;break}return e.next=15,this.setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:p});case 15:return Gk.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",d),e.next=18,this._pc.setLocalDescription(d);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:f}),h={type:"answer",sdp:this._remoteSdp.getSdp()},Gk.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),e.next=23,this._pc.setRemoteDescription(h);case 23:this._hasDataChannelMediaSection=!0;case 24:return v={streamId:c.id,ordered:c.ordered,maxPacketLifeTime:c.maxPacketLifeTime,maxRetransmits:c.maxRetransmits},e.abrupt("return",{dataChannel:u,sctpStreamParameters:v});case 26:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receive",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,u,d,p,f,h,v,m,g,y,k,b,w,_,S,E=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=[],a=new Map,i=(0,c.Z)(t);try{for(i.s();!(o=i.n()).done;)s=o.value,u=s.trackId,d=s.kind,p=s.rtpParameters,f=s.streamId,Gk.debug("receive() [trackId:%s, kind:%s]",u,d),h=p.mid||String(this._mapMidTransceiver.size),a.set(u,h),this._remoteSdp.receive({mid:h,kind:d,offerRtpParameters:p,streamId:f||p.rtcp.cname,trackId:u})}catch(Cx){i.e(Cx)}finally{i.f()}return v={type:"offer",sdp:this._remoteSdp.getSdp()},Gk.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",v),e.next=8,this._pc.setRemoteDescription(v);case 8:return e.next=10,this._pc.createAnswer();case 10:m=e.sent,g=Si.Qc(m.sdp),y=(0,c.Z)(t),e.prev=13,b=(0,l.Z)().mark((function e(){var t,n,r,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=k.value,n=t.trackId,r=t.rtpParameters,i=a.get(n),o=g.media.find((function(e){return String(e.mid)===i})),xk({offerRtpParameters:r,answerMediaObject:o});case 3:case"end":return e.stop()}}),e)})),y.s();case 16:if((k=y.n()).done){e.next=20;break}return e.delegateYield(b(),"t0",18);case 18:e.next=16;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(13),y.e(e.t1);case 25:return e.prev=25,y.f(),e.finish(25);case 28:if(m={type:"answer",sdp:Si.cW(g)},e.t2=this._transportReady,e.t2){e.next=33;break}return e.next=33,this.setupTransport({localDtlsRole:null!==(n=this._forcedLocalDtlsRole)&&void 0!==n?n:"client",localSdpObject:g});case 33:return Gk.debug("receive() | calling pc.setLocalDescription() [answer:%o]",m),e.next=36,this._pc.setLocalDescription(m);case 36:w=(0,c.Z)(t),e.prev=37,S=(0,l.Z)().mark((function e(){var t,n,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=_.value,n=t.trackId,i=a.get(n),o=E._pc.getTransceivers().find((function(e){return e.mid===i})),o){e.next=4;break}throw new Error("new RTCRtpTransceiver not found");case 4:E._mapMidTransceiver.set(i,o),r.push({localId:i,track:o.receiver.track,rtpReceiver:o.receiver});case 5:case"end":return e.stop()}}),e)})),w.s();case 40:if((_=w.n()).done){e.next=44;break}return e.delegateYield(S(),"t3",42);case 42:e.next=40;break;case 44:e.next=49;break;case 46:e.prev=46,e.t4=e.catch(37),w.e(e.t4);case 49:return e.prev=49,w.f(),e.finish(49);case 52:return e.abrupt("return",r);case 53:case"end":return e.stop()}}),e,this,[[13,22,25,28],[37,46,49,52]])})));return function(t){return e.apply(this,arguments)}}()},{key:"stopReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,u,d,p;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),n=(0,c.Z)(t),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=13;break}if(a=r.value,Gk.debug("stopReceiving() [localId:%s]",a),i=this._mapMidTransceiver.get(a)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:this._remoteSdp.closeMediaSection(i.mid);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),n.e(e.t0);case 18:return e.prev=18,n.f(),e.finish(18);case 21:return o={type:"offer",sdp:this._remoteSdp.getSdp()},Gk.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=25,this._pc.setRemoteDescription(o);case 25:return e.next=27,this._pc.createAnswer();case 27:return s=e.sent,Gk.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),e.next=31,this._pc.setLocalDescription(s);case 31:u=(0,c.Z)(t);try{for(u.s();!(d=u.n()).done;)p=d.value,this._mapMidTransceiver.delete(p)}catch(Cx){u.e(Cx)}finally{u.f()}case 33:case"end":return e.stop()}}),e,this,[[2,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getReceiverStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertRecvDirection(),n=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.abrupt("return",n.receiver.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receiveDataChannel",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u,d,p,f,h,v;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sctpStreamParameters,r=t.label,a=t.protocol,this.assertRecvDirection(),o=n.streamId,s=n.ordered,c=n.maxPacketLifeTime,u=n.maxRetransmits,d={negotiated:!0,id:o,ordered:s,maxPacketLifeTime:c,maxRetransmitTime:c,maxRetransmits:u,protocol:a},Gk.debug("receiveDataChannel() [options:%o]",d),p=this._pc.createDataChannel(r,d),this._hasDataChannelMediaSection){e.next=22;break}return this._remoteSdp.receiveSctpAssociation(),f={type:"offer",sdp:this._remoteSdp.getSdp()},Gk.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",f),e.next=11,this._pc.setRemoteDescription(f);case 11:return e.next=13,this._pc.createAnswer();case 13:if(h=e.sent,this._transportReady){e.next=18;break}return v=Si.Qc(h.sdp),e.next=18,this.setupTransport({localDtlsRole:null!==(i=this._forcedLocalDtlsRole)&&void 0!==i?i:"client",localSdpObject:v});case 18:return Gk.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),e.next=21,this._pc.setLocalDescription(h);case 21:this._hasDataChannelMediaSection=!0;case 22:return e.abrupt("return",{dataChannel:p});case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupTransport",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.localDtlsRole,(r=t.localSdpObject)||(r=Si.Qc(this._pc.localDescription.sdp)),(a=Ek({sdpObject:r})).role=n,this._remoteSdp.updateDtlsRole("client"===n?"server":"client"),e.next=7,new Promise((function(e,t){i.safeEmit("@connect",{dtlsParameters:a},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(Rk),Kk=new ky("Chrome74"),Jk={OS:1024,MIS:1024},Qk=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;return(0,y.Z)(this,n),(e=t.call(this))._mapMidTransceiver=new Map,e._sendStream=new MediaStream,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return(0,k.Z)(n,[{key:"name",get:function(){return"Chrome74"}},{key:"close",value:function(){if(Kk.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}},{key:"getNativeRtpCapabilities",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Kk.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"}),e.prev=2,t.addTransceiver("audio"),t.addTransceiver("video"),e.next=6,t.createOffer();case 6:n=e.sent;try{t.close()}catch(a){}return r=Si.Qc(n.sdp),e.abrupt("return",Sk({sdpObject:r}));case 12:e.prev=12,e.t0=e.catch(2);try{t.close()}catch(i){}throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"getNativeSctpCapabilities",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(Kk.debug("getNativeSctpCapabilities()"),{numStreams:Jk}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"run",value:function(e){var t=this,n=e.direction,r=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,o=e.sctpParameters,c=e.iceServers,u=e.iceTransportPolicy,l=e.additionalSettings,d=e.proprietaryConstraints,p=e.extendedRtpCapabilities;Kk.debug("run()"),this._direction=n,this._remoteSdp=new Ak({iceParameters:r,iceCandidates:a,dtlsParameters:i,sctpParameters:o}),this._sendingRtpParametersByKind={audio:Vy("audio",p),video:Vy("video",p)},this._sendingRemoteRtpParametersByKind={audio:Hy("audio",p),video:Hy("video",p)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection((0,s.Z)({iceServers:c||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"unified-plan"},l),d),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):(Kk.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),this._pc.addEventListener("iceconnectionstatechange",(function(){switch(t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}})))}},{key:"updateIceServers",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Kk.debug("updateIceServers()"),(n=this._pc.getConfiguration()).iceServers=t,this._pc.setConfiguration(n);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"restartIce",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Kk.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),!this._transportReady){e.next=24;break}if("send"!==this._direction){e.next=14;break}return e.next=4,this._pc.createOffer({iceRestart:!0});case 4:return n=e.sent,Kk.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),e.next=8,this._pc.setLocalDescription(n);case 8:return r={type:"answer",sdp:this._remoteSdp.getSdp()},Kk.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),e.next=12,this._pc.setRemoteDescription(r);case 12:e.next=24;break;case 14:return a={type:"offer",sdp:this._remoteSdp.getSdp()},Kk.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),e.next=18,this._pc.setRemoteDescription(a);case 18:return e.next=20,this._pc.createAnswer();case 20:return i=e.sent,Kk.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),e.next=24,this._pc.setLocalDescription(i);case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTransportStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,u,d,p,f,h,v,m,g,y,k,b,w,_,S,E;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.track,r=t.encodings,a=t.codecOptions,i=t.codec,this.assertSendDirection(),Kk.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),r&&r.length>1&&r.forEach((function(e,t){e.rid="r".concat(t)})),(u=Ey(this._sendingRtpParametersByKind[n.kind],{})).codecs=zy(u.codecs,i),(d=Ey(this._sendingRemoteRtpParametersByKind[n.kind],{})).codecs=zy(d.codecs,i),p=this._remoteSdp.getNextMediaSectionIdx(),f=this._pc.addTransceiver(n,{direction:"sendonly",streams:[this._sendStream],sendEncodings:r}),e.next=9,this._pc.createOffer();case 9:if(h=e.sent,v=Si.Qc(h.sdp),e.t0=this._transportReady,e.t0){e.next=15;break}return e.next=15,this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:v});case 15:return g=!1,y=Wk((r||[{}])[0].scalabilityMode),r&&1===r.length&&y.spatialLayers>1&&"video/vp9"===u.codecs[0].mimeType.toLowerCase()&&(Kk.debug("send() | enabling legacy simulcast for VP9 SVC"),g=!0,v=Si.Qc(h.sdp),Hk({offerMediaObject:m=v.media[p.idx],numStreams:y.spatialLayers}),h={type:"offer",sdp:Si.cW(v)}),Kk.debug("send() | calling pc.setLocalDescription() [offer:%o]",h),e.next=21,this._pc.setLocalDescription(h);case 21:if(k=f.mid,u.mid=k,v=Si.Qc(this._pc.localDescription.sdp),m=v.media[p.idx],u.rtcp.cname=Tk({offerMediaObject:m}),r?1===r.length?(b=Vk({offerMediaObject:m}),Object.assign(b[0],r[0]),g&&(b=[b[0]]),u.encodings=b):u.encodings=r:u.encodings=Vk({offerMediaObject:m}),u.encodings.length>1&&("video/vp8"===u.codecs[0].mimeType.toLowerCase()||"video/h264"===u.codecs[0].mimeType.toLowerCase())){w=(0,c.Z)(u.encodings);try{for(w.s();!(_=w.n()).done;)(S=_.value).scalabilityMode?S.scalabilityMode="S1T".concat(y.temporalLayers):S.scalabilityMode="S1T2"}catch(Cx){w.e(Cx)}finally{w.f()}}return this._remoteSdp.send({offerMediaObject:m,reuseMid:p.reuseMid,offerRtpParameters:u,answerRtpParameters:d,codecOptions:a,extmapAllowMixed:!0,forceGoogConference:null!==(s=null==a?void 0:a.forceGoogConference)&&void 0!==s&&s}),E={type:"answer",sdp:this._remoteSdp.getSdp()},Kk.debug("send() | calling pc.setRemoteDescription() [answer:%o]",E),e.next=29,this._pc.setRemoteDescription(E);case 29:return this._mapMidTransceiver.set(k,f),e.abrupt("return",{localId:k,rtpParameters:u,rtpSender:f.sender});case 31:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),Kk.debug("stopSending() [localId:%s]",t),n=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:if(n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.closeMediaSection(n.mid))try{n.stop()}catch(i){}return e.next=7,this._pc.createOffer();case 7:return r=e.sent,Kk.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return a={type:"answer",sdp:this._remoteSdp.getSdp()},Kk.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=15,this._pc.setRemoteDescription(a);case 15:this._mapMidTransceiver.delete(t);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),Kk.debug("pauseSending() [localId:%s]",t),n=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return n.direction="inactive",this._remoteSdp.pauseMediaSection(t),e.next=7,this._pc.createOffer();case 7:return r=e.sent,Kk.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return a={type:"answer",sdp:this._remoteSdp.getSdp()},Kk.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=15,this._pc.setRemoteDescription(a);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),Kk.debug("resumeSending() [localId:%s]",t),n=this._mapMidTransceiver.get(t),this._remoteSdp.resumeSendingMediaSection(t),n){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return n.direction="sendonly",e.next=7,this._pc.createOffer();case 7:return r=e.sent,Kk.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return a={type:"answer",sdp:this._remoteSdp.getSdp()},Kk.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=15,this._pc.setRemoteDescription(a);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"replaceTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),n?Kk.debug("replaceTrack() [localId:%s, track.id:%s]",t,n.id):Kk.debug("replaceTrack() [localId:%s, no track]",t),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.next=6,r.sender.replaceTrack(n);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setMaxSpatialLayer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),Kk.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,n),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return(a=r.sender.getParameters()).encodings.forEach((function(e,t){e.active=t<=n})),e.next=8,r.sender.setParameters(a);case 8:return this._remoteSdp.muxMediaSectionSimulcast(t,a.encodings),e.next=11,this._pc.createOffer();case 11:return i=e.sent,Kk.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),e.next=15,this._pc.setLocalDescription(i);case 15:return o={type:"answer",sdp:this._remoteSdp.getSdp()},Kk.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=19,this._pc.setRemoteDescription(o);case 19:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setRtpEncodingParameters",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),Kk.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,n),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return(a=r.sender.getParameters()).encodings.forEach((function(e,t){a.encodings[t]=(0,s.Z)((0,s.Z)({},e),n)})),e.next=8,r.sender.setParameters(a);case 8:return this._remoteSdp.muxMediaSectionSimulcast(t,a.encodings),e.next=11,this._pc.createOffer();case 11:return i=e.sent,Kk.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),e.next=15,this._pc.setLocalDescription(i);case 15:return o={type:"answer",sdp:this._remoteSdp.getSdp()},Kk.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=19,this._pc.setRemoteDescription(o);case 19:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getSenderStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),n=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.abrupt("return",n.sender.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendDataChannel",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u,d,p,f,h,v;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.ordered,r=t.maxPacketLifeTime,a=t.maxRetransmits,i=t.label,o=t.protocol,this.assertSendDirection(),c={negotiated:!0,id:this._nextSendSctpStreamId,ordered:n,maxPacketLifeTime:r,maxRetransmits:a,protocol:o},Kk.debug("sendDataChannel() [options:%o]",c),u=this._pc.createDataChannel(i,c),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%Jk.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=8,this._pc.createOffer();case 8:if(d=e.sent,p=Si.Qc(d.sdp),f=p.media.find((function(e){return"application"===e.type})),e.t0=this._transportReady,e.t0){e.next=15;break}return e.next=15,this.setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:p});case 15:return Kk.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",d),e.next=18,this._pc.setLocalDescription(d);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:f}),h={type:"answer",sdp:this._remoteSdp.getSdp()},Kk.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),e.next=23,this._pc.setRemoteDescription(h);case 23:this._hasDataChannelMediaSection=!0;case 24:return v={streamId:c.id,ordered:c.ordered,maxPacketLifeTime:c.maxPacketLifeTime,maxRetransmits:c.maxRetransmits},e.abrupt("return",{dataChannel:u,sctpStreamParameters:v});case 26:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receive",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,u,d,p,f,h,v,m,g,y,k,b,w,_,S,E=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=[],a=new Map,i=(0,c.Z)(t);try{for(i.s();!(o=i.n()).done;)s=o.value,u=s.trackId,d=s.kind,p=s.rtpParameters,f=s.streamId,Kk.debug("receive() [trackId:%s, kind:%s]",u,d),h=p.mid||String(this._mapMidTransceiver.size),a.set(u,h),this._remoteSdp.receive({mid:h,kind:d,offerRtpParameters:p,streamId:f||p.rtcp.cname,trackId:u})}catch(Cx){i.e(Cx)}finally{i.f()}return v={type:"offer",sdp:this._remoteSdp.getSdp()},Kk.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",v),e.next=8,this._pc.setRemoteDescription(v);case 8:return e.next=10,this._pc.createAnswer();case 10:m=e.sent,g=Si.Qc(m.sdp),y=(0,c.Z)(t),e.prev=13,b=(0,l.Z)().mark((function e(){var t,n,r,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=k.value,n=t.trackId,r=t.rtpParameters,i=a.get(n),o=g.media.find((function(e){return String(e.mid)===i})),xk({offerRtpParameters:r,answerMediaObject:o});case 3:case"end":return e.stop()}}),e)})),y.s();case 16:if((k=y.n()).done){e.next=20;break}return e.delegateYield(b(),"t0",18);case 18:e.next=16;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(13),y.e(e.t1);case 25:return e.prev=25,y.f(),e.finish(25);case 28:if(m={type:"answer",sdp:Si.cW(g)},e.t2=this._transportReady,e.t2){e.next=33;break}return e.next=33,this.setupTransport({localDtlsRole:null!==(n=this._forcedLocalDtlsRole)&&void 0!==n?n:"client",localSdpObject:g});case 33:return Kk.debug("receive() | calling pc.setLocalDescription() [answer:%o]",m),e.next=36,this._pc.setLocalDescription(m);case 36:w=(0,c.Z)(t),e.prev=37,S=(0,l.Z)().mark((function e(){var t,n,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=_.value,n=t.trackId,i=a.get(n),o=E._pc.getTransceivers().find((function(e){return e.mid===i})),!o){e.next=6;break}E._mapMidTransceiver.set(i,o),r.push({localId:i,track:o.receiver.track,rtpReceiver:o.receiver}),e.next=7;break;case 6:throw new Error("new RTCRtpTransceiver not found");case 7:case"end":return e.stop()}}),e)})),w.s();case 40:if((_=w.n()).done){e.next=44;break}return e.delegateYield(S(),"t3",42);case 42:e.next=40;break;case 44:e.next=49;break;case 46:e.prev=46,e.t4=e.catch(37),w.e(e.t4);case 49:return e.prev=49,w.f(),e.finish(49);case 52:return e.abrupt("return",r);case 53:case"end":return e.stop()}}),e,this,[[13,22,25,28],[37,46,49,52]])})));return function(t){return e.apply(this,arguments)}}()},{key:"stopReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,u,d,p;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),n=(0,c.Z)(t),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=13;break}if(a=r.value,Kk.debug("stopReceiving() [localId:%s]",a),i=this._mapMidTransceiver.get(a)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:this._remoteSdp.closeMediaSection(i.mid);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),n.e(e.t0);case 18:return e.prev=18,n.f(),e.finish(18);case 21:return o={type:"offer",sdp:this._remoteSdp.getSdp()},Kk.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=25,this._pc.setRemoteDescription(o);case 25:return e.next=27,this._pc.createAnswer();case 27:return s=e.sent,Kk.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),e.next=31,this._pc.setLocalDescription(s);case 31:u=(0,c.Z)(t);try{for(u.s();!(d=u.n()).done;)p=d.value,this._mapMidTransceiver.delete(p)}catch(Cx){u.e(Cx)}finally{u.f()}case 33:case"end":return e.stop()}}),e,this,[[2,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),n=(0,c.Z)(t),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=13;break}if(a=r.value,Kk.debug("pauseReceiving() [localId:%s]",a),i=this._mapMidTransceiver.get(a)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:i.direction="inactive",this._remoteSdp.pauseMediaSection(a);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),n.e(e.t0);case 18:return e.prev=18,n.f(),e.finish(18);case 21:return o={type:"offer",sdp:this._remoteSdp.getSdp()},Kk.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=25,this._pc.setRemoteDescription(o);case 25:return e.next=27,this._pc.createAnswer();case 27:return s=e.sent,Kk.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",s),e.next=31,this._pc.setLocalDescription(s);case 31:case"end":return e.stop()}}),e,this,[[2,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),n=(0,c.Z)(t),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=13;break}if(a=r.value,Kk.debug("resumeReceiving() [localId:%s]",a),i=this._mapMidTransceiver.get(a)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:i.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(a);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),n.e(e.t0);case 18:return e.prev=18,n.f(),e.finish(18);case 21:return o={type:"offer",sdp:this._remoteSdp.getSdp()},Kk.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=25,this._pc.setRemoteDescription(o);case 25:return e.next=27,this._pc.createAnswer();case 27:return s=e.sent,Kk.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",s),e.next=31,this._pc.setLocalDescription(s);case 31:case"end":return e.stop()}}),e,this,[[2,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getReceiverStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertRecvDirection(),n=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.abrupt("return",n.receiver.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receiveDataChannel",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u,d,p,f,h,v;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sctpStreamParameters,r=t.label,a=t.protocol,this.assertRecvDirection(),o=n.streamId,s=n.ordered,c=n.maxPacketLifeTime,u=n.maxRetransmits,d={negotiated:!0,id:o,ordered:s,maxPacketLifeTime:c,maxRetransmits:u,protocol:a},Kk.debug("receiveDataChannel() [options:%o]",d),p=this._pc.createDataChannel(r,d),this._hasDataChannelMediaSection){e.next=22;break}return this._remoteSdp.receiveSctpAssociation(),f={type:"offer",sdp:this._remoteSdp.getSdp()},Kk.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",f),e.next=11,this._pc.setRemoteDescription(f);case 11:return e.next=13,this._pc.createAnswer();case 13:if(h=e.sent,this._transportReady){e.next=18;break}return v=Si.Qc(h.sdp),e.next=18,this.setupTransport({localDtlsRole:null!==(i=this._forcedLocalDtlsRole)&&void 0!==i?i:"client",localSdpObject:v});case 18:return Kk.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),e.next=21,this._pc.setLocalDescription(h);case 21:this._hasDataChannelMediaSection=!0;case 22:return e.abrupt("return",{dataChannel:p});case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupTransport",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.localDtlsRole,(r=t.localSdpObject)||(r=Si.Qc(this._pc.localDescription.sdp)),(a=Ek({sdpObject:r})).role=n,this._remoteSdp.updateDtlsRole("client"===n?"server":"client"),e.next=7,new Promise((function(e,t){i.safeEmit("@connect",{dtlsParameters:a},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(Rk);function Xk(){var e,t=Ey(RTCRtpReceiver.getCapabilities(),{}),n=(0,c.Z)(t.codecs);try{for(n.s();!(e=n.n()).done;){var r=e.value;if(r.channels=r.numChannels,delete r.numChannels,r.mimeType=r.mimeType||"".concat(r.kind,"/").concat(r.name),r.parameters){var a=r.parameters;a.apt&&(a.apt=Number(a.apt)),a["packetization-mode"]&&(a["packetization-mode"]=Number(a["packetization-mode"]))}var i,o=(0,c.Z)(r.rtcpFeedback||[]);try{for(o.s();!(i=o.n()).done;){var s=i.value;s.parameter||(s.parameter="")}}catch(Cx){o.e(Cx)}finally{o.f()}}}catch(Cx){n.e(Cx)}finally{n.f()}return t}function Yk(e){var t=Ey(e,{});t.mid&&(t.muxId=t.mid,delete t.mid);var n,r=(0,c.Z)(t.codecs);try{for(r.s();!(n=r.n()).done;){var a=n.value;a.channels&&(a.numChannels=a.channels,delete a.channels),a.mimeType&&!a.name&&(a.name=a.mimeType.split("/")[1]),delete a.mimeType}}catch(Cx){r.e(Cx)}finally{r.f()}return t}var eb=new ky("Edge11"),tb=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;return(0,y.Z)(this,n),(e=t.call(this))._rtpSenders=new Map,e._rtpReceivers=new Map,e._nextSendLocalId=0,e._transportReady=!1,e}return(0,k.Z)(n,[{key:"name",get:function(){return"Edge11"}},{key:"close",value:function(){eb.debug("close()");try{this._iceGatherer.close()}catch(n){}try{this._iceTransport.stop()}catch(n){}try{this._dtlsTransport.stop()}catch(n){}var e,t=(0,c.Z)(this._rtpSenders.values());try{for(t.s();!(e=t.n()).done;){var n=e.value;try{n.stop()}catch(o){}}}catch(Cx){t.e(Cx)}finally{t.f()}var r,a=(0,c.Z)(this._rtpReceivers.values());try{for(a.s();!(r=a.n()).done;){var i=r.value;try{i.stop()}catch(o){}}}catch(Cx){a.e(Cx)}finally{a.f()}this.emit("@close")}},{key:"getNativeRtpCapabilities",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(eb.debug("getNativeRtpCapabilities()"),Xk()));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getNativeSctpCapabilities",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(eb.debug("getNativeSctpCapabilities()"),{numStreams:{OS:0,MIS:0}}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"run",value:function(e){e.direction;var t=e.iceParameters,n=e.iceCandidates,r=e.dtlsParameters,a=(e.sctpParameters,e.iceServers),i=e.iceTransportPolicy,o=(e.additionalSettings,e.proprietaryConstraints,e.extendedRtpCapabilities);eb.debug("run()"),this._sendingRtpParametersByKind={audio:Vy("audio",o),video:Vy("video",o)},this._remoteIceParameters=t,this._remoteIceCandidates=n,this._remoteDtlsParameters=r,this._cname="CNAME-".concat(Ty()),this.setIceGatherer({iceServers:a,iceTransportPolicy:i}),this.setIceTransport(),this.setDtlsTransport()}},{key:"updateIceServers",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new _y("not supported");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"restartIce",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(eb.debug("restartIce()"),this._remoteIceParameters=t,this._transportReady){eb.debug("restartIce() | calling iceTransport.start()"),this._iceTransport.start(this._iceGatherer,t,"controlling"),n=(0,c.Z)(this._remoteIceCandidates);try{for(n.s();!(r=n.n()).done;)a=r.value,this._iceTransport.addRemoteCandidate(a)}catch(Cx){n.e(Cx)}finally{n.f()}this._iceTransport.addRemoteCandidate({})}case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTransportStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._iceTransport.getStats());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,u,d,p,f,h;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.track,r=t.encodings,t.codecOptions,a=t.codec,eb.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),e.t0=this._transportReady,e.t0){e.next=6;break}return e.next=6,this.setupTransport({localDtlsRole:"server"});case 6:eb.debug("send() | calling new RTCRtpSender()"),i=new RTCRtpSender(n,this._dtlsTransport),(o=Ey(this._sendingRtpParametersByKind[n.kind],{})).codecs=zy(o.codecs,a),s=o.codecs.some((function(e){return/.+\/rtx$/i.test(e.mimeType)})),r||(r=[{}]),u=(0,c.Z)(r);try{for(u.s();!(d=u.n()).done;)(p=d.value).ssrc=Ty(),s&&(p.rtx={ssrc:Ty()})}catch(Cx){u.e(Cx)}finally{u.f()}return o.encodings=r,o.rtcp={cname:this._cname,reducedSize:!0,mux:!0},f=Yk(o),eb.debug("send() | calling rtpSender.send() [params:%o]",f),e.next=18,i.send(f);case 18:return h=String(this._nextSendLocalId),e.abrupt("return",(this._nextSendLocalId++,this._rtpSenders.set(h,i),{localId:h,rtpParameters:o,rtpSender:i}));case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(eb.debug("stopSending() [localId:%s]",t),n=this._rtpSenders.get(t)){e.next=4;break}throw new Error("RTCRtpSender not found");case 4:this._rtpSenders.delete(t),e.prev=5,eb.debug("stopSending() | calling rtpSender.stop()"),n.stop(),e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(5),eb.warn("stopSending() | rtpSender.stop() failed:%o",e.t0),e.t0;case 12:case"end":return e.stop()}}),e,this,[[5,9]])})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"replaceTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n?eb.debug("replaceTrack() [localId:%s, track.id:%s]",t,n.id):eb.debug("replaceTrack() [localId:%s, no track]",t),r=this._rtpSenders.get(t)){e.next=4;break}throw new Error("RTCRtpSender not found");case 4:r.setTrack(n);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setMaxSpatialLayer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(eb.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,n),r=this._rtpSenders.get(t)){e.next=4;break}throw new Error("RTCRtpSender not found");case 4:return(a=r.getParameters()).encodings.forEach((function(e,t){e.active=t<=n})),e.next=8,r.setParameters(a);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setRtpEncodingParameters",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(eb.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,n),r=this._rtpSenders.get(t)){e.next=4;break}throw new Error("RTCRtpSender not found");case 4:return(a=r.getParameters()).encodings.forEach((function(e,t){a.encodings[t]=(0,s.Z)((0,s.Z)({},e),n)})),e.next=8,r.setParameters(a);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getSenderStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._rtpSenders.get(t)){e.next=3;break}throw new Error("RTCRtpSender not found");case 3:return e.abrupt("return",n.getStats());case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendDataChannel",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new _y("not implemented");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"receive",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,u,d,p,f,h,v,m,g,y;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],r=(0,c.Z)(t);try{for(r.s();!(a=r.n()).done;)i=a.value,o=i.trackId,s=i.kind,eb.debug("receive() [trackId:%s, kind:%s]",o,s)}catch(Cx){r.e(Cx)}finally{r.f()}if(e.t0=this._transportReady,e.t0){e.next=7;break}return e.next=7,this.setupTransport({localDtlsRole:"server"});case 7:u=(0,c.Z)(t),e.prev=8,u.s();case 10:if((d=u.n()).done){e.next=24;break}return p=d.value,f=p.trackId,h=p.kind,v=p.rtpParameters,eb.debug("receive() | calling new RTCRtpReceiver()"),(m=new RTCRtpReceiver(this._dtlsTransport,h)).addEventListener("error",(function(e){eb.error('rtpReceiver "error" event [event:%o]',e)})),g=Yk(v),eb.debug("receive() | calling rtpReceiver.receive() [params:%o]",g),e.next=20,m.receive(g);case 20:y=f,this._rtpReceivers.set(y,m),n.push({localId:y,track:m.track,rtpReceiver:m});case 22:e.next=10;break;case 24:e.next=29;break;case 26:e.prev=26,e.t1=e.catch(8),u.e(e.t1);case 29:return e.prev=29,u.f(),e.finish(29);case 32:return e.abrupt("return",n);case 33:case"end":return e.stop()}}),e,this,[[8,26,29,32]])})));return function(t){return e.apply(this,arguments)}}()},{key:"stopReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,c.Z)(t),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=13;break}if(a=r.value,eb.debug("stopReceiving() [localId:%s]",a),i=this._rtpReceivers.get(a)){e.next=9;break}throw new Error("RTCRtpReceiver not found");case 9:this._rtpReceivers.delete(a);try{eb.debug("stopReceiving() | calling rtpReceiver.stop()"),i.stop()}catch(T){eb.warn("stopReceiving() | rtpReceiver.stop() failed:%o",T)}case 11:e.next=3;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),n.e(e.t0);case 18:return e.prev=18,n.f(),e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[1,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getReceiverStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this._rtpReceivers.get(t)){e.next=3;break}throw new Error("RTCRtpReceiver not found");case 3:return e.abrupt("return",n.getStats());case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receiveDataChannel",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new _y("not implemented");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"setIceGatherer",value:function(e){var t=e.iceServers,n=e.iceTransportPolicy,r=new RTCIceGatherer({iceServers:t||[],gatherPolicy:n||"all"});r.addEventListener("error",(function(e){eb.error('iceGatherer "error" event [event:%o]',e)}));try{r.gather()}catch(T){eb.debug("setIceGatherer() | iceGatherer.gather() failed: %s",T.toString())}this._iceGatherer=r}},{key:"setIceTransport",value:function(){var e=this,t=new RTCIceTransport(this._iceGatherer);t.addEventListener("statechange",(function(){switch(t.state){case"checking":e.emit("@connectionstatechange","connecting");break;case"connected":case"completed":e.emit("@connectionstatechange","connected");break;case"failed":e.emit("@connectionstatechange","failed");break;case"disconnected":e.emit("@connectionstatechange","disconnected");break;case"closed":e.emit("@connectionstatechange","closed")}})),t.addEventListener("icestatechange",(function(){switch(t.state){case"checking":e.emit("@connectionstatechange","connecting");break;case"connected":case"completed":e.emit("@connectionstatechange","connected");break;case"failed":e.emit("@connectionstatechange","failed");break;case"disconnected":e.emit("@connectionstatechange","disconnected");break;case"closed":e.emit("@connectionstatechange","closed")}})),t.addEventListener("candidatepairchange",(function(e){eb.debug('iceTransport "candidatepairchange" event [pair:%o]',e.pair)})),this._iceTransport=t}},{key:"setDtlsTransport",value:function(){var e=this,t=new RTCDtlsTransport(this._iceTransport);t.addEventListener("statechange",(function(){eb.debug('dtlsTransport "statechange" event [state:%s]',t.state)})),t.addEventListener("dtlsstatechange",(function(){eb.debug('dtlsTransport "dtlsstatechange" event [state:%s]',t.state),"closed"===t.state&&e.emit("@connectionstatechange","closed")})),t.addEventListener("error",(function(e){eb.error('dtlsTransport "error" event [event:%o]',e)})),this._dtlsTransport=t}},{key:"setupTransport",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.localDtlsRole,eb.debug("setupTransport()"),(r=this._dtlsTransport.getLocalParameters()).role=n,e.next=6,new Promise((function(e,t){s.safeEmit("@connect",{dtlsParameters:r},e,t)}));case 6:this._iceTransport.start(this._iceGatherer,this._remoteIceParameters,"controlling"),a=(0,c.Z)(this._remoteIceCandidates);try{for(a.s();!(i=a.n()).done;)o=i.value,this._iceTransport.addRemoteCandidate(o)}catch(Cx){a.e(Cx)}finally{a.f()}this._iceTransport.addRemoteCandidate({}),this._remoteDtlsParameters.fingerprints=this._remoteDtlsParameters.fingerprints.filter((function(e){return"sha-256"===e.algorithm||"sha-384"===e.algorithm||"sha-512"===e.algorithm})),this._dtlsTransport.start(this._remoteDtlsParameters),this._transportReady=!0;case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(Rk),nb=new ky("Firefox60"),rb={OS:16,MIS:2048},ab=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;return(0,y.Z)(this,n),(e=t.call(this))._mapMidTransceiver=new Map,e._sendStream=new MediaStream,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return(0,k.Z)(n,[{key:"name",get:function(){return"Firefox60"}},{key:"close",value:function(){if(nb.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}},{key:"getNativeRtpCapabilities",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r,a,i,o,s,c;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return nb.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),(n=document.createElement("canvas")).getContext("2d"),r=n.captureStream().getVideoTracks()[0],e.prev=4,t.addTransceiver("audio",{direction:"sendrecv"}),a=t.addTransceiver(r,{direction:"sendrecv"}),i=a.sender.getParameters(),o=[{rid:"r0",maxBitrate:1e5},{rid:"r1",maxBitrate:5e5}],i.encodings=o,e.next=10,a.sender.setParameters(i);case 10:return e.next=12,t.createOffer();case 12:s=e.sent;try{n.remove()}catch(u){}try{r.stop()}catch(u){}try{t.close()}catch(u){}return c=Si.Qc(s.sdp),e.abrupt("return",Sk({sdpObject:c}));case 20:e.prev=20,e.t0=e.catch(4);try{n.remove()}catch(l){}try{r.stop()}catch(l){}try{t.close()}catch(l){}throw e.t0;case 26:case"end":return e.stop()}}),e,null,[[4,20]])})));return function(){return e.apply(this,arguments)}}()},{key:"getNativeSctpCapabilities",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(nb.debug("getNativeSctpCapabilities()"),{numStreams:rb}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"run",value:function(e){var t=this,n=e.direction,r=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,o=e.sctpParameters,c=e.iceServers,u=e.iceTransportPolicy,l=e.additionalSettings,d=e.proprietaryConstraints,p=e.extendedRtpCapabilities;nb.debug("run()"),this._direction=n,this._remoteSdp=new Ak({iceParameters:r,iceCandidates:a,dtlsParameters:i,sctpParameters:o}),this._sendingRtpParametersByKind={audio:Vy("audio",p),video:Vy("video",p)},this._sendingRemoteRtpParametersByKind={audio:Hy("audio",p),video:Hy("video",p)},this._pc=new RTCPeerConnection((0,s.Z)({iceServers:c||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},l),d),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(function(){switch(nb.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new _y("not supported");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"restartIce",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(nb.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),!this._transportReady){e.next=24;break}if("send"!==this._direction){e.next=14;break}return e.next=4,this._pc.createOffer({iceRestart:!0});case 4:return n=e.sent,nb.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),e.next=8,this._pc.setLocalDescription(n);case 8:return r={type:"answer",sdp:this._remoteSdp.getSdp()},nb.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),e.next=12,this._pc.setRemoteDescription(r);case 12:e.next=24;break;case 14:return a={type:"offer",sdp:this._remoteSdp.getSdp()},nb.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),e.next=18,this._pc.setRemoteDescription(a);case 18:return e.next=20,this._pc.createAnswer();case 20:return i=e.sent,nb.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),e.next=24,this._pc.setLocalDescription(i);case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTransportStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,u,d,p,f,h,v,m,g,y,k,b,w;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.track,r=t.encodings,a=t.codecOptions,i=t.codec,this.assertSendDirection(),nb.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),r&&((r=Ey(r,[])).length>1&&(r.forEach((function(e,t){e.rid="r".concat(t)})),r.reverse())),(o=Ey(this._sendingRtpParametersByKind[n.kind],{})).codecs=zy(o.codecs,i),(s=Ey(this._sendingRemoteRtpParametersByKind[n.kind],{})).codecs=zy(s.codecs,i),u=this._pc.addTransceiver(n,{direction:"sendonly",streams:[this._sendStream]}),!r){e.next=12;break}return(d=u.sender.getParameters()).encodings=r,e.next=12,u.sender.setParameters(d);case 12:return e.next=14,this._pc.createOffer();case 14:if(p=e.sent,f=Si.Qc(p.sdp),e.t0=this._transportReady,e.t0){e.next=20;break}return e.next=20,this.setupTransport({localDtlsRole:"client",localSdpObject:f});case 20:return h=Wk((r||[{}])[0].scalabilityMode),nb.debug("send() | calling pc.setLocalDescription() [offer:%o]",p),e.next=24,this._pc.setLocalDescription(p);case 24:if(v=u.mid,o.mid=v,f=Si.Qc(this._pc.localDescription.sdp),m=f.media[f.media.length-1],o.rtcp.cname=Tk({offerMediaObject:m}),r?1===r.length?(g=Vk({offerMediaObject:m}),Object.assign(g[0],r[0]),o.encodings=g):o.encodings=r.reverse():o.encodings=Vk({offerMediaObject:m}),o.encodings.length>1&&("video/vp8"===o.codecs[0].mimeType.toLowerCase()||"video/h264"===o.codecs[0].mimeType.toLowerCase())){y=(0,c.Z)(o.encodings);try{for(y.s();!(k=y.n()).done;)(b=k.value).scalabilityMode?b.scalabilityMode="S1T".concat(h.temporalLayers):b.scalabilityMode="S1T2"}catch(Cx){y.e(Cx)}finally{y.f()}}return this._remoteSdp.send({offerMediaObject:m,offerRtpParameters:o,answerRtpParameters:s,codecOptions:a,extmapAllowMixed:!0}),w={type:"answer",sdp:this._remoteSdp.getSdp()},nb.debug("send() | calling pc.setRemoteDescription() [answer:%o]",w),e.next=34,this._pc.setRemoteDescription(w);case 34:return this._mapMidTransceiver.set(v,u),e.abrupt("return",{localId:v,rtpParameters:o,rtpSender:u.sender});case 36:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(nb.debug("stopSending() [localId:%s]",t),n=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated transceiver not found");case 4:return n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.disableMediaSection(n.mid),e.next=7,this._pc.createOffer();case 7:return r=e.sent,nb.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return a={type:"answer",sdp:this._remoteSdp.getSdp()},nb.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=15,this._pc.setRemoteDescription(a);case 15:this._mapMidTransceiver.delete(t);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),nb.debug("pauseSending() [localId:%s]",t),n=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return n.direction="inactive",this._remoteSdp.pauseMediaSection(t),e.next=7,this._pc.createOffer();case 7:return r=e.sent,nb.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return a={type:"answer",sdp:this._remoteSdp.getSdp()},nb.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=15,this._pc.setRemoteDescription(a);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),nb.debug("resumeSending() [localId:%s]",t),n=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return n.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(t),e.next=7,this._pc.createOffer();case 7:return r=e.sent,nb.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return a={type:"answer",sdp:this._remoteSdp.getSdp()},nb.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=15,this._pc.setRemoteDescription(a);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"replaceTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),n?nb.debug("replaceTrack() [localId:%s, track.id:%s]",t,n.id):nb.debug("replaceTrack() [localId:%s, no track]",t),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.next=6,r.sender.replaceTrack(n);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setMaxSpatialLayer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),nb.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,n),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated transceiver not found");case 4:return a=r.sender.getParameters(),n=a.encodings.length-1-n,a.encodings.forEach((function(e,t){e.active=t>=n})),e.next=9,r.sender.setParameters(a);case 9:return this._remoteSdp.muxMediaSectionSimulcast(t,a.encodings),e.next=12,this._pc.createOffer();case 12:return i=e.sent,nb.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),e.next=16,this._pc.setLocalDescription(i);case 16:return o={type:"answer",sdp:this._remoteSdp.getSdp()},nb.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=20,this._pc.setRemoteDescription(o);case 20:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setRtpEncodingParameters",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),nb.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,n),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return(a=r.sender.getParameters()).encodings.forEach((function(e,t){a.encodings[t]=(0,s.Z)((0,s.Z)({},e),n)})),e.next=8,r.sender.setParameters(a);case 8:return this._remoteSdp.muxMediaSectionSimulcast(t,a.encodings),e.next=11,this._pc.createOffer();case 11:return i=e.sent,nb.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),e.next=15,this._pc.setLocalDescription(i);case 15:return o={type:"answer",sdp:this._remoteSdp.getSdp()},nb.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=19,this._pc.setRemoteDescription(o);case 19:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getSenderStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),n=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.abrupt("return",n.sender.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendDataChannel",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u,d,p,f,h;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.ordered,r=t.maxPacketLifeTime,a=t.maxRetransmits,i=t.label,o=t.protocol,this.assertSendDirection(),s={negotiated:!0,id:this._nextSendSctpStreamId,ordered:n,maxPacketLifeTime:r,maxRetransmits:a,protocol:o},nb.debug("sendDataChannel() [options:%o]",s),c=this._pc.createDataChannel(i,s),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%rb.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=8,this._pc.createOffer();case 8:if(u=e.sent,d=Si.Qc(u.sdp),p=d.media.find((function(e){return"application"===e.type})),e.t0=this._transportReady,e.t0){e.next=15;break}return e.next=15,this.setupTransport({localDtlsRole:"client",localSdpObject:d});case 15:return nb.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",u),e.next=18,this._pc.setLocalDescription(u);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:p}),f={type:"answer",sdp:this._remoteSdp.getSdp()},nb.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),e.next=23,this._pc.setRemoteDescription(f);case 23:this._hasDataChannelMediaSection=!0;case 24:return h={streamId:s.id,ordered:s.ordered,maxPacketLifeTime:s.maxPacketLifeTime,maxRetransmits:s.maxRetransmits},e.abrupt("return",{dataChannel:c,sctpStreamParameters:h});case 26:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receive",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,u,d,p,f,h,v,m,g,y,k,b,w,_,S=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),n=[],r=new Map,a=(0,c.Z)(t);try{for(a.s();!(i=a.n()).done;)o=i.value,s=o.trackId,u=o.kind,d=o.rtpParameters,p=o.streamId,nb.debug("receive() [trackId:%s, kind:%s]",s,u),f=d.mid||String(this._mapMidTransceiver.size),r.set(s,f),this._remoteSdp.receive({mid:f,kind:u,offerRtpParameters:d,streamId:p||d.rtcp.cname,trackId:s})}catch(Cx){a.e(Cx)}finally{a.f()}return h={type:"offer",sdp:this._remoteSdp.getSdp()},nb.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",h),e.next=8,this._pc.setRemoteDescription(h);case 8:return e.next=10,this._pc.createAnswer();case 10:v=e.sent,m=Si.Qc(v.sdp),g=(0,c.Z)(t),e.prev=13,k=(0,l.Z)().mark((function e(){var t,n,a,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=y.value,n=t.trackId,a=t.rtpParameters,i=r.get(n),o=m.media.find((function(e){return String(e.mid)===i})),xk({offerRtpParameters:a,answerMediaObject:o}),v={type:"answer",sdp:Si.cW(m)};case 3:case"end":return e.stop()}}),e)})),g.s();case 16:if((y=g.n()).done){e.next=20;break}return e.delegateYield(k(),"t0",18);case 18:e.next=16;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(13),g.e(e.t1);case 25:return e.prev=25,g.f(),e.finish(25);case 28:if(e.t2=this._transportReady,e.t2){e.next=32;break}return e.next=32,this.setupTransport({localDtlsRole:"client",localSdpObject:m});case 32:return nb.debug("receive() | calling pc.setLocalDescription() [answer:%o]",v),e.next=35,this._pc.setLocalDescription(v);case 35:b=(0,c.Z)(t),e.prev=36,_=(0,l.Z)().mark((function e(){var t,a,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=w.value,a=t.trackId,i=r.get(a),o=S._pc.getTransceivers().find((function(e){return e.mid===i})),o){e.next=4;break}throw new Error("new RTCRtpTransceiver not found");case 4:S._mapMidTransceiver.set(i,o),n.push({localId:i,track:o.receiver.track,rtpReceiver:o.receiver});case 5:case"end":return e.stop()}}),e)})),b.s();case 39:if((w=b.n()).done){e.next=43;break}return e.delegateYield(_(),"t3",41);case 41:e.next=39;break;case 43:e.next=48;break;case 45:e.prev=45,e.t4=e.catch(36),b.e(e.t4);case 48:return e.prev=48,b.f(),e.finish(48);case 51:return e.abrupt("return",n);case 52:case"end":return e.stop()}}),e,this,[[13,22,25,28],[36,45,48,51]])})));return function(t){return e.apply(this,arguments)}}()},{key:"stopReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,u,d,p;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),n=(0,c.Z)(t),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=13;break}if(a=r.value,nb.debug("stopReceiving() [localId:%s]",a),i=this._mapMidTransceiver.get(a)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:this._remoteSdp.closeMediaSection(i.mid);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),n.e(e.t0);case 18:return e.prev=18,n.f(),e.finish(18);case 21:return o={type:"offer",sdp:this._remoteSdp.getSdp()},nb.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=25,this._pc.setRemoteDescription(o);case 25:return e.next=27,this._pc.createAnswer();case 27:return s=e.sent,nb.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),e.next=31,this._pc.setLocalDescription(s);case 31:u=(0,c.Z)(t);try{for(u.s();!(d=u.n()).done;)p=d.value,this._mapMidTransceiver.delete(p)}catch(Cx){u.e(Cx)}finally{u.f()}case 33:case"end":return e.stop()}}),e,this,[[2,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),n=(0,c.Z)(t),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=13;break}if(a=r.value,nb.debug("pauseReceiving() [localId:%s]",a),i=this._mapMidTransceiver.get(a)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:i.direction="inactive",this._remoteSdp.pauseMediaSection(a);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),n.e(e.t0);case 18:return e.prev=18,n.f(),e.finish(18);case 21:return o={type:"offer",sdp:this._remoteSdp.getSdp()},nb.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=25,this._pc.setRemoteDescription(o);case 25:return e.next=27,this._pc.createAnswer();case 27:return s=e.sent,nb.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",s),e.next=31,this._pc.setLocalDescription(s);case 31:case"end":return e.stop()}}),e,this,[[2,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),n=(0,c.Z)(t),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=13;break}if(a=r.value,nb.debug("resumeReceiving() [localId:%s]",a),i=this._mapMidTransceiver.get(a)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:i.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(a);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),n.e(e.t0);case 18:return e.prev=18,n.f(),e.finish(18);case 21:return o={type:"offer",sdp:this._remoteSdp.getSdp()},nb.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=25,this._pc.setRemoteDescription(o);case 25:return e.next=27,this._pc.createAnswer();case 27:return s=e.sent,nb.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",s),e.next=31,this._pc.setLocalDescription(s);case 31:case"end":return e.stop()}}),e,this,[[2,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getReceiverStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertRecvDirection(),n=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.abrupt("return",n.receiver.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receiveDataChannel",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u,d,p,f,h;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sctpStreamParameters,r=t.label,a=t.protocol,this.assertRecvDirection(),i=n.streamId,o=n.ordered,s=n.maxPacketLifeTime,c=n.maxRetransmits,u={negotiated:!0,id:i,ordered:o,maxPacketLifeTime:s,maxRetransmits:c,protocol:a},nb.debug("receiveDataChannel() [options:%o]",u),d=this._pc.createDataChannel(r,u),this._hasDataChannelMediaSection){e.next=22;break}return this._remoteSdp.receiveSctpAssociation(),p={type:"offer",sdp:this._remoteSdp.getSdp()},nb.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",p),e.next=11,this._pc.setRemoteDescription(p);case 11:return e.next=13,this._pc.createAnswer();case 13:if(f=e.sent,this._transportReady){e.next=18;break}return h=Si.Qc(f.sdp),e.next=18,this.setupTransport({localDtlsRole:"client",localSdpObject:h});case 18:return nb.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",f),e.next=21,this._pc.setLocalDescription(f);case 21:this._hasDataChannelMediaSection=!0;case 22:return e.abrupt("return",{dataChannel:d});case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupTransport",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.localDtlsRole,(r=t.localSdpObject)||(r=Si.Qc(this._pc.localDescription.sdp)),(a=Ek({sdpObject:r})).role=n,this._remoteSdp.updateDtlsRole("client"===n?"server":"client"),e.next=7,new Promise((function(e,t){i.safeEmit("@connect",{dtlsParameters:a},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(Rk),ib=new ky("Safari11"),ob={OS:1024,MIS:1024},sb=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;return(0,y.Z)(this,n),(e=t.call(this))._sendStream=new MediaStream,e._mapSendLocalIdRtpSender=new Map,e._nextSendLocalId=0,e._mapRecvLocalIdInfo=new Map,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return(0,k.Z)(n,[{key:"name",get:function(){return"Safari11"}},{key:"close",value:function(){if(ib.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}},{key:"getNativeRtpCapabilities",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ib.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require",sdpSemantics:"plan-b"}),e.prev=2,e.next=5,t.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});case 5:n=e.sent;try{t.close()}catch(a){}return r=Si.Qc(n.sdp),e.abrupt("return",Sk({sdpObject:r}));case 11:e.prev=11,e.t0=e.catch(2);try{t.close()}catch(i){}throw e.t0;case 15:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"getNativeSctpCapabilities",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(ib.debug("getNativeSctpCapabilities()"),{numStreams:ob}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"run",value:function(e){var t=this,n=e.direction,r=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,o=e.sctpParameters,c=e.iceServers,u=e.iceTransportPolicy,l=e.additionalSettings,d=e.proprietaryConstraints,p=e.extendedRtpCapabilities;ib.debug("run()"),this._direction=n,this._remoteSdp=new Ak({iceParameters:r,iceCandidates:a,dtlsParameters:i,sctpParameters:o,planB:!0}),this._sendingRtpParametersByKind={audio:Vy("audio",p),video:Vy("video",p)},this._sendingRemoteRtpParametersByKind={audio:Hy("audio",p),video:Hy("video",p)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection((0,s.Z)({iceServers:c||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},l),d),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(function(){switch(ib.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ib.debug("updateIceServers()"),(n=this._pc.getConfiguration()).iceServers=t,this._pc.setConfiguration(n);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"restartIce",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ib.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),!this._transportReady){e.next=24;break}if("send"!==this._direction){e.next=14;break}return e.next=4,this._pc.createOffer({iceRestart:!0});case 4:return n=e.sent,ib.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),e.next=8,this._pc.setLocalDescription(n);case 8:return r={type:"answer",sdp:this._remoteSdp.getSdp()},ib.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),e.next=12,this._pc.setRemoteDescription(r);case 12:e.next=24;break;case 14:return a={type:"offer",sdp:this._remoteSdp.getSdp()},ib.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),e.next=18,this._pc.setRemoteDescription(a);case 18:return e.next=20,this._pc.createAnswer();case 20:return i=e.sent,ib.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),e.next=24,this._pc.setLocalDescription(i);case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTransportStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,u,d,p,f,h,v,m,g,y,k;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.track,r=t.encodings,a=t.codecOptions,i=t.codec,this.assertSendDirection(),ib.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),i&&ib.warn("send() | codec selection is not available in %s handler",this.name),this._sendStream.addTrack(n),this._pc.addTrack(n,this._sendStream),e.next=4,this._pc.createOffer();case 4:if(s=e.sent,u=Si.Qc(s.sdp),(p=Ey(this._sendingRtpParametersByKind[n.kind],{})).codecs=zy(p.codecs),(f=Ey(this._sendingRemoteRtpParametersByKind[n.kind],{})).codecs=zy(f.codecs),e.t0=this._transportReady,e.t0){e.next=14;break}return e.next=14,this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:u});case 14:return"video"===n.kind&&r&&r.length>1&&(ib.debug("send() | enabling simulcast"),u=Si.Qc(s.sdp),d=u.media.find((function(e){return"video"===e.type})),Ck({offerMediaObject:d,track:n,numStreams:r.length}),s={type:"offer",sdp:Si.cW(u)}),ib.debug("send() | calling pc.setLocalDescription() [offer:%o]",s),e.next=18,this._pc.setLocalDescription(s);case 18:if(u=Si.Qc(this._pc.localDescription.sdp),d=u.media.find((function(e){return e.type===n.kind})),p.rtcp.cname=Tk({offerMediaObject:d}),p.encodings=Zk({offerMediaObject:d,track:n}),!r){e.next=24;break}for(h=0;h<p.encodings.length;++h)r[h]&&Object.assign(p.encodings[h],r[h]);case 24:if(p.encodings.length>1&&"video/vp8"===p.codecs[0].mimeType.toLowerCase()){v=(0,c.Z)(p.encodings);try{for(v.s();!(m=v.n()).done;)m.value.scalabilityMode="S1T3"}catch(Cx){v.e(Cx)}finally{v.f()}}return this._remoteSdp.send({offerMediaObject:d,offerRtpParameters:p,answerRtpParameters:f,codecOptions:a}),g={type:"answer",sdp:this._remoteSdp.getSdp()},ib.debug("send() | calling pc.setRemoteDescription() [answer:%o]",g),e.next=30,this._pc.setRemoteDescription(g);case 30:return y=String(this._nextSendLocalId),this._nextSendLocalId++,k=this._pc.getSenders().find((function(e){return e.track===n})),e.abrupt("return",(this._mapSendLocalIdRtpSender.set(y,k),{localId:y,rtpParameters:p,rtpSender:k}));case 34:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),n=this._mapSendLocalIdRtpSender.get(t)){e.next=4;break}throw new Error("associated RTCRtpSender not found");case 4:return n.track&&this._sendStream.removeTrack(n.track),this._mapSendLocalIdRtpSender.delete(t),e.next=7,this._pc.createOffer();case 7:return r=e.sent,ib.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),e.prev=9,e.next=12,this._pc.setLocalDescription(r);case 12:e.next=20;break;case 14:if(e.prev=14,e.t0=e.catch(9),0!==this._sendStream.getTracks().length){e.next=19;break}return ib.warn("stopSending() | ignoring expected error due no sending tracks: %s",e.t0.toString()),e.abrupt("return");case 19:throw e.t0;case 20:if("stable"!==this._pc.signalingState){e.next=22;break}return e.abrupt("return");case 22:return a={type:"answer",sdp:this._remoteSdp.getSdp()},ib.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=26,this._pc.setRemoteDescription(a);case 26:case"end":return e.stop()}}),e,this,[[9,14]])})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"replaceTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),n?ib.debug("replaceTrack() [localId:%s, track.id:%s]",t,n.id):ib.debug("replaceTrack() [localId:%s, no track]",t),r=this._mapSendLocalIdRtpSender.get(t)){e.next=4;break}throw new Error("associated RTCRtpSender not found");case 4:return a=r.track,e.next=7,r.replaceTrack(n);case 7:a&&this._sendStream.removeTrack(a),n&&this._sendStream.addTrack(n);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setMaxSpatialLayer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),ib.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,n),r=this._mapSendLocalIdRtpSender.get(t)){e.next=4;break}throw new Error("associated RTCRtpSender not found");case 4:return(a=r.getParameters()).encodings.forEach((function(e,t){e.active=t<=n})),e.next=8,r.setParameters(a);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setRtpEncodingParameters",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),ib.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,n),r=this._mapSendLocalIdRtpSender.get(t)){e.next=4;break}throw new Error("associated RTCRtpSender not found");case 4:return(a=r.getParameters()).encodings.forEach((function(e,t){a.encodings[t]=(0,s.Z)((0,s.Z)({},e),n)})),e.next=8,r.setParameters(a);case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getSenderStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),n=this._mapSendLocalIdRtpSender.get(t)){e.next=4;break}throw new Error("associated RTCRtpSender not found");case 4:return e.abrupt("return",n.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendDataChannel",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u,d,p,f,h,v;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.ordered,r=t.maxPacketLifeTime,a=t.maxRetransmits,i=t.label,o=t.protocol,this.assertSendDirection(),c={negotiated:!0,id:this._nextSendSctpStreamId,ordered:n,maxPacketLifeTime:r,maxRetransmits:a,protocol:o},ib.debug("sendDataChannel() [options:%o]",c),u=this._pc.createDataChannel(i,c),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%ob.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=8,this._pc.createOffer();case 8:if(d=e.sent,p=Si.Qc(d.sdp),f=p.media.find((function(e){return"application"===e.type})),e.t0=this._transportReady,e.t0){e.next=15;break}return e.next=15,this.setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:p});case 15:return ib.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",d),e.next=18,this._pc.setLocalDescription(d);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:f}),h={type:"answer",sdp:this._remoteSdp.getSdp()},ib.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),e.next=23,this._pc.setRemoteDescription(h);case 23:this._hasDataChannelMediaSection=!0;case 24:return v={streamId:c.id,ordered:c.ordered,maxPacketLifeTime:c.maxPacketLifeTime,maxRetransmits:c.maxRetransmits},e.abrupt("return",{dataChannel:u,sctpStreamParameters:v});case 26:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receive",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,u,d,p,f,h,v,m,g,y,k,b,w,_,S=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=[],a=(0,c.Z)(t);try{for(a.s();!(i=a.n()).done;)o=i.value,s=o.trackId,u=o.kind,d=o.rtpParameters,p=o.streamId,ib.debug("receive() [trackId:%s, kind:%s]",s,u),f=u,this._remoteSdp.receive({mid:f,kind:u,offerRtpParameters:d,streamId:p||d.rtcp.cname,trackId:s})}catch(Cx){a.e(Cx)}finally{a.f()}return h={type:"offer",sdp:this._remoteSdp.getSdp()},ib.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",h),e.next=8,this._pc.setRemoteDescription(h);case 8:return e.next=10,this._pc.createAnswer();case 10:v=e.sent,m=Si.Qc(v.sdp),g=(0,c.Z)(t),e.prev=13,k=(0,l.Z)().mark((function e(){var t,n,r,a,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=y.value,n=t.kind,r=t.rtpParameters,a=n,i=m.media.find((function(e){return String(e.mid)===a})),xk({offerRtpParameters:r,answerMediaObject:i});case 3:case"end":return e.stop()}}),e)})),g.s();case 16:if((y=g.n()).done){e.next=20;break}return e.delegateYield(k(),"t0",18);case 18:e.next=16;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(13),g.e(e.t1);case 25:return e.prev=25,g.f(),e.finish(25);case 28:if(v={type:"answer",sdp:Si.cW(m)},e.t2=this._transportReady,e.t2){e.next=33;break}return e.next=33,this.setupTransport({localDtlsRole:null!==(n=this._forcedLocalDtlsRole)&&void 0!==n?n:"client",localSdpObject:m});case 33:return ib.debug("receive() | calling pc.setLocalDescription() [answer:%o]",v),e.next=36,this._pc.setLocalDescription(v);case 36:b=(0,c.Z)(t),e.prev=37,_=(0,l.Z)().mark((function e(){var t,n,a,i,o,s,c;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=w.value,n=t.kind,a=t.trackId,i=t.rtpParameters,o=n,s=a,c=S._pc.getReceivers().find((function(e){return e.track&&e.track.id===s}))){e.next=4;break}throw new Error("new RTCRtpReceiver not");case 4:S._mapRecvLocalIdInfo.set(s,{mid:o,rtpParameters:i,rtpReceiver:c}),r.push({localId:s,track:c.track,rtpReceiver:c});case 5:case"end":return e.stop()}}),e)})),b.s();case 40:if((w=b.n()).done){e.next=44;break}return e.delegateYield(_(),"t3",42);case 42:e.next=40;break;case 44:e.next=49;break;case 46:e.prev=46,e.t4=e.catch(37),b.e(e.t4);case 49:return e.prev=49,b.f(),e.finish(49);case 52:return e.abrupt("return",r);case 53:case"end":return e.stop()}}),e,this,[[13,22,25,28],[37,46,49,52]])})));return function(t){return e.apply(this,arguments)}}()},{key:"stopReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,u,d;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),n=(0,c.Z)(t);try{for(n.s();!(r=n.n()).done;)a=r.value,ib.debug("stopReceiving() [localId:%s]",a),i=this._mapRecvLocalIdInfo.get(a)||{},o=i.mid,s=i.rtpParameters,this._mapRecvLocalIdInfo.delete(a),this._remoteSdp.planBStopReceiving({mid:o,offerRtpParameters:s})}catch(Cx){n.e(Cx)}finally{n.f()}return u={type:"offer",sdp:this._remoteSdp.getSdp()},ib.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",u),e.next=7,this._pc.setRemoteDescription(u);case 7:return e.next=9,this._pc.createAnswer();case 9:return d=e.sent,ib.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",d),e.next=13,this._pc.setLocalDescription(d);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getReceiverStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertRecvDirection(),n=this._mapRecvLocalIdInfo.get(t)||{},r=n.rtpReceiver){e.next=4;break}throw new Error("associated RTCRtpReceiver not found");case 4:return e.abrupt("return",r.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"receiveDataChannel",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u,d,p,f,h,v;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sctpStreamParameters,r=t.label,a=t.protocol,this.assertRecvDirection(),o=n.streamId,s=n.ordered,c=n.maxPacketLifeTime,u=n.maxRetransmits,d={negotiated:!0,id:o,ordered:s,maxPacketLifeTime:c,maxRetransmits:u,protocol:a},ib.debug("receiveDataChannel() [options:%o]",d),p=this._pc.createDataChannel(r,d),this._hasDataChannelMediaSection){e.next=22;break}return this._remoteSdp.receiveSctpAssociation({oldDataChannelSpec:!0}),f={type:"offer",sdp:this._remoteSdp.getSdp()},ib.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",f),e.next=11,this._pc.setRemoteDescription(f);case 11:return e.next=13,this._pc.createAnswer();case 13:if(h=e.sent,this._transportReady){e.next=18;break}return v=Si.Qc(h.sdp),e.next=18,this.setupTransport({localDtlsRole:null!==(i=this._forcedLocalDtlsRole)&&void 0!==i?i:"client",localSdpObject:v});case 18:return ib.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),e.next=21,this._pc.setLocalDescription(h);case 21:this._hasDataChannelMediaSection=!0;case 22:return e.abrupt("return",{dataChannel:p});case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupTransport",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.localDtlsRole,(r=t.localSdpObject)||(r=Si.Qc(this._pc.localDescription.sdp)),(a=Ek({sdpObject:r})).role=n,this._remoteSdp.updateDtlsRole("client"===n?"server":"client"),e.next=7,new Promise((function(e,t){i.safeEmit("@connect",{dtlsParameters:a},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(Rk),cb=new ky("Safari12"),ub={OS:1024,MIS:1024},lb=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){var e;return(0,y.Z)(this,n),(e=t.call(this))._mapMidTransceiver=new Map,e._sendStream=new MediaStream,e._hasDataChannelMediaSection=!1,e._nextSendSctpStreamId=0,e._transportReady=!1,e}return(0,k.Z)(n,[{key:"name",get:function(){return"Safari12"}},{key:"close",value:function(){if(cb.debug("close()"),this._pc)try{this._pc.close()}catch(e){}this.emit("@close")}},{key:"getNativeRtpCapabilities",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return cb.debug("getNativeRtpCapabilities()"),t=new RTCPeerConnection({iceServers:[],iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}),e.prev=2,t.addTransceiver("audio"),t.addTransceiver("video"),e.next=6,t.createOffer();case 6:n=e.sent;try{t.close()}catch(a){}return r=Si.Qc(n.sdp),e.abrupt("return",Sk({sdpObject:r}));case 12:e.prev=12,e.t0=e.catch(2);try{t.close()}catch(i){}throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"getNativeSctpCapabilities",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(cb.debug("getNativeSctpCapabilities()"),{numStreams:ub}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"run",value:function(e){var t=this,n=e.direction,r=e.iceParameters,a=e.iceCandidates,i=e.dtlsParameters,o=e.sctpParameters,c=e.iceServers,u=e.iceTransportPolicy,l=e.additionalSettings,d=e.proprietaryConstraints,p=e.extendedRtpCapabilities;cb.debug("run()"),this._direction=n,this._remoteSdp=new Ak({iceParameters:r,iceCandidates:a,dtlsParameters:i,sctpParameters:o}),this._sendingRtpParametersByKind={audio:Vy("audio",p),video:Vy("video",p)},this._sendingRemoteRtpParametersByKind={audio:Hy("audio",p),video:Hy("video",p)},i.role&&"auto"!==i.role&&(this._forcedLocalDtlsRole="server"===i.role?"client":"server"),this._pc=new RTCPeerConnection((0,s.Z)({iceServers:c||[],iceTransportPolicy:u||"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},l),d),this._pc.connectionState?this._pc.addEventListener("connectionstatechange",(function(){t.emit("@connectionstatechange",t._pc.connectionState)})):this._pc.addEventListener("iceconnectionstatechange",(function(){switch(cb.warn("run() | pc.connectionState not supported, using pc.iceConnectionState"),t._pc.iceConnectionState){case"checking":t.emit("@connectionstatechange","connecting");break;case"connected":case"completed":t.emit("@connectionstatechange","connected");break;case"failed":t.emit("@connectionstatechange","failed");break;case"disconnected":t.emit("@connectionstatechange","disconnected");break;case"closed":t.emit("@connectionstatechange","closed")}}))}},{key:"updateIceServers",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:cb.debug("updateIceServers()"),(n=this._pc.getConfiguration()).iceServers=t,this._pc.setConfiguration(n);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"restartIce",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(cb.debug("restartIce()"),this._remoteSdp.updateIceParameters(t),!this._transportReady){e.next=24;break}if("send"!==this._direction){e.next=14;break}return e.next=4,this._pc.createOffer({iceRestart:!0});case 4:return n=e.sent,cb.debug("restartIce() | calling pc.setLocalDescription() [offer:%o]",n),e.next=8,this._pc.setLocalDescription(n);case 8:return r={type:"answer",sdp:this._remoteSdp.getSdp()},cb.debug("restartIce() | calling pc.setRemoteDescription() [answer:%o]",r),e.next=12,this._pc.setRemoteDescription(r);case 12:e.next=24;break;case 14:return a={type:"offer",sdp:this._remoteSdp.getSdp()},cb.debug("restartIce() | calling pc.setRemoteDescription() [offer:%o]",a),e.next=18,this._pc.setRemoteDescription(a);case 18:return e.next=20,this._pc.createAnswer();case 20:return i=e.sent,cb.debug("restartIce() | calling pc.setLocalDescription() [answer:%o]",i),e.next=24,this._pc.setLocalDescription(i);case 24:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTransportStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._pc.getStats());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,u,d,p,f,h,v,m,g,y,k,b,w,_;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.track,r=t.encodings,a=t.codecOptions,i=t.codec,this.assertSendDirection(),cb.debug("send() [kind:%s, track.id:%s]",n.kind,n.id),(s=Ey(this._sendingRtpParametersByKind[n.kind],{})).codecs=zy(s.codecs,i),(u=Ey(this._sendingRemoteRtpParametersByKind[n.kind],{})).codecs=zy(u.codecs,i),d=this._remoteSdp.getNextMediaSectionIdx(),p=this._pc.addTransceiver(n,{direction:"sendonly",streams:[this._sendStream]}),e.next=9,this._pc.createOffer();case 9:if(f=e.sent,h=Si.Qc(f.sdp),e.t0=this._transportReady,e.t0){e.next=15;break}return e.next=15,this.setupTransport({localDtlsRole:null!==(o=this._forcedLocalDtlsRole)&&void 0!==o?o:"client",localSdpObject:h});case 15:return m=Wk((r||[{}])[0].scalabilityMode),r&&r.length>1&&(cb.debug("send() | enabling legacy simulcast"),h=Si.Qc(f.sdp),Hk({offerMediaObject:v=h.media[d.idx],numStreams:r.length}),f={type:"offer",sdp:Si.cW(h)}),cb.debug("send() | calling pc.setLocalDescription() [offer:%o]",f),e.next=20,this._pc.setLocalDescription(f);case 20:if(g=p.mid,s.mid=g,h=Si.Qc(this._pc.localDescription.sdp),v=h.media[d.idx],s.rtcp.cname=Tk({offerMediaObject:v}),s.encodings=Vk({offerMediaObject:v}),r)for(y=0;y<s.encodings.length;++y)r[y]&&Object.assign(s.encodings[y],r[y]);if(s.encodings.length>1&&("video/vp8"===s.codecs[0].mimeType.toLowerCase()||"video/h264"===s.codecs[0].mimeType.toLowerCase())){k=(0,c.Z)(s.encodings);try{for(k.s();!(b=k.n()).done;)(w=b.value).scalabilityMode?w.scalabilityMode="S1T".concat(m.temporalLayers):w.scalabilityMode="S1T3"}catch(Cx){k.e(Cx)}finally{k.f()}}return this._remoteSdp.send({offerMediaObject:v,reuseMid:d.reuseMid,offerRtpParameters:s,answerRtpParameters:u,codecOptions:a}),_={type:"answer",sdp:this._remoteSdp.getSdp()},cb.debug("send() | calling pc.setRemoteDescription() [answer:%o]",_),e.next=28,this._pc.setRemoteDescription(_);case 28:return this._mapMidTransceiver.set(g,p),e.abrupt("return",{localId:g,rtpParameters:s,rtpSender:p.sender});case 30:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),cb.debug("stopSending() [localId:%s]",t),n=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:if(n.sender.replaceTrack(null),this._pc.removeTrack(n.sender),this._remoteSdp.closeMediaSection(n.mid))try{n.stop()}catch(i){}return e.next=7,this._pc.createOffer();case 7:return r=e.sent,cb.debug("stopSending() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return a={type:"answer",sdp:this._remoteSdp.getSdp()},cb.debug("stopSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=15,this._pc.setRemoteDescription(a);case 15:this._mapMidTransceiver.delete(t);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),cb.debug("pauseSending() [localId:%s]",t),n=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return n.direction="inactive",this._remoteSdp.pauseMediaSection(t),e.next=7,this._pc.createOffer();case 7:return r=e.sent,cb.debug("pauseSending() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return a={type:"answer",sdp:this._remoteSdp.getSdp()},cb.debug("pauseSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=15,this._pc.setRemoteDescription(a);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeSending",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),cb.debug("resumeSending() [localId:%s]",t),n=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return n.direction="sendonly",this._remoteSdp.resumeSendingMediaSection(t),e.next=7,this._pc.createOffer();case 7:return r=e.sent,cb.debug("resumeSending() | calling pc.setLocalDescription() [offer:%o]",r),e.next=11,this._pc.setLocalDescription(r);case 11:return a={type:"answer",sdp:this._remoteSdp.getSdp()},cb.debug("resumeSending() | calling pc.setRemoteDescription() [answer:%o]",a),e.next=15,this._pc.setRemoteDescription(a);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"replaceTrack",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),n?cb.debug("replaceTrack() [localId:%s, track.id:%s]",t,n.id):cb.debug("replaceTrack() [localId:%s, no track]",t),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.next=6,r.sender.replaceTrack(n);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setMaxSpatialLayer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),cb.debug("setMaxSpatialLayer() [localId:%s, spatialLayer:%s]",t,n),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return(a=r.sender.getParameters()).encodings.forEach((function(e,t){e.active=t<=n})),e.next=8,r.sender.setParameters(a);case 8:return this._remoteSdp.muxMediaSectionSimulcast(t,a.encodings),e.next=11,this._pc.createOffer();case 11:return i=e.sent,cb.debug("setMaxSpatialLayer() | calling pc.setLocalDescription() [offer:%o]",i),e.next=15,this._pc.setLocalDescription(i);case 15:return o={type:"answer",sdp:this._remoteSdp.getSdp()},cb.debug("setMaxSpatialLayer() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=19,this._pc.setRemoteDescription(o);case 19:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setRtpEncodingParameters",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),cb.debug("setRtpEncodingParameters() [localId:%s, params:%o]",t,n),r=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return(a=r.sender.getParameters()).encodings.forEach((function(e,t){a.encodings[t]=(0,s.Z)((0,s.Z)({},e),n)})),e.next=8,r.sender.setParameters(a);case 8:return this._remoteSdp.muxMediaSectionSimulcast(t,a.encodings),e.next=11,this._pc.createOffer();case 11:return i=e.sent,cb.debug("setRtpEncodingParameters() | calling pc.setLocalDescription() [offer:%o]",i),e.next=15,this._pc.setLocalDescription(i);case 15:return o={type:"answer",sdp:this._remoteSdp.getSdp()},cb.debug("setRtpEncodingParameters() | calling pc.setRemoteDescription() [answer:%o]",o),e.next=19,this._pc.setRemoteDescription(o);case 19:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getSenderStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertSendDirection(),n=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.abrupt("return",n.sender.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendDataChannel",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u,d,p,f,h,v;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.ordered,r=t.maxPacketLifeTime,a=t.maxRetransmits,i=t.label,o=t.protocol,this.assertSendDirection(),c={negotiated:!0,id:this._nextSendSctpStreamId,ordered:n,maxPacketLifeTime:r,maxRetransmits:a,protocol:o},cb.debug("sendDataChannel() [options:%o]",c),u=this._pc.createDataChannel(i,c),this._nextSendSctpStreamId=++this._nextSendSctpStreamId%ub.MIS,this._hasDataChannelMediaSection){e.next=24;break}return e.next=8,this._pc.createOffer();case 8:if(d=e.sent,p=Si.Qc(d.sdp),f=p.media.find((function(e){return"application"===e.type})),e.t0=this._transportReady,e.t0){e.next=15;break}return e.next=15,this.setupTransport({localDtlsRole:null!==(s=this._forcedLocalDtlsRole)&&void 0!==s?s:"client",localSdpObject:p});case 15:return cb.debug("sendDataChannel() | calling pc.setLocalDescription() [offer:%o]",d),e.next=18,this._pc.setLocalDescription(d);case 18:return this._remoteSdp.sendSctpAssociation({offerMediaObject:f}),h={type:"answer",sdp:this._remoteSdp.getSdp()},cb.debug("sendDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),e.next=23,this._pc.setRemoteDescription(h);case 23:this._hasDataChannelMediaSection=!0;case 24:return v={streamId:c.id,ordered:c.ordered,maxPacketLifeTime:c.maxPacketLifeTime,maxRetransmits:c.maxRetransmits},e.abrupt("return",{dataChannel:u,sctpStreamParameters:v});case 26:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receive",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,u,d,p,f,h,v,m,g,y,k,b,w,_,S,E=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),r=[],a=new Map,i=(0,c.Z)(t);try{for(i.s();!(o=i.n()).done;)s=o.value,u=s.trackId,d=s.kind,p=s.rtpParameters,f=s.streamId,cb.debug("receive() [trackId:%s, kind:%s]",u,d),h=p.mid||String(this._mapMidTransceiver.size),a.set(u,h),this._remoteSdp.receive({mid:h,kind:d,offerRtpParameters:p,streamId:f||p.rtcp.cname,trackId:u})}catch(Cx){i.e(Cx)}finally{i.f()}return v={type:"offer",sdp:this._remoteSdp.getSdp()},cb.debug("receive() | calling pc.setRemoteDescription() [offer:%o]",v),e.next=8,this._pc.setRemoteDescription(v);case 8:return e.next=10,this._pc.createAnswer();case 10:m=e.sent,g=Si.Qc(m.sdp),y=(0,c.Z)(t),e.prev=13,b=(0,l.Z)().mark((function e(){var t,n,r,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=k.value,n=t.trackId,r=t.rtpParameters,i=a.get(n),o=g.media.find((function(e){return String(e.mid)===i})),xk({offerRtpParameters:r,answerMediaObject:o});case 3:case"end":return e.stop()}}),e)})),y.s();case 16:if((k=y.n()).done){e.next=20;break}return e.delegateYield(b(),"t0",18);case 18:e.next=16;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(13),y.e(e.t1);case 25:return e.prev=25,y.f(),e.finish(25);case 28:if(m={type:"answer",sdp:Si.cW(g)},e.t2=this._transportReady,e.t2){e.next=33;break}return e.next=33,this.setupTransport({localDtlsRole:null!==(n=this._forcedLocalDtlsRole)&&void 0!==n?n:"client",localSdpObject:g});case 33:return cb.debug("receive() | calling pc.setLocalDescription() [answer:%o]",m),e.next=36,this._pc.setLocalDescription(m);case 36:w=(0,c.Z)(t),e.prev=37,S=(0,l.Z)().mark((function e(){var t,n,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=_.value,n=t.trackId,i=a.get(n),o=E._pc.getTransceivers().find((function(e){return e.mid===i})),o){e.next=4;break}throw new Error("new RTCRtpTransceiver not found");case 4:E._mapMidTransceiver.set(i,o),r.push({localId:i,track:o.receiver.track,rtpReceiver:o.receiver});case 5:case"end":return e.stop()}}),e)})),w.s();case 40:if((_=w.n()).done){e.next=44;break}return e.delegateYield(S(),"t3",42);case 42:e.next=40;break;case 44:e.next=49;break;case 46:e.prev=46,e.t4=e.catch(37),w.e(e.t4);case 49:return e.prev=49,w.f(),e.finish(49);case 52:return e.abrupt("return",r);case 53:case"end":return e.stop()}}),e,this,[[13,22,25,28],[37,46,49,52]])})));return function(t){return e.apply(this,arguments)}}()},{key:"stopReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,u,d,p;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),n=(0,c.Z)(t),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=13;break}if(a=r.value,cb.debug("stopReceiving() [localId:%s]",a),i=this._mapMidTransceiver.get(a)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:this._remoteSdp.closeMediaSection(i.mid);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),n.e(e.t0);case 18:return e.prev=18,n.f(),e.finish(18);case 21:return o={type:"offer",sdp:this._remoteSdp.getSdp()},cb.debug("stopReceiving() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=25,this._pc.setRemoteDescription(o);case 25:return e.next=27,this._pc.createAnswer();case 27:return s=e.sent,cb.debug("stopReceiving() | calling pc.setLocalDescription() [answer:%o]",s),e.next=31,this._pc.setLocalDescription(s);case 31:u=(0,c.Z)(t);try{for(u.s();!(d=u.n()).done;)p=d.value,this._mapMidTransceiver.delete(p)}catch(Cx){u.e(Cx)}finally{u.f()}case 33:case"end":return e.stop()}}),e,this,[[2,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),n=(0,c.Z)(t),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=13;break}if(a=r.value,cb.debug("pauseReceiving() [localId:%s]",a),i=this._mapMidTransceiver.get(a)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:i.direction="inactive",this._remoteSdp.pauseMediaSection(a);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),n.e(e.t0);case 18:return e.prev=18,n.f(),e.finish(18);case 21:return o={type:"offer",sdp:this._remoteSdp.getSdp()},cb.debug("pauseReceiving() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=25,this._pc.setRemoteDescription(o);case 25:return e.next=27,this._pc.createAnswer();case 27:return s=e.sent,cb.debug("pauseReceiving() | calling pc.setLocalDescription() [answer:%o]",s),e.next=31,this._pc.setLocalDescription(s);case 31:case"end":return e.stop()}}),e,this,[[2,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeReceiving",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.assertRecvDirection(),n=(0,c.Z)(t),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=13;break}if(a=r.value,cb.debug("resumeReceiving() [localId:%s]",a),i=this._mapMidTransceiver.get(a)){e.next=10;break}throw new Error("associated RTCRtpTransceiver not found");case 10:i.direction="recvonly",this._remoteSdp.resumeReceivingMediaSection(a);case 11:e.next=4;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),n.e(e.t0);case 18:return e.prev=18,n.f(),e.finish(18);case 21:return o={type:"offer",sdp:this._remoteSdp.getSdp()},cb.debug("resumeReceiving() | calling pc.setRemoteDescription() [offer:%o]",o),e.next=25,this._pc.setRemoteDescription(o);case 25:return e.next=27,this._pc.createAnswer();case 27:return s=e.sent,cb.debug("resumeReceiving() | calling pc.setLocalDescription() [answer:%o]",s),e.next=31,this._pc.setLocalDescription(s);case 31:case"end":return e.stop()}}),e,this,[[2,15,18,21]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getReceiverStats",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.assertRecvDirection(),n=this._mapMidTransceiver.get(t)){e.next=4;break}throw new Error("associated RTCRtpTransceiver not found");case 4:return e.abrupt("return",n.receiver.getStats());case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"receiveDataChannel",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u,d,p,f,h,v;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sctpStreamParameters,r=t.label,a=t.protocol,this.assertRecvDirection(),o=n.streamId,s=n.ordered,c=n.maxPacketLifeTime,u=n.maxRetransmits,d={negotiated:!0,id:o,ordered:s,maxPacketLifeTime:c,maxRetransmits:u,protocol:a},cb.debug("receiveDataChannel() [options:%o]",d),p=this._pc.createDataChannel(r,d),this._hasDataChannelMediaSection){e.next=22;break}return this._remoteSdp.receiveSctpAssociation(),f={type:"offer",sdp:this._remoteSdp.getSdp()},cb.debug("receiveDataChannel() | calling pc.setRemoteDescription() [offer:%o]",f),e.next=11,this._pc.setRemoteDescription(f);case 11:return e.next=13,this._pc.createAnswer();case 13:if(h=e.sent,this._transportReady){e.next=18;break}return v=Si.Qc(h.sdp),e.next=18,this.setupTransport({localDtlsRole:null!==(i=this._forcedLocalDtlsRole)&&void 0!==i?i:"client",localSdpObject:v});case 18:return cb.debug("receiveDataChannel() | calling pc.setRemoteDescription() [answer:%o]",h),e.next=21,this._pc.setLocalDescription(h);case 21:this._hasDataChannelMediaSection=!0;case 22:return e.abrupt("return",{dataChannel:p});case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupTransport",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.localDtlsRole,(r=t.localSdpObject)||(r=Si.Qc(this._pc.localDescription.sdp)),(a=Ek({sdpObject:r})).role=n,this._remoteSdp.updateDtlsRole("client"===n?"server":"client"),e.next=7,new Promise((function(e,t){i.safeEmit("@connect",{dtlsParameters:a},e,t)}));case 7:this._transportReady=!0;case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"assertSendDirection",value:function(){if("send"!==this._direction)throw new Error('method can just be called for handlers with "send" direction')}},{key:"assertRecvDirection",value:function(){if("recv"!==this._direction)throw new Error('method can just be called for handlers with "recv" direction')}}],[{key:"createFactory",value:function(){return function(){return new n}}}]),n}(Rk),db=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.handlerName,a=e.handlerFactory,i=e.Handler;return(0,y.Z)(this,n),t.call(this,{handlerName:r,handlerFactory:a,Handler:i})}return(0,k.Z)(n,[{key:"switchDevice",value:function(e){switch(e){case"Chrome74":this._handlerFactory=Qk.createFactory();break;case"Chrome70":this._handlerFactory=$k.createFactory();break;case"Chrome67":this._handlerFactory=Bk.createFactory();break;case"Chrome55":this._handlerFactory=jk.createFactory();break;case"Firefox60":this._handlerFactory=ab.createFactory();break;case"Safari12":this._handlerFactory=lb.createFactory();break;case"Safari11":this._handlerFactory=sb.createFactory();break;case"Edge11":this._handlerFactory=tb.createFactory();break;default:throw new TypeError('unknown handlerName "'.concat(e,'"'))}}}]),n}(_k),pb=Object.defineProperty,fb=Object.getOwnPropertyDescriptor,hb=function(e,t,n,r){for(var a,i=r>1?void 0:r?fb(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&pb(t,n,i),i},vb=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;return(0,y.Z)(this,n),r=t.call(this),Ko((0,v.Z)(r),"device"),Ko((0,v.Z)(r),"sendTransport"),Ko((0,v.Z)(r),"recvTransport"),Ko((0,v.Z)(r),"sendTransportIceStateDisconnectTime"),Ko((0,v.Z)(r),"recvTransportIceStateDisconnectTime"),Ko((0,v.Z)(r),"producerCreationStatus"),Ko((0,v.Z)(r),"consumers"),Ko((0,v.Z)(r),"producers"),Ko((0,v.Z)(r),"socketClient"),Ko((0,v.Z)(r),"iceRestartInProgress"),r.producers=new Map,r.consumers=new Map,r.producerCreationStatus=new Map,r.iceRestartInProgress={sendTransport:!1,recvTransport:!1},r.device=new db,r.socketClient=e,r}return(0,k.Z)(n,[{key:"setupTransports",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vg().getICEServers();case 2:return t=e.sent,e.next=5,this.loadRouter();case 5:return e.next=7,Promise.all([this.createRecvTransport(t),this.createSendTransport(t)]);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadRouter",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.recvTransport||this.sendTransport,!e.t0){e.next=4;break}return e.next=4,this.stopAllTransports();case 4:return e.next=6,this.socketClient.sendMessage({type:"getRouterRtpCapabilities"});case 6:return t=e.sent,n=null==t?void 0:t.payload,e.abrupt("return",(this.device.loaded&&(this.device=new db),n&&(n.headerExtensions=n.headerExtensions.filter((function(e){return"urn:3gpp:video-orientation"!==e.uri}))),this.device.load({routerRtpCapabilities:n})));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getRTPCapabilities",value:function(){return this.device.rtpCapabilities}},{key:"createRecvTransport",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.socketClient){e.next=2;break}return e.abrupt("return");case 2:return n={forceTcp:!1,producing:!1,consuming:!0},e.next=5,this.socketClient.sendMessage({type:"createWebRtcTransport",payload:n});case 5:r=e.sent.payload,qp.info("recvTransport::initializing_transport"),this.recvTransport=this.device.createRecvTransport((0,s.Z)((0,s.Z)({},r),{},{iceServers:t,proprietaryConstraints:bf})),qp.info("recvTransport::initialized_transport"),Lc.onSafeInitialization((function(){Lc.configureRecvTransport(i.recvTransport)})),this.recvTransport.on("connect",function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n,r){var a,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.dtlsParameters,e.next=3,i.socketClient.sendMessage({type:"connectWebRtcTransport",payload:{transportId:i.recvTransport.id,dtlsParameters:a}});case 3:if(e.t1=o=e.sent.payload,e.t0=null!=e.t1,!e.t0){e.next=7;break}e.t0=o.error;case 7:if(!e.t0){e.next=11;break}qp.error("recvTransport::transport_status",{status:"failed"}),r(new Error("failed")),e.next=12;break;case 11:n(),qp.info("recvTransport::transport_status",{status:"connected"});case 12:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),Vc.hasFeature(Sp.ENABLE_ICE_STATE_LOGGING)&&(qp.info("enabling_ice_state_logging_for_recv_transport"),this.recvTransport.on("connectionstatechange",function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=(qp.info("recvTransport::connection_state_change",{state:t}),t),e.next="failed"===e.t0?3:"disconnected"===e.t0?13:"connected"===e.t0?17:19;break;case 3:if(vf.emit(ff.ICE_FAILED,{transport:"recv"}),qp.warn("recvTransport::ice_state_failed"),!Vc.hasFeature(Sp.ICE_RESTART_ON_FAILED_STATE)){e.next=12;break}return e.prev=4,e.next=7,i.restartIceTillSuccess(i.recvTransport);case 7:e.next=12;break;case 9:e.prev=9,e.t1=e.catch(4),qp.error("recvTransport::ice_restart_failed",{error:{name:e.t1.name,message:e.t1.message}});case 12:return e.abrupt("break",19);case 13:vf.emit(ff.ICE_DISCONNECTED,{transport:"recv"}),qp.warn("recvTransport::ice_state_disconnected"),i.recvTransportIceStateDisconnectTime&&qp.warn("recvTransport::ice_state_disconnected_again",{lastDisconnectedTime:i.recvTransportIceStateDisconnectTime.toLocaleTimeString(),durationPassed:(new Date).getTime()-i.recvTransportIceStateDisconnectTime.getTime()}),i.recvTransportIceStateDisconnectTime=new Date;try{"number"!=typeof(a=Vc.getValue(Sp.ICE_RESTART_ON_DISCONNECTED_STATE))&&(a=void 0)}catch(r){a=void 0}return a&&setTimeout((0,d.Z)((0,l.Z)().mark((function e(){var t,n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===i.recvTransportIceStateDisconnectTime){e.next=10;break}return vf.emit(ff.ICE_RECONNECTING,{transport:"recv"}),qp.info("recvTransport::attempting_ice_restart",{recvTransportIceStateDisconnectTime:null==(t=i.recvTransportIceStateDisconnectTime)?void 0:t.toISOString(),recvTransportIceStateDisconnectTimeOffset:null==(n=i.recvTransportIceStateDisconnectTime)?void 0:n.getTimezoneOffset(),iceRestartInProgress:i.iceRestartInProgress}),e.prev=2,e.next=5,i.restartIceTillSuccess(i.recvTransport);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),qp.info("SFUHandler.disconnected.restartIceFailed",{error:{name:e.t0.name,message:e.t0.message},direction:"recv"});case 10:case"end":return e.stop()}}),e,null,[[2,7]])}))),a),e.abrupt("break",19);case 17:return vf.emit(ff.ICE_CONNECTED,{transport:"recv"}),qp.info("recvTransport::ice_state_connected",{lastDisconnectionTime:null==(n=i.recvTransportIceStateDisconnectTime)?void 0:n.toLocaleTimeString(),durationPassed:i.recvTransportIceStateDisconnectTime?(new Date).getTime()-i.recvTransportIceStateDisconnectTime.getTime():null}),i.recvTransportIceStateDisconnectTime=void 0,e.abrupt("break",19);case 19:case"end":return e.stop()}}),e,null,[[4,9]])})));return function(t){return e.apply(this,arguments)}}())),this.recvTransport.observer.on("close",(function(){i.recvTransport=void 0,qp.warn("recvTransport_closed")}));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createSendTransport",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={forceTcp:!1,producing:!0,consuming:!1},e.next=3,this.socketClient.sendMessage({type:"createWebRtcTransport",payload:n});case 3:r=e.sent.payload,qp.info("sendTransport::initializing_transport"),this.sendTransport=this.device.createSendTransport((0,s.Z)((0,s.Z)({},r),{},{iceServers:t,proprietaryConstraints:bf})),qp.info("sendTransport::initialized_transport"),Lc.onSafeInitialization((function(){Lc.configureSendTransport(i.sendTransport)})),this.sendTransport.on("connect",function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n,r){var a,o,s;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.dtlsParameters,e.next=3,i.socketClient.sendMessage({type:"connectWebRtcTransport",payload:{transportId:null==(o=i.sendTransport)?void 0:o.id,dtlsParameters:a}});case 3:if(e.t1=s=e.sent.payload,e.t0=null!=e.t1,!e.t0){e.next=7;break}e.t0=s.error;case 7:if(!e.t0){e.next=11;break}qp.error("sendTransport::transport_status",{status:"failed"}),r(new Error("failed")),e.next=12;break;case 11:qp.info("sendTransport::transport_status",{status:"connected"}),n();case 12:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),this.sendTransport.on("produce",function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n,r){var a,o,s,c,u,d,p,f;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.kind,o=t.rtpParameters,s=t.appData,e.next=3,i.socketClient.sendMessage({type:"produce",payload:{transportId:null==(c=i.sendTransport)?void 0:c.id,kind:a,rtpParameters:o,appData:s}});case 3:f=e.sent,null!=(u=f.payload)&&u.error?(qp.info("sendTransport::producer_status",{kind:a,appData:{screenShare:null==s?void 0:s.screenShare,supportsRemoteControl:null==s?void 0:s.supportsRemoteControl},status:"failed"}),r(null==(p=f.payload)?void 0:p.error)):(qp.info("sendTransport::producer_status",{kind:a,appData:{screenShare:null==s?void 0:s.screenShare,supportsRemoteControl:null==s?void 0:s.supportsRemoteControl},status:"producing"}),n({id:null==(d=f.payload)?void 0:d.id}));case 5:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),Vc.hasFeature(Sp.ENABLE_ICE_STATE_LOGGING)&&(qp.info("enabling_ice_state_logging_for_send_transport"),this.sendTransport.on("connectionstatechange",function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=(qp.info("sendTransport::connection_state_change",{state:t}),t),e.next="failed"===e.t0?3:"disconnected"===e.t0?13:"connected"===e.t0?17:19;break;case 3:if(vf.emit(ff.ICE_FAILED,{transport:"send"}),qp.warn("sendTransport::ice_state_failed"),!Vc.hasFeature(Sp.ICE_RESTART_ON_FAILED_STATE)){e.next=12;break}return e.prev=4,e.next=7,i.restartIceTillSuccess(i.sendTransport);case 7:e.next=12;break;case 9:e.prev=9,e.t1=e.catch(4),qp.error("sendTransport::ice_restart_failed",{error:{name:e.t1.name,message:e.t1.message}});case 12:return e.abrupt("break",19);case 13:vf.emit(ff.ICE_DISCONNECTED,{transport:"send"}),qp.warn("sendTransport::ice_state_disconnected"),i.sendTransportIceStateDisconnectTime&&qp.warn("sendTransport::ice_state_disconnected_again",{lastDisconnectedTime:i.sendTransportIceStateDisconnectTime.toLocaleTimeString(),durationPassed:(new Date).getTime()-i.sendTransportIceStateDisconnectTime.getTime()}),i.sendTransportIceStateDisconnectTime=new Date;try{"number"!=typeof(a=Vc.getValue(Sp.ICE_RESTART_ON_DISCONNECTED_STATE))&&(a=void 0)}catch(r){a=void 0}return a&&setTimeout((0,d.Z)((0,l.Z)().mark((function e(){var t,n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===i.sendTransportIceStateDisconnectTime){e.next=10;break}return vf.emit(ff.ICE_RECONNECTING,{transport:"send"}),qp.info("sendTransport::attempting_ice_restart",{sendTransportIceStateDisconnectTime:null==(t=i.sendTransportIceStateDisconnectTime)?void 0:t.toISOString(),sendTransportIceStateDisconnectTimeoffset:null==(n=i.sendTransportIceStateDisconnectTime)?void 0:n.getTimezoneOffset(),iceRestartInProgress:i.iceRestartInProgress}),e.prev=2,e.next=5,i.restartIceTillSuccess(i.sendTransport);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),qp.info("SFUHandler.disconnected.restartIceFailed",{error:{name:e.t0.name,message:e.t0.message},direction:"send"});case 10:case"end":return e.stop()}}),e,null,[[2,7]])}))),a),e.abrupt("break",19);case 17:return vf.emit(ff.ICE_CONNECTED,{transport:"send"}),qp.info("sendTransport::ice_state_connected",{lastDisconnectionTime:null==(n=i.sendTransportIceStateDisconnectTime)?void 0:n.toLocaleTimeString(),durationPassed:i.sendTransportIceStateDisconnectTime?(new Date).getTime()-i.sendTransportIceStateDisconnectTime.getTime():null}),i.sendTransportIceStateDisconnectTime=void 0,e.abrupt("break",19);case 19:case"end":return e.stop()}}),e,null,[[4,9]])})));return function(t){return e.apply(this,arguments)}}())),this.sendTransport.observer.on("close",(function(){i.sendTransport=void 0,qp.warn("sendTransport_closed")}));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"restartIce",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("recv"===(n=t.direction)?this.iceRestartInProgress.recvTransport:this.iceRestartInProgress.sendTransport){e.next=15;break}return"recv"===n?this.iceRestartInProgress.recvTransport=!0:this.iceRestartInProgress.sendTransport=!0,e.prev=3,e.next=6,this.socketClient.sendMessage({type:"restartIce",payload:{transportId:t.id}});case 6:return r=e.sent.payload,e.next=9,t.restartIce(r);case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),qp.error("SFUHandler.restartIce.Failed",{error:{name:e.t0.name,message:e.t0.message},transportId:t.id});case 14:"recv"===n?this.iceRestartInProgress.recvTransport=!1:this.iceRestartInProgress.sendTransport=!1;case 15:case"end":return e.stop()}}),e,this,[[3,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"createConsumer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,c,u,d,p;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.recvTransport&&!this.recvTransport.closed){e.next=2;break}return e.abrupt("return");case 2:return n=t.peerId,r=t.producerId,a=t.id,i=t.kind,o=t.rtpParameters,c=t.appData,u=t.remotelyPaused,qp.info("createConsumer::initializing_consumer",{peerId:n,kind:i,appData:c,remotelyPaused:u}),e.next=6,this.recvTransport.consume({id:a,producerId:r,kind:i,rtpParameters:o,appData:(0,s.Z)((0,s.Z)({},c),{},{peerId:n})});case 6:d=e.sent,qp.info("createConsumer::initialized_consumer",{peerId:n,kind:i,appData:c,remotelyPaused:u}),(p=d).peerId=n,p.remotelyPaused=u,p.score=10,this.consumers.set(d.id,p);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"closeConsumer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.id,(r=this.consumers.get(n))&&(qp.info("SFUHandler::close_consumer",{peerId:r.peerId,kind:r.kind,appData:r.appData}),r.close(),this.consumers.delete(n));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"cleanupConsumers",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null==(t=this.consumers)||t.forEach((function(e){vf.emit(ff.CONSUMER_CLOSED,{id:e.id}),n.closeConsumer({id:e.id})}));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pauseConsumer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.id,(r=this.consumers.get(n))&&r.pause();case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resumeConsumer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.id,(r=this.consumers.get(n))&&r.resume();case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createProducer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n,r){var a,i,o=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.sendTransport&&!this.sendTransport.closed){e.next=2;break}return e.abrupt("return");case 2:if(qp.info("createProducer::initializing_producer",{producerType:t}),!this.producerCreationStatus.get(t)||"INITIALIZING"!==this.producerCreationStatus.get(t)){e.next=5;break}return qp.info("createProducer::producer_initializing",{producerType:t}),e.abrupt("return");case 5:return this.producerCreationStatus.set(t,"INITIALIZING"),e.next=8,Promise.race([this.sendTransport.produce(n),new Promise((function(e){return setTimeout((function(){return e(void 0)}),6e3)}))]);case 8:if(a=e.sent){e.next=11;break}throw qp.error("createProducer::transport_initialization_timed_out",{producerType:t}),this.producerCreationStatus.set(t,"NOT_INITIALIZED"),new Jp("Producer Creation timed out! ".concat(t));case 11:return this.producerCreationStatus.set(t,"INITIALIZED"),qp.info("createProducer::initialized_producer",{producerType:t}),a.on("transportclose",(function(){qp.info("producer::transportclose",{producerType:t}),o.producerCreationStatus.set(t,"NOT_INITIALIZED"),o.producers.delete(t)})),a.on("trackended",(function(){qp.info("producer::trackended",{producerType:t}),[xf.MIC,xf.WEBCAM].includes(t)||r()})),(i=a).score=10,this.producers.set(t,i),e.next=17,this.reconfigureWebcamLayers();case 17:return e.next=19,this.reconfigureSafariScreenshareLayers();case 19:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"removeProducer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!(a.length>1&&void 0!==a[1])||a[1],r=this.producers.get(t),e.t0=!r||r.closed,e.t0){e.next=13;break}return qp.info("SFUHandler::remove_producer",{producerType:t,stopTrack:n}),n&&r.track.stop(),r.close(),e.next=9,this.socketClient.sendMessage({type:"closeProducer",payload:{producerId:r.id}});case 9:return this.producerCreationStatus.set(t,"NOT_INITIALIZED"),this.producers.delete(t),e.next=13,this.reconfigureWebcamLayers();case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"stopAllProducers",value:function(){var e=this;Array.from(this.producers.keys()).forEach((function(t){e.removeProducer(t)}))}},{key:"stopAllTransports",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.sendTransport){try{this.sendTransport.close()}catch(t){qp.error("stopAllTransports",t)}this.sendTransport=void 0}if(this.recvTransport){try{this.recvTransport.close()}catch(t){qp.error("SFUHandler::stopAllTransports::error",t)}this.recvTransport=void 0}case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reconfigureWebcamLayers",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Vc.hasFeature(Sp.DISABLE_WEBCAM_LAYERS_ON_SCREENSHARE)){e.next=2;break}return e.abrupt("return");case 2:if(t=this.producers.get(xf.WEBCAM),e.t0=t,!e.t0){e.next=7;break}return e.next=7,t.setMaxSpatialLayer(this.producers.get(xf.SCREENSHARE_VIDEO)?0:1);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reconfigureSafariScreenshareLayers",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Vc.hasFeature(Sp.SCREENSHARE_SIMULCAST)&&zp.isSafari()){e.next=2;break}return e.abrupt("return");case 2:if(t=this.producers.get(xf.SCREENSHARE_VIDEO)){e.next=5;break}return e.abrupt("return");case 5:(n=t.rtpSender.getParameters()).encodings=Sf,t.rtpSender.setParameters(n);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"restartIceTillSuccess",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=i.length>1&&void 0!==i[1]?i[1]:3,r=!1,a=0;case 2:if(r||!(a<n)){e.next=15;break}return e.prev=3,qp.info("SFUHandler.restartIceTillSuccess.AttemptRestart",{currentAttempt:a,direction:t.direction}),e.next=7,this.restartIce(t);case 7:r=!0,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),a+=1;case 13:e.next=2;break;case 15:if(r){e.next=17;break}throw new Jp("Failed to restart Ice");case 17:case"end":return e.stop()}}),e,this,[[3,10]])})));return function(t){return e.apply(this,arguments)}}()}]),n}(is);hb([Gp.trace("SFUHandler.setupTransports")],vb.prototype,"setupTransports",1),hb([Gp.trace("SFUHandler.loadRouter")],vb.prototype,"loadRouter",1),hb([Gp.trace("SFUHandler.createRecvTransport")],vb.prototype,"createRecvTransport",1),hb([Gp.trace("SFUHandler.createSendTransport")],vb.prototype,"createSendTransport",1),hb([Gp.trace("SFUHandler.restartIce")],vb.prototype,"restartIce",1),hb([Gp.trace("SFUHandler.createConsumer")],vb.prototype,"createConsumer",1),hb([Gp.trace("SFUHandler.closeConsumer")],vb.prototype,"closeConsumer",1),hb([Gp.trace("SFUHandler.cleanupConsumers")],vb.prototype,"cleanupConsumers",1),hb([Gp.trace("SFUHandler.pauseConsumer")],vb.prototype,"pauseConsumer",1),hb([Gp.trace("SFUHandler.resumeConsumer")],vb.prototype,"resumeConsumer",1),hb([Gp.trace("SFUHandler.createProducer")],vb.prototype,"createProducer",1),hb([Gp.trace("SFUHandler.removeProducer")],vb.prototype,"removeProducer",1),hb([Gp.trace("SFUHandler.stopAllProducers")],vb.prototype,"stopAllProducers",1),hb([Gp.trace("SFUHandler.stopAllTransports")],vb.prototype,"stopAllTransports",1);var mb=Object.defineProperty,gb=Object.getOwnPropertyDescriptor,yb=function(e){return e.REQUEST="REQUEST",e.ACCEPT="ACCEPT",e.REJECT="REJECT",e.END="END",e.EVENT="EVENT",e}(yb||{}),kb=function(e){return e.PENDING="PENDING",e.ACCEPTED="ACCEPTED",e.REJECTED="REJECTED",e.ENDED="ENDED",e}(kb||{}),bb=function(e){return e.KEYBOARD="KEYBOARD",e.MOUSE="MOUSE",e}(bb||{}),wb=function(e){return e.LEFT_CLICK="click",e.RIGHT_CLICK="contextmenu",e.MOVE="mousemove",e}(wb||{}),_b=function(e){return e.REQUEST_RECEIVED="REQUEST_RECEIVED",e.REQUEST_SENT="REQUEST_SENT",e.INCOMING_REQUEST_ACCEPTED="INCOMING_REQUEST_ACCEPTED",e.OUTGOING_REQUEST_ACCEPTED="OUTGOING_REQUEST_ACCEPTED",e.INCOMING_REQUEST_ENDED="INCOMING_REQUEST_ENDED",e.OUTGOING_REQUEST_ENDED="OUTGOING_REQUEST_ENDED",e}(_b||{}),Sb=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;(0,y.Z)(this,n),r=t.call(this),Ko((0,v.Z)(r),"id"),Ko((0,v.Z)(r),"remotePeerId"),Ko((0,v.Z)(r),"hostPeerId"),Ko((0,v.Z)(r),"state");var a=e.remotePeerId,i=e.requestId,o=e.hostPeerId,s=e.state;return r.id=i,r.remotePeerId=a,r.hostPeerId=o,r.state=s,r}return(0,k.Z)(n)}(yp);Sb=function(e,t,n,r){for(var a,i=r>1?void 0:r?gb(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&mb(t,n,i),i}([Yp((function(e){throw new Jp(e.message,"1400")}))],Sb);var Eb,Tb,xb,Zb,Cb=Object.defineProperty,Rb=Object.getOwnPropertyDescriptor,Pb=function(e,t,n,r){for(var a,i=r>1?void 0:r?Rb(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Cb(t,n,i),i},Ib=(xb=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;(0,y.Z)(this,n),r=t.call(this),Xo((0,v.Z)(r),Eb,void 0),Ko((0,v.Z)(r),"isV2AuthToken"),Xo((0,v.Z)(r),Tb,void 0),Ko((0,v.Z)(r),"legacyMode"),Ko((0,v.Z)(r),"roomNodeUrl"),Ko((0,v.Z)(r),"peerDisplayName");var a=e.roomName,i=e.roomNodeUrl,o=e.peerId,s=e.authToken,c=e.legacyMode,u=e.socketClient,l=e.meetingTitle;return r.roomName=a,r.roomNodeUrl=i,r.peerId=o,r.authToken=s,r.legacyMode=c,Yo((0,v.Z)(r),Eb,u),r.roomJoined=!1,r.meetingTitle=l,r.isV2AuthToken=av.isV2AuthToken,Yo((0,v.Z)(r),Tb,new vb(u)),Lc.legacySwitch(c),r}return(0,k.Z)(n,[{key:"sfuHandler",get:function(){return Qo(this,Tb)}},{key:"reconnect",value:function(){Qo(this,Eb).reconnect()}},{key:"setupTransports",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sfuHandler.setupTransports();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleSocketCallbacks",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.type,e.next=e.t0===ff.NEW_CONSUMER?3:4;break;case 3:return e.abrupt("return",this.sfuHandler.createConsumer(t.payload));case 4:return e.abrupt("return",null);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleSockets",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=17;break}e.t0=((!Gp.logExclusionList.includes(null==t?void 0:t.type)||Vc.hasFeature(Sp.BYPASS_LOG_EXCLUSION_LIST))&&qp.info("RoomNodeClient::handleSockets::".concat(null==t?void 0:t.type),{type:null==t?void 0:t.type}),t.type),e.next=e.t0===ff.CONSUMER_CLOSED?4:e.t0===ff.CONSUMER_PAUSED?6:e.t0===ff.CONSUMER_RESUMED?8:e.t0===ff.CONSUMER_SCORE?10:e.t0===ff.PRODUCER_SCORE?12:e.t0===ff.PRODUCER_CLOSED?14:16;break;case 4:return this.sfuHandler.closeConsumer(t.payload),e.abrupt("break",16);case 6:return this.sfuHandler.pauseConsumer(t.payload),e.abrupt("break",16);case 8:return this.sfuHandler.resumeConsumer(t.payload),e.abrupt("break",16);case 10:return this.handleConsumerScore(t.payload),e.abrupt("break",16);case 12:return this.handleProducerScore(t.payload),e.abrupt("break",16);case 14:return this.handleProducerClosed(t.payload),e.abrupt("break",16);case 16:"function"==typeof n&&n();case 17:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"joinRoom",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n,r,a){var i,o,c,u,p,f,h=this,v=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=v.length>4&&void 0!==v[4]?v[4]:{},this.peerDisplayName=t,this.roomUUID=r,e.next=4,Qo(this,Eb).sendMessage({type:"joinRoom",payload:{device:zp.getDeviceInfo(),displayName:t,rtpCapabilities:this.sfuHandler.getRTPCapabilities(),isLegacy:this.legacyMode,audioMuted:n}});case 4:if(p=e.sent,null==(o=p.payload)||!o.waitlisted){e.next=7;break}return e.abrupt("return",(vf.emit(ff.WAITLISTED),{roomJoined:!1}));case 7:if(null==(u=null==(c=p.payload)?void 0:c.waitlistedPeers)||u.forEach((function(e){vf.emit(ff.WAITLIST_PEER_ADDED,e)})),this.legacyMode=p.payload.legacyMode||this.legacyMode,e.t0=a&&""!==a,!e.t0){e.next=13;break}return e.next=13,this.changeRoomDisplayTitle(a);case 13:return this.maxPreferredStreams=p.payload.maxPreferredStreams,this.roomJoined=!0,f=vg(),qp.info("RoomNodeClient::joinRoom::pre_emitasync_room_joined"),e.prev=17,e.next=20,vf.emitAsync(ff.ROOM_JOINED,p.payload);case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(17),qp.error("RoomNodeClient::joinRoom::emitAsync",{error:{name:e.t1.name,message:e.t1.message}});case 25:return e.abrupt("return",(qp.info("RoomNodeClient::joinRoom::post_emitasync_room_joined"),vf.emit(ff.SELF_ROOM_JOINED),Vc.hasFeature(Sp.INTERNAL_CALL_STATS)&&"ReactNative"!==navigator.product&&setTimeout((0,d.Z)((0,l.Z)().mark((function e(){var n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.getUserDetails();case 2:n=e.sent,r={userId:av.isV2AuthToken?n.participant.id:n.id,peerId:h.peerId,displayName:t,roomUUID:h.roomUUID,roomViewType:"groupCall",roomName:h.roomName,deviceInfo:(0,s.Z)((0,s.Z)({},zp.getDeviceInfo()),{},{userAgent:navigator.userAgent,memory:navigator.deviceMemory,cpus:navigator.hardwareConcurrency}),metaData:{},permissions:{}},Lc.roomJoined(r),null!=i&&i.audio?Lc.audioOn():Lc.audioOff(),null!=i&&i.video?Lc.videoOn():Lc.videoOff();case 5:case"end":return e.stop()}}),e)})))),{roomJoined:!0}));case 26:case"end":return e.stop()}}),e,this,[[17,22]])})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"leaveRoom",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.sfuHandler.stopAllProducers(),e.next=3,this.sfuHandler.stopAllTransports();case 3:Qo(this,Eb).disconnect(),Lc.callEnded(),Gp.destruct();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleProducerClosed",value:function(e){var t=this,n=e.id;this.sfuHandler.producers.forEach((function(e,r){e.id===n&&t.sfuHandler.removeProducer(r)}))}},{key:"getConsumers",value:function(){return this.sfuHandler.consumers}},{key:"handleConsumerScore",value:function(e){var t=e.id,n=e.score,r=Qo(this,Tb).consumers.get(t);r&&(r.score=Ib.getComputedScore(n),vf.emit(ff.CONSUMER_SCORE_UPDATE,{id:r.id,kind:r.kind,peerId:r.peerId,score:r.score}))}},{key:"handleProducerScore",value:function(e){var t=e.id,n=e.score,r=(0,o.Z)(Qo(this,Tb).producers.values()).find((function(e){return e.id===t}));if(r){if(r){var a=Ib.getComputedScore(n);void 0!==a&&a!==r.score&&(r.score=a,vf.emit(ff.PRODUCER_SCORE_UPDATE,{id:r.id,kind:r.kind,appData:r.appData,score:r.score}))}}else qp.error("RoomNodeClient::producer_not_found",{id:t})}},{key:"shareWebcam",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u,d=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}return e.abrupt("return");case 2:if(!this.sfuHandler.producers.has(xf.WEBCAM)){e.next=12;break}if((n=this.sfuHandler.producers.get(xf.WEBCAM)).closed){e.next=10;break}return e.next=7,n.replaceTrack({track:t});case 7:return e.next=9,this.resumeWebcam();case 9:return e.abrupt("return");case 10:return e.next=12,this.sfuHandler.removeProducer(xf.WEBCAM,!1);case 12:if(r=wf,a=this.sfuHandler.getRTPCapabilities().codecs.find((function(e){return"video/vp9"===e.mimeType.toLowerCase()}))||void 0,i=this.sfuHandler.getRTPCapabilities().codecs.find((function(e){return"video/vp8"===e.mimeType.toLowerCase()}))||void 0,o=Vc.getValue(Sp.OVERRIDE_WEBCAM_SIMULCAST),a&&!this.legacyMode)r=Tf;else if(void 0!==o)try{r=JSON.parse(o)}catch(n){qp.error("Failed to parse flagsmith simulcast")}return s=function(){return d.legacyMode?i:a},c={track:t,encodings:Vc.hasFeature(Sp.DISABLE_WEBCAM_SIMULCAST)?void 0:r,codecOptions:{videoGoogleStartBitrate:1e3},codec:s(),appData:{screenShare:!1},stopTracks:!1},u=function(){d.disableWebcam()},e.next=18,this.sfuHandler.createProducer(xf.WEBCAM,c,u);case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"shareScreen",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u,d,p=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.video,i=t.audio,void 0!==a){e.next=3;break}return e.abrupt("return");case 3:return Vc.hasFeature(Sp.SCREENSHARE_SIMULCAST)&&(o=_f),s={track:a,appData:{screenShare:!0,supportsRemoteControl:zp.isElectron()},encodings:o,stopTracks:!1},c=function(){p.disableScreenShare()},Lc.screenShareRequested(),e.next=9,this.sfuHandler.createProducer(xf.SCREENSHARE_VIDEO,s,c);case 9:if(u={opusDtx:!1,opusStereo:!1,opusFec:!0,forceGoogConference:!1},Vc.hasFeature(Sp.SCREENSHARE_FORCE_GOOG_CONFERENCE)&&(u.forceGoogConference=!0),!i){e.next=15;break}return d={track:i,codecOptions:u,appData:{screenShare:!0,supportsRemoteControl:zp.isElectron()},stopTracks:!1},c=function(){},e.next=15,this.sfuHandler.createProducer(xf.SCREENSHARE_AUDIO,d,c);case 15:Lc.screenShareStart(null==(r=null==(n=this.sfuHandler.producers.get(xf.SCREENSHARE_VIDEO))?void 0:n.rtpParameters.encodings[0])?void 0:r.ssrc);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"shareMic",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==t){e.next=2;break}return e.abrupt("return");case 2:if(!this.sfuHandler.producers.has(xf.MIC)){e.next=12;break}if((n=this.sfuHandler.producers.get(xf.MIC)).closed){e.next=10;break}return e.next=7,n.replaceTrack({track:t});case 7:return e.next=9,this.resumeMic();case 9:return e.abrupt("return");case 10:return e.next=12,this.sfuHandler.removeProducer(xf.MIC,!1);case 12:return r={track:t,codecOptions:{opusDtx:!1,opusStereo:!1,opusFec:!0,opusMaxAverageBitrate:16e3},stopTracks:!1},a=function(){i.disableMic()},e.next=15,this.sfuHandler.createProducer(xf.MIC,r,a);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pauseMic",value:function(){var e=this.sfuHandler.producers.get(xf.MIC);e?(e.pause(),Qo(this,Eb).sendMessage({type:"pauseProducer",payload:{producerId:e.id}})):qp.error("pauseMic::could_not_find_mic_producer")}},{key:"pauseWebcam",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.sfuHandler.producers.get(xf.WEBCAM)){e.next=4;break}return qp.error("pauseWebcam::could_not_find_webcam_producer"),e.abrupt("return");case 4:return t.pause(),e.next=7,Qo(this,Eb).sendMessage({type:"pauseProducer",payload:{producerId:t.id}});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resumeMic",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.sfuHandler.producers.get(xf.MIC)){e.next=4;break}return qp.error("resumeMic::could_not_find_mic_producer"),e.abrupt("return");case 4:return t.resume(),e.next=7,Qo(this,Eb).sendMessage({type:"resumeProducer",payload:{producerId:t.id}});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resumeWebcam",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.sfuHandler.producers.get(xf.WEBCAM)){e.next=4;break}return qp.error("resumeWebcam::could_not_find_webcam_producer"),e.abrupt("return");case 4:return t.resume(),e.next=7,Qo(this,Eb).sendMessage({type:"resumeProducer",payload:{producerId:t.id}});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"disableWebcam",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sfuHandler.removeProducer(xf.WEBCAM);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"disableMic",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sfuHandler.removeProducer(xf.MIC);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"disableScreenShare",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return qp.info("screen_sharing_stopped"),Lc.screenShareStop(null==(n=null==(t=this.sfuHandler.producers.get(xf.SCREENSHARE_VIDEO))?void 0:t.rtpParameters.encodings[0])?void 0:n.ssrc),e.next=4,this.sfuHandler.removeProducer(xf.SCREENSHARE_VIDEO);case 4:return e.next=6,this.sfuHandler.removeProducer(xf.SCREENSHARE_AUDIO);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resetVideoProducers",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t,!e.t0){e.next=5;break}return e.next=4,this.sfuHandler.removeProducer(xf.WEBCAM,!1);case 4:this.shareWebcam(t);case 5:if(e.t1=n,!e.t1){e.next=10;break}return e.next=9,this.sfuHandler.removeProducer(xf.SCREENSHARE_VIDEO,!1);case 9:this.shareScreen({video:n});case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getRoomState",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Qo(this,Eb).sendMessage({type:"getRoomState"}));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"changeRoomDisplayTitle",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,Eb).sendMessage({type:"changeDisplayTitle",payload:{displayTitle:t}});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendMessage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Qo(this,Eb).sendMessage(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"broadcastMessage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={payload:n,type:t},e.abrupt("return",Qo(this,Eb).sendMessage({type:"roomMessage",payload:r}));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"sendChatMessage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,Eb).sendMessage({type:"chatMessage",payload:t});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getChatMessages",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Qo(this,Eb).sendMessage({type:"getChatMessages"}));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pinChatMessage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Qo(this,Eb).sendMessage({type:"pinChatMessage",payload:t}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"unpinChatMessage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Qo(this,Eb).sendMessage({type:"unpinChatMessage",payload:t}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPolls",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Qo(this,Eb).sendMessage({type:"getPolls"}));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"newPoll",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,Eb).sendMessage({type:"newPoll",payload:t});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"votePoll",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,Eb).sendMessage({type:"votePoll",payload:t});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"acceptWaitingRequest",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,Eb).sendMessage({type:"acceptWaitingRequest",payload:{id:t}});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"rejectWaitingRequest",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,Eb).sendMessage({type:"rejectWaitingRequest",payload:{id:t}});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"muteAll",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,Eb).sendMessage({type:"muteAllNew",payload:{allowUnMute:t}});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"muteAllVideo",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,Eb).sendMessage({type:"muteAllVideo"});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"pinPeer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Qo(this,Eb).sendMessage({type:"pinPeer",payload:{id:t}}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"unpinPeer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Qo(this,Eb).sendMessage({type:"unpinPeer",payload:{id:t}}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"disableAudio",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,Eb).sendMessage({type:"disableAudioPeerNew",payload:{id:t}});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"disableVideo",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,Eb).sendMessage({type:"disableVideoPeer",payload:{id:t}});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"kickAll",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,Eb).sendMessage({type:"kickAll"});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"kick",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,Eb).sendMessage({type:"kick",payload:{id:t}});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Qo(this,Eb).sendMessage({type:"getPage",payload:{pageNum:t}}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"muteSelf",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.pauseMic(),e.next=3,Qo(this,Eb).sendMessage({type:"muteSelf"});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"unmuteSelf",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resumeMic();case 2:return e.next=4,Qo(this,Eb).sendMessage({type:"unmuteSelf"});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addRoomPlugin",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Qo(this,Eb).sendMessage({type:"addPlugin",payload:t}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"removeRoomPlugin",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Qo(this,Eb).sendMessage({type:"removePlugin",payload:t}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"remoteControlMessage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Qo(this,Eb).sendMessage({type:"message",payload:t}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"requestRemoteControl",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.remoteControlMessage({peerId:t.hostPeerId,remoteRequestId:t.id,hostPeerId:t.hostPeerId,remotePeerId:t.remotePeerId,remoteRequestType:yb.REQUEST}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"acceptRemoteControl",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.remoteControlMessage({peerId:t.remotePeerId,remoteRequestId:t.id,hostPeerId:t.hostPeerId,remotePeerId:t.remotePeerId,remoteRequestType:yb.ACCEPT}));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"terminateRemoteControl",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.remoteControlMessage({peerId:t,remoteRequestId:n.id,hostPeerId:n.hostPeerId,remotePeerId:n.remotePeerId,remoteRequestType:yb.END}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"sendEventRemoteControl",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n,r){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.remoteControlMessage({peerId:t,remoteRequestId:n,remoteEvent:r,hostPeerId:this.peerId,remotePeerId:t,remoteRequestType:yb.EVENT}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"assertSpotlight",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Qo(this,Eb).sendMessage({type:t,payload:(0,s.Z)((0,s.Z)({},n),{},{roomMessageType:"spotlight"})}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"assertSpotlightToRoom",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.assertSpotlight("roomMessage",t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"assertSpotlightToPeer",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.assertSpotlight("message",t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"requestToJoinStage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendMessage({type:"requestToJoinStage",payload:t});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"acceptAllRequestToJoinStage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendMessage({type:"acceptAllRequestToJoinStage",payload:t.map((function(e){return(0,s.Z)((0,s.Z)({},e),{},{type:pv.REQUESTED_BY_MODERATOR})}))});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"removePeerFromStage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendMessage({type:"removePeerFromStage",payload:{id:t,type:n}});case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"stopAllProducers",value:function(){Qo(this,Tb).stopAllProducers()}},{key:"startPresenting",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendMessage({type:"startPresenting"});case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stopPresenting",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.stopAllProducers(),e.next=3,this.sendMessage({type:"stopPresenting"});case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"rejectRequestToJoinStage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendMessage({type:"rejectRequestToJoinStage",payload:{id:t}});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"init",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u,p;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.legacyMode,r=void 0===n||n,a=t.roomName,i=t.peerId,o=t.authToken,s=t.meetingTitle,u="".concat(t.roomNodeUrl,"?roomURL=").concat(a,"&peerId=").concat(i,"&authToken=").concat(o,"&version=0.5.0"),p=new dy({callbackHandler:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.handleSocketCallbacks(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),e.abrupt("return",(p.on(oy.SOCKET_MESSAGE,function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.handleSockets(t,n);case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),p.connect(u),c=new Ib({legacyMode:r,authToken:o,peerId:i,roomName:a,roomNodeUrl:u,socketClient:p,meetingTitle:s}),p.on(oy.SOCKET_DISCONNECTED,(function(e){var t;c.isDisconnected=!0,null==(t=c.sfuHandler)||t.cleanupConsumers(),vf.emit(ff.ROOM_NODE_DISCONNECTED,e),c.roomJoined=!1,qp.info("ROOM_NODE_DISCONNECTED")})),p.on(oy.SOCKET_CONNECTED,function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:vf.emit(ff.ROOM_NODE_CONNECTED,t),c.isDisconnected,c.isDisconnected=!1,qp.info("ROOM_NODE_CONNECTED");case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),p.on(oy.SOCKET_CONNECTION_ERROR,function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.err,c.isDisconnected=!0,null==(r=c.sfuHandler)||r.cleanupConsumers(),vf.emit(ff.ROOM_NODE_CONNECTION_ERROR,n),c.roomJoined=!1;case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),c));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getComputedScore",value:function(e){var t,n,r=0;try{r=Array.isArray(e)?1===e.length?e[0].score:e.map((function(e){var t=e.score;return null!=t?t:10})).filter((function(e){return e>0})).reduce((function(e,t){return e+t}),0)/e.length:null!=(t=null==e?void 0:e.score)?t:10}catch(a){r=null!=(n=null==e?void 0:e.score)?n:10}return r}}]),n}(_g),Eb=new WeakMap,Tb=new WeakMap,xb),Ob=Ib;function Db(e){return Mb.apply(this,arguments)}function Mb(){return Mb=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Zb){e.next=2;break}throw new Error("Room Node Client already setup");case 2:return e.next=4,ry.init(t);case 4:Zb=e.sent;case 5:case"end":return e.stop()}}),e)}))),Mb.apply(this,arguments)}function Ab(e){return Nb.apply(this,arguments)}function Nb(){return Nb=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Zb){e.next=2;break}throw new Error("Room Node Client already setup");case 2:return e.next=4,Ob.init(t);case 4:Zb=e.sent;case 5:case"end":return e.stop()}}),e)}))),Nb.apply(this,arguments)}function Lb(){return Zb}Pb([Gp.trace("RoomNodeClient.reconnect")],Ob.prototype,"reconnect",1),Pb([Gp.trace("RoomNodeClient.joinRoom")],Ob.prototype,"joinRoom",1),Pb([Gp.trace("RoomNodeClient.leaveRoom")],Ob.prototype,"leaveRoom",1),Pb([Gp.trace("RoomNodeClient.shareWebcam")],Ob.prototype,"shareWebcam",1),Pb([Gp.trace("RoomNodeClient.shareScreen")],Ob.prototype,"shareScreen",1),Pb([Gp.trace("RoomNodeClient.shareMic")],Ob.prototype,"shareMic",1),Pb([Gp.trace("RoomNodeClient.pauseMic")],Ob.prototype,"pauseMic",1),Pb([Gp.trace("RoomNodeClient.pauseWebcam")],Ob.prototype,"pauseWebcam",1),Pb([Gp.trace("RoomNodeClient.resumeMic")],Ob.prototype,"resumeMic",1),Pb([Gp.trace("RoomNodeClient.resumeWebcam")],Ob.prototype,"resumeWebcam",1),Pb([Gp.trace("RoomNodeClient.disableWebcam")],Ob.prototype,"disableWebcam",1),Pb([Gp.trace("RoomNodeClient.disableMic")],Ob.prototype,"disableMic",1),Pb([Gp.trace("RoomNodeClient.disableScreenShare")],Ob.prototype,"disableScreenShare",1),Pb([Gp.trace("RoomNodeClient.resetVideoProducers")],Ob.prototype,"resetVideoProducers",1);var jb,Fb,Ub,Bb,Vb,Hb,zb,Wb,Gb=Object.defineProperty,qb=Object.getOwnPropertyDescriptor,$b=function(e,t,n,r){for(var a,i=r>1?void 0:r?qb(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Gb(t,n,i),i},Kb=function(e){return e.OFF_STAGE="OFF_STAGE",e.REQUESTED_TO_JOIN_STAGE="REQUESTED_TO_JOIN_STAGE",e.ACCEPTED_TO_JOIN_STAGE="ACCEPTED_TO_JOIN_STAGE",e.ON_STAGE="ON_STAGE",e}(Kb||{}),Jb=(Wb=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e,r,a,i,o,s){var c;return(0,y.Z)(this,n),c=t.call(this),Xo((0,v.Z)(c),Hb),Ko((0,v.Z)(c),"id"),Ko((0,v.Z)(c),"name"),Ko((0,v.Z)(c),"picture"),Ko((0,v.Z)(c),"clientSpecificId"),Ko((0,v.Z)(c),"waitlistStatus"),Xo((0,v.Z)(c),jb,void 0),Xo((0,v.Z)(c),Fb,void 0),Xo((0,v.Z)(c),Ub,void 0),Xo((0,v.Z)(c),Bb,void 0),Xo((0,v.Z)(c),Vb,void 0),Ko((0,v.Z)(c),"role"),Ko((0,v.Z)(c),"userId"),Ko((0,v.Z)(c),"organizationId"),Ko((0,v.Z)(c),"supportsRemoteControl",!1),Ko((0,v.Z)(c),"device"),Ko((0,v.Z)(c),"webinarStageStatus","OFF_STAGE"),Ko((0,v.Z)(c),"stageStatus"),Yo((0,v.Z)(c),jb,r),c.id=e,c.userId=a.id,c.name=a.name,c.picture=a.picture,c.clientSpecificId=a.clientSpecificId,c.waitlistStatus="none",Yo((0,v.Z)(c),Bb,i),Yo((0,v.Z)(c),Ub,o),Yo((0,v.Z)(c),Vb,!1),c.organizationId=a.organizationId,c.supportsRemoteControl=zp.isElectron(),c.device=zp.getDeviceInfo(),Yo((0,v.Z)(c),Fb,av.isV2AuthToken?o.viewType:i.viewType),c.setupEvents(),c.stageStatus=s,c}return(0,k.Z)(n,[{key:"setupEvents",value:function(){var e=this;vf.on(ff.ROOM_NODE_CONNECTED,(0,d.Z)((0,l.Z)().mark((function t(){return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=Qo(e,Hb,zb).isDisconnected,!t.t0){t.next=4;break}return t.next=4,e.resetSelf();case 4:Qo(e,Hb,zb).isDisconnected=!1,qp.info("DyteSelf::ROOM_NODE_CONNECTED");case 6:case"end":return t.stop()}}),t)})))),vf.on(ff.RESET_PRODUCER_STATE,(0,d.Z)((0,l.Z)().mark((function t(){return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.roomJoined&&Qo(e,Hb,zb)instanceof ry,!t.t0){t.next=14;break}if(t.t1=Qo(e,jb).videoEnabled,!t.t1){t.next=6;break}return t.next=6,Qo(e,Hb,zb).shareWebcam(Qo(e,jb).videoTrack);case 6:if(t.t2=Qo(e,jb).audioEnabled,!t.t2){t.next=10;break}return t.next=10,Qo(e,Hb,zb).shareMic(Qo(e,jb).audioTrack);case 10:if(t.t3=Qo(e,jb).screenShareEnabled,!t.t3){t.next=14;break}return t.next=14,Qo(e,Hb,zb).shareScreen({video:Qo(e,jb).screenShareTracks.video,audio:Qo(e,jb).screenShareTracks.audio});case 14:case"end":return t.stop()}}),t)})))),Qo(this,jb).on("AUDIO_TRACK_CHANGE",(0,d.Z)((0,l.Z)().mark((function t(){var n;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(qp.info("DyteSelf::setupEvents::AUDIO_TRACK_CHANGE",{audioEnabled:e.audioEnabled,trackId:null==(n=e.audioTrack)?void 0:n.id}),!e.roomJoined||!e.audioEnabled){t.next=9;break}return t.prev=1,t.next=4,Qo(e,Hb,zb).shareMic(e.audioTrack);case 4:t.next=9;break;case 6:t.prev=6,t.t0=t.catch(1),qp.error("DyteSelf::setupEvents::Error while sharing mic",{error:{name:t.t0.name,message:t.t0.message}}),Qo(e,jb).disableAudio();case 9:e.emit("audioUpdate",{audioEnabled:e.audioEnabled,audioTrack:e.audioTrack});case 10:case"end":return t.stop()}}),t,null,[[1,6]])})))),Qo(this,jb).on("VIDEO_TRACK_CHANGE",(0,d.Z)((0,l.Z)().mark((function t(){var n;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(qp.info("DyteSelf::setupEvents::VIDEO_TRACK_CHANGE",{videoEnabled:e.videoEnabled,trackId:null==(n=e.videoTrack)?void 0:n.id}),!e.videoEnabled||!e.roomJoined){t.next=13;break}return t.prev=1,t.next=4,Qo(e,Hb,zb).shareWebcam(e.videoTrack);case 4:t.next=13;break;case 6:if(t.prev=6,t.t0=t.catch(1),qp.error("DyteSelf::setupEvents::failed shareWebcam",{error:{name:t.t0.name,message:t.t0.message}}),t.t1=e.videoEnabled,!t.t1){t.next=13;break}return t.next=13,Qo(e,jb).disableVideo();case 13:e.emit("videoUpdate",{videoEnabled:e.videoEnabled,videoTrack:e.videoTrack});case 14:case"end":return t.stop()}}),t,null,[[1,6]])})))),Qo(this,jb).on("DEVICE_CHANGE",function(){var t=(0,d.Z)((0,l.Z)().mark((function t(n){var r;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=n.device,e.emit("deviceUpdate",{device:r});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),Qo(this,jb).on("SCREENSHARE_TRACK_CHANGE",(0,d.Z)((0,l.Z)().mark((function t(){return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.roomJoined){t.next=3;break}return qp.error("DyteSelf.SCREENSHARE_TRACK_CHANGE.LocalMediaInitialized_WithoutRoomNode"),t.abrupt("return");case 3:if(!e.screenShareEnabled){t.next=16;break}return t.prev=4,t.next=7,Qo(e,Hb,zb).shareScreen(e.screenShareTracks);case 7:t.next=16;break;case 9:if(t.prev=9,t.t0=t.catch(4),qp.error("DyteSelf::setupEvents::Error while sharing screen",{error:{name:t.t0.name,message:t.t0.message}}),t.t1=e.screenShareEnabled,!t.t1){t.next=16;break}return t.next=16,Qo(e,jb).disableScreenShare();case 16:qp.info("DyteSelf::setupEvents::SCREENSHARE_TRACK_CHANGE",{screenShareEnabled:e.screenShareEnabled}),e.emit("screenShareUpdate",{screenShareEnabled:e.screenShareEnabled,screenShareTracks:e.screenShareTracks});case 17:case"end":return t.stop()}}),t,null,[[4,9]])})))),Qo(this,jb).on("SCREENSHARE_ENDED",(0,d.Z)((0,l.Z)().mark((function t(){return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.disableScreenShare();case 2:qp.info("DyteSelf::setupEvents::SCREENSHARE_ENDED",{screenShareEnabled:e.screenShareEnabled});case 3:case"end":return t.stop()}}),t)})))),Qo(this,jb).on("AUDIO_TRACK_SILENT",(function(){e.emit("audioTrackSilent"),Lc.mediaTrackMuted("AUDIO")})),Qo(this,jb).on("FORCE_MUTE_AUDIO",this.disableAudio),Qo(this,jb).on("FORCE_MUTE_VIDEO",(0,d.Z)((0,l.Z)().mark((function t(){return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.roomJoined,!t.t0){t.next=4;break}return t.next=4,Qo(e,Hb,zb).pauseWebcam();case 4:e.emit("videoUpdate",{videoEnabled:e.videoEnabled,videoTrack:e.videoTrack}),Lc.videoOff();case 6:case"end":return t.stop()}}),t)}))))}},{key:"audioTrack",get:function(){return Qo(this,jb).audioTrack}},{key:"rawAudioTrack",get:function(){return Qo(this,jb).rawAudioTrack}},{key:"addAudioMiddleware",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Qo(this,jb).addAudioMiddleware(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"removeAudioMiddleware",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Qo(this,jb).removeAudioMiddleware(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"videoTrack",get:function(){return Qo(this,jb).videoTrack}},{key:"rawVideoTrack",get:function(){return Qo(this,jb).rawVideoTrack}},{key:"addVideoMiddleware",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Qo(this,jb).addVideoMiddleware(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"removeVideoMiddleware",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Qo(this,jb).removeVideoMiddleware(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"screenShareTracks",get:function(){return Qo(this,jb).screenShareTracks}},{key:"audioEnabled",get:function(){return Qo(this,jb).audioEnabled}},{key:"videoEnabled",get:function(){return Qo(this,jb).videoEnabled}},{key:"screenShareEnabled",get:function(){return Qo(this,jb).screenShareEnabled}},{key:"mediaPermissions",get:function(){return Qo(this,jb).permissions}},{key:"permissions",get:function(){return Qo(this,Bb)}},{key:"suggestedTheme",get:function(){return Qo(this,Ub)}},{key:"config",get:function(){return Qo(this,Ub)}},{key:"roomJoined",get:function(){var e;return!0===(null==(e=Qo(this,Hb,zb))?void 0:e.roomJoined)}},{key:"setName",value:function(e){if(!e)throw new Jp("Name cannot be empty.");this.name=e}},{key:"setupTracks",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r,a=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},e.abrupt("return",(t.forceReset&&(Qo(this,Hb,zb).stopAllProducers(),Qo(this,jb).removeAllTracks()),Qo(this,jb).setupStreams({video:null==(n=t.video)||n,audio:null==(r=t.audio)||r})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resetSelf",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r,a,i,o,s,c,u,d;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Lc.callEnded(),null==(r=null==(n=null==(t=Qo(this,Hb,zb))?void 0:t.sfuHandler)?void 0:n.cleanupConsumers)||r.call(n),e.next=4,null==(o=null==(i=null==(a=Qo(this,Hb,zb))?void 0:a.sfuHandler)?void 0:i.setupTransports)?void 0:o.call(i);case 4:return e.next=6,null==(s=Qo(this,Hb,zb))?void 0:s.joinRoom(this.name,!Qo(this,jb).audioEnabled,Qo(this,Hb,zb).roomUUID,Qo(this,Hb,zb).meetingTitle,{audio:Qo(this,jb).audioEnabled,video:Qo(this,jb).videoEnabled,screen:Qo(this,jb).screenShareEnabled});case 6:if(e.t0=Qo(this,jb).videoEnabled,!e.t0){e.next=10;break}return e.next=10,null==(c=Qo(this,Hb,zb))?void 0:c.shareWebcam(Qo(this,jb).videoTrack);case 10:if(e.t1=Qo(this,jb).audioEnabled,!e.t1){e.next=14;break}return e.next=14,null==(u=Qo(this,Hb,zb))?void 0:u.shareMic(Qo(this,jb).audioTrack);case 14:if(e.t2=Qo(this,jb).screenShareEnabled,!e.t2){e.next=18;break}return e.next=18,null==(d=Qo(this,Hb,zb))?void 0:d.shareScreen({video:Qo(this,jb).screenShareTracks.video,audio:Qo(this,jb).screenShareTracks.audio});case 18:qp.info("DyteSelf::resetSelf");case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destructMediaHandler",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(qp.info("DyteSelf::destructMediaHandler"),Qo(this,jb).destruct()));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeDocumentEventListeners",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(qp.info("DyteSelf::removeDocumentEventListeners"),Qo(this,jb).removeDocumentEventListeners()));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"enableAudio",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.permissions.canProduceAudio===tv.notAllowed||"WEBINAR"===Qo(this,Ub).viewType&&Qo(this,Bb).canProduceAudio===tv.canRequest&&("OFF_STAGE"===this.webinarStageStatus||"REQUESTED_TO_JOIN_STAGE"===this.webinarStageStatus)||this.audioEnabled){e.next=17;break}return e.next=3,Qo(this,jb).enableAudio();case 3:if(!this.roomJoined){e.next=16;break}if(!this.audioTrack){e.next=13;break}return e.prev=5,e.next=8,Qo(this,Hb,zb).shareMic(this.audioTrack);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(5),qp.error("DyteSelf::enableAudio::Error while sharing mic",{error:{name:e.t0.name,message:e.t0.message}}),Qo(this,jb).disableAudio();case 13:if(this.audioEnabled){e.next=15;break}return e.abrupt("return");case 15:Qo(this,Hb,zb).unmuteSelf();case 16:this.emit("audioUpdate",{audioEnabled:this.audioEnabled,audioTrack:this.audioTrack}),Lc.audioOn();case 17:case"end":return e.stop()}}),e,this,[[5,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"enableVideo",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Qo(this,Bb).canProduceVideo===tv.notAllowed||"WEBINAR"===Qo(this,Ub).viewType&&Qo(this,Bb).canProduceVideo===tv.canRequest&&("OFF_STAGE"===this.webinarStageStatus||"REQUESTED_TO_JOIN_STAGE"===this.webinarStageStatus)||this.videoEnabled){e.next=17;break}return e.next=3,Qo(this,jb).enableVideo();case 3:if(!this.roomJoined){e.next=16;break}return e.prev=4,e.next=7,Qo(this,Hb,zb).shareWebcam(this.videoTrack);case 7:e.next=16;break;case 9:if(e.prev=9,e.t0=e.catch(4),qp.error("DyteSelf::enableVideo::Error while sharing video",{error:{name:e.t0.name,message:e.t0.message}}),e.t1=this.videoEnabled,!e.t1){e.next=16;break}return e.next=16,Qo(this,jb).disableVideo();case 16:this.emit("videoUpdate",{videoEnabled:this.videoEnabled,videoTrack:this.videoTrack}),qp.info("DyteSelf.enableVideo",{deviceId:null==(t=this.videoTrack)?void 0:t.getSettings().deviceId}),Lc.videoOn();case 17:case"end":return e.stop()}}),e,this,[[4,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"enableScreenShare",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.roomJoined){e.next=2;break}throw new Jp("Can`t enable screenshare without joining room");case 2:if(Qo(this,Bb).canProduceScreenshare===tv.notAllowed||"WEBINAR"===Qo(this,Ub).viewType&&Qo(this,Bb).canProduceScreenshare===tv.canRequest&&("OFF_STAGE"===this.webinarStageStatus||"REQUESTED_TO_JOIN_STAGE"===this.webinarStageStatus)||this.screenShareEnabled){e.next=19;break}return e.next=5,Qo(this,jb).enableScreenShare();case 5:if(!this.screenShareTracks.audio&&!this.screenShareTracks.video){e.next=18;break}return e.prev=6,e.next=9,Qo(this,Hb,zb).shareScreen(this.screenShareTracks);case 9:e.next=18;break;case 11:if(e.prev=11,e.t0=e.catch(6),qp.error("DyteSelf::enableScreenShare::Error while sharing screen",{error:{name:e.t0.name,message:e.t0.message}}),e.t1=this.screenShareEnabled,!e.t1){e.next=18;break}return e.next=18,Qo(this,jb).disableScreenShare();case 18:this.emit("screenShareUpdate",{screenShareEnabled:this.screenShareEnabled,screenShareTracks:this.screenShareTracks});case 19:case"end":return e.stop()}}),e,this,[[6,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"disableAudio",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.audioEnabled&&(Qo(this,jb).disableAudio(),this.roomJoined&&Qo(this,Hb,zb).muteSelf(),this.emit("audioUpdate",{audioEnabled:this.audioEnabled,audioTrack:this.audioTrack}),Lc.audioOff());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"disableVideo",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.videoEnabled,!e.t0){e.next=10;break}return e.next=4,Qo(this,jb).disableVideo();case 4:if(e.t1=this.roomJoined,!e.t1){e.next=8;break}return e.next=8,Qo(this,Hb,zb).pauseWebcam();case 8:this.emit("videoUpdate",{videoEnabled:this.videoEnabled,videoTrack:this.videoTrack}),Lc.videoOff();case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"disableScreenShare",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.screenShareEnabled,!e.t0){e.next=9;break}return e.next=4,Qo(this,jb).disableScreenShare();case 4:if(e.t1=this.roomJoined,!e.t1){e.next=8;break}return e.next=8,Qo(this,Hb,zb).disableScreenShare();case 8:this.emit("screenShareUpdate",{screenShareEnabled:this.screenShareEnabled,screenShareTracks:this.screenShareTracks});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCurrentDevices",value:function(){return Qo(this,jb).getCurrentDevices()}},{key:"getAudioDevices",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,jb).getAudioDevices();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getVideoDevices",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,jb).getVideoDevices();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getSpeakerDevices",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,jb).getSpeakerDevices();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getDeviceById",value:function(e,t){var n;return"audio"===t?n="audioinput":"video"===t?n="videoinput":"speaker"===t&&(n="audiooutput"),Qo(this,jb).getDeviceById(e,n)}},{key:"getAllDevices",value:function(){return Qo(this,jb).getAllDevices()}},{key:"setIsPinned",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Yo(this,Vb,e);var n=e?"pinned":"unpinned";t&&this.emit(n,this)}},{key:"isPinned",get:function(){return Qo(this,Vb)}},{key:"pin",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.roomJoined){e.next=2;break}throw new Jp("Can`t pin participants without joining room");case 2:return e.abrupt("return",Qo(this,Hb,zb).pinPeer(this.id));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"unpin",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.roomJoined){e.next=2;break}throw new Jp("Can`t unpin participants without joining room");case 2:return e.abrupt("return",Qo(this,Hb,zb).pinPeer(null));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setDevice",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={added:[t],removed:[]},!("onDeviceChange"in Qo(this,jb))){e.next=5;break}return e.next=4,Qo(this,jb).onDeviceChange(n,!0);case 4:return e.abrupt("return");case 5:e.t0=t.kind,e.next="audioinput"===e.t0?8:"audiooutput"===e.t0?21:"videoinput"===e.t0?24:37;break;case 8:return e.prev=8,e.next=11,Qo(this,jb).setAudioDevice(t);case 11:e.next=20;break;case 13:if(e.prev=13,e.t1=e.catch(8),e.t2=this.roomJoined,!e.t2){e.next=19;break}return e.next=19,Qo(this,Hb,zb).muteSelf();case 19:this.emit("audioUpdate",{audioEnabled:this.audioEnabled,audioTrack:this.audioTrack});case 20:return e.abrupt("break",37);case 21:return e.next=23,Qo(this,jb).setSpeakerDevice(t);case 23:return e.abrupt("break",37);case 24:return e.prev=24,e.next=27,Qo(this,jb).setVideoDevice(t);case 27:e.next=36;break;case 29:if(e.prev=29,e.t3=e.catch(24),e.t4=this.roomJoined,!e.t4){e.next=35;break}return e.next=35,Qo(this,Hb,zb).pauseWebcam();case 35:this.emit("videoUpdate",{videoEnabled:this.videoEnabled,videoTrack:this.videoTrack});case 36:return e.abrupt("break",37);case 37:this.emit("deviceUpdate",{device:t});case 38:case"end":return e.stop()}}),e,this,[[8,13],[24,29]])})));return function(t){return e.apply(this,arguments)}}()},{key:"cleanUpTracks",value:function(){var e,t,n,r;null==(e=this.audioTrack)||e.stop(),null==(t=this.rawAudioTrack)||t.stop(),null==(n=this.videoTrack)||n.stop(),null==(r=this.rawVideoTrack)||r.stop()}},{key:"requestToJoinStage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.roomJoined){e.next=2;break}throw new Jp("Can`t request to join stage without joining room");case 2:if(Qo(this,Fb)===op.Webinar){e.next=4;break}throw new Jp("Not allowed to go on stage on non webinar meeting");case 4:if(this.permissions.requestProduce){e.next=6;break}throw qp.error("DyteSelf::requestGoToStage::permission_denied"),new Jp("User does not have permission to go on stage");case 6:return this.webinarStageStatus="REQUESTED_TO_JOIN_STAGE",e.next=9,Qo(this,Hb,zb).requestToJoinStage(fv.PRESENT);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"leaveStage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.roomJoined){e.next=2;break}throw new Jp("Can`t leave stage without joining room");case 2:if(Qo(this,Fb)===op.Webinar){e.next=4;break}throw new Jp("Not allowed to leave stage on non webinar meeting");case 4:return e.next=6,this.disableScreenShare();case 6:return e.next=8,this.disableVideo();case 8:return e.next=10,this.disableAudio();case 10:return Qo(this,jb).removeAllTracks(),Qo(this,jb).destruct(),e.next=14,Qo(this,Hb,zb).stopPresenting();case 14:this.setWebinarStageStatus("OFF_STAGE"),this.emit("stageLeft");case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"joinStage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.roomJoined){e.next=2;break}throw new Jp("Can`t join stage without joining room");case 2:if(this.permissions.canPresent||"ACCEPTED_TO_JOIN_STAGE"===this.webinarStageStatus){e.next=4;break}throw qp.error("DyteSelf::joinStage::permission_denied"),new Jp("User does not have permission to join stage");case 4:return e.next=6,Qo(this,Hb,zb).startPresenting();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWebinarStageStatus",value:function(e){this.webinarStageStatus=e}},{key:"setStageStatus",value:function(e){this.stageStatus=e}},{key:"disablePreview",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"init",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n,r,a,i){var o,s,c,u,d,p,f;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!navigator.RNLocalMediaHandlerImpl){e.next=8;break}return u=navigator,d=u.RNLocalMediaHandlerImpl,e.next=5,d.init();case 5:c=e.sent,e.next=15;break;case 8:if(!Vc.hasFeature(Sp.NEW_LOCAL_MEDIA_HANDLER)){e.next=12;break}c=new nh(a.mediaConstraints),e.next=15;break;case 12:return e.next=14,Yh.init(a.mediaConstraints);case 14:c=e.sent;case 15:return p=null==(o=i.audio)||o,f=null==(s=i.video)||s,"ALLOWED"!==r.canProduceAudio&&(p=!1),"ALLOWED"!==r.canProduceVideo&&(f=!1),e.next=20,c.setupStreams({video:f,audio:p});case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(0),qp.error("DyteSelf::init::Failed To Setup Streams",{error:{name:e.t0.name,message:e.t0.message}});case 25:return e.abrupt("return",new Jb(t,c,n,r,a,ay(r,a)));case 26:case"end":return e.stop()}}),e,null,[[0,22]])})));return function(t,n,r,a,i){return e.apply(this,arguments)}}()}]),n}(yp),jb=new WeakMap,Fb=new WeakMap,Ub=new WeakMap,Bb=new WeakMap,Vb=new WeakMap,Hb=new WeakSet,zb=function(){return Lb()},Wb);$b([Gp.trace("DyteSelf.setupEvents")],Jb.prototype,"setupEvents",1),$b([Gp.trace("DyteSelf.setupTracks")],Jb.prototype,"setupTracks",1),$b([Gp.trace("DyteSelf.resetSelf")],Jb.prototype,"resetSelf",1),$b([Gp.trace("DyteSelf.destructMediaHandler")],Jb.prototype,"destructMediaHandler",1),$b([Gp.trace("DyteSelf.removeDocumentEventListeners")],Jb.prototype,"removeDocumentEventListeners",1),$b([Gp.trace("DyteSelf.enableAudio")],Jb.prototype,"enableAudio",1),$b([Gp.trace("DyteSelf.enableVideo")],Jb.prototype,"enableVideo",1),$b([Gp.trace("DyteSelf.enableScreenShare")],Jb.prototype,"enableScreenShare",1),$b([Gp.trace("DyteSelf.disableAudio")],Jb.prototype,"disableAudio",1),$b([Gp.trace("DyteSelf.disableVideo")],Jb.prototype,"disableVideo",1),$b([Gp.trace("DyteSelf.disableScreenShare")],Jb.prototype,"disableScreenShare",1),$b([Gp.trace("DyteSelf.setDevice")],Jb.prototype,"setDevice",1),$b([Gp.trace("DyteSelf.requestToJoinStage")],Jb.prototype,"requestToJoinStage",1),$b([Gp.trace("DyteSelf.leaveStage")],Jb.prototype,"leaveStage",1),$b([Gp.trace("DyteSelf.joinStage")],Jb.prototype,"joinStage",1),$b([Gp.trace("DyteSelf.deprecated.disablePreview")],Jb.prototype,"disablePreview",1),Jb=$b([Yp((function(e){throw new Jp(e.message,"1100")}))],Jb);var Qb,Xb,Yb,ew,tw=function(){function e(t){(0,y.Z)(this,e),Ko(this,"socket"),this.socket=t}return(0,k.Z)(e,[{key:"onReconnect",set:function(e){this.socket.onStateEvent("reconnected",e)}},{key:"joinRoom",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n,r,a){var i,o,s;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={capabilities:[],peer:{displayName:t,peerId:n,userId:r},roomUuid:a},e.next=3,this.socket.sendMessagePromise(gg.joinRoom,Em.toBinary(i));case 3:return vf.emit(ff.SOCKET_SERVICE_ROOM_JOINED),e.prev=4,e.next=7,this.getRoomState();case 7:o=e.sent,s=o.room,vf.emit(ff.ROOM_STATE,s),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(4),qp.error("RoomSocketHandler.joinRoom.failedToGetRoomState",{error:e.t0});case 15:case"end":return e.stop()}}),e,this,[[4,12]])})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"getRoomState",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Sm.create(),e.prev=1,e.next=4,this.socket.sendMessagePromise(gg.getRoomInfo);case 4:n=e.sent,t=Sm.fromBinary(n.payload),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),qp.error("getRoomState::binary_decode_error",{error:e.t0});case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"leaveRoom",value:function(){this.socket.sendMessage(gg.leaveRoom,Tm.toBinary({}))}}]),e}(),nw=Object.defineProperty,rw=Object.getOwnPropertyDescriptor,aw=function(e,t,n,r){for(var a,i=r>1?void 0:r?rw(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&nw(t,n,i),i},iw=(ew=function(){function e(t,n){var r,a,i,o;(0,y.Z)(this,e),Xo(this,Xb),Ko(this,"self"),Ko(this,"authToken"),Ko(this,"peerId"),Xo(this,Qb,void 0),Yo(this,Qb,t),this.authToken=null!=(a=null==(r=Lb())?void 0:r.authToken)?a:t.authToken,this.peerId=null!=(o=null==(i=Lb())?void 0:i.peerId)?o:t.peerId,this.self=n,this.setupEvents()}return(0,k.Z)(e,[{key:"roomJoined",get:function(){var e;return!0===(null==(e=Qo(this,Xb,Yb))?void 0:e.roomJoined)}},{key:"shareMediaTracks",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([this.self.videoTrack&&Qo(this,Xb,Yb).shareWebcam(this.self.videoTrack),this.self.audioTrack&&Qo(this,Xb,Yb).shareMic(this.self.audioTrack)]));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setupEvents",value:function(){var e=this;vf.on(ff.DISABLE_AUDIO,(0,d.Z)((0,l.Z)().mark((function t(){return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.self.audioEnabled,!t.t0){t.next=5;break}return t.next=4,e.self.disableAudio();case 4:Lc.audioOff();case 5:case"end":return t.stop()}}),t)})))),vf.on(ff.DISABLE_VIDEO,(0,d.Z)((0,l.Z)().mark((function t(){return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.self.videoEnabled,!t.t0){t.next=5;break}return t.next=4,e.self.disableVideo();case 4:Lc.videoOff();case 5:case"end":return t.stop()}}),t)})))),vf.on(ff.MUTE_ALL,(0,d.Z)((0,l.Z)().mark((function t(){return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.self.audioEnabled,!t.t0){t.next=5;break}return t.next=4,e.self.disableAudio();case 4:Lc.audioOff();case 5:case"end":return t.stop()}}),t)})))),vf.on(ff.MUTE_ALL_VIDEO,(0,d.Z)((0,l.Z)().mark((function t(){return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.self.videoEnabled,!t.t0){t.next=5;break}return t.next=4,e.self.disableVideo();case 4:Lc.videoOff();case 5:case"end":return t.stop()}}),t)})))),vf.on(ff.WAITLISTED,(function(){e.self.waitlistStatus="waiting",e.self.emit("waitlisted")})),vf.on(ff.WAITLIST_ACCEPTED,(0,d.Z)((0,l.Z)().mark((function t(){return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.self.waitlistStatus="accepted",e.joinRoom();case 1:case"end":return t.stop()}}),t)})))),vf.on(ff.WAITLIST_REJECTED,(0,d.Z)((0,l.Z)().mark((function t(){return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.self.waitlistStatus="rejected",e.leaveRoom("rejected");case 1:case"end":return t.stop()}}),t)})))),vf.on(ff.KICKED,function(){var t=(0,d.Z)((0,l.Z)().mark((function t(n){var r;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r="kicked","kickAll"===(null==n?void 0:n.kickType)&&(r="ended"),e.leaveRoom(r);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),vf.on(ff.SELF_ROOM_JOINED,(function(){"WEBINAR"===e.self.config.viewType&&e.self.permissions.canPresent&&e.self.joinStage(),e.self.emit("roomJoined")})),vf.on(ff.SOCKET_SERVICE_ROOM_JOINED,(function(){e.self.emit("socketServiceRoomJoined")})),vf.on(ff.MEDIA_PERMISSION_ERROR,function(){var t=(0,d.Z)((0,l.Z)().mark((function t(n){var r,a;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=n.kind,a=n.message,"audio"===r?(Lc.mediaPermission("AUDIO",gf(a)),e.self.disableAudio()):"video"===r?(Lc.mediaPermission("VIDEO",gf(a)),e.self.disableVideo()):"screenshare"===r&&(Lc.mediaPermission("VIDEO",gf(a)),e.self.disableScreenShare()),qp.error("SelfController::mediaPermissionError",{error:JSON.stringify(n,null,4)}),e.self.emit("mediaPermissionError",n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),vf.on(ff.REQUEST_TO_JOIN_STAGE_ACCEPTED,(function(){e.self.setWebinarStageStatus(Kb.ACCEPTED_TO_JOIN_STAGE),e.self.emit("joinStageRequestAccepted")})),vf.on(ff.REQUEST_TO_JOIN_STAGE_REJECTED,(function(){e.self.setWebinarStageStatus(Kb.OFF_STAGE),e.self.emit("joinStageRequestRejected")})),vf.on(ff.REMOVED_FROM_STAGE,(0,d.Z)((0,l.Z)().mark((function t(){return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.self.setWebinarStageStatus(Kb.OFF_STAGE),t.next=3,e.self.disableScreenShare();case 3:return t.next=5,e.self.disableVideo();case 5:return t.next=7,e.self.disableAudio();case 7:e.self.destructMediaHandler(),e.self.emit("removedFromStage");case 9:case"end":return t.stop()}}),t)})))),vf.on(ff.STARTED_PRESENTING,(function(){e.self.setWebinarStageStatus(Kb.ON_STAGE),e.self.emit("stageJoined")})),vf.on(ff.STOPPED_PRESENTING,(function(){e.self.setWebinarStageStatus(Kb.OFF_STAGE),e.self.emit("stageLeft")})),vf.on(ff.PRODUCER_SCORE_UPDATE,(function(t){var n,r=t.score,a=t.kind,i=t.appData,o="video"===a&&null!=(n=null==i?void 0:i.screenShare)&&n;e.self.emit("mediaScoreUpdate",{kind:a,isScreenshare:o,score:r}),Vc.hasFeature(Sp.NS_NETWORK_SCORE)&&Qo(e,Xb,Yb).broadcastMessage("producerScoreBroadcast",{kind:a,score:r,peerId:e.self.id})})),vf.on(ff.PRODUCER_STATUS_UPDATE,(function(t){var n=t.status;e.self.emit("mediaChannelUpdate",{status:n})}))}},{key:"joinRoom",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r,a,i,o,s,c,u,p=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(null!=(t=Qo(this,Xb,Yb))&&t.isDisconnected&&Qo(this,Xb,Yb)instanceof Ob)){e.next=4;break}return null==(n=Qo(this,Xb,Yb))||n.reconnect(),e.abrupt("return");case 4:if(i=vg(),o="",!(Qo(this,Xb,Yb)instanceof Ob)){e.next=11;break}return e.next=9,Qo(this,Xb,Yb).getRoomState();case 9:c=e.sent,s=null!=(a=null==(r=null==c?void 0:c.payload)?void 0:r.roomState)?a:{},o=s.roomUUID,i.setRoomUUID(o);case 11:if(u=new tw(Qo(this,Qb)),e.t0=sv(this.self.config.viewType)||"socket-service"===uv("chat_socket_server"),!e.t0){e.next=18;break}return e.next=16,u.joinRoom(this.self.name,this.self.id,this.self.userId,o);case 16:u.socket.flush(),u.onReconnect=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.joinRoom(p.self.name,p.self.id,p.self.userId,o);case 2:u.socket.flush();case 3:case"end":return e.stop()}}),e)})));case 18:return e.next=20,this.joinMediaRoom(o);case 20:e.next=25;break;case 22:throw e.prev=22,e.t1=e.catch(0),qp.error(e.t1.message),e.t1;case 25:case"end":return e.stop()}}),e,this,[[0,22]])})));return function(){return e.apply(this,arguments)}}()},{key:"leaveRoom",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r,a,i=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]?i[0]:"left",Qo(this,Xb,Yb)){e.next=12;break}return e.next=4,this.self.disableAudio();case 4:return e.next=6,this.self.disableVideo();case 6:this.self.cleanUpTracks(),this.self.destructMediaHandler(),this.self.removeDocumentEventListeners();try{null==(n=Qo(this,Qb))||n.disconnect()}catch(T){qp.error("SelfController::leaveRoom::socketDisconnect")}return this.self.emit("roomLeft",{state:t}),e.abrupt("return");case 12:return e.next=14,this.self.disableAudio();case 14:return e.next=16,this.self.disableVideo();case 16:return e.next=18,this.self.disableScreenShare();case 18:if(this.self.cleanUpTracks(),this.self.destructMediaHandler(),this.self.removeDocumentEventListeners(),a=this.roomJoined,e.t0=this.roomJoined,!e.t0){e.next=27;break}return e.next=26,Qo(this,Xb,Yb).leaveRoom();case 26:Qo(this,Xb,Yb).roomJoined=!1;case 27:try{null==(r=Qo(this,Qb))||r.disconnect()}catch(T){qp.error("SelfController::leaveRoom::socketDisconnect")}a&&this.self.emit("roomLeft",{state:t});case 29:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"joinMediaRoom",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null==(n=Qo(this,Xb,Yb))?void 0:n.joinRoom(this.self.name,!this.self.audioEnabled,t,void 0,{audio:this.self.audioEnabled,video:this.self.videoEnabled,screen:this.self.screenShareEnabled});case 2:if(e.t0=r=e.sent,null==e.t0){e.next=7;break}e.t1=r,e.next=8;break;case 7:e.t1={};case 8:if(a=e.t1,i=a.roomJoined,Qo(this,Xb,Yb)instanceof ry&&(Qo(this,Xb,Yb).onSocketReconnection=this.joinMediaRoom.bind(this,t)),e.t2=i,!e.t2){e.next=15;break}return e.next=15,this.shareMediaTracks();case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"init",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n,r,a,i){var o,s,c,u,p,f,h,v,m;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.defaults,u=vg(),p=av.isV2AuthToken,e.next=5,Jb.init(null!=(s=null==(o=Lb())?void 0:o.peerId)?s:t.peerId,av.isV2AuthToken?r.participant:r,a,i,c);case 5:return f=e.sent,h=p?r.participant.organizationId:r.organizationId,Gp.meetingMetadata.organizationId=h,Vc.hasFeature(Sp.INTERNAL_CALL_STATS)&&"ReactNative"!==navigator.product&&((v=Vc.getValue(Sp.CALLSTATS_INGESTION_LAYER))&&!["SQS","ALL","INGESTION"].includes(v)&&(v="SQS"),m="dev",kp.apiBase.indexOf("cluster.dyte")>-1?m="production":kp.apiBase.indexOf("staging.dyte")>-1&&(m="staging"),setTimeout((0,d.Z)((0,l.Z)().mark((function e(){var n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Lc,e.t1=null!=(r=null==(n=Lb())?void 0:n.peerId)?r:t.peerId,e.t2=zp.getDeviceInfo().engineName,e.t3=m,e.next=6,u.getICEServers();case 6:e.t4=e.sent,e.t5=kp.apiBase,e.t6={ingestionLayerDetails:null!=v?v:"SQS"},e.t7=qp,e.t8={peerId:e.t1,engineName:e.t2,env:e.t3,iceServers:e.t4,apiBase:e.t5,flags:e.t6,logger:e.t7},e.t0.initialize.call(e.t0,e.t8);case 12:case"end":return e.stop()}}),e)}))))),e.abrupt("return",new iw(t,f));case 9:case"end":return e.stop()}}),e)})));return function(t,n,r,a,i){return e.apply(this,arguments)}}()}]),e}(),Qb=new WeakMap,Xb=new WeakSet,Yb=function(){return Lb()},ew),ow=iw;aw([Gp.trace("SelfController.setupEvents")],ow.prototype,"setupEvents",1),aw([Gp.trace("SelfController.joinRoom")],ow.prototype,"joinRoom",1),aw([Gp.trace("SelfController.leaveRoom")],ow.prototype,"leaveRoom",1),aw([Gp.trace("SelfController.joinMediaRoom")],ow.prototype,"joinMediaRoom",1);var sw,cw,uw,lw,dw,pw,fw,hw=Object.defineProperty,vw=Object.getOwnPropertyDescriptor,mw=function(e,t,n,r){for(var a,i=r>1?void 0:r?vw(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&hw(t,n,i),i},gw=(dw=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e,r){var a;(0,y.Z)(this,n),a=t.call(this),Xo((0,v.Z)(a),cw),Ko((0,v.Z)(a),"id"),Ko((0,v.Z)(a),"userId"),Ko((0,v.Z)(a),"name"),Ko((0,v.Z)(a),"picture"),Ko((0,v.Z)(a),"isHost"),Ko((0,v.Z)(a),"clientSpecificId"),Ko((0,v.Z)(a),"flags"),Ko((0,v.Z)(a),"device"),Ko((0,v.Z)(a),"videoTrack"),Ko((0,v.Z)(a),"audioTrack"),Ko((0,v.Z)(a),"screenShareTracks"),Ko((0,v.Z)(a),"videoEnabled"),Ko((0,v.Z)(a),"audioEnabled"),Ko((0,v.Z)(a),"screenShareEnabled"),Ko((0,v.Z)(a),"producers"),Xo((0,v.Z)(a),sw,void 0),Ko((0,v.Z)(a),"supportsRemoteControl",!1),Ko((0,v.Z)(a),"webinarStageStatus",Kb.OFF_STAGE),Ko((0,v.Z)(a),"presetName"),Xo((0,v.Z)(a),lw,void 0);var i=e.id,o=e.userId,s=e.displayName,c=e.device,u=e.picture,l=e.isHost,d=e.flags,p=e.clientSpecificId,f=e.audioMuted,h=e.audioTrack,m=e.videoEnabled,g=void 0!==m&&m,k=e.videoTrack,b=e.producers,w=e.metadata;return a.id=i,a.userId=o,a.name=s,a.device=c,a.picture=u,a.isHost=l,a.flags=d,a.clientSpecificId=p,a.audioEnabled=!f,a.audioTrack=h,a.videoEnabled=g,a.videoTrack=k,a.screenShareTracks={audio:void 0,video:void 0},a.producers=null!=b?b:[],a.presetName=null==w?void 0:w.preset_name,Yo((0,v.Z)(a),sw,!1),Yo((0,v.Z)(a),lw,r),a}return(0,k.Z)(n,[{key:"roomJoined",get:function(){var e;return!0===(null==(e=Qo(this,cw,uw))?void 0:e.roomJoined)}},{key:"setVideoEnabled",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.videoEnabled=e,n&&(qp.info("DyteParticipant::setVideoEnabled::videoUpdate",{videoEnabled:this.videoEnabled,trackId:null==(t=this.videoTrack)?void 0:t.id}),this.emit("videoUpdate",{videoEnabled:this.videoEnabled,videoTrack:this.videoTrack}))}},{key:"setAudioEnabled",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.audioEnabled=e,n&&(qp.info("DyteParticipant::setAudioEnabled::audioUpdate",{audioEnabled:this.audioEnabled,trackId:null==(t=this.audioTrack)?void 0:t.id}),this.emit("audioUpdate",{audioEnabled:this.audioEnabled,audioTrack:this.audioTrack}))}},{key:"setScreenShareEnabled",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.screenShareEnabled=e,t&&this.emit("screenShareUpdate",{screenShareEnabled:this.screenShareEnabled,screenShareTracks:this.screenShareTracks})}},{key:"pin",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.roomJoined){e.next=2;break}throw new Jp("Can`t pin participant without joining room");case 2:return e.abrupt("return",Qo(this,cw,uw).pinPeer(this.id));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"unpin",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.roomJoined){e.next=2;break}throw new Jp("Can`t unpin participant without joining room");case 2:return e.abrupt("return",Qo(this,cw,uw).pinPeer(null));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setIsPinned",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Yo(this,sw,e);var n=e?"pinned":"unpinned";t&&this.emit(n,this)}},{key:"disableAudio",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.id,qp.info("DyteParticipant::disable_audio",{peerId:t}),this.roomJoined){e.next=3;break}throw new Jp("Can`t disable participant audio without joining room");case 3:if(!Qo(this,lw).permissions.canAllowParticipantAudio){e.next=5;break}return e.abrupt("return",Qo(this,cw,uw).disableAudio(t));case 5:throw qp.error("DyteParticipant::unauthorized_disable_audio",{peerId:t}),new Jp("Unauthorized: User does not have permission to disable participant audio.");case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"kick",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.id,qp.info("DyteParticipant::kick",{peerId:t}),this.roomJoined){e.next=3;break}throw new Jp("Can`t kick participant without joining room");case 3:if(!Qo(this,lw).permissions.kickParticipant){e.next=5;break}return e.abrupt("return",Qo(this,cw,uw).kick(t));case 5:throw qp.error("DyteParticipant::unauthorized_kick",{peerId:t}),new Jp("Unauthorized: User does not have permission to kick participants.");case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"disableVideo",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.id,qp.info("DyteParticipant::disable_video",{peerId:t}),this.roomJoined){e.next=3;break}throw new Jp("Can`t disable participant video without joining room");case 3:if(!Qo(this,lw).permissions.canAllowParticipantVideo){e.next=5;break}return e.abrupt("return",Qo(this,cw,uw).disableVideo(t));case 5:throw qp.error("DyteParticipant::unauthorized_disable_video",{peerId:t}),new Jp("Unauthorized: User does not have permission to disable participant video.");case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"acceptJoinStageRequest",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.roomJoined){e.next=2;break}throw new Jp("Can`t acceptJoinStageRequest for participant without joining room");case 2:Qo(this,cw,uw).acceptAllRequestToJoinStage([{id:this.id,requestToJoinType:fv.PRESENT}]);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"rejectRequestToJoinStage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.roomJoined){e.next=2;break}throw new Jp("Can`t rejectRequestToJoinStage for participant without joining room");case 2:Qo(this,cw,uw).rejectRequestToJoinStage(this.id);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeFromStage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.roomJoined){e.next=2;break}throw new Jp("Can`t removeFromStage participant without joining room");case 2:Qo(this,cw,uw).removePeerFromStage(this.id,pv.REQUESTED_BY_MODERATOR);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setWebinarStageStatus",value:function(e){var t;this.webinarStageStatus=e,e===Kb.OFF_STAGE&&(t="peerStoppedPresenting"),e===Kb.ON_STAGE&&(t="peerStartedPresenting"),e===Kb.ACCEPTED_TO_JOIN_STAGE&&(t="peerAcceptedToJoinStage"),e===Kb.REQUESTED_TO_JOIN_STAGE&&(t="peerRequestToJoinStage"),t&&this.emit(t,this)}},{key:"isPinned",get:function(){return Qo(this,sw)}},{key:"setMediaScore",value:function(e,t){this.emit("mediaScoreUpdate",{score:e,kind:t})}}]),n}(yp),sw=new WeakMap,cw=new WeakSet,uw=function(){return Lb()},lw=new WeakMap,dw);mw([Gp.trace("DyteParticipant.disableAudio")],gw.prototype,"disableAudio",1),mw([Gp.trace("DyteParticipant.kick")],gw.prototype,"kick",1),mw([Gp.trace("DyteParticipant.disableVideo")],gw.prototype,"disableVideo",1),mw([Gp.trace("DyteParticipant.acceptJoinStageRequest")],gw.prototype,"acceptJoinStageRequest",1),mw([Gp.trace("DyteParticipant.rejectRequestToJoinStage")],gw.prototype,"rejectRequestToJoinStage",1),mw([Gp.trace("DyteParticipant.removeFromStage")],gw.prototype,"removeFromStage",1),mw([Gp.trace("DyteParticipant.setWebinarStageStatus")],gw.prototype,"setWebinarStageStatus",1),gw=mw([Yp((function(e){throw new Jp(e.message,"1200")}))],gw);var yw=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;(0,y.Z)(this,n);var a=null!=e?e:{},i=a.onAddEvent,o=void 0===i?"added":i,s=a.onDeleteEvent,c=void 0===s?"deleted":s,u=a.onClearEvent,l=void 0===u?"cleared":u;return r=t.call(this),Xo((0,v.Z)(r),pw,void 0),Xo((0,v.Z)(r),fw,void 0),Ko((0,v.Z)(r),"onAddEvent"),Ko((0,v.Z)(r),"onDeleteEvent"),Ko((0,v.Z)(r),"onClearEvent"),Yo((0,v.Z)(r),pw,new yp),r.onAddEvent=o,r.onDeleteEvent=c,r.onClearEvent=l,Yo((0,v.Z)(r),fw,new Map),r}return(0,k.Z)(n,[{key:"emit",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return(t=Qo(this,pw)).emit.apply(t,[e].concat(r))}},{key:"on",value:function(e,t){return Qo(this,pw).on(e,t)}},{key:"addListener",value:function(e,t){return Qo(this,pw).addListener(e,t)}},{key:"off",value:function(e,t){return Qo(this,pw).off(e,t)}},{key:"once",value:function(e,t){return Qo(this,pw).once(e,t)}},{key:"prependListener",value:function(e,t){return Qo(this,pw).prependListener(e,t)}},{key:"prependOnceListener",value:function(e,t){return Qo(this,pw).prependOnceListener(e,t)}},{key:"removeListener",value:function(e,t){return Qo(this,pw).removeListener(e,t)}},{key:"removeAllListeners",value:function(e){return Qo(this,pw).removeAllListeners(e)}},{key:"listeners",value:function(e){return Qo(this,pw).listeners(e)}},{key:"listenerCount",value:function(e){return Qo(this,pw).listenerCount(e)}},{key:"getMaxListeners",value:function(){return Qo(this,pw).getMaxListeners()}},{key:"setMaxListeners",value:function(e){return Qo(this,pw).setMaxListeners(e)}},{key:"eventNames",value:function(){return Qo(this,pw).eventNames()}},{key:"add",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.set(e.id,e,t)}},{key:"set",value:function(e,t){var r=this,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=f((0,p.Z)(n.prototype),"set",this).call(this,e,t),o=function(e){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];r.emit.apply(r,[e,t].concat(a))};return Qo(this,fw).set(e,o),t.on("*",o),a&&Qo(this,pw).emit(this.onAddEvent,t),i}},{key:"delete",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this.get(e);if(!a)return!1;a.removeListener("*",Qo(this,fw).get(e));var i=f((0,p.Z)(n.prototype),"delete",this).call(this,e);return r&&a.removeAllListeners(),t&&Qo(this,pw).emit(this.onDeleteEvent,a),i}},{key:"clear",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.forEach((function(t){t.removeListener("*",Qo(e,fw).get(t.id)),r&&t.removeAllListeners()}));var a=f((0,p.Z)(n.prototype),"clear",this).call(this);return t&&Qo(this,pw).emit(this.onClearEvent),a}},{key:"toArray",value:function(){return Array.from(this.values())}}]),n}((0,a.Z)(Map));pw=new WeakMap,fw=new WeakMap;var kw,bw,ww,_w,Sw=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){(0,y.Z)(this,n);var r=null!=e?e:{},a=r.onAddEvent,i=void 0===a?"participantJoined":a,o=r.onDeleteEvent,s=void 0===o?"participantLeft":o,c=r.onClearEvent,u=void 0===c?"participantsCleared":c;return t.call(this,{onAddEvent:i,onDeleteEvent:s,onClearEvent:u})}return(0,k.Z)(n,[{key:"add",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return f((0,p.Z)(n.prototype),"add",this).call(this,e,t)}},{key:"clear",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return f((0,p.Z)(n.prototype),"clear",this).call(this,e,t)}},{key:"delete",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return f((0,p.Z)(n.prototype),"delete",this).call(this,e,t,r)}}]),n}(yw),Ew=function(e){function t(){(0,y.Z)(this,t),Ko(this,"_orderedArray"),Ko(this,"_map"),this._map=new Map,this._orderedArray=[]}return(0,k.Z)(t,[{key:"add",value:function(e,t){if(!this._map.has(e))return this._map.set(e,{peerId:e,priority:t}),this._orderedArray.splice(Math.max(t-1,0),0,e),this.index(e);var n=this.index(e);this.delete(e);var r=this.add(e,t);return n!==r?(qp.info("DyteSelectedPeer::add()::new_position_for_active_speaker",{oldIndex:n,newIndex:r}),r):-1}},{key:"delete",value:function(e){if(this._map.has(e)){var t=this.index(e);this._map.delete(e),this._orderedArray.splice(t,1)}}},{key:"index",value:function(e){return this._map.has(e)?this._orderedArray.indexOf(e):-1}},{key:e,value:function(){return this._orderedArray[Symbol.iterator]()}}]),t}(Symbol.iterator),Tw=function(){function e(){(0,y.Z)(this,e),Ko(this,"_activeSpeakerPeers"),Ko(this,"_compulsoryPeers"),this._activeSpeakerPeers=new Ew,this._compulsoryPeers=new Set}return(0,k.Z)(e,[{key:"add",value:function(e,t){return t<0?(this._compulsoryPeers.add(e),0):this.compulsoryPeers.includes(e)&&(t>0||246267631===t)&&(qp.info("DyteSelectedPeer::removing_compulsory_peer",{peerId:e}),this._removeFromCompulsoryPeer(e),246267631===t)?-1:this._activeSpeakerPeers.add(e,t)}},{key:"delete",value:function(e){qp.info("DyteSelectedPeer::deleting_peer_from_selectedPeer",{peerId:e}),this._removeFromCompulsoryPeer(e),this._activeSpeakerPeers.delete(e)}},{key:"index",value:function(e){return this._activeSpeakerPeers.index(e)}},{key:"peers",get:function(){return(0,o.Z)(new Set(this.compulsoryPeers.concat(this.activeSpeakerPeers)))}},{key:"compulsoryPeers",get:function(){return(0,o.Z)(this._compulsoryPeers.values())}},{key:"peerPriorities",get:function(){return(0,o.Z)(this._activeSpeakerPeers).map((function(e,t){return t}))}},{key:"activeSpeakerPeers",get:function(){return(0,o.Z)(this._activeSpeakerPeers)}},{key:"_removeFromCompulsoryPeer",value:function(e){this._compulsoryPeers.delete(e)}}]),e}(),xw=Object.defineProperty,Zw=Object.getOwnPropertyDescriptor,Cw=function(e,t,n,r){for(var a,i=r>1?void 0:r?Zw(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&xw(t,n,i),i},Rw=(_w=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;return(0,y.Z)(this,n),r=t.call(this),Xo((0,v.Z)(r),kw),Ko((0,v.Z)(r),"waitlisted"),Ko((0,v.Z)(r),"joined"),Ko((0,v.Z)(r),"active"),Ko((0,v.Z)(r),"pinned"),Xo((0,v.Z)(r),ww,void 0),Ko((0,v.Z)(r),"viewMode"),Ko((0,v.Z)(r),"currentPage"),Ko((0,v.Z)(r),"lastActiveSpeaker"),Ko((0,v.Z)(r),"selectedPeers"),Yo((0,v.Z)(r),ww,e),r.waitlisted=new Sw,r.joined=new Sw,r.active=new Sw,r.pinned=new Sw,r.selectedPeers=new Tw,r.viewMode="ACTIVE_GRID",r.currentPage=0,r}return(0,k.Z)(n,[{key:"roomJoined",get:function(){var e;return!0===(null==(e=Qo(this,kw,bw))?void 0:e.roomJoined)}},{key:"count",get:function(){return this.joined.size}},{key:"maxActiveParticipantsCount",get:function(){var e,t,n;if(Qo(this,kw,bw)instanceof Ob)return Qo(this,kw,bw).maxPreferredStreams;var r=Qo(this,ww).suggestedTheme;return null!=(n=null==(t=null==(e=null==r?void 0:r.grid)?void 0:e.multi)?void 0:t.maxVideoCount)?n:6}},{key:"pageCount",get:function(){return"PAGINATED"===this.viewMode?Math.ceil(this.joined.size/this.maxActiveParticipantsCount):0}},{key:"acceptWaitingRoomRequest",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.roomJoined){e.next=2;break}throw new Jp("Can`t accept waiting room request without joining room");case 2:return e.abrupt("return",Qo(this,kw,bw).acceptWaitingRequest(t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"rejectWaitingRoomRequest",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.roomJoined){e.next=2;break}throw new Jp("Can`t reject waiting room request without joining room");case 2:return e.next=4,Qo(this,kw,bw).rejectWaitingRequest(t);case 4:this.waitlisted.delete(t);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setViewMode",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(qp.info("DyteParticipants::set_view_mode",{viewMode:t}),["ACTIVE_GRID","PAGINATED"].includes(t)){e.next=2;break}throw qp.error("DyteParticipants::setViewMode::invalid_view_mode",{viewMode:t}),new Jp("Invalid view mode: ".concat(t,". Try ACTIVE_GRID or PAGINATED."));case 2:if(this.viewMode!==t){e.next=5;break}return qp.info("DyteParticipants::setViewMode::view_mode_same_as_previous",{viewMode:t}),e.abrupt("return");case 5:if(this.viewMode=t,"PAGINATED"!==t){e.next=20;break}if(this.currentPage=1,r=[],!(Qo(this,kw,bw)instanceof Ob)){e.next=16;break}return e.next=11,Qo(this,kw,bw).getPage(this.currentPage);case 11:n=e.sent.payload,r=n.peerIds,e.next=17;break;case 16:r=this.getPeerIdsForCurrentPage();case 17:vf.emit(ff.GET_PAGE,{peerIds:r}),e.next=21;break;case 20:"ACTIVE_GRID"===t&&(this.currentPage=0,Qo(this,kw,bw)instanceof Ob?Qo(this,kw,bw).getPage(this.currentPage):vf.emit(ff.REFRESH_GRID));case 21:this.emit("viewModeChanged",{viewMode:t,currentPage:this.currentPage,pageCount:this.pageCount});case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPeerIdsForCurrentPage",value:function(){qp.info("DyteParticipants::getPeerIdsForCurrentPage()",{currentPage:this.currentPage,maxActiveParticipantsCount:this.maxActiveParticipantsCount});var e=this.selectedPeers.compulsoryPeers,t=(0,o.Z)(this.joined.keys()),n=Math.max((this.currentPage-1)*(this.maxActiveParticipantsCount-e.length)),r=this.currentPage*(this.maxActiveParticipantsCount-e.length);return e.concat(t.slice(n,r))}},{key:"setPage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(qp.info("DyteParticipants::set_page",{page:t,maxPageCount:this.pageCount}),"PAGINATED"===this.viewMode){e.next=2;break}return e.abrupt("return");case 2:if(Number.isInteger(t)){e.next=4;break}throw qp.error("DyteParticipants::invalid_page_number",{page:t,maxPageCount:this.pageCount}),new Jp("Invalid page: ".concat(t,". Page must be an integer."));case 4:if(!(t<1||t>this.pageCount)){e.next=6;break}throw qp.error("DyteParticipants::invalid_page_number",{page:t,maxPageCount:this.pageCount}),new Jp("Invalid page: ".concat(t,". Page must be greater than 0 and less than or equal to ").concat(this.pageCount,"."));case 6:if(this.currentPage=t,r=[],!(Qo(this,kw,bw)instanceof Ob)){e.next=16;break}return e.next=11,Qo(this,kw,bw).getPage(t);case 11:n=e.sent.payload,r=n.peerIds,e.next=17;break;case 16:r=this.getPeerIdsForCurrentPage();case 17:vf.emit(ff.GET_PAGE,{peerIds:r}),this.emit("pageChanged",{viewMode:this.viewMode,currentPage:this.currentPage,pageCount:this.pageCount});case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"disableAllAudio",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(qp.info("DyteParticipants::disable_all_audio",{allowUnMute:t}),this.roomJoined){e.next=2;break}throw new Jp("Can`t disable all audio without joining room");case 2:if(!Qo(this,ww).permissions.canAllowParticipantAudio){e.next=4;break}return e.abrupt("return",Qo(this,kw,bw).muteAll(t));case 4:throw qp.error("DyteParticipants::unauthorized_disable_all_audio",{allowUnMute:t}),new Jp("Unauthorized: User does not have permission to disable peer audio.");case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"disableAllVideo",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(qp.info("DyteParticipants::disable_all_video"),this.roomJoined){e.next=2;break}throw new Jp("Can`t disable all video without joining room");case 2:if(!Qo(this,ww).permissions.canAllowParticipantVideo){e.next=4;break}return e.abrupt("return",Qo(this,kw,bw).muteAllVideo());case 4:throw qp.error("DyteParticipants::unauthorized_disable_all_video"),new Jp("Unauthorized: User does not have permission to disable peer video.");case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"disableAudio",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.joined.get(t).disableAudio();case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"disableVideo",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.joined.get(t).disableVideo();case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"kick",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.joined.get(t).kick();case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"kickAll",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(qp.info("DyteParticipants::kick_all"),this.roomJoined){e.next=2;break}throw new Jp("Can`t kick all without joining room");case 2:if(!Qo(this,ww).permissions.kickParticipant){e.next=4;break}return e.abrupt("return",Qo(this,kw,bw).kickAll());case 4:throw qp.error("DyteParticipants::unauthorized_kick_all"),new Jp("Unauthorized: User does not have permission to kick peers.");case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"broadcastMessage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(qp.info("DyteParticipants::broadcastMessage"),this.roomJoined){e.next=2;break}throw new Jp("Can`t broadcast message without joining room");case 2:if(null!=t&&t.trim()){e.next=4;break}throw new Jp("`type` must be a non-empty string.");case 4:Qo(this,kw,bw).broadcastMessage(t,n);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"acceptAllRequestToJoinStageRequests",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.roomJoined){e.next=2;break}throw new Jp("Can`t acceptAllRequestToJoinStageRequests without joining room");case 2:Qo(this,kw,bw).acceptAllRequestToJoinStage(t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(yp),kw=new WeakSet,bw=function(){return Lb()},ww=new WeakMap,_w);Cw([Gp.trace("DyteParticipants.setViewMode")],Rw.prototype,"setViewMode",1),Cw([Gp.trace("DyteParticipants.setPage")],Rw.prototype,"setPage",1),Cw([Gp.trace("DyteParticipants.disableAllAudio")],Rw.prototype,"disableAllAudio",1),Cw([Gp.trace("DyteParticipants.disableAllVideo")],Rw.prototype,"disableAllVideo",1),Cw([Gp.trace("DyteParticipants.disablePeerAudio")],Rw.prototype,"disableAudio",1),Cw([Gp.trace("DyteParticipants.disablePeerVideo")],Rw.prototype,"disableVideo",1),Cw([Gp.trace("DyteParticipants.kickPeer")],Rw.prototype,"kick",1),Cw([Gp.trace("DyteParticipants.kickAll")],Rw.prototype,"kickAll",1),Cw([Gp.trace("DyteParticipants.broadcastMessage")],Rw.prototype,"broadcastMessage",1),Cw([Gp.trace("DyteParticipants.acceptAllRequestToJoinStageRequests")],Rw.prototype,"acceptAllRequestToJoinStageRequests",1),Rw=Cw([Yp((function(e){throw new Jp(e.message,"1200")}))],Rw);var Pw,Iw,Ow,Dw,Mw,Aw=Object.defineProperty,Nw=Object.getOwnPropertyDescriptor,Lw=function(e,t,n,r){for(var a,i=r>1?void 0:r?Nw(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Aw(t,n,i),i},jw=function(){function e(t){(0,y.Z)(this,e),Xo(this,Dw),Ko(this,"participants"),Xo(this,Pw,void 0),Xo(this,Iw,void 0),Xo(this,Ow,new Set),this.participants=new Rw(t),Yo(this,Iw,new Map),Yo(this,Pw,t),this.setupEvents()}return(0,k.Z)(e,[{key:"roomJoined",get:function(){var e;return!0===(null==(e=Qo(this,Dw,Mw))?void 0:e.roomJoined)}},{key:"updatePageParticipants",value:function(e){var t=this,n=new Set(e),r=new Map(this.participants.active);if(this.participants.active.forEach((function(e,r){t.participants.active.delete(r,!n.has(r))})),n.forEach((function(e){t.participants.joined.get(e)?t.participants.active.add(t.participants.joined.get(e),!r.get(e)):qp.warn("updatePageParticipants::participant_not_in_joined_list",{peerId:e})})),Qo(this,Dw,Mw)instanceof ry){Array.from(r.keys()).forEach((function(e){if(!n.has(e)){var r=t.participants.joined.get(e);if(r){var a={producers:r.producers,peerId:r.id};Qo(t,Dw,Mw).deactivatePeers(a)}}}));var a=[];this.participants.active.forEach((function(e){var t={peerId:e.id,producers:e.producers};a.push(t)})),Qo(this,Dw,Mw).activatePeers(a)}}},{key:"updatePinnedParticipants",value:function(){var e=this;this.participants.pinned.forEach((function(t){t.setIsPinned(!1),e.participants.pinned.delete(t.id)}))}},{key:"refreshGridParticipants",value:function(){var e=this,t=(0,o.Z)(this.participants.joined.keys()),n=this.participants.selectedPeers.peers;if("ACTIVE_GRID"===this.participants.viewMode){var r=this.participants.maxActiveParticipantsCount-1,a=new Set(n.filter((function(t){return t!==Qo(e,Pw).id}))),i=(0,o.Z)(a),s=r-a.size;if(s>=0){qp.debug("ParticipantController::refreshGridParticipants::adding_peers",{peersToAdd:s});var c=t.filter((function(t){return!a.has(t)&&t!==Qo(e,Pw).id})).slice(0,s);i=(0,o.Z)(a).concat(c)}else i=i.slice(0,r);this.updateActiveParticipantsHiveNode(i)}else qp.warn("ParticipantController::refreshGridParticipants::not_refreshing_grid_in_not_active_grid_mode")}},{key:"updateActiveParticipantsHiveNode",value:function(e){var t=this;if(this.roomJoined){var n=Array.from(this.participants.active.keys()),r=new Map(this.participants.active),a={};e.forEach((function(e){a[e]=!0}));var i=[];n.forEach((function(e,n){(!a[e]||!t.participants.joined.get(e))&&i.push(n)})),e.forEach((function(t){r.get(t)||(n.length<e.length?n.push(t):n[i.shift()]=t)})),n.forEach((function(e,t){a[e]||n.splice(t,1)})),Array.from(this.participants.active.keys()).forEach((function(e){t.participants.active.delete(e,!a[e])})),n.forEach((function(e){t.participants.joined.get(e)?t.participants.active.add(t.participants.joined.get(e),!r.get(e)):qp.warn("updateActiveParticipants::participant_not_in_joined_list",{peerId:e})})),this.updateWebinarStatusForJoinedParticipants(e),this.participants.active.emit("participantsUpdate"),qp.info("ParticipantController::updateActiveParticipants::updating_current_selected_peers");var o=[];if(Qo(this,Ow).forEach((function(t){e.includes(t)||o.push(t)})),Yo(this,Ow,new Set(e)),Qo(this,Dw,Mw)instanceof ry){var s=[];o.forEach((function(e){var n=t.participants.joined.get(e);if(n){var r={producers:n.producers,peerId:n.id};s.push(Qo(t,Dw,Mw).deactivatePeers(r))}})),Promise.all(s).then((function(){var e=[];t.participants.active.forEach((function(t){var n={peerId:t.id,producers:t.producers};e.push(n)})),Qo(t,Dw,Mw).activatePeers(e)})).catch((function(e){qp.info("Error on deactivating peers",e)}))}}else qp.warn("Skipped::ParticipantController::updateActiveParticipants",{peerIds:JSON.stringify(e),roomJoined:this.roomJoined})}},{key:"updateActiveParticipants",value:function(e){var t=this;if(this.roomJoined){var n=Array.from(this.participants.active.keys()),r=new Map(this.participants.active),a={};e.forEach((function(e){a[e]=!0}));var i=[];n.forEach((function(e,n){(!a[e]||!t.participants.joined.get(e))&&i.push(n)})),e.forEach((function(t){r.get(t)||(n.length<e.length?n.push(t):n[i.shift()]=t)})),n.forEach((function(e,t){a[e]||n.splice(t,1)})),Array.from(this.participants.active.keys()).forEach((function(e){t.participants.active.delete(e,!a[e])})),n.forEach((function(e){t.participants.joined.get(e)?t.participants.active.add(t.participants.joined.get(e),!r.get(e)):qp.warn("updateActiveParticipants::participant_not_in_joined_list",{peerId:e})})),this.updateWebinarStatusForJoinedParticipants(e),this.participants.active.emit("participantsUpdate")}else qp.warn("Skipped::ParticipantController::updateActiveParticipants",{peerIds:JSON.stringify(e),roomJoined:this.roomJoined})}},{key:"updateActiveParticipantsWithPriorities",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.roomJoined?(e.forEach((function(e){t.participants.joined.get(e.peerId)&&t.participants.selectedPeers.add(e.peerId,e.priority)})),n&&this.refreshGridParticipants()):qp.warn("Skipped::ParticipantController::updateActiveParticipantsWithPriorities",{entries:JSON.stringify(e),roomJoined:this.roomJoined})}},{key:"setupEvents",value:function(){var e=this;vf.on(ff.PEER_JOINED,function(){var t=(0,d.Z)((0,l.Z)().mark((function t(n){var r,a,i,o;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=new gw(n,Qo(e,Pw)),t.t0=Qo(e,Pw).id!==o.id&&!(null!=(r=n.flags)&&r.recorder)&&!(null!=(a=o.flags)&&a.hidden_participant)&&!(null!=(i=o.flags)&&i.hiddenParticipant),!t.t0){t.next=13;break}if(e.participants.joined.add(o),e.participants.waitlisted.delete(o.id),t.t1=e.participants.currentPage===e.participants.pageCount&&Qo(e,Dw,Mw)instanceof Ob,!t.t1){t.next=13;break}return t.t2=vf,t.t3=ff.GET_PAGE,t.next=11,Qo(e,Dw,Mw).getPage(e.participants.currentPage);case 11:t.t4=t.sent.payload,t.t2.emit.call(t.t2,t.t3,t.t4);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),vf.on(ff.WAITLIST_PEER_ADDED,(function(t){var n=t.id,r=t.name;e.participants.waitlisted.add(new gw({id:n,displayName:r,audioMuted:!0,videoEnabled:!1,audioTrack:void 0,videoTrack:void 0,userId:void 0,flags:{},isHost:!1},Qo(e,Pw)))})),vf.on(ff.WAITLIST_PEER_REMOVED,(function(t){var n=t.id;e.participants.waitlisted.delete(n)})),vf.on(ff.ROOM_JOINED,(function(t){Qo(e,Dw,Mw)instanceof ry&&e.participants.joined.clear(),t.peers.forEach((function(n){var r,a,i;if(!(null!=(r=n.flags)&&r.recorder||null!=(a=n.flags)&&a.hidden_participant||null!=(i=n.flags)&&i.hiddenParticipant)){var o=new gw(n,Qo(e,Pw));o.id===t.pinnedPeerId&&(o.setIsPinned(!0,!1),e.participants.pinned.add(o)),e.participants.joined.add(o)}})),t.requestToJoinPeersList&&t.requestToJoinPeersList.forEach((function(t){var n,r=t.id;null==(n=e.participants.joined.get(r))||n.setWebinarStageStatus(Kb.REQUESTED_TO_JOIN_STAGE)})),Qo(e,Dw,Mw)instanceof Ob&&Qo(e,Dw,Mw).getPage(e.participants.currentPage)})),vf.on(ff.PEER_CLOSED,function(){var t=(0,d.Z)((0,l.Z)().mark((function t(n){var r,a,i,o,s,c,u;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.id,e.participants.joined.delete(r,!0,!0),e.participants.pinned.delete(r,!0,!0),!(Qo(e,Dw,Mw)instanceof ry&&(e.participants.selectedPeers.delete(r),e.participants.active.get(r)&&0===e.participants.currentPage))){t.next=4;break}return e.refreshGridParticipants(),t.abrupt("return");case 4:if(a=e.participants.currentPage,i=Qo(e,Pw).config.maxVideoStreams,o=(zp.isMobile()?i.mobile:i.desktop)*(a-1),s=e.participants.active.get(r),0!==o){t.next=9;break}e.participants.setViewMode("ACTIVE_GRID"),t.next=25;break;case 9:if(!(e.participants.joined.size<=o)){t.next=13;break}2===a?e.participants.setViewMode("ACTIVE_GRID"):e.participants.setPage(a-1),t.next=25;break;case 13:if(!s){t.next=25;break}if(u=[],!(Qo(e,Dw,Mw)instanceof Ob)){t.next=23;break}return t.next=18,Qo(e,Dw,Mw).getPage(a);case 18:c=t.sent.payload,u=c.peerIds,t.next=24;break;case 23:u=e.participants.getPeerIdsForCurrentPage();case 24:vf.emit(ff.GET_PAGE,{peerIds:u});case 25:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),vf.on(ff.ROOM_NODE_DISCONNECTED,(function(){Array.from(e.participants.joined.keys()).forEach((function(t){e.participants.joined.delete(t)})),Array.from(e.participants.active.keys()).forEach((function(t){e.participants.active.delete(t)})),Array.from(e.participants.pinned.keys()).forEach((function(t){e.participants.pinned.delete(t)})),e.participants.currentPage=0,e.participants.viewMode="ACTIVE_GRID",e.participants.emit("viewModeChanged",{viewMode:"ACTIVE_GRID",currentPage:e.participants.currentPage,pageCount:e.participants.pageCount})})),vf.on(ff.PEER_MUTED,(function(t){var n=t.peerId,r=e.participants.joined.get(n);r&&r.setAudioEnabled(!1)})),vf.on(ff.PEER_UNMUTED,(function(t){var n=t.peerId,r=e.participants.joined.get(n);r&&r.setAudioEnabled(!0)})),vf.on(ff.CONSUMER_PAUSED,(function(t){var n=t.id;e.processConsumerPaused(n)})),vf.on(ff.CONSUMER_RESUMED,(function(t){var n=t.id;e.processConsumerResumed(n)})),vf.on(ff.NEW_CONSUMER,(function(t){var n=t.id;e.processNewConsumer(n)})),vf.on(ff.CONSUMER_CLOSED,(function(t){var n=t.id;e.processConsumerClosed(n)})),vf.on(ff.GET_PAGE,(function(t){var n=t.peerIds;"PAGINATED"===e.participants.viewMode&&e.updatePageParticipants(n)})),vf.on(ff.SELECTED_PEERS,(function(t){var n=t.peerIds,r=t.compulsoryPeers;if("ACTIVE_GRID"===e.participants.viewMode)if(Qo(e,Dw,Mw)instanceof Ob)e.updateActiveParticipants(n);else{var a=n.map((function(e,t){return{peerId:e,priority:t+1}})),i=null==r?void 0:r.map((function(e,t){return{peerId:e,priority:-(t+1)}}));a.push.apply(a,(0,o.Z)(null!=i?i:[])),a.length>0&&e.updateActiveParticipantsWithPriorities(a)}})),vf.on(ff.SELECTED_PEERS_DIFF,(function(t){var n=t.entries;"ACTIVE_GRID"===e.participants.viewMode&&e.updateActiveParticipantsWithPriorities(n,!0)})),vf.on(ff.REFRESH_GRID,(function(){"ACTIVE_GRID"===e.participants.viewMode&&e.refreshGridParticipants()})),vf.on(ff.NEW_PRODUCER,(function(t){var n=t.peerId,r=t.producer,a=e.participants.joined.get(n);a?(a.producers.push(r),qp.info("ParticipantController::NEW_PRODUCER::producer_added_to_participant",{producerKind:r.kind}),"audio"===r.kind||r.screenShare||Qo(e,Ow).has(n)?Qo(e,Dw,Mw).createConsumer({producingPeerId:n,producerId:r.producerId,screenShare:r.screenShare}):qp.info("ParticipantController::NEW_PRODUCER::not_consuming_producer",{peerId:n,producerKind:r.kind})):qp.warn("ParticipantController::NEW_PRODUCER::participant_not_found",{peerId:n,producerKind:r.kind})})),vf.on(ff.PRODUCER_CLOSED,(function(t){var n=t.peerId,r=t.producerId,a=e.participants.joined.get(n);a?a.producers=a.producers.filter((function(e){return e.producerId!==r})):qp.warn("ParticipantController::NEW_PRODUCER::participant_not_found",{peerId:n})})),vf.on(ff.PRODUCER_TOGGLE,(function(t){var n=t.peerId,r=t.producerId,a=t.paused,i=t.kind,o=e.participants.joined.get(n);if(o&&"audio"===i){o.setAudioEnabled(!a);var s=o.producers.find((function(e){return e.producerId===r}));s&&(s.pause=a)}})),vf.on(ff.ACTIVE_SPEAKER,(function(t){var n=t.peerId,r=t.volume;e.participants.lastActiveSpeaker=n,e.participants.emit("activeSpeaker",{peerId:n,volume:r})})),vf.on(ff.ROOM_MESSAGE,function(){var t=(0,d.Z)((0,l.Z)().mark((function t(n){var r,a;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=n.payload,a=n.type,e.participants.emit("broadcastedMessage",{type:a,payload:r});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),vf.on(ff.LOW_CONSUMER_SCORE,(function(t){var n=t.peerId,r=t.score,a=t.kind,i=e.participants.joined.get(n);i&&(i.emit("poorConnection",{score:r,kind:a}),e.participants.emit("poorConnection",{participantId:n,score:r,kind:a}))})),vf.on(ff.CONSUMER_SCORE_UPDATE,(function(t){var n,r=t.score,a=t.kind,i=t.appData,o=t.peerId,s="video"===a&&null!=(n=null==i?void 0:i.screenShare)&&n,c=e.participants.joined.get(o);c&&(c.emit("mediaScoreUpdate",{kind:a,isScreenshare:s,score:r,participantId:o}),e.participants.emit("mediaScoreUpdate",{kind:a,isScreenshare:s,score:r,participantId:o}))})),vf.on(ff.PEER_PINNED,(function(t){var n=t.peerId;if(!n)return Qo(e,Pw).isPinned&&Qo(e,Pw).setIsPinned(!1),void(0!==e.participants.pinned.size&&e.updatePinnedParticipants());if(n===Qo(e,Pw).id)return 0!==e.participants.pinned.size&&e.updatePinnedParticipants(),void Qo(e,Pw).setIsPinned(!0);var r=e.participants.joined.get(n);Qo(e,Pw).isPinned&&Qo(e,Pw).setIsPinned(!1),e.updatePinnedParticipants(),r.setIsPinned(!0),e.participants.pinned.add(r),Qo(e,Dw,Mw)instanceof ry&&Qo(e,Dw,Mw).activatePeers([{peerId:r.id,producers:r.producers}]).catch((function(e){qp.error("unable to create consumers",{error:{name:e.name,message:e.message}})}))})),vf.on(ff.PEER_REQUESTED_TO_JOIN_STAGE,(function(t){var n=t.id,r=e.participants.joined.get(n);null==r||r.setWebinarStageStatus(Kb.REQUESTED_TO_JOIN_STAGE)})),vf.on(ff.PEER_REJECTED_TO_JOIN_STAGE,(function(t){var n=t.id,r=e.participants.joined.get(n);null==r||r.setWebinarStageStatus(Kb.OFF_STAGE)})),vf.on(ff.PEER_ADDED_TO_STAGE,(function(t){var n=t.id,r=e.participants.joined.get(n);null==r||r.setWebinarStageStatus(Kb.ACCEPTED_TO_JOIN_STAGE)})),vf.on(ff.PEER_REMOVED_FROM_STAGE,(function(t){var n=t.id,r=e.participants.joined.get(n);null==r||r.setWebinarStageStatus(Kb.OFF_STAGE)})),vf.on(ff.PEER_STARTED_PRESENTING,(function(t){var n=t.id,r=e.participants.joined.get(n);null==r||r.setWebinarStageStatus(Kb.ON_STAGE)})),vf.on(ff.PEER_STOPPED_PRESENTING,(function(t){var n=t.id,r=e.participants.joined.get(n);null==r||r.setWebinarStageStatus(Kb.OFF_STAGE)})),vf.on(ff.ROOM_MESSAGE,(function(t){var n=t.roomMessageType,r=t.kind,a=t.score,i=t.peerId;if("producerScoreBroadcast"===n){var o=e.participants.joined.get(i);null==o||o.setMediaScore(a,r)}}))}},{key:"processMedia",value:function(e){var t,n=null!=(t=Qo(this,Dw,Mw).getConsumers().get(e))?t:{},r=n.peerId,a=n.kind,i=n.appData,o=n.remotelyPaused,s=n.track;if(!r)return qp.warn("processMedia::Peer ID is undefined",{consumerId:e}),{};var c=i;return qp.info("ParticipantController::processMedia",{consumerId:e,peerId:r,kind:a,appData:c,remotelyPaused:o}),Qo(this,Iw).set(e,{type:a,peerId:r,appData:c}),{peerId:r,kind:a,appData:c,remotelyPaused:o,track:s}}},{key:"processConsumerClosed",value:function(e){var t=Qo(this,Iw).get(e)||{},n=t.peerId,r=t.type,a=t.appData,i=this.participants.joined.get(n);if(qp.info("ParticipantController::processConsumerClosed",{consumerId:e,peerId:n,type:r,appData:a}),Qo(this,Iw).delete(e),i){if(a&&a.screenShare)return i.setScreenShareEnabled(!1),Lc.consumerSharedMediaState(e,{screen:!1}),void(i.screenShareTracks={audio:void 0,video:void 0});"audio"===r?(i.setAudioEnabled(!1),Lc.consumerSharedMediaState(e,{audio:!1}),i.audioTrack=void 0):"video"===r&&(i.setVideoEnabled(!1),Lc.consumerSharedMediaState(e,{video:!1}),i.videoTrack=void 0)}}},{key:"processConsumerResumed",value:function(e){var t=this.processMedia(e),n=t.peerId,r=t.kind,a=t.appData,i=t.track;if(n){qp.info("ParticipantController::processConsumerResumed",{consumerId:e,peerId:n,kind:r,appData:a});var o=this.participants.joined.get(n);if(o){if(a.screenShare)return"video"===r?o.screenShareTracks.video=i:"audio"===r&&(o.screenShareTracks.audio=i),o.setScreenShareEnabled(!0),void Lc.consumerSharedMediaState(e,{screen:!0});"video"===r?(o.videoTrack=i,o.setVideoEnabled(!0),Lc.consumerSharedMediaState(e,{video:!0})):"audio"===r&&(o.audioTrack=i,o.setAudioEnabled(o.audioEnabled),Lc.consumerSharedMediaState(e,{audio:o.audioEnabled}))}}}},{key:"processConsumerPaused",value:function(e){qp.info("ParticipantController::processConsumerPaused",{consumerId:e});var t=this.processMedia(e),n=t.peerId,r=t.kind,a=t.track,i=t.appData;if(n){qp.info("ParticipantController::processConsumerPaused",{consumerId:e,peerId:n,kind:r,appData:i});var o=this.participants.joined.get(n);o&&("video"===r?(o.videoTrack=a,o.setVideoEnabled(!1),Lc.consumerSharedMediaState(e,{video:!1})):"audio"===r&&(o.audioTrack=a,o.setAudioEnabled(o.audioEnabled),Lc.consumerSharedMediaState(e,{audio:o.audioEnabled})))}}},{key:"processNewConsumer",value:function(e){var t=this.processMedia(e),n=t.peerId,r=t.kind,a=t.remotelyPaused,i=t.track,o=t.appData;if(n){qp.info("ParticipantController::processNewConsumer",{consumerId:e,peerId:n,kind:r,remotelyPaused:a,appData:o,trackId:i.id});var s=this.participants.joined.get(n);if(s){if(o.screenShare)return"video"===r?s.screenShareTracks.video=i:"audio"===r&&(s.screenShareTracks.audio=i),a||s.setScreenShareEnabled(!0),void(o.supportsRemoteControl&&(s.supportsRemoteControl=!0));"video"===r?(s.videoTrack=i,a||s.setVideoEnabled(!0),Lc.consumerSharedMediaState(e,{video:!a})):"audio"===r&&Qo(this,Dw,Mw)instanceof ry&&(s.audioTrack=i,a||s.setAudioEnabled(!0),Lc.consumerSharedMediaState(e,{audio:!a}))}}}},{key:"updateWebinarStatusForJoinedParticipants",value:function(e){var t=this;e.forEach((function(e){var n=t.participants.joined.get(e);n&&(n.webinarStageStatus=Kb.ON_STAGE)}))}}]),e}();Pw=new WeakMap,Iw=new WeakMap,Ow=new WeakMap,Dw=new WeakSet,Mw=function(){return Lb()},Lw([Gp.trace("ParticipantController.updatePageParticipants")],jw.prototype,"updatePageParticipants",1),Lw([Gp.trace("ParticipantController.setupEvents")],jw.prototype,"setupEvents",1),Lw([Gp.trace("ParticipantController.processMedia")],jw.prototype,"processMedia",1),Lw([Gp.trace("ParticipantController.processConsumerClosed")],jw.prototype,"processConsumerClosed",1),Lw([Gp.trace("ParticipantController.processConsumerResumed")],jw.prototype,"processConsumerResumed",1),Lw([Gp.trace("ParticipantController.processConsumerPaused")],jw.prototype,"processConsumerPaused",1),Lw([Gp.trace("ParticipantController.processNewConsumer")],jw.prototype,"processNewConsumer",1);var Fw,Uw,Bw,Vw,Hw,zw=Object.defineProperty,Ww=Object.getOwnPropertyDescriptor,Gw=(Hw=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e,r,a,i){var o;return(0,y.Z)(this,n),o=t.call(this),Xo((0,v.Z)(o),Fw),Xo((0,v.Z)(o),Bw,void 0),Xo((0,v.Z)(o),Vw,void 0),Ko((0,v.Z)(o),"viewType"),Ko((0,v.Z)(o),"meetingStartedTimestamp"),Ko((0,v.Z)(o),"meetingTitle"),Yo((0,v.Z)(o),Bw,e),o.viewType=r,Yo((0,v.Z)(o),Vw,a),o.meetingTitle=i,o}return(0,k.Z)(n,[{key:"joined",get:function(){var e;return null==(e=Qo(this,Fw,Uw))?void 0:e.roomJoined}},{key:"roomName",get:function(){var e;return null==(e=Qo(this,Fw,Uw))?void 0:e.roomName}},{key:"socketConnected",get:function(){return Qo(this,Vw).isConnected}}]),n}(yp),Fw=new WeakSet,Uw=function(){return Lb()},Bw=new WeakMap,Vw=new WeakMap,Hw);Gw=function(e,t,n,r){for(var a,i=r>1?void 0:r?Ww(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&zw(t,n,i),i}([Yp((function(e){throw new Jp(e.message,"0800")}))],Gw);var qw=Object.defineProperty,$w=Object.getOwnPropertyDescriptor,Kw=function(){function e(t,n,r){(0,y.Z)(this,e),Ko(this,"meta"),this.meta=new Gw(n,av.isV2AuthToken?n.config.viewType:n.permissions.viewType,t,r),this.setupEvents()}return(0,k.Z)(e,[{key:"roomName",get:function(){return this.meta.roomName}},{key:"setupEvents",value:function(){var e=this;vf.on(ff.ROOM_JOINED,(function(t){t.startedAt&&(e.meta.meetingStartedTimestamp=new Date(t.startedAt))})),vf.on(ff.ROOM_STATE,(function(t){var n=t.createdAt,r=e.meta.meetingStartedTimestamp;if(n&&!r){var a=new Date(1e3*n);e.meta.meetingStartedTimestamp=a}})),vf.on(ff.ROOM_NODE_CONNECTED,(function(){e.meta.emit("connected")})),vf.on(ff.ROOM_NODE_DISCONNECTED,(function(){e.meta.emit("disconnected")})),vf.on(ff.ICE_CONNECTED,(function(t){var n=t.transport;e.meta.emit("iceConnected",{transport:n})})),vf.on(ff.ICE_DISCONNECTED,(function(t){var n=t.transport;e.meta.emit("iceDisconnected",{transport:n})})),vf.on(ff.ICE_RECONNECTING,(function(t){var n=t.transport;e.meta.emit("iceReconnecting",{transport:n})})),vf.on(ff.ICE_FAILED,(function(t){var n=t.transport;e.meta.emit("iceFailed",{transport:n})})),vf.on(ff.PRODUCER_SCORE_UPDATE,(function(t){var n=t.score;n<5&&e.meta.emit("poorConnection",{score:n})})),vf.on(ff.SOCKET_SERVICE_CONNECTED,(function(){e.meta.emit("socketConnected")})),vf.on(ff.SOCKET_SERVICE_DISCONNECTED,(function(){e.meta.emit("socketDisconnected")})),vf.on(ff.SOCKET_SERVICE_RECONNECTING,(function(){e.meta.emit("socketReconnecting")})),vf.on(ff.SOCKET_SERVICE_RECONNECTION_ATTEMPT,(function(t){var n=t.attempt;e.meta.emit("socketReconnectAttempt",{attempt:n})})),vf.on(ff.SOCKET_SERVICE_RECONNECT_FAILURE,(function(t){var n=t.attempt;e.meta.emit("socketReconnectFailure",{attempt:n})})),vf.on(ff.SOCKET_SERVICE_RECONNECTED,(function(){e.meta.emit("socketReconnected")})),vf.on(ff.SOCKET_SERVICE_FAILED,(function(){e.meta.emit("socketFailure")})),vf.on(ff.ROOM_NODE_CONNECTION_ERROR,(function(t){t.message.match(/room '([a-z0-9-]+)' not found/i)&&e.meta.emit("connectionError",{reason:"ROOM_NOT_FOUND"})}))}}]),e}();!function(e,t,n,r){for(var a,i=r>1?void 0:r?$w(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);r&&i&&qw(t,n,i)}([Gp.trace("MetaController.setupEvents")],Kw.prototype,"setupEvents",1);var Jw,Qw,Xw,Yw,e_,t_,n_,r_,a_,i_=Object.defineProperty,o_=Object.getOwnPropertyDescriptor,s_=14,c_=15,u_=16,l_=17,d_=18,p_=19,f_=20,h_=22,v_=23,m_=24,g_=(a_=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e,r,a,i,o,s){var c,u=e.baseURL,l=e.createdAt,d=e.description,p=e.id,f=e.name,h=e.organizationId,m=e.picture,g=e.private,k=e.published,b=e.staggered,w=e.tags,_=e.type,S=e.updatedAt;return(0,y.Z)(this,n),c=t.call(this),Xo((0,v.Z)(c),n_),Xo((0,v.Z)(c),Jw,void 0),Xo((0,v.Z)(c),Qw,void 0),Ko((0,v.Z)(c),"baseURL"),Ko((0,v.Z)(c),"createdAt"),Ko((0,v.Z)(c),"description"),Ko((0,v.Z)(c),"id"),Ko((0,v.Z)(c),"name"),Xo((0,v.Z)(c),Xw,void 0),Xo((0,v.Z)(c),Yw,void 0),Xo((0,v.Z)(c),e_,void 0),Ko((0,v.Z)(c),"organizationId"),Ko((0,v.Z)(c),"picture"),Ko((0,v.Z)(c),"private"),Ko((0,v.Z)(c),"published"),Ko((0,v.Z)(c),"staggered"),Ko((0,v.Z)(c),"tags"),Ko((0,v.Z)(c),"type"),Ko((0,v.Z)(c),"updatedAt"),Ko((0,v.Z)(c),"config"),Xo((0,v.Z)(c),t_,void 0),Ko((0,v.Z)(c),"active"),Ko((0,v.Z)(c),"iframes"),Ko((0,v.Z)(c),"enabledBy"),c.baseURL=u,c.createdAt=new Date(l),c.description=d,c.id=p,c.name=f,Yo((0,v.Z)(c),Xw,i),c.organizationId=h,c.picture=m,c.private=g,c.published=k,c.staggered=b,c.tags=w,c.type=_,c.updatedAt=new Date(S),c.active=!1,c.iframes=new Map,Yo((0,v.Z)(c),Jw,r),Yo((0,v.Z)(c),Qw,a),Yo((0,v.Z)(c),Yw,o),Yo((0,v.Z)(c),e_,s),c.enabledBy="",c}return(0,k.Z)(n,[{key:"roomJoined",get:function(){var e;return!0===(null==(e=Qo(this,n_,r_))?void 0:e.roomJoined)}},{key:"sendIframeEvent",value:function(e){var t=this;this.iframes.size&&(0,o.Z)(this.iframes.keys()).forEach((function(n){var r=t.iframes.get(n).iframe;r&&r.contentWindow.postMessage(e,"*")}))}},{key:"handleIframeMessage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,c,u,d,p,f,h,v,m,g,y,k,b,w,_,S,E,T,x,Z,C,R,P,I,O,D,M,A,N=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("socket-service"!==Qo(this,Qw)){e.next=54;break}u=(c=t).payload,d=c.uuid,p=c.type,e.t0=p,e.next=e.t0===kg.customPluginEventToRoom?5:e.t0===kg.customPluginEventToPeers?7:e.t0===kg.enablePluginForRoom?9:e.t0===kg.enablePluginForPeers?11:e.t0===kg.disablePluginForRoom?13:e.t0===kg.disablePluginForPeers?15:e.t0===kg.storeInsertKeys?17:e.t0===kg.storeGetKeys?19:e.t0===kg.storeDeleteKeys?21:e.t0===kg.storeDelete?23:e.t0===u_?25:e.t0===s_?39:e.t0===c_?42:e.t0===p_?45:e.t0===d_?47:e.t0===l_?49:e.t0===f_?51:53;break;case 5:return Qo(this,Jw).customPluginEventToRoom(this.id,u,d),e.abrupt("break",53);case 7:return Qo(this,Jw).customPluginEventToPeers(this.id,u,u.peerIds,d),e.abrupt("break",53);case 9:return Qo(this,Jw).enablePluginForRoom(this.id,d),e.abrupt("break",53);case 11:return Qo(this,Jw).enablePluginForPeers(this.id,u.peerIds,d),e.abrupt("break",53);case 13:return Qo(this,Jw).disablePluginForRoom(this.id,d),e.abrupt("break",53);case 15:return Qo(this,Jw).disablePluginForPeers(this.id,u.peerIds,d),e.abrupt("break",53);case 17:return Qo(this,Jw).storeInsertKeys(this.id,u.store,u.insertKeys,d),e.abrupt("break",53);case 19:return Qo(this,Jw).storeGetKeys(this.id,u.store,u.getKeys,d),e.abrupt("break",53);case 21:return Qo(this,Jw).storeDeleteKeys(this.id,u.store,u.deleteKeys,d),e.abrupt("break",53);case 23:return Qo(this,Jw).storeDelete(this.id,u.store,d),e.abrupt("break",53);case 25:if(f=u.messagePayload,h=u.peerIds,Qo(this,e_)){e.next=29;break}return this.sendIframeEvent({type:u_,uuid:c.uuid,payload:{error:"Chat is disabled for this room."}}),e.abrupt("return");case 29:return e.prev=29,e.next=32,Qo(this,e_).sendMessage(f,h);case 32:this.sendIframeEvent({type:u_,uuid:c.uuid,payload:{success:!0}}),e.next=38;break;case 35:e.prev=35,e.t1=e.catch(29),this.sendIframeEvent({type:u_,uuid:c.uuid,payload:{error:e.t1}});case 38:return e.abrupt("break",53);case 39:return m=u.peerId,g=(0,s.Z)((0,s.Z)({},Qo(this,Xw)),{},{isRecorder:null==(n=Qo(this,Xw).permissions)?void 0:n.isRecorder}),m?(v=Qo(this,Yw).joined.get(u.peerId),Qo(this,Xw).id===m&&(v=g)):v=g,this.sendIframeEvent({type:s_,payload:{peer:v&&Cf(v)},uuid:c.uuid}),e.abrupt("break",53);case 42:return y=Qo(this,Yw).joined.toArray().map((function(e){return Cf(e)})),this.sendIframeEvent({type:c_,payload:{peers:y},uuid:c.uuid}),e.abrupt("break",53);case 45:return this.sendIframeEvent({type:p_,payload:{enabledBy:this.enabledBy},uuid:c.uuid}),e.abrupt("break",53);case 47:return this.sendIframeEvent({type:d_,payload:{displayTitle:Qo(this,n_,r_).meetingTitle},uuid:c.uuid}),e.abrupt("break",53);case 49:return this.sendIframeEvent({type:l_,payload:{roomName:Qo(this,n_,r_).roomName},uuid:c.uuid}),e.abrupt("break",53);case 51:return this.emit(c.payload.eventName,c.payload.data),e.abrupt("break",53);case 53:return e.abrupt("return");case 54:k=function(e,t){return Qo(N,Xw).userId===e?Qo(N,Xw).id:(t.forEach((function(t){t.userId===e&&(n=t.id)})),n);var n},b=t,e.t2=b.type,e.next="pluginEvent"===e.t2||"storePluginData"===e.t2||"getPluginData"===e.t2||"enablePluginForAll"===e.t2||"enablePluginForUser"===e.t2||"disablePluginForUser"===e.t2||"chatMessage"===e.t2?58:"getJoinedPeers"===e.t2?63:"getPeerInfo"===e.t2?68:"getRoomState"===e.t2?73:"getPluginInitiatorId"===e.t2?79:"getPluginInitiatorUserId"===e.t2?85:"pluginEventToParent"===e.t2?91:"toggleViewMode"===e.t2?93:95;break;case 58:return e.next=60,Qo(this,n_,r_).sendMessage(b);case 60:return o=e.sent,this.sendIframeEvent(o),e.abrupt("break",95);case 63:return e.next=65,Qo(this,n_,r_).getRoomState();case 65:return o=e.sent,this.sendIframeEvent({type:"websocket/get-joined-peers",payload:(0,s.Z)((0,s.Z)({},b.payload),{},{peers:o.payload.roomState.peers})}),e.abrupt("break",95);case 68:return e.next=70,Qo(this,n_,r_).sendMessage({type:b.type,payload:(0,s.Z)((0,s.Z)({},b.payload),{},{peerId:null!=(a=null==(r=b.payload)?void 0:r.peerId)?a:Qo(this,Xw).id})});case 70:return o=e.sent,this.sendIframeEvent(o),e.abrupt("break",95);case 73:return e.next=75,Qo(this,n_,r_).getRoomState();case 75:return o=e.sent,w=o.payload.roomState,_=w.plugins,S=w.peers,E=_.find((function(e){return e.id===N.id})),T=E.enabledBy,x=k(T,S),this.sendIframeEvent({type:"websocket/get-room-state",payload:(0,s.Z)((0,s.Z)({},b.payload),{},{roomName:o.payload.roomState.roomName,pluginInitiatorPeerId:x,pluginInitiatorUserId:T,peers:o.payload.roomState.peers,displayTitle:o.payload.roomState.displayTitle,roomUUID:o.payload.roomState.roomUUID,currentPeer:Qo(this,Xw).id,isRecorder:null==(i=Qo(this,Xw).permissions)?void 0:i.isRecorder})}),e.abrupt("break",95);case 79:return e.next=81,Qo(this,n_,r_).getRoomState();case 81:return o=e.sent,Z=o.payload.roomState,C=Z.plugins,R=Z.peers,P=C.find((function(e){return e.id===N.id})),I=P.enabledBy,O=k(I,R),this.sendIframeEvent({type:"websocket/get-plugin-initiator-peer-id",payload:(0,s.Z)((0,s.Z)({},b.payload),{},{pluginInitiatorPeerId:O})}),e.abrupt("break",95);case 85:return e.next=87,Qo(this,n_,r_).getRoomState();case 87:return o=e.sent,D=o.payload.roomState.plugins,M=D.find((function(e){return e.id===N.id})),A=M.enabledBy,this.sendIframeEvent({type:"websocket/get-plugin-initiator-user-id",payload:(0,s.Z)((0,s.Z)({},b.payload),{},{pluginInitiatorUserId:A})}),e.abrupt("break",95);case 91:return this.emit(b.payload.eventName,b.payload.data),e.abrupt("break",95);case 93:return this.emit("toggleViewMode",b.payload.data),e.abrupt("break",95);case 95:case"end":return e.stop()}}),e,this,[[29,35]])})));return function(t){return e.apply(this,arguments)}}()},{key:"sendData",value:function(e){"socket-service"!==Qo(this,Qw)?this.sendIframeEvent({type:ff.PLUGIN_INTERNAL_DATA,payload:{pluginId:this.id,data:e}}):this.sendIframeEvent({type:m_,uuid:"",payload:e})}},{key:"removePluginView",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",n=null!=(e=this.iframes.get(t))?e:{},r=n.iframe,a=n.listener;(r||a)&&(window.removeEventListener("message",a),this.iframes.delete(t))}},{key:"addPluginView",value:function(e){var t,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";if(!Qo(this,t_))throw qp.error("DytePlugin::addPluginView::no_auth_token_set_for_plugin"),new Jp("No auth token set for plugin.");if(!e)throw qp.error("DytePlugin::addPluginView::iframe_was_not_provided"),new Jp("Iframe was not provided.");this.removePluginView(r);var a=e,i=new URL(this.baseURL),o={auth:Qo(this,t_),parent:!navigator.isReactNative&&window.location.origin,backend:kp.apiBase,pluginId:this.id,roomName:null!=(t=Qo(this,n_,r_).roomName)?t:"",displayTitle:Qo(this,n_,r_).meetingTitle};Object.keys(o).forEach((function(e){i.searchParams.set(e,o[e])})),a.src=i.href,a.allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",a.title=r;var s=function(){var t=(0,d.Z)((0,l.Z)().mark((function t(r){return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=r.source===e.contentWindow,!t.t0){t.next=4;break}return t.next=4,n.handleIframeMessage(r.data);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();window.addEventListener("message",s),this.iframes.set(r,{iframe:a,listener:s})}},{key:"setActive",value:function(e){var t,n;this.active=e,e?this.emit("stateUpdate",{active:this.active,pluginId:this.id,bind:this.addPluginView.bind(this),views:null==(t=this.config)?void 0:t.views}):(this.active=!1,this.emit("stateUpdate",{active:this.active,pluginId:this.id,views:null==(n=this.config)?void 0:n.views}))}},{key:"activateForSelf",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=vg(),e.next=3,t.authorizePlugin(this.id);case 3:return n=e.sent,Yo(this,t_,n),e.prev=5,e.next=8,t.getPluginConfig(this.baseURL);case 8:r=e.sent,this.config=r,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(5),qp.error("DytePlugin::activateForSelf",e.t0);case 15:this.setActive(!0),this.emit("enabled");case 16:case"end":return e.stop()}}),e,this,[[5,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"deactivateForSelf",value:function(){var e=this;(0,o.Z)(this.iframes.keys()).forEach((function(t){e.removePluginView(t)})),this.iframes.clear(),this.setActive(!1),this.emit("closed")}},{key:"enable",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.activateForSelf());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"disable",value:function(){return this.deactivateForSelf()}},{key:"activate",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(n=null==(t=Qo(this,Xw).permissions)?void 0:t.plugins)||!n.canStart){e.next=6;break}if("socket-service"!==Qo(this,Qw)){e.next=4;break}return Qo(this,Jw).addPlugin(this.id,this.staggered),e.abrupt("return");case 4:return e.next=6,Qo(this,n_,r_).addRoomPlugin(this);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"deactivate",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==(n=null==(t=Qo(this,Xw).permissions)?void 0:t.plugins)||!n.canClose){e.next=6;break}if("socket-service"!==Qo(this,Qw)){e.next=4;break}return Qo(this,Jw).removePlugin(this.id),e.abrupt("return");case 4:return e.next=6,Qo(this,n_,r_).removeRoomPlugin(this);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(yp),Jw=new WeakMap,Qw=new WeakMap,Xw=new WeakMap,Yw=new WeakMap,e_=new WeakMap,t_=new WeakMap,n_=new WeakSet,r_=function(){return Lb()},a_);g_=function(e,t,n,r){for(var a,i=r>1?void 0:r?o_(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&i_(t,n,i),i}([Yp((function(e){throw new Jp(e.message,"0600")}))],g_);var y_=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,{onAddEvent:"pluginAdded",onDeleteEvent:"pluginDeleted"})}return(0,k.Z)(n,[{key:"add",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return f((0,p.Z)(n.prototype),"add",this).call(this,e,t)}},{key:"delete",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return f((0,p.Z)(n.prototype),"delete",this).call(this,e,t,r)}}]),n}(yw),k_=Object.defineProperty,b_=Object.getOwnPropertyDescriptor,w_=(0,k.Z)((function e(){(0,y.Z)(this,e),Ko(this,"all"),Ko(this,"active"),this.all=new y_,this.active=new y_}));w_=function(e,t,n,r){for(var a,i=r>1?void 0:r?b_(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&k_(t,n,i),i}([Yp((function(e){throw new Jp(e.message,"0600")}))],w_);var __,S_=Object.defineProperty,E_=Object.getOwnPropertyDescriptor,T_=function(e,t,n,r){for(var a,i=r>1?void 0:r?E_(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&S_(t,n,i),i},x_=function(e){return e[e.TEXT=0]="TEXT",e[e.IMAGE=1]="IMAGE",e[e.FILE=2]="FILE",e}(x_||{}),Z_=function(){function e(t){(0,y.Z)(this,e),Xo(this,__,void 0),Yo(this,__,t)}return(0,k.Z)(e,[{key:"getChatMessages",value:function(){return Qo(this,__).sendMessagePromise(yg.getMessages)}},{key:"sendMessageToRoom",value:function(e,t){var n={payloadType:t,payload:e};Qo(this,__).sendMessage(yg.sendMessageToRoom,pm.toBinary(n))}},{key:"sendMessageToPeers",value:function(e,t,n){var r={payloadType:t,peerIds:n,payload:e};Qo(this,__).sendMessage(yg.sendMessageToPeers,hm.toBinary(r))}},{key:"sendMessage",value:function(e,t,n){n&&n.length>0?this.sendMessageToPeers(e,t,n):this.sendMessageToRoom(e,t)}},{key:"editMessage",value:function(e,t,n,r){var a={chatId:e,pinned:r,payloadType:n,payload:t};Qo(this,__).sendMessage(yg.editMessage,mm.toBinary(a))}},{key:"deleteMessage",value:function(e){Qo(this,__).sendMessage(yg.deleteMessage,ym.toBinary({chatId:e}))}},{key:"on",value:function(e,t){var n,r;switch(e){case yg.sendMessageToRoom:n=fm.fromBinary.bind(fm),r=fm.create();break;case yg.sendMessageToPeers:n=vm.fromBinary.bind(vm),r=vm.create();break;case yg.editMessage:n=gm.fromBinary.bind(gm),r=gm.create();break;case yg.deleteMessage:n=km.fromBinary.bind(km),r=km.create()}Qo(this,__).on(e,(function(e){var a=e.payload,i=r;try{i=n(a)}catch(o){qp.error("chatSocketHandler::on::binary_decode_error",{error:o})}return t(i)}))}}]),e}();__=new WeakMap,T_([Gp.trace("SocketService.getChatMessages")],Z_.prototype,"getChatMessages",1),T_([Gp.trace("SocketService.sendMessageToRoom")],Z_.prototype,"sendMessageToRoom",1),T_([Gp.trace("SocketService.sendMessageToPeers")],Z_.prototype,"sendMessageToPeers",1),T_([Gp.trace("SocketService.sendMessage")],Z_.prototype,"sendMessage",1),T_([Gp.trace("SocketService.editMessage")],Z_.prototype,"editMessage",1),T_([Gp.trace("SocketService.deleteMessage")],Z_.prototype,"deleteMessage",1);var C_,R_,P_,I_,O_,D_,M_,A_=Object.defineProperty,N_=Object.getOwnPropertyDescriptor,L_=function(e,t,n,r){for(var a,i=r>1?void 0:r?N_(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&A_(t,n,i),i},j_=["text","image","file","poll"],F_=(M_=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e,r,a,i){var o;return(0,y.Z)(this,n),o=t.call(this),Xo((0,v.Z)(o),O_),Ko((0,v.Z)(o),"messages"),Xo((0,v.Z)(o),C_,void 0),Xo((0,v.Z)(o),R_,void 0),Xo((0,v.Z)(o),P_,void 0),Xo((0,v.Z)(o),I_,void 0),Yo((0,v.Z)(o),P_,e),Yo((0,v.Z)(o),I_,r),Yo((0,v.Z)(o),C_,a),Yo((0,v.Z)(o),R_,i),o.messages=[],o}return(0,k.Z)(n,[{key:"roomJoined",get:function(){var e;return!0===(null==(e=Qo(this,O_,D_))?void 0:e.roomJoined)}},{key:"sendTextMessage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o,s,c,u;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(a=null==(r=Qo(this,C_).permissions)?void 0:r.chatPublic)&&a.canSend&&null!=(o=null==(i=Qo(this,C_).permissions)?void 0:i.chatPublic)&&o.text){e.next=2;break}throw qp.error("sendTextMessage::public_chat_permission_denied"),new Jp("Could not send message to public chat.","0501");case 2:if(!(n&&n.length>0)||null!=(s=Qo(this,C_).permissions)&&s.chatPrivate.canSend&&null!=(c=Qo(this,C_).permissions)&&c.chatPrivate.text){e.next=4;break}throw qp.error("sendTextMessage::private_chat_permission_denied"),new Jp("Could not send message to private chat.","0501");case 4:if(t){e.next=6;break}throw qp.error("sendTextMessage::message_can_not_be_empty"),new Jp("Message can not be empty.","0502");case 6:if("socket-service"!==Qo(this,I_)){e.next=10;break}return[],n&&n.length>0&&(n.push(Qo(this,C_).id),Qo(this,R_).joined.toArray().filter((function(e){return n.includes(e.id)})).map((function(e){return e.userId})).push(Qo(this,C_).userId)),Qo(this,P_).sendMessage(t,x_.TEXT,n),e.abrupt("return");case 10:if(!(void 0!==n&&n.length>0)){e.next=13;break}return qp.error("sendTextMessage::private_chat_unsupported"),e.abrupt("return");case 13:if(u={userId:Qo(this,C_).userId,displayName:Qo(this,C_).name,message:t,type:j_.indexOf("text"),time:+new Date},this.roomJoined){e.next=16;break}throw qp.error("DyteChat.sendTextMessage.RoomNodeClientSocketUsed_WithoutRoomJoin"),new Jp("Can`t sendTextMessage without joining room");case 16:return e.next=18,Qo(this,O_,D_).sendChatMessage(u);case 18:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"sendImageMessage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o,s,c,u,d,p,f,h;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n&&n.length>0)){e.next=6;break}if(null!=(r=Qo(this,C_).permissions)&&r.chatPrivate.canSend&&null!=(a=Qo(this,C_).permissions)&&a.chatPrivate.files){e.next=4;break}return qp.error("sendImageMessage::private_chat_permission_denied"),e.abrupt("return");case 4:e.next=9;break;case 6:if(null!=(o=null==(i=Qo(this,C_).permissions)?void 0:i.chatPublic)&&o.canSend&&null!=(c=null==(s=Qo(this,C_).permissions)?void 0:s.chatPublic)&&c.files){e.next=9;break}return qp.error("sendImageMessage::permission_denied"),e.abrupt("return");case 9:if(t){e.next=12;break}return qp.error("sendImageMessage::required_argument_image_can_not_be_empty"),e.abrupt("return");case 12:if(["image/gif","image/jpeg","image/png"].includes(t.type)){e.next=15;break}return qp.error("sendImageMessage::image_type_not_supported",{imageType:t.type}),e.abrupt("return");case 15:return e.prev=15,u=vg(),e.next=19,u.getPresignedUrls(t.name);case 19:return d=e.sent,p=d.getLocation,f=d.putLocation,e.next=24,u.uploadFile(t,f);case 24:if("socket-service"!==Qo(this,I_)){e.next=28;break}return[],n&&n.length>0&&(n.push(Qo(this,C_).id),Qo(this,R_).joined.toArray().filter((function(e){return n.includes(e.id)})).map((function(e){return e.userId})).push(Qo(this,C_).userId)),Qo(this,P_).sendMessage(p,x_.IMAGE,n),e.abrupt("return");case 28:if(!(void 0!==n&&n.length>0)){e.next=31;break}return qp.error("sendImageMessage::private_chat_unsupported"),e.abrupt("return");case 31:if(h={userId:Qo(this,C_).userId,displayName:Qo(this,C_).name,type:j_.indexOf("image"),link:p,time:+new Date},this.roomJoined){e.next=34;break}throw qp.error("DyteChat.sendImageMessage.RoomNodeClientSocketUsed_WithoutRoomJoin"),new Jp("Can`t sendImageMessage without joining room");case 34:return e.next=36,Qo(this,O_,D_).sendChatMessage(h);case 36:e.next=41;break;case 38:throw e.prev=38,e.t0=e.catch(15),new Jp("Error sending image message.");case 41:case"end":return e.stop()}}),e,this,[[15,38]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"sendFileMessage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o,s,c,u,d,p,f,h,v;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n&&n.length>0)){e.next=6;break}if(null!=(r=Qo(this,C_).permissions)&&r.chatPrivate.canSend&&null!=(a=Qo(this,C_).permissions)&&a.chatPrivate.files){e.next=4;break}return qp.error("sendFileMessage::private_chat_permission_denied"),e.abrupt("return");case 4:e.next=9;break;case 6:if(null!=(o=null==(i=Qo(this,C_).permissions)?void 0:i.chatPublic)&&o.canSend&&null!=(c=null==(s=Qo(this,C_).permissions)?void 0:s.chatPublic)&&c.files){e.next=9;break}return qp.error("sendFileMessage::permission_denied"),e.abrupt("return");case 9:if(t){e.next=12;break}return qp.error("sendFileMessage::required_argument_file_can_not_be_empty"),e.abrupt("return");case 12:return e.prev=12,u=vg(),e.next=16,u.getPresignedUrls(t.name);case 16:return d=e.sent,p=d.getLocation,f=d.putLocation,e.next=21,u.uploadFile(t,f);case 21:if("socket-service"!==Qo(this,I_)){e.next=27;break}return[],n&&n.length>0&&(n.push(Qo(this,C_).id),Qo(this,R_).joined.toArray().filter((function(e){return n.includes(e.id)})).map((function(e){return e.userId})).push(Qo(this,C_).userId)),h=JSON.stringify({link:p,name:t.name,size:t.size}),Qo(this,P_).sendMessage(h,x_.FILE,n),e.abrupt("return");case 27:if(!(void 0!==n&&n.length>0)){e.next=30;break}return qp.error("sendFileMessage::private_chat_unsupported"),e.abrupt("return");case 30:if(v={userId:Qo(this,C_).userId,displayName:Qo(this,C_).name,type:j_.indexOf("file"),link:p,name:t.name,size:t.size,time:+new Date},this.roomJoined){e.next=33;break}throw qp.error("DyteChat.sendFileMessage.RoomNodeClientSocketUsed_WithoutRoomJoin"),new Jp("Can`t sendFileMessage without joining room");case 33:return e.next=35,Qo(this,O_,D_).sendChatMessage(v);case 35:e.next=40;break;case 37:throw e.prev=37,e.t0=e.catch(12),new Jp("Error sending file message.");case 40:case"end":return e.stop()}}),e,this,[[12,37]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"sendMessage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.type,e.next="text"===e.t0?3:"image"===e.t0?6:"file"===e.t0?9:12;break;case 3:return e.next=5,this.sendTextMessage(t.message,n);case 5:case 8:case 11:return e.abrupt("break",14);case 6:return e.next=8,this.sendImageMessage(t.image,n);case 9:return e.next=11,this.sendFileMessage(t.file,n);case 12:return qp.error("sendMessage::message_type_not_supported",{messageType:t.type}),e.abrupt("break",14);case 14:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"editTextMessage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("socket-service"===Qo(this,I_)){e.next=3;break}return qp.warn("editTextMessage::Coming soon!"),e.abrupt("return");case 3:if(null!=(a=null==(r=Qo(this,C_).permissions)?void 0:r.chatPublic)&&a.canSend&&null!=(o=null==(i=Qo(this,C_).permissions)?void 0:i.chatPublic)&&o.text){e.next=6;break}return qp.error("editTextMessage::permission_denied"),e.abrupt("return");case 6:if(n){e.next=9;break}return qp.error("editTextMessage::message_can_not_be_empty"),e.abrupt("return");case 9:Qo(this,P_).editMessage(t,n,x_.TEXT);case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"editImageMessage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o,s,c,u,d;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("socket-service"===Qo(this,I_)){e.next=3;break}return qp.warn("editImageMessage::Coming soon!"),e.abrupt("return");case 3:if(null!=(a=null==(r=Qo(this,C_).permissions)?void 0:r.chatPublic)&&a.canSend&&null!=(o=null==(i=Qo(this,C_).permissions)?void 0:i.chatPublic)&&o.files){e.next=6;break}return qp.error("editImageMessage::permission_denied"),e.abrupt("return");case 6:if(n){e.next=9;break}return qp.error("editImageMessage::required_argument_image_can_not_be_empty"),e.abrupt("return");case 9:if(["image/gif","image/jpeg","image/png"].includes(n.type)){e.next=12;break}return qp.error("sendImageMessage::image_type_not_supported",{imageType:n.type}),e.abrupt("return");case 12:return e.prev=12,s=vg(),e.next=16,s.getPresignedUrls(n.name);case 16:return c=e.sent,u=c.getLocation,d=c.putLocation,e.next=21,s.uploadFile(n,d);case 21:Qo(this,P_).editMessage(t,u,x_.IMAGE),e.next=27;break;case 24:throw e.prev=24,e.t0=e.catch(12),new Jp("Error editing image message.");case 27:case"end":return e.stop()}}),e,this,[[12,24]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"editFileMessage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o,s,c,u,d;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("socket-service"===Qo(this,I_)){e.next=3;break}return qp.warn("editFileMessage::Coming soon!"),e.abrupt("return");case 3:if(null!=(a=null==(r=Qo(this,C_).permissions)?void 0:r.chatPublic)&&a.canSend&&null!=(o=null==(i=Qo(this,C_).permissions)?void 0:i.chatPublic)&&o.files){e.next=6;break}return qp.error("sendFileMessage::permission_denied"),e.abrupt("return");case 6:if(n){e.next=9;break}return qp.error("sendFileMessage::required_argument_file_can_not_be_empty"),e.abrupt("return");case 9:return e.prev=9,s=vg(),e.next=13,s.getPresignedUrls(n.name);case 13:return c=e.sent,u=c.getLocation,d=c.putLocation,e.next=18,s.uploadFile(n,d);case 18:Qo(this,P_).editMessage(t,JSON.stringify({link:u,name:n.name,size:n.size}),x_.FILE),e.next=24;break;case 21:throw e.prev=21,e.t0=e.catch(9),new Jp("Error editing file message.");case 24:case"end":return e.stop()}}),e,this,[[9,21]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"editMessage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("socket-service"===Qo(this,I_)){e.next=3;break}return qp.warn("editMessage::Coming soon!"),e.abrupt("return");case 3:e.t0=n.type,e.next="text"===e.t0?6:"image"===e.t0?8:"file"===e.t0?10:12;break;case 6:return this.editTextMessage(t,n.message),e.abrupt("break",14);case 8:return this.editImageMessage(t,n.image),e.abrupt("break",14);case 10:return this.editFileMessage(t,n.file),e.abrupt("break",14);case 12:return qp.error("editMessage::message_type_not_supported",{messageType:n.type}),e.abrupt("break",14);case 14:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteMessage",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("socket-service"===Qo(this,I_)){e.next=3;break}return qp.warn("editMessage::Coming soon!"),e.abrupt("return");case 3:Qo(this,P_).deleteMessage(t);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getMessagesByUser",value:function(e){return this.messages.filter((function(t){return t.userId===e}))}},{key:"getMessagesByType",value:function(e){return this.messages.filter((function(t){return t.type===e}))}},{key:"pin",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("socket-service"===Qo(this,I_)){e.next=5;break}if(this.roomJoined){e.next=3;break}throw new Jp("Can`t pin message without joining room");case 3:return e.next=5,Qo(this,O_,D_).pinChatMessage({id:t});case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"unpin",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("socket-service"===Qo(this,I_)){e.next=5;break}if(this.roomJoined){e.next=3;break}throw new Jp("Can`t unpin message without joining room");case 3:return e.next=5,Qo(this,O_,D_).unpinChatMessage({id:t});case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"pinned",get:function(){return this.messages.filter((function(e){return e.pinned}))}}]),n}(yp),C_=new WeakMap,R_=new WeakMap,P_=new WeakMap,I_=new WeakMap,O_=new WeakSet,D_=function(){return Lb()},M_);L_([Gp.trace("DyteChat.sendTextMessage")],F_.prototype,"sendTextMessage",1),L_([Gp.trace("DyteChat.sendImageMessage")],F_.prototype,"sendImageMessage",1),L_([Gp.trace("DyteChat.sendFileMessage")],F_.prototype,"sendFileMessage",1),L_([Gp.trace("DyteChat.sendMessage")],F_.prototype,"sendMessage",1),L_([Gp.trace("DyteChat.editTextMessage")],F_.prototype,"editTextMessage",1),L_([Gp.trace("DyteChat.editImageMessage")],F_.prototype,"editImageMessage",1),L_([Gp.trace("DyteChat.editFileMessage")],F_.prototype,"editFileMessage",1),L_([Gp.trace("DyteChat.editMessage")],F_.prototype,"editMessage",1),L_([Gp.trace("DyteChat.deleteMessage")],F_.prototype,"deleteMessage",1),F_=L_([Yp((function(e){throw new Jp(e.message,"0500")}))],F_);var U_,B_,V_,H_,z_=Object.defineProperty,W_=Object.getOwnPropertyDescriptor,G_=(H_=function(){function e(t,n,r,a){(0,y.Z)(this,e),Xo(this,U_),Ko(this,"chat"),Ko(this,"chatSocketHandler"),Xo(this,V_,void 0),this.chatSocketHandler=t,Yo(this,V_,n),this.chat=new F_(t,n,r,a),this.setupEvents()}return(0,k.Z)(e,[{key:"roomJoined",get:function(){var e;return!0===(null==(e=Qo(this,U_,B_))?void 0:e.roomJoined)}},{key:"getChatMessages",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("socket-service"!==Qo(this,V_)){e.next=9;break}return e.next=3,this.chatSocketHandler.getChatMessages();case 3:if(null!=(t=e.sent)&&t.payload){e.next=6;break}return e.abrupt("return");case 6:return n=dm.fromBinary(t.payload).messages,this.chat.messages=n.map((function(e){return G_.formatSocketServiceMessage(e)})),e.abrupt("return");case 9:if(this.roomJoined){e.next=12;break}return qp.error("ChatController.getChatMessages.RoomNodeClientSocketUsed_WithoutRoomJoin"),e.abrupt("return");case 12:return e.next=14,Qo(this,U_,B_).getChatMessages();case 14:r=e.sent.payload.messages,this.chat.messages=r.map(G_.formatMessage);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setupEvents",value:function(){var e=this;"socket-service"===Qo(this,V_)?vf.on(ff.SOCKET_SERVICE_ROOM_JOINED,(function(){e.getChatMessages()})):vf.onAsync(ff.ROOM_JOINED,(0,d.Z)((0,l.Z)().mark((function t(){return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getChatMessages();case 2:case"end":return t.stop()}}),t)})))),this.chatSocketHandler.on(yg.sendMessageToRoom,(function(t){var n=G_.formatSocketServiceMessage(t.message);e.chat.messages=[].concat((0,o.Z)(e.chat.messages),[n]),e.chat.emit("chatUpdate",{action:"add",message:n,messages:e.chat.messages})})),this.chatSocketHandler.on(yg.sendMessageToPeers,(function(t){var n=G_.formatSocketServiceMessage(t.message);e.chat.messages=[].concat((0,o.Z)(e.chat.messages),[n]),e.chat.emit("chatUpdate",{action:"add",message:n,messages:e.chat.messages})})),this.chatSocketHandler.on(yg.editMessage,(function(t){var n=G_.formatSocketServiceMessage(t.message),r=e.chat.messages.findIndex((function(e){return e.id===n.id}));-1!==r&&(e.chat.messages[r]=n,e.chat.emit("chatUpdate",{action:"edit",message:n,messages:e.chat.messages}))})),this.chatSocketHandler.on(yg.deleteMessage,(function(t){var n=e.chat.messages.findIndex((function(e){return e.id===t.chatId}));if(-1!==n){var r=e.chat.messages.splice(n,1),a=(0,u.Z)(r,1)[0];e.chat.emit("chatUpdate",{action:"delete",message:a,messages:e.chat.messages})}})),vf.on(ff.NEW_CHAT_MESSAGE,(function(t){if("poll"!==j_[null==t?void 0:t.type]){var n=G_.formatMessage(t);e.chat.messages=[].concat((0,o.Z)(e.chat.messages),[n]),e.chat.emit("chatUpdate",{action:"add",message:n,messages:e.chat.messages})}})),vf.on(ff.PIN_CHAT_MESSAGE,function(){var t=(0,d.Z)((0,l.Z)().mark((function t(n){var r,a;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=G_.formatMessage(n),a=e.chat.messages.findIndex((function(e){return e.id===r.id})),e.chat.messages[a]=r,e.chat.emit("pinMessage",{message:r,messages:e.chat.messages});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),vf.on(ff.UNPIN_CHAT_MESSAGE,function(){var t=(0,d.Z)((0,l.Z)().mark((function t(n){var r,a;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=G_.formatMessage(n),a=e.chat.messages.findIndex((function(e){return e.id===r.id})),e.chat.messages[a]=r,e.chat.emit("unpinMessage",{message:r,messages:e.chat.messages});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}],[{key:"init",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n,r){var a,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Vc.getValue(Sp.CHAT_SOCKET_SERVER),qp.debug("Received flagsmith chat_socket_server: ".concat(a)),i="socket-service"===uv("chat_socket_server")||"socket-service"===a?"socket-service":"room-node",e.abrupt("return",(qp.info("Using socket server",{socketServerName:i}),new G_(t,i,n,r)));case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"formatMessage",value:function(e){return(0,s.Z)((0,s.Z)({},e),{},{time:new Date(e.time),type:j_[e.type]})}},{key:"formatSocketServiceMessage",value:function(e){var t=1e3*e.createdAt,n={displayName:e.displayName,id:e.chatId,time:t,type:e.payloadType,isEdited:e.isEdited,userId:e.userId,targetUserIds:e.targetUserIds,message:"",link:"",name:"",size:0};switch(n.type){case x_.TEXT:n.message=e.payload;break;case x_.IMAGE:n.link=e.payload;break;case x_.FILE:var r=JSON.parse(e.payload),a=r.link,i=r.name,o=r.size;n.link=a,n.name=i,n.size=o}return G_.formatMessage(n)}}]),e}(),U_=new WeakSet,B_=function(){return Lb()},V_=new WeakMap,H_),q_=G_;!function(e,t,n,r){for(var a,i=r>1?void 0:r?W_(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);r&&i&&z_(t,n,i)}([Gp.trace("ChatController.setupEvents")],q_.prototype,"setupEvents",1);var $_,K_,J_,Q_,X_,Y_,eS=Object.defineProperty,tS=Object.getOwnPropertyDescriptor,nS=(Y_=function(){function e(t,n,r,a){(0,y.Z)(this,e),Xo(this,Q_),Ko(this,"plugins"),Xo(this,$_,void 0),Xo(this,K_,void 0),Xo(this,J_,void 0),Yo(this,$_,t),Yo(this,J_,n),Yo(this,K_,r),this.plugins=a,this.setupEvents()}return(0,k.Z)(e,[{key:"roomJoined",get:function(){var e;return!0===(null==(e=Qo(this,Q_,X_))?void 0:e.roomJoined)}},{key:"getRoomPlugins",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r,a,i=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("socket-service"!==Qo(this,K_)){e.next=8;break}return e.next=3,Qo(this,$_).getActivePlugins();case 3:return t=e.sent,n=t.plugins,e.next=7,Promise.all(n.map((function(e){return i.enablePlugin({id:e.pluginId,enabledBy:e.enabledBy})})));case 7:return e.abrupt("return");case 8:if(this.roomJoined){e.next=11;break}return qp.error("PluginController.getRoomPlugins.RoomNodeClientSocketUsed_WithoutRoomJoin"),e.abrupt("return");case 11:return e.next=13,Qo(this,Q_,X_).getRoomState();case 13:return r=e.sent,a=r.payload,e.next=17,Promise.all(a.roomState.plugins.map((function(e){return i.enablePlugin(e)})));case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"enablePlugin",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.id,r=t.enabledBy,a=this.plugins.all.get(n),e.t0=a,!e.t0){e.next=7;break}return e.next=6,a.activateForSelf();case 6:a.enabledBy=r;case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"disablePlugin",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.id,(r=this.plugins.all.get(n))&&r.deactivateForSelf();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"sendIframeEventOld",value:function(e,t){var n=t.id,r=this.plugins.all.get(n);r&&r.sendIframeEvent({type:e,payload:t})}},{key:"sendIframeEvent",value:function(e,t,n,r){var a=this.plugins.all.get(t);t&&a.sendIframeEvent({type:e,uuid:n,payload:r})}},{key:"broadcastIframeEventOld",value:function(e,t){var n=this;this.plugins.active.forEach((function(r){n.sendIframeEventOld(e,(0,s.Z)((0,s.Z)({},t),{},{id:r.id}))}))}},{key:"broadcastIframeEvent",value:function(e,t){var n=this;this.plugins.active.forEach((function(r){n.sendIframeEvent(e,r.id,"",t)}))}},{key:"setupEvents",value:function(){var e=this;if(this.plugins.all.on("stateUpdate",(function(t){var n=t.active,r=t.id;n?e.plugins.active.add(e.plugins.all.get(r)):e.plugins.active.delete(r)})),vf.onAsync(ff.ROOM_JOINED,(0,d.Z)((0,l.Z)().mark((function t(){return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getRoomPlugins();case 2:qp.debug("[ROOM_JOINED] resolved request to fetch plugins.");case 3:case"end":return t.stop()}}),t)})))),"socket-service"===Qo(this,K_))return Qo(this,$_).on(kg.addPlugin,function(){var t=(0,d.Z)((0,l.Z)().mark((function t(n){var r,a;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.pluginId,t.t0=null!=(r=e.plugins.all.get(a))&&r.active,t.t0){t.next=5;break}return t.next=5,e.enablePlugin({id:a,enabledBy:n.enabledBy});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),Qo(this,$_).on(kg.removePlugin,function(){var t=(0,d.Z)((0,l.Z)().mark((function t(n){var r,a;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.pluginId,t.t0=null!=(r=e.plugins.all.get(a))&&r.active,!t.t0){t.next=5;break}return t.next=5,e.disablePlugin({id:a});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),[kg.enablePluginForPeers,kg.enablePluginForRoom].forEach((function(t){Qo(e,$_).on(t,function(){var n=(0,d.Z)((0,l.Z)().mark((function n(r,a){return(0,l.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.sendIframeEvent(t,r.pluginId,a,{enabledBy:r.enabledBy});case 1:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())})),[kg.disablePluginForPeers,kg.disablePluginForRoom].forEach((function(t){Qo(e,$_).on(t,function(){var n=(0,d.Z)((0,l.Z)().mark((function n(r,a){return(0,l.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.sendIframeEvent(t,r.pluginId,a,{disabledBy:r.disabledBy});case 1:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())})),[kg.customPluginEventToPeers,kg.customPluginEventToRoom].forEach((function(t){Qo(e,$_).on(t,function(){var n=(0,d.Z)((0,l.Z)().mark((function n(r,a){return(0,l.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.sendIframeEvent(t,r.pluginId,a,{data:JSON.parse((new TextDecoder).decode(r.pluginData))});case 1:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())})),[kg.storeInsertKeys,kg.storeGetKeys,kg.storeDeleteKeys].forEach((function(t){Qo(e,$_).on(t,function(){var n=(0,d.Z)((0,l.Z)().mark((function n(r,a){var i,o;return(0,l.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=null==(i=r.storeItems)?void 0:i.map((function(e){return{timestamp:e.timestamp,peerId:e.peerId,payload:JSON.parse(e.payload?(new TextDecoder).decode(e.payload):"{}"),key:e.storeKey}})),e.sendIframeEvent(t,r.pluginId,a,{storeName:r.storeName,storeItems:o});case 2:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())})),Qo(this,$_).on(kg.storeDelete,function(){var t=(0,d.Z)((0,l.Z)().mark((function t(n,r){return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.sendIframeEvent(kg.storeDelete,n.pluginId,r,{storeName:n.storeName});case 1:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),Qo(this,J_).on(yg.sendMessageToPeers,(function(t){var n=null==q_?void 0:q_.formatSocketServiceMessage(t.message);e.broadcastIframeEvent(u_,{message:n})})),Qo(this,J_).on(yg.sendMessageToRoom,(function(t){var n=null==q_?void 0:q_.formatSocketServiceMessage(t.message);e.broadcastIframeEvent(u_,{message:n})})),vf.on(ff.PEER_JOINED,(function(t){e.broadcastIframeEvent(h_,t)})),void vf.on(ff.PEER_CLOSED,(function(t){e.broadcastIframeEvent(v_,t)}));vf.on(ff.ENABLE_PLUGIN,function(){var t=(0,d.Z)((0,l.Z)().mark((function t(n){var r,a;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.id,a=n.enabledBy,t.next=3,e.enablePlugin({id:r,enabledBy:a});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),vf.on(ff.DISABLE_PLUGIN,function(){var t=(0,d.Z)((0,l.Z)().mark((function t(n){var r;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n.id,t.next=3,e.disablePlugin({id:r});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),[ff.PLUGIN_DATA,ff.PLUGIN_EVENT].forEach((function(t){vf.on(t,(function(n){e.sendIframeEventOld(t,n)}))})),[ff.PEER_JOINED,ff.PEER_CLOSED,ff.NEW_CHAT_MESSAGE].forEach((function(t){vf.on(t,(function(n){e.broadcastIframeEventOld(t,n)}))}))}}],[{key:"init",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n,r,a,i){var o,s,c,u,d;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=vg(),s=Vc.getValue(Sp.PLUGIN_SOCKET_SERVER),e.next=4,o.getPlugins(s);case 4:return c=e.sent,qp.debug("Received flagsmith plugin_socket_server",{flagsmithPluginSocketServer:s}),u="socket-service"===s?"socket-service":"room-node",qp.info("Using socket server: ".concat(u)),d=new w_,e.abrupt("return",(c.forEach((function(e){var n=new g_(e,t,u,a,i,r);d.all.add(n)})),!1===a.config.isV2&&a.config.setDisabledPlugins(d.all.toArray().map((function(e){return e.id}))),new nS(t,n,u,d)));case 10:case"end":return e.stop()}}),e)})));return function(t,n,r,a,i){return e.apply(this,arguments)}}()}]),e}(),$_=new WeakMap,K_=new WeakMap,J_=new WeakMap,Q_=new WeakSet,X_=function(){return Lb()},Y_),rS=nS;!function(e,t,n,r){for(var a,i=r>1?void 0:r?tS(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);r&&i&&eS(t,n,i)}([Gp.trace("PluginController.setupEvents")],rS.prototype,"setupEvents",1);var aS,iS,oS,sS,cS=Object.defineProperty,uS=Object.getOwnPropertyDescriptor,lS=(sS=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;return(0,y.Z)(this,n),r=t.call(this),Xo((0,v.Z)(r),aS),Ko((0,v.Z)(r),"items"),Xo((0,v.Z)(r),oS,void 0),Yo((0,v.Z)(r),oS,e),r.items=[],r}return(0,k.Z)(n,[{key:"roomJoined",get:function(){var e;return!0===(null==(e=Qo(this,aS,iS))?void 0:e.roomJoined)}},{key:"create",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r,a,i,o=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=o.length>2&&void 0!==o[2]&&o[2],a=o.length>3&&void 0!==o[3]&&o[3],this.roomJoined){e.next=4;break}throw new Jp("Can't create polls without joining room");case 4:if(Qo(this,oS).permissions.polls.canCreate){e.next=7;break}return qp.error("DytePolls::create::permission_denied"),e.abrupt("return");case 7:if(t&&n){e.next=10;break}return qp.error("question_and_options_can_not_be_empty",{hasQuestions:!!t,hasOptions:!!n}),e.abrupt("return");case 10:if(!(n.length<2)){e.next=13;break}return qp.error("there_must_be_at_least_two_options",{optionsLength:n.length}),e.abrupt("return");case 13:return i={question:t,options:n,anonymous:r,hideVotes:a,createdBy:Qo(this,oS).name,createdByUserId:Qo(this,oS).userId},e.next=16,Qo(this,aS,iS).newPoll(i);case 16:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"vote",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,n){var r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Qo(this,oS).permissions.polls.canVote){e.next=3;break}return qp.error("DytePolls::vote::permission_denied"),e.abrupt("return");case 3:return r={pollId:t,index:n},e.next=6,Qo(this,aS,iS).votePoll(r);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(yp),aS=new WeakSet,iS=function(){return Lb()},oS=new WeakMap,sS);lS=function(e,t,n,r){for(var a,i=r>1?void 0:r?uS(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&cS(t,n,i),i}([Yp((function(e){throw new Jp(e.message,"0700")}))],lS);var dS,pS,fS,hS=Object.defineProperty,vS=Object.getOwnPropertyDescriptor,mS=function(){function e(t){(0,y.Z)(this,e),Xo(this,pS),Ko(this,"polls"),Xo(this,dS,void 0),this.polls=new lS(t),Yo(this,dS,t),this.setupEvents()}return(0,k.Z)(e,[{key:"canViewPolls",value:function(){return Qo(this,dS).permissions.polls.canView}},{key:"setupEvents",value:function(){var e=this;vf.onAsync(ff.ROOM_JOINED,(0,d.Z)((0,l.Z)().mark((function t(){var n;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.canViewPolls()&&Qo(e,pS,fS)instanceof Ob)){t.next=5;break}return t.next=3,Qo(e,pS,fS).getPolls();case 3:n=t.sent.payload.polls,e.polls.items=Object.values(n),qp.debug("[ROOM_JOINED] resolved request to fetch polls.");case 5:case"end":return t.stop()}}),t)})))),vf.on(ff.UPDATE_POLL,function(){var t=(0,d.Z)((0,l.Z)().mark((function t(n){var r,a,i;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=n.poll,e.canViewPolls()){t.next=3;break}return t.abrupt("return");case 3:if(!((a=e.polls.items.findIndex((function(e){return e.id===r.id})))>-1)){t.next=8;break}return i=JSON.stringify(e.polls.items[a]),e.polls.items[a]=r,i!==JSON.stringify(r)&&e.polls.emit("pollsUpdate",{polls:e.polls.items,newPoll:!1}),t.abrupt("return");case 8:e.polls.items=[].concat((0,o.Z)(e.polls.items),[r]),e.polls.emit("pollsUpdate",{polls:e.polls.items,newPoll:!0});case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}]),e}();dS=new WeakMap,pS=new WeakSet,fS=function(){return Lb()},function(e,t,n,r){for(var a,i=r>1?void 0:r?vS(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);r&&i&&hS(t,n,i)}([Gp.trace("PollController.setupEvents")],mS.prototype,"setupEvents",1);var gS,yS,kS,bS,wS,_S,SS=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,{onAddEvent:"remoteRequestAdd",onDeleteEvent:"remoteRequestRemove"})}return(0,k.Z)(n,[{key:"add",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return f((0,p.Z)(n.prototype),"add",this).call(this,e,t)}},{key:"delete",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return f((0,p.Z)(n.prototype),"delete",this).call(this,e,t,r)}}]),n}(yw),ES=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e,r){var a;return(0,y.Z)(this,n),a=t.call(this),Xo((0,v.Z)(a),gS),Ko((0,v.Z)(a),"incomingRequests"),Ko((0,v.Z)(a),"outgoingRequests"),Ko((0,v.Z)(a),"active"),Xo((0,v.Z)(a),kS,void 0),Xo((0,v.Z)(a),bS,void 0),Yo((0,v.Z)(a),bS,r),Yo((0,v.Z)(a),kS,e),a.incomingRequests=new SS,a.outgoingRequests=new SS,a.active=null,a.mouseEvent=a.mouseEvent.bind((0,v.Z)(a)),a.keyboardEvent=a.keyboardEvent.bind((0,v.Z)(a)),a}return(0,k.Z)(n,[{key:"requestControl",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Qo(this,bS).joined.get(t)){e.next=2;break}throw new Jp("Invalid peer.");case 2:if(!(r=null==(n=this.outgoingRequests)?void 0:n.toArray().find((function(e){return e.hostPeerId===t})))){e.next=5;break}return e.abrupt("return",r.id);case 5:return a=Z(),i=new Sb({requestId:a,hostPeerId:t,remotePeerId:Qo(this,kS).id,state:kb.PENDING}),this.outgoingRequests.add(i),e.next=9,Qo(this,gS,yS).requestRemoteControl(i);case 9:return this.emit("remoteUpdate",{payload:{request:{id:i.id,hostPeerId:i.hostPeerId,remotePeerId:i.remotePeerId}},type:_b.REQUEST_SENT}),e.abrupt("return",a);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"acceptControl",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((null==(n=this.active)?void 0:n.id)!==t){e.next=2;break}return e.abrupt("return");case 2:if(r=this.incomingRequests.get(t)){e.next=5;break}throw new Jp("No request found.");case 5:r.state=kb.ACCEPTED,this.endControl(),this.active=r,Qo(this,gS,yS).acceptRemoteControl(r),this.emit("remoteUpdate",{payload:{request:{id:this.active.id,hostPeerId:this.active.hostPeerId,remotePeerId:this.active.remotePeerId}},type:_b.INCOMING_REQUEST_ACCEPTED});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"endControl",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.active){e.next=2;break}return e.abrupt("return");case 2:t=(0,s.Z)({},this.active),Qo(this,gS,yS).terminateRemoteControl(this.active.hostPeerId===Qo(this,kS).id?this.active.remotePeerId:this.active.hostPeerId,this.active),this.active=null,this.emit("remoteUpdate",{payload:{request:{id:t.id,hostPeerId:t.hostPeerId,remotePeerId:t.remotePeerId}},type:t.hostPeerId===Qo(this,kS).id?_b.INCOMING_REQUEST_ENDED:_b.OUTGOING_REQUEST_ENDED});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"keyboardEvent",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.active){e.next=2;break}return e.abrupt("return");case 2:(r=n.getFormattedKeyboardEvent(t))&&(a={eventType:bb.KEYBOARD,keyboardEvent:r},Qo(this,gS,yS).sendEventRemoteControl(this.active.hostPeerId,this.active.id,a));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"mouseEvent",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t,r){var a,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.active){e.next=2;break}return e.abrupt("return");case 2:(a=n.getFormattedRemoteMouseEvent(t,r))&&(i={eventType:bb.MOUSE,mouseEvent:a},Qo(this,gS,yS).sendEventRemoteControl(this.active.hostPeerId,this.active.id,i));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}],[{key:"getFormattedRemoteMouseEvent",value:function(e,t){var n=t.getBoundingClientRect();return{type:e.type,position:{x:Math.floor(e.x-n.left),y:Math.floor(e.y-n.top)},boundingRect:{width:n.width,height:n.height}}}},{key:"getFormattedKeyboardEvent",value:function(e){return"keydown"===e.type?{type:e.type,key:e.key}:null}}]),n}(yp),TS=ES;gS=new WeakSet,yS=function(){return Lb()},kS=new WeakMap,bS=new WeakMap;var xS=function(){function e(t,n){(0,y.Z)(this,e),Ko(this,"remote"),Ko(this,"hostPeetId"),Ko(this,"remotePeetId"),Ko(this,"remoteRequestTokens"),Ko(this,"activeRemoteToken"),Xo(this,wS,void 0),Xo(this,_S,void 0),Yo(this,wS,t),Yo(this,_S,n),this.hostPeetId=t.id,this.remote=new TS(t,n),this.setupEvents()}return(0,k.Z)(e,[{key:"setupEvents",value:function(){var t=this;vf.on(ff.MESSAGE,(function(n){var r;if(n.remoteRequestType===yb.REQUEST&&(t.remote.incomingRequests.add(new Sb({requestId:n.remoteRequestId,hostPeerId:n.hostPeerId,remotePeerId:n.remotePeerId,state:kb.PENDING})),t.remote.emit("remoteUpdate",{payload:{request:{id:n.remoteRequestId,hostPeerId:n.hostPeerId,remotePeerId:n.remotePeerId}},type:_b.REQUEST_RECEIVED})),n.remoteRequestType===yb.ACCEPT){var a=t.remote.outgoingRequests.get(n.remoteRequestId);if(!a)throw new Jp("There is no pending remote control request to accept.");t.remote.endControl(),a.state=kb.ACCEPTED,t.remote.active=new Sb({requestId:n.remoteRequestId,hostPeerId:n.hostPeerId,remotePeerId:n.remotePeerId,state:kb.ACCEPTED}),t.remote.emit("remoteUpdate",{payload:{request:{id:n.remoteRequestId,hostPeerId:n.hostPeerId,remotePeerId:n.remotePeerId}},type:_b.OUTGOING_REQUEST_ACCEPTED})}n.remoteRequestType===yb.END&&((null==(r=t.remote.active)?void 0:r.id)===n.remoteRequestId&&(t.remote.active=null),t.remote.emit("remoteUpdate",{payload:{request:{id:n.remoteRequestId,hostPeerId:n.hostPeerId,remotePeerId:n.remotePeerId}},type:n.hostPeerId===Qo(t,wS).id?_b.INCOMING_REQUEST_ENDED:_b.OUTGOING_REQUEST_ENDED})),n.remoteRequestType===yb.EVENT&&t.remote.active&&t.remote.active.id===n.remoteRequestId&&window.DyteRobot&&(n.remoteEvent.eventType===bb.MOUSE?e.executeMouseEvent(n.remoteEvent.mouseEvent):n.remoteEvent.eventType===bb.KEYBOARD&&e.executeKeyboardEvent(n.remoteEvent.keyboardEvent))})),vf.on(ff.PEER_CLOSED,(function(e){var n,r,a,i,o,s,c,u,l=e.id;[null==(r=null==(n=t.remote)?void 0:n.active)?void 0:r.hostPeerId,null==(i=null==(a=t.remote)?void 0:a.active)?void 0:i.remotePeerId].includes(l)&&t.remote.endControl(),null==(s=null==(o=t.remote)?void 0:o.incomingRequests)||s.toArray().forEach((function(e){[e.hostPeerId,e.remotePeerId].includes(l)&&t.remote.incomingRequests.delete(e.id)})),null==(u=null==(c=t.remote)?void 0:c.outgoingRequests)||u.toArray().forEach((function(e){[e.hostPeerId,e.remotePeerId].includes(l)&&t.remote.outgoingRequests.delete(e.id)}))}))}}],[{key:"executeMouseEvent",value:function(e){var t=window.screen.width*e.position.x/e.boundingRect.width,n=window.screen.height*e.position.y/e.boundingRect.height,r={width:window.screen.width,height:window.screen.height};switch(e.type){case wb.LEFT_CLICK:window.DyteRobot.mouse.leftClick(t,n,r);break;case wb.RIGHT_CLICK:window.DyteRobot.mouse.rightClick(t,n,r);break;case wb.MOVE:window.DyteRobot.mouse.moveTo(t,n,r)}}},{key:"executeKeyboardEvent",value:function(e){if("keydown"===e.type)window.DyteRobot.keyboard.press(e.key)}}]),e}(),ZS=xS;wS=new WeakMap,_S=new WeakMap;var CS,RS,PS,IS,OS,DS,MS,AS,NS,LS,jS,FS,US,BS,VS,HS,zS,WS,GS,qS,$S,KS,JS,QS,XS,YS,eE,tE,nE,rE,aE,iE,oE=Object.defineProperty,sE=function(e,t,n){return function(e,t,n){t in e?oE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=typeof t?t+"":t,n),n},cE=function(e,t,n){if(!t.has(e))throw TypeError("Cannot "+n)},uE=function(e,t,n){return cE(e,t,"read from private field"),n?n.call(e):t.get(e)},lE=function(e,t,n){if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,n)},dE=function(e,t,n,r){return cE(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n},pE=function(e,t,n){return cE(e,t,"access private method"),n},fE={exports:{}},hE="object"==typeof Reflect?Reflect:null,vE=hE&&"function"==typeof hE.apply?hE.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};iE=hE&&"function"==typeof hE.ownKeys?hE.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var mE=Number.isNaN||function(e){return e!==e};function gE(){gE.init.call(this)}fE.exports=gE,fE.exports.once=function(e,t){return new Promise((function(n,r){function a(n){e.removeListener(t,i),r(n)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",a),n([].slice.call(arguments))}ZE(e,t,i,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&ZE(e,"error",t,n)}(e,a,{once:!0})}))},gE.EventEmitter=gE,gE.prototype._events=void 0,gE.prototype._eventsCount=0,gE.prototype._maxListeners=void 0;var yE=10;function kE(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function bE(e){return void 0===e._maxListeners?gE.defaultMaxListeners:e._maxListeners}function wE(e,t,n,r){var a,i,o;if(kE(n),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),o=i[t]),void 0===o)o=i[t]=n,++e._eventsCount;else if("function"==typeof o?o=i[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),(a=bE(e))>0&&o.length>a&&!o.warned){o.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=o.length,function(e){console&&console.warn&&console.warn(e)}(s)}return e}function _E(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function SE(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},a=_E.bind(r);return a.listener=n,r.wrapFn=a,a}function EE(e,t,n){var r=e._events;if(void 0===r)return[];var a=r[t];return void 0===a?[]:"function"==typeof a?n?[a.listener||a]:[a]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(a):xE(a,a.length)}function TE(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function xE(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function ZE(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function a(i){r.once&&e.removeEventListener(t,a),n(i)}))}}Object.defineProperty(gE,"defaultMaxListeners",{enumerable:!0,get:function(){return yE},set:function(e){if("number"!=typeof e||e<0||mE(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");yE=e}}),gE.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},gE.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||mE(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},gE.prototype.getMaxListeners=function(){return bE(this)},gE.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,a=this._events;if(void 0!==a)r=r&&void 0===a.error;else if(!r)return!1;if(r){var i;if(t.length>0&&(i=t[0]),i instanceof Error)throw i;var o=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw o.context=i,o}var s=a[e];if(void 0===s)return!1;if("function"==typeof s)vE(s,this,t);else{var c=s.length,u=xE(s,c);for(n=0;n<c;++n)vE(u[n],this,t)}return!0},gE.prototype.addListener=function(e,t){return wE(this,e,t,!1)},gE.prototype.on=gE.prototype.addListener,gE.prototype.prependListener=function(e,t){return wE(this,e,t,!0)},gE.prototype.once=function(e,t){return kE(t),this.on(e,SE(this,e,t)),this},gE.prototype.prependOnceListener=function(e,t){return kE(t),this.prependListener(e,SE(this,e,t)),this},gE.prototype.removeListener=function(e,t){var n,r,a,i,o;if(kE(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(a=-1,i=n.length-1;i>=0;i--)if(n[i]===t||n[i].listener===t){o=n[i].listener,a=i;break}if(a<0)return this;0===a?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,a),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,o||t)}return this},gE.prototype.off=gE.prototype.removeListener,gE.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var a,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(a=i[r])&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},gE.prototype.listeners=function(e){return EE(this,e,!0)},gE.prototype.rawListeners=function(e){return EE(this,e,!1)},gE.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):TE.call(e,t)},gE.prototype.listenerCount=TE,gE.prototype.eventNames=function(){return this._eventsCount>0?iE(this._events):[]};var CE=fE.exports,RE=new(function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(){return(0,y.Z)(this,n),t.call(this,"message.v1.SocketMessage",[{no:1,name:"event",kind:"scalar",T:13},{no:2,name:"id",kind:"scalar",opt:!0,T:9},{no:3,name:"payload",kind:"scalar",opt:!0,T:12},{no:4,name:"metadata",kind:"scalar",opt:!0,T:12}])}return(0,k.Z)(n)}(_i)),PE=function(){function e(){(0,y.Z)(this,e)}return(0,k.Z)(e,null,[{key:"encode",value:function(e){return RE.toBinary(e)}},{key:"decode",value:function(e){return RE.fromBinary(new Uint8Array(e))}}]),e}();function IE(e,t){return Math.floor(Math.random()*(t-e+1)+e)}var OE=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,y.Z)(this,e),sE(this,"opts"),lE(this,CS,void 0),this.opts={initialTimeout:t.initialTimeout||1e3,maxTimeout:t.maxTimeout||1e4,factor:t.factor||2},dE(this,CS,0)}return(0,k.Z)(e,[{key:"wait",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return dE(this,CS,uE(this,CS)+1),t=IE(0,Math.min(this.opts.maxTimeout,this.opts.initialTimeout*Math.pow(2,uE(this,CS)))),e.next=4,new Promise((function(e){setTimeout(e,t)}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAttempts",value:function(){return uE(this,CS)}},{key:"reset",value:function(){dE(this,CS,0)}}]),e}();CS=new WeakMap;var DE={debug:0,info:1,warn:2,error:3},ME=function(){function e(t){(0,y.Z)(this,e),lE(this,RS,void 0),lE(this,PS,void 0),dE(this,RS,console),dE(this,PS,t)}return(0,k.Z)(e,[{key:"debug",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];DE[uE(this,PS)]>DE.debug||(e=uE(this,RS)).debug.apply(e,["[Sockrates]:"].concat(n))}},{key:"info",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];DE[uE(this,PS)]>DE.info||(e=uE(this,RS)).info.apply(e,["[Sockrates]:"].concat(n))}},{key:"warn",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];DE[uE(this,PS)]>DE.warn||(e=uE(this,RS)).warn.apply(e,["[Sockrates]:"].concat(n))}},{key:"error",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];DE[uE(this,PS)]>DE.error||(e=uE(this,RS)).error.apply(e,["[Sockrates]:"].concat(n))}}]),e}();RS=new WeakMap,PS=new WeakMap;var AE=function(e){return e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSING=2]="CLOSING",e[e.CLOSED=3]="CLOSED",e}(AE||{}),NE=function(){function e(t,n){var r,a,i,o,s,c,u,l,d,p;(0,y.Z)(this,e),lE(this,BS),lE(this,HS),lE(this,WS),lE(this,qS),lE(this,KS),lE(this,QS),lE(this,YS),lE(this,tE),lE(this,rE),lE(this,IS,void 0),lE(this,OS,void 0),lE(this,DS,void 0),lE(this,MS,void 0),lE(this,AS,void 0),lE(this,NS,void 0),lE(this,LS,void 0),lE(this,jS,void 0),lE(this,FS,void 0),lE(this,US,void 0),dE(this,OS,t),dE(this,AS,[]),dE(this,NS,new CE),dE(this,LS,!0),dE(this,jS,!1),dE(this,DS,null!=n?n:{}),null!=(r=uE(this,DS)).autoReconnect||(r.autoReconnect=!0),null!=(a=uE(this,DS)).retryConnectionInterval||(a.retryConnectionInterval=1e3),null!=(i=uE(this,DS)).pingTimeout||(i.pingTimeout=3e4),null!=(o=uE(this,DS)).connectionTimeout||(o.connectionTimeout=5e3),null!=(s=uE(this,DS)).debug||(s.debug=!0),null!=(c=uE(this,DS)).maxReconnectionAttempts||(c.maxReconnectionAttempts=10),null!=(u=uE(this,DS)).disconnectOnPingTimeout||(u.disconnectOnPingTimeout=!0),null!=(l=uE(this,DS)).queueOnDisconnect||(l.queueOnDisconnect=!1),null!=(d=uE(this,DS)).flushOnReconnect||(d.flushOnReconnect=!1),dE(this,MS,null!=(p=uE(this,DS).logger)?p:new ME(uE(this,DS).debug?"debug":"info")),dE(this,US,new OE)}return(0,k.Z)(e,[{key:"readyState",get:function(){return uE(this,IS).readyState}},{key:"url",get:function(){return uE(this,OS)}},{key:"config",get:function(){return uE(this,DS)}},{key:"sendQueue",get:function(){return uE(this,AS)}},{key:"flush",value:function(){var e=this;if(!uE(this,DS).queueOnDisconnect)return!1;var t=[];return uE(this,AS).forEach((function(n){e.send(n.event,n.id,n.payload,n.metadata)||t.push(n)})),dE(this,AS,t),uE(this,AS)}},{key:"connect",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1===uE(this,LS)){e.next=2;break}return e.abrupt("return",new Promise((function(e,n){pE(t,tE,nE).call(t),pE(t,rE,aE).call(t);try{dE(t,IS,new WebSocket(pE(t,BS,VS).call(t,uE(t,OS)))),uE(t,IS).binaryType="arraybuffer",uE(t,MS).debug("Connecting to",uE(t,OS));var r=setTimeout((function(){uE(t,MS).debug("Connection timeout. Closing socket"),dE(t,LS,!0),pE(t,rE,aE).call(t),uE(t,IS).close(3001,"Connection Timeout"),uE(t,DS).autoReconnect&&!uE(t,jS)&&(uE(t,NS).emit("reconnecting"),pE(t,KS,JS).call(t)),n(new Error("Connection timed out!"))}),uE(t,DS).connectionTimeout);uE(t,IS).onopen=function(){uE(t,MS).debug("Ready State: ".concat(AE[uE(t,IS).readyState])),r&&clearTimeout(r),pE(t,YS,eE).call(t),uE(t,NS).emit("connected"),uE(t,DS).flushOnReconnect&&t.flush(),e()},uE(t,IS).onclose=function(e){try{r&&clearTimeout(r);var a=e.code,i=e.reason;if(n(i),uE(t,MS).debug("Socket closed. Close event:",e),uE(t,MS).debug("Connection closed code:",a),uE(t,MS).debug("Connection closed reason:",i),uE(t,LS)&&1e3!==a&&uE(t,DS).autoReconnect&&!uE(t,jS))return uE(t,NS).emit("reconnecting"),void pE(t,KS,JS).call(t);uE(t,jS)||uE(t,NS).emit("disconnected",{code:a,reason:i})}catch(a){pE(t,HS,zS).call(t,a)}},uE(t,IS).onerror=function(e){pE(t,HS,zS).call(t,e)},uE(t,IS).onmessage=function(e){return pE(t,WS,GS).call(t,e)}}catch(a){pE(t,HS,zS).call(t,a,n)}})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(e,t,n,r){var a={event:e,id:t,payload:n,metadata:r};if(uE(this,DS).queueOnDisconnect&&(!uE(this,IS)||1!==uE(this,IS).readyState))return uE(this,MS).debug("Queuing message since socket is not connected!",a),uE(this,AS).push(a),!1;var i=PE.encode(a);return pE(this,QS,XS).call(this,i)}},{key:"emit",value:function(e,t,n,r){return this.send(e,t,n,r)}},{key:"receive",value:function(e,t){return uE(this,NS).on(e.toString(),t)}},{key:"on",value:function(e,t){"string"!=typeof e||"connected"!==e&&"disconnected"!==e&&"errored"!==e&&"reconnected"!==e&&"reconnecting"!==e&&"reconnectAttempt"!==e&&"reconnectFailure"!==e&&"failed"!==e?this.receive(e,t):uE(this,NS).on(e,t)}},{key:"removeAllListeners",value:function(){uE(this,NS).removeAllListeners()}},{key:"removeReceiver",value:function(e,t){this.removeListener(e,t)}},{key:"removeListener",value:function(e,t){uE(this,NS).removeListener(e.toString(),t)}},{key:"removeReceivers",value:function(e){this.removeListeners(e)}},{key:"removeListeners",value:function(e){var t=this;uE(this,NS).listeners(e.toString()).map((function(n){return t.removeListener(e,n)}))}},{key:"disconnect",value:function(){dE(this,LS,!1),pE(this,tE,nE).call(this),this.removeAllListeners(),uE(this,IS).close(1e3,"Sockrates disconnect method called.")}}]),e}();IS=new WeakMap,OS=new WeakMap,DS=new WeakMap,MS=new WeakMap,AS=new WeakMap,NS=new WeakMap,LS=new WeakMap,jS=new WeakMap,FS=new WeakMap,US=new WeakMap,BS=new WeakSet,VS=function(e){if(e.startsWith("ws://")||e.startsWith("wss://"))return e;if(e.startsWith("https://"))return"wss://".concat(e.substring(8));if(e.startsWith("http://"))return"ws://".concat(e.substring(7));throw new Error("Invalid URL. URL must start with http(s):// or ws(s)://.")},HS=new WeakSet,zS=function(e,t){uE(this,MS).error("Error:",e),uE(this,NS).emit("errored",{error:e}),null==t||t(e)},WS=new WeakSet,GS=function(e){if("2"===e.data)return uE(this,MS).debug("Received ping from server"),pE(this,YS,eE).call(this),void pE(this,QS,XS).call(this,"3");uE(this,MS).debug("Received data:",e.data);var t=PE.decode(e.data),n=t.id,r=t.payload;uE(this,NS).emit(t.event.toString(),{id:n,payload:r})},qS=new WeakSet,$S=function(){return 1===uE(this,IS).readyState},KS=new WeakSet,JS=function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!(t.length>0&&void 0!==t[0])||t[0])||!uE(this,jS)){e.next=4;break}return uE(this,MS).debug("Reconnect called when already in a reconnect loop. Ignoring."),e.abrupt("return");case 4:if(uE(this,jS)||uE(this,US).reset(),!(null!==uE(this,DS).maxReconnectionAttempts&&uE(this,US).getAttempts()>=uE(this,DS).maxReconnectionAttempts)){e.next=7;break}return uE(this,NS).emit("failed"),dE(this,jS,!1),e.abrupt("return");case 7:return dE(this,jS,!0),pE(this,rE,aE).call(this),pE(this,tE,nE).call(this),e.prev=8,e.next=11,uE(this,US).wait();case 11:if(!1!==uE(this,LS)){e.next=13;break}return e.abrupt("return");case 13:return uE(this,MS).debug("Reconnection attempt ".concat(uE(this,US).getAttempts())),uE(this,NS).emit("reconnectAttempt",{attempt:uE(this,US).getAttempts()}),e.next=17,this.connect();case 17:if(pE(this,qS,$S).call(this)){e.next=19;break}throw Error("Reconnect Failed");case 19:dE(this,jS,!1),uE(this,NS).emit("reconnected"),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(8),uE(this,MS).debug("Failed to reconnect."),uE(this,NS).emit("reconnectFailure",{attempt:uE(this,US).getAttempts()}),pE(this,KS,JS).call(this,!1);case 25:case"end":return e.stop()}}),e,this,[[8,22]])})));return function(){return e.apply(this,arguments)}}(),QS=new WeakSet,XS=function(e){try{return uE(this,IS).send(e),!0}catch(t){return uE(this,MS).error(t.message),!1}},YS=new WeakSet,eE=function(){var e=this;this.config.disconnectOnPingTimeout&&(uE(this,MS).debug("Resetting ping timeout"),pE(this,tE,nE).call(this),dE(this,FS,setTimeout((function(){var t;uE(e,MS).debug("Disconnecting the socket due to ping timeout"),dE(e,LS,!0);var n="Ping timeout";null==(t=uE(e,IS))||t.close(3002,n),uE(e,NS).emit("disconnected",{code:3002,reason:n}),uE(e,DS).autoReconnect&&!uE(e,jS)&&(uE(e,MS).debug("Triggering reconnection due to ping timeout"),uE(e,NS).emit("reconnecting"),pE(e,KS,JS).call(e))}),uE(this,DS).pingTimeout)))},tE=new WeakSet,nE=function(){uE(this,FS)&&(clearTimeout(uE(this,FS)),dE(this,FS,void 0))},rE=new WeakSet,aE=function(){uE(this,IS)&&(uE(this,IS).onopen=void 0,uE(this,IS).onerror=void 0,uE(this,IS).onmessage=void 0,uE(this,IS).onclose=void 0)};var LE,jE,FE,UE,BE,VE,HE=Object.defineProperty,zE=Object.getOwnPropertyDescriptor,WE=function(e,t,n,r){for(var a,i=r>1?void 0:r?zE(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&HE(t,n,i),i},GE=function(){function e(t){var n,r=t.peerId,a=t.roomName,i=t.authToken,o=t.url,s=t.capabilities;if((0,y.Z)(this,e),Xo(this,UE),Xo(this,LE,void 0),Xo(this,jE,void 0),Xo(this,FE,void 0),Ko(this,"roomName"),Ko(this,"peerId"),Ko(this,"authToken"),Ko(this,"capabilities"),!r||!a||!i)throw new Jp("peerId, roomName, or authToken can not be empty");var c=kp.apiBase.includes("staging.dyte")?"socket-staging.dyte.io":"socket-edge.dyte.io";"string"==typeof uv("socket_server_base")&&(c=uv("socket_server_base"));var l="wss://".concat(c);this.roomName=a,this.peerId=r,this.authToken=i,this.capabilities=s;var d=new URL("".concat(null!=o?o:l,"/ws")),p={roomID:a,peerID:r,authToken:i,useMediaV2:s.includes("HIVE"),ping:s.includes("PING"),capabilities:s.map((function(e){return Xv[e]})).join(" ")};Object.entries(p).forEach((function(e){var t=(0,u.Z)(e,2),n=t[0],r=t[1];d.searchParams.append(n,r.toString())})),Yo(this,LE,d.href),Yo(this,FE,r),Yo(this,jE,new NE(Qo(this,LE),{autoReconnect:!0,disconnectOnPingTimeout:null!=(n=s.includes("PING"))&&n,queueOnDisconnect:!0,flushOnReconnect:!1,logger:qp}))}return(0,k.Z)(e,[{key:"url",get:function(){return Qo(this,LE)}},{key:"connect",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r,a,i,o,s;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=function(){qp.info("SocketService::connect::Connected to socket-edge"),vf.emit(ff.SOCKET_SERVICE_CONNECTED)},this.onStateEvent("connected",t),n=function(e){var t=e.reason,n=e.code;qp.info("SocketService::connect::Disconnected from socket-edge",{reason:t,code:n}),vf.emit(ff.SOCKET_SERVICE_DISCONNECTED),!(n<4e3||n>4002)&&(4e3===n?qp.error("SocketService::connect::Bad Request",{code:n,reason:t}):4001===n?qp.error("SocketService::connect::Unauthorized",{code:n,reason:t}):4002===n?qp.error("SocketService::connect::Internal Error",{code:n,reason:t}):qp.error("SocketService::connect::Unknown Error",{code:n,reason:t}))},this.onStateEvent("disconnected",n),r=function(){qp.info("SocketService::connect::Reconnecting to socket-edge"),vf.emit(ff.SOCKET_SERVICE_RECONNECTING)},this.onStateEvent("reconnecting",r),a=function(e){var t=e.attempt;qp.info("SocketService::connect::Attempting reconnect to socket-edge"),vf.emit(ff.SOCKET_SERVICE_RECONNECTION_ATTEMPT,{attempt:t})},this.onStateEvent("reconnectAttempt",a),i=function(e){var t=e.attempt;qp.info("SocketService::connect::Reconnect attempt failed"),vf.emit(ff.SOCKET_SERVICE_RECONNECT_FAILURE,{attempt:t})},this.onStateEvent("reconnectFailure",i),o=function(){qp.info("SocketService::connect::Reconnected to socket-edge"),vf.emit(ff.SOCKET_SERVICE_RECONNECTED)},this.onStateEvent("reconnected",o),s=function(){qp.info("SocketService::connect::Socket-edge reconnects failed"),vf.emit(ff.SOCKET_SERVICE_FAILED)},this.onStateEvent("failed",s),e.next=16,Qo(this,jE).connect();case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){return Qo(this,jE).disconnect()}},{key:"isConnected",get:function(){try{return 1===Qo(this,jE).readyState}catch(e){return!1}}},{key:"sendMessage",value:function(e,t,n){var r={};return Gp.injectContext(r),Qo(this,jE).send(e,null!=n?n:es(this,UE,BE).call(this),t,(new TextEncoder).encode(JSON.stringify(r)))}},{key:"sendMessagePromise",value:function(e,t,n){var r=parseInt({}.SOCKET_SERVICE_MESSAGE_REQUEST_TIMEOUT,10)||2e4;return this.sendMessagePromiseWithTimeout({event:e,timeout:r,protobuf:t,messageId:n})}},{key:"sendMessagePromiseWithTimeout",value:function(e){var t=this,n=e.event,r=e.timeout,a=e.protobuf,i=e.messageId;return new Promise((function(e,o){var s=null!=i?i:es(t,UE,BE).call(t),c={};Gp.injectContext(c),setTimeout(o,r,"request timeout for callback");var u=function r(a){var i=a.id,o=a.payload;s===i&&(e({id:i,payload:o}),Qo(t,jE).removeListener(n,r),Qo(t,jE).removeListener(65535,r))};Qo(t,jE).on(n,u),Qo(t,jE).on(65535,u),Qo(t,jE).send(n,s,a,(new TextEncoder).encode(JSON.stringify(c)))}))}},{key:"on",value:function(e,t){Qo(this,jE).on(e,t)}},{key:"onStateEvent",value:function(e,t){Qo(this,jE).on(e,t)}},{key:"flush",value:function(){return Qo(this,jE).flush()}}]),e}();LE=new WeakMap,jE=new WeakMap,FE=new WeakMap,UE=new WeakSet,BE=function(){return"".concat(Qo(this,FE),"-").concat((Math.random()+1).toString(36).substring(7))},WE([Gp.trace("SocketService.connect")],GE.prototype,"connect",1),WE([Gp.trace("SocketService.disconnect")],GE.prototype,"disconnect",1),WE([Gp.trace("SocketService.sendMessage")],GE.prototype,"sendMessage",1),WE([Gp.trace("SocketService.sendMessagePromise")],GE.prototype,"sendMessagePromise",1);var qE=function(){function e(t){(0,y.Z)(this,e),Xo(this,VE,void 0),Yo(this,VE,t)}return(0,k.Z)(e,[{key:"addPlugin",value:function(e,t){Qo(this,VE).sendMessage(kg.addPlugin,Cm.toBinary({pluginId:e,staggered:t}))}},{key:"removePlugin",value:function(e){Qo(this,VE).sendMessage(kg.removePlugin,Rm.toBinary({pluginId:e,staggered:!1}))}},{key:"getActivePlugins",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qo(this,VE).sendMessagePromise(kg.getPlugins);case 2:return t=e.sent,n=t.payload,e.abrupt("return",n?Vm.fromBinary(n):{plugins:[]});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"customPluginEventToRoom",value:function(e,t,n){var r={pluginId:e,pluginData:(new TextEncoder).encode(JSON.stringify(t))};Qo(this,VE).sendMessage(kg.customPluginEventToRoom,Mm.toBinary(r),n)}},{key:"customPluginEventToPeers",value:function(e,t,n,r){var a={pluginId:e,peerIds:t,pluginData:(new TextEncoder).encode(JSON.stringify(n))};Qo(this,VE).sendMessage(kg.customPluginEventToPeers,Am.toBinary(a),r)}},{key:"enablePluginForRoom",value:function(e,t){Qo(this,VE).sendMessage(kg.enablePluginForRoom,Pm.toBinary({pluginId:e}),t)}},{key:"enablePluginForPeers",value:function(e,t,n){Qo(this,VE).sendMessage(kg.enablePluginForPeers,Om.toBinary({pluginId:e,peerIds:t}),n)}},{key:"disablePluginForRoom",value:function(e,t){Qo(this,VE).sendMessage(kg.disablePluginForRoom,Im.toBinary({pluginId:e}),t)}},{key:"disablePluginForPeers",value:function(e,t,n){Qo(this,VE).sendMessage(kg.disablePluginForPeers,Dm.toBinary({pluginId:e,peerIds:t}),n)}},{key:"storeInsertKeys",value:function(e,t,n,r){var a={pluginId:e,storeName:t,insertKeys:n.map((function(e){return{storeKey:e.key,payload:(new TextEncoder).encode(JSON.stringify(e.payload))}}))};Qo(this,VE).sendMessage(kg.storeInsertKeys,Lm.toBinary(a),r)}},{key:"storeGetKeys",value:function(e,t,n,r){var a={pluginId:e,storeName:t,getKeys:n.map((function(e){return{storeKey:e.key}}))};Qo(this,VE).sendMessage(kg.storeGetKeys,jm.toBinary(a),r)}},{key:"storeDeleteKeys",value:function(e,t,n,r){var a={pluginId:e,storeName:t,deleteKeys:n.map((function(e){return{storeKey:e.key}}))};Qo(this,VE).sendMessage(kg.storeDeleteKeys,Fm.toBinary(a),r)}},{key:"storeDelete",value:function(e,t,n){Qo(this,VE).sendMessage(kg.storeDelete,Um.toBinary({pluginId:e,storeName:t}),n)}},{key:"getPluginDataOld",value:function(e,t){qp.info("getPluginDataOld",{pluginId:e,store:t})}},{key:"storePluginDataOld",value:function(e,t,n){var r={pluginId:e,storeName:t,insertKeys:[{storeKey:n.key,payload:(new TextEncoder).encode(JSON.stringify(n))}]};Qo(this,VE).sendMessage(kg.storeInsertKeys,Lm.toBinary(r))}},{key:"on",value:function(e,t){var n;switch(e){case kg.addPlugin:case kg.enablePluginForPeers:case kg.enablePluginForRoom:n=Bm.fromBinary.bind(Bm);break;case kg.removePlugin:case kg.disablePluginForPeers:case kg.disablePluginForRoom:n=Hm.fromBinary.bind(Hm);break;case kg.customPluginEventToPeers:case kg.customPluginEventToRoom:n=Gm.fromBinary.bind(Gm);break;case kg.storeInsertKeys:case kg.storeGetKeys:case kg.storeDeleteKeys:case kg.storeDelete:n=Wm.fromBinary.bind(Wm)}Qo(this,VE).on(e,(function(e){var r=e.payload,a=e.id,i=n(r);return t(i,a)}))}}]),e}();VE=new WeakMap;var $E,KE,JE=Object.defineProperty,QE=Object.getOwnPropertyDescriptor,XE=function(e,t,n,r){for(var a,i=r>1?void 0:r?QE(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&JE(t,n,i),i},YE=(KE=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;return(0,y.Z)(this,n),r=t.call(this),Xo((0,v.Z)(r),$E,void 0),Ko((0,v.Z)(r),"recordingState","IDLE"),Ko((0,v.Z)(r),"recordingId"),Ko((0,v.Z)(r),"recordingPeerId"),Yo((0,v.Z)(r),$E,e),r}return(0,k.Z)(n,[{key:"setRecordingState",value:function(e){var t=this.recordingState;this.recordingState=e,t!==e&&this.emitCurrentRecordingState()}},{key:"emitCurrentRecordingState",value:function(){this.emit("recordingUpdate",this.recordingState)}},{key:"start",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Qo(this,$E).permissions.canRecord){e.next=2;break}throw qp.error("DyteRecording::start::permission_denied"),new Jp("User does not have permission to start recording");case 2:if("STARTING"!==this.recordingState&&"RECORDING"!==this.recordingState&&"STOPPING"!==this.recordingState){e.next=4;break}throw qp.error("DyteRecording::start::recording_in_progress",{recordingState:this.recordingState}),new Jp("Cant start recording, recordingState irregular: ".concat(this.recordingState));case 4:return this.setRecordingState("STARTING"),e.prev=5,e.next=8,vg().startRecording();case 8:t=e.sent,this.recordingId=t,e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(5),qp.error("DyteRecording::stop::recording_failed_to_start"),this.setRecordingState("IDLE"),new Jp("Error while starting recording");case 15:case"end":return e.stop()}}),e,this,[[5,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Qo(this,$E).permissions.canRecord){e.next=2;break}throw qp.error("DyteRecording::stop::permission_denied"),new Jp("User does not have permission to stop recording");case 2:if(e.t0="RECORDING"!==this.recordingState||!this.recordingId,!e.t0){e.next=7;break}return qp.error("DyteRecording::stop::recording_not_in_progress",{recordingState:this.recordingState,recordingId:this.recordingId}),e.next=7,this.getRecordingId();case 7:if("RECORDING"===this.recordingState&&this.recordingId){e.next=9;break}throw qp.error("DyteRecording::stop::recording_not_in_progress",{recordingState:this.recordingState,recordingId:this.recordingId}),new Jp("Cant stop recording, recordingState irregular: ".concat(this.recordingState));case 9:return this.setRecordingState("STOPPING"),e.prev=10,e.next=13,vg().stopRecording(this.recordingId);case 13:this.setRecordingState("IDLE"),e.next=19;break;case 16:throw e.prev=16,e.t1=e.catch(10),qp.error("DyteRecording::stop::recording_failed_to_stop"),this.setRecordingState("RECORDING"),new Jp("Error while stopping recording");case 19:case"end":return e.stop()}}),e,this,[[10,16]])})));return function(){return e.apply(this,arguments)}}()},{key:"getRecordingId",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Qo(this,$E).permissions.canRecord){e.next=2;break}throw qp.error("DyteRecording::getRecordingId::permission_denied"),new Jp("User does not have permission to stop recording");case 2:return e.prev=2,t=vg(),e.next=6,t.getActiveRecording();case 6:n=e.sent,r=n.status,a=n.id,"RECORDING"===r&&(this.recordingState="RECORDING",this.recordingId=a),e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(2),qp.error("DyteRecording::getRecordingId::unable_to_get_recording_id"),new Jp("Unable to get recording");case 15:case"end":return e.stop()}}),e,this,[[2,12]])})));return function(){return e.apply(this,arguments)}}()}]),n}(yp),$E=new WeakMap,KE);XE([Gp.trace("DyteRecording.start")],YE.prototype,"start",1),XE([Gp.trace("DyteRecording.stop")],YE.prototype,"stop",1),XE([Gp.trace("DyteRecording.getRecordingId")],YE.prototype,"getRecordingId",1),YE=XE([Yp((function(e){throw new Jp(e.message,"1000")}))],YE);var eT=Object.defineProperty,tT=Object.getOwnPropertyDescriptor,nT=function(){function e(t){(0,y.Z)(this,e),Ko(this,"recording"),this.recording=new YE(t),this.setupEvents()}return(0,k.Z)(e,[{key:"setupEvents",value:function(){var e=this;vf.on(ff.HIVE_RECORDING_STARTED,(function(t){e.recording.recordingPeerId=t,e.recording.setRecordingState("RECORDING")})),vf.on(ff.HIVE_RECORDING_STOPPED,(function(){e.recording.recordingPeerId=void 0,e.recording.setRecordingState("IDLE")})),vf.on(ff.PEER_JOINED,function(){var t=(0,d.Z)((0,l.Z)().mark((function t(n){var r;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null!=(r=n.flags)&&r.recorder&&(e.recording.recordingPeerId=n.id,e.recording.setRecordingState("RECORDING"));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),vf.on(ff.PEER_CLOSED,(function(t){t.id===e.recording.recordingPeerId&&(e.recording.recordingPeerId=void 0,e.recording.setRecordingState("IDLE"))})),vf.onAsync(ff.ROOM_JOINED,function(){var t=(0,d.Z)((0,l.Z)().mark((function t(n){var r,a,i;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:qp.debug("[ROOM_JOINED] resolved request to fetch recordings."),(i=null==(r=n.peers)?void 0:r.filter((function(e){var t;return!(null==(t=e.flags)||!t.recorder)}))).length?(e.recording.recordingPeerId=i&&(null==(a=i[0])?void 0:a.id),e.recording.setRecordingState("RECORDING")):(e.recording.recordingPeerId=void 0,e.recording.setRecordingState("IDLE"));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),vf.on(ff.RECORDING_STARTED,(function(){e.recording.setRecordingState("RECORDING")})),vf.on(ff.RECORDING_STOPPED,(function(){e.recording.recordingId=void 0,e.recording.recordingPeerId=void 0,e.recording.setRecordingState("IDLE")}))}}]),e}();!function(e,t,n,r){for(var a,i=r>1?void 0:r?tT(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);r&&i&&eT(t,n,i)}([Gp.trace("RecordingController.setupEvents")],nT.prototype,"setupEvents",1);var rT,aT,iT,oT,sT=Object.defineProperty,cT=Object.getOwnPropertyDescriptor,uT=function(e){return e[e.User=0]="User",e[e.Spotlight=1]="Spotlight",e}(uT||{}),lT=(oT=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;return(0,y.Z)(this,n),r=t.call(this),Xo((0,v.Z)(r),rT),Ko((0,v.Z)(r),"selfActiveTab"),Ko((0,v.Z)(r),"spotlighted"),Xo((0,v.Z)(r),iT,void 0),r.spotlighted=e.permissions.canSpotlight,Yo((0,v.Z)(r),iT,e),r}return(0,k.Z)(n,[{key:"roomJoined",get:function(){var e;return!0===(null==(e=Qo(this,rT,aT))?void 0:e.roomJoined)}},{key:"setSpotlighted",value:function(e){if(!Qo(this,iT).permissions.canSpotlight)throw qp.error("DyteSpotlight::setSpotlighted::permission_denied"),new Jp("User does not have permission to toggle spotlight");this.spotlighted=e,this.emit("spotlightUpdate",this.spotlighted),this.spotlighted&&this.assertSpotlightToRoom()}},{key:"setSelfActiveTab",value:function(e,t){var n;qp.info("DyteSpotlight::setActiveTab",{spotlightTab:{id:e.id,type:e.type}}),this.selfActiveTab=e,0===t&&this.emit("selfTabUpdate",e),null!=(n=Qo(this,iT).permissions)&&n.canSpotlight&&this.spotlighted&&0===t&&this.assertSpotlightToRoom()}},{key:"assertSpotlightToRoom",value:function(){Qo(this,rT,aT)instanceof Ob&&this.selfActiveTab&&Qo(this,rT,aT).assertSpotlightToRoom({spotlightedUserId:Qo(this,iT).userId,currentTab:this.selfActiveTab,peerId:void 0})}}],[{key:"init",value:function(e){return new lT(e)}}]),n}(yp),rT=new WeakSet,aT=function(){return Lb()},iT=new WeakMap,oT);lT=function(e,t,n,r){for(var a,i=r>1?void 0:r?cT(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&sT(t,n,i),i}([Yp((function(e){throw new Jp(e.message,"1300")}))],lT);var dT,pT,fT,hT=Object.defineProperty,vT=Object.getOwnPropertyDescriptor,mT=function(){function e(t){(0,y.Z)(this,e),Xo(this,pT),Ko(this,"spotlight"),Xo(this,dT,void 0),this.spotlight=lT.init(t),Yo(this,dT,t),this.setupEvents()}return(0,k.Z)(e,[{key:"conditionallySetActiveTab",value:function(e){var t;null!=e&&e.currentTab&&(null==(t=this.spotlight.selfActiveTab)?void 0:t.id)!==e.currentTab.id&&(this.spotlight.setSelfActiveTab(e.currentTab,uT.Spotlight),this.spotlight.emit("activeTabUpdate",e.currentTab))}},{key:"setupEvents",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Qo(this,dT).permissions.canSpotlight&&(qp.info("DyteSpotlightController::Asserting Spotlight"),Qo(this,pT,fT)instanceof Ob&&this.spotlight.selfActiveTab&&Qo(this,pT,fT).assertSpotlightToRoom({spotlightedUserId:Qo(this,dT).userId,currentTab:this.spotlight.selfActiveTab,peerId:void 0})),vf.on(ff.PEER_JOINED,function(){var e=(0,d.Z)((0,l.Z)().mark((function e(n){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Qo(t,dT).permissions.canSpotlight&&Qo(t,pT,fT)instanceof Ob&&t.spotlight.selfActiveTab&&Qo(t,pT,fT).assertSpotlightToPeer({spotlightedUserId:Qo(t,dT).userId,currentTab:t.spotlight.selfActiveTab,peerId:n.id});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),vf.on(ff.ROOM_MESSAGE,(function(e){var n,r;"spotlight"===e.roomMessageType&&(qp.info("Spotlight Assertion Received",{spotligher:e.spotlightedUserId,currentTab:{id:null==(n=e.currentTab)?void 0:n.id,type:null==(r=e.currentTab)?void 0:r.type}}),t.conditionallySetActiveTab(e))})),vf.on(ff.MESSAGE,(function(e){var n,r;"spotlight"===e.roomMessageType&&(qp.info("Spotlight Assertion Received",{spotligher:e.spotlightedUserId,currentTab:{id:null==(n=e.currentTab)?void 0:n.id,type:null==(r=e.currentTab)?void 0:r.type}}),t.conditionallySetActiveTab(e))}));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();dT=new WeakMap,pT=new WeakSet,fT=function(){return Lb()},function(e,t,n,r){for(var a,i=r>1?void 0:r?vT(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);r&&i&&hT(t,n,i)}([Gp.trace("SpotlightController.setupEvents")],mT.prototype,"setupEvents",1);var gT,yT,kT,bT,wT="NewConnectedMeeting_",_T=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e,r,a,i){var o;return(0,y.Z)(this,n),o=t.call(this),Xo((0,v.Z)(o),gT,void 0),Ko((0,v.Z)(o),"clientSpecificIdToParticipantMap",{}),Ko((0,v.Z)(o),"clientSpecificIdToMeetingIdMap",{}),Xo((0,v.Z)(o),yT,void 0),Xo((0,v.Z)(o),kT,void 0),Xo((0,v.Z)(o),bT,void 0),Ko((0,v.Z)(o),"meetingsList",[]),Yo((0,v.Z)(o),gT,e),Yo((0,v.Z)(o),yT,r),Yo((0,v.Z)(o),kT,a),Yo((0,v.Z)(o),bT,i),o}return(0,k.Z)(n,[{key:"getUnassignedParticipants",value:function(){var e=this,t=[];this.meetingsList.forEach((function(e){e.participants.forEach((function(e){t.push(e.clientSpecificId)}))}));var n=[];return Object.keys(this.clientSpecificIdToParticipantMap).forEach((function(r){t.includes(r)||n.push(e.clientSpecificIdToParticipantMap[r])})),n}},{key:"openTitleEditorForConnectedMeeting",value:function(e){var t=this.meetingsList.find((function(t){return t.id===e}));t.isTitleEditorOpen=!0,this.emit("stateUpdate",{source:"openTitleEditorForConnectedMeeting"})}},{key:"closeTitleEditorForConnectedMeeting",value:function(e){var t=this.meetingsList.find((function(t){return t.id===e}));t.isTitleEditorOpen=!1,this.emit("stateUpdate",{source:"closeTitleEditorForConnectedMeeting"})}},{key:"assignParticipants",value:function(e,t,n){var r=this;this.unassignParticipants(t);var a=this.meetingsList.find((function(t){return t.id===e}));a&&t.forEach((function(e){var t=r.clientSpecificIdToParticipantMap[e];t&&a.participants.push(t)})),n||this.emit("stateUpdate",{source:"assignParticipants"})}},{key:"assignParticipantsRandomly",value:function(e){var t=this,n=[];n=function(e){return e.sort((function(){return Math.random()-.5}))}(n=null!=e&&e.length?(0,o.Z)(e):this.getUnassignedParticipants().map((function(e){return e.clientSpecificId})));var r=this.meetingsList.filter((function(e){return"ACTIVE"===e.status&&!e.shouldDelete})),a=Math.floor(n.length/r.length);r.forEach((function(e,r){n.slice(r*a,(r+1)*a).forEach((function(n){var r=t.clientSpecificIdToParticipantMap[n];r&&e.participants.push(r)}))})),n.slice(r.length*a).forEach((function(e){var n=r[Math.floor(Math.random()*r.length)].id;t.assignParticipants(n,[e],!0)})),this.emit("stateUpdate",{source:"assignParticipantsRandomly"})}},{key:"unassignParticipants",value:function(e){this.meetingsList.forEach((function(t){t.participants=t.participants.filter((function(t){return!e.includes(t.clientSpecificId)}))})),this.emit("stateUpdate",{source:"unassignParticipants"})}},{key:"unassignAllParticipants",value:function(){this.meetingsList.forEach((function(e){e.participants.splice(0)})),this.emit("stateUpdate",{source:"unassignAllParticipants"})}},{key:"addNewConnectedMeeting",value:function(e){this.meetingsList.push({id:wT+Z(),title:e||"Room ".concat(this.getConnectedMeetings().length+1),status:"ACTIVE",shouldPersistInDB:!0,participants:[]}),this.emit("stateUpdate",{source:"addNewConnectedMeeting"})}},{key:"renameConnectedMeeting",value:function(e,t){var n=this.meetingsList.find((function(t){return t.id===e}));n.title=t,n.shouldRename=!0,this.emit("stateUpdate",{source:"renameConnectedMeeting"})}},{key:"deleteConnectedMeetings",value:function(e){this.meetingsList.forEach((function(t){e.includes(t.id)&&(Object.assign(t,{shouldDelete:!0}),Object.assign(t,{participants:[]}))})),this.emit("stateUpdate",{source:"deleteConnectedMeeting"})}},{key:"getConnectedMeetings",value:function(){return this.meetingsList.filter((function(e){return!e.shouldDelete}))}},{key:"applyChanges",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r,a=this;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],n={},r=[],e.next=3,Promise.all(this.meetingsList.map(function(){var e=(0,d.Z)((0,l.Z)().mark((function e(i){var o,s,c,u;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!i.shouldDelete||i.id.startsWith(wT)){e.next=3;break}return t.push(i.id),e.abrupt("return");case 3:if(!i.shouldPersistInDB){e.next=16;break}return e.prev=4,e.next=7,Qo(a,gT).createConnectedMeetings([{title:i.title}]);case 7:u=e.sent,null!=(o=null==u?void 0:u.payload)&&o.meetings&&null!=(c=null==(s=null==u?void 0:u.payload)?void 0:s.meetings[0])&&c.id?Object.assign(i,{id:u.payload.meetings[0].id}):qp.error("ConnectedMeetingsState::applyChanges::replacingMeetingId",null==u?void 0:u.payload),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),qp.error("ConnectedMeetingsState::applyChanges::replacingMeetingId",e.t0);case 14:e.next=17;break;case 16:i.shouldRename&&r.push({title:i.title,meetingId:i.id});case 17:i.participants.forEach((function(e){var t=a.clientSpecificIdToMeetingIdMap[e.clientSpecificId],r=i.id;if(t!==r){var o="".concat(t,"__").concat(r).toString();n[o]=n[o]||{participantIds:[]},n[o].participantIds.push(e.id)}}));case 18:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t){return e.apply(this,arguments)}}()));case 3:if(e.t0=r.length>0,!e.t0){e.next=7;break}return e.next=7,Qo(this,gT).updateConnectedMeetings(r);case 7:return this.getUnassignedParticipants().forEach((function(e){var t,r,i=a.clientSpecificIdToMeetingIdMap[e.clientSpecificId],o=null==(t=Qo(a,gT))?void 0:t.parentMeeting.id;if(i!==o){var s="".concat(i,"__").concat(o).toString();n[s]=n[s]||{participantIds:[]},n[s].participantIds.push(null==(r=a.clientSpecificIdToParticipantMap[e.clientSpecificId])?void 0:r.id)}})),e.next=10,Promise.all(Object.keys(n).map(function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var r,i,o,s;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.split("__"),i=(0,u.Z)(r,2),o=i[0],s=i[1],e.abrupt("return",s.startsWith(wT)?(qp.error("ConnectedMeetingsState::applyChanges::meetingIdNotReplaced",{message:"Please find errors with ConnectedMeetingsState::applyChanges::replacingMeetingId to know more"}),null):Qo(a,gT).moveParticipants({sourceMeetingId:o,destinationMeetingId:s,participants:n[t].participantIds}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 10:if(e.t1=t.length>0,!e.t1){e.next=14;break}return e.next=14,Qo(this,gT).deleteConnectedMeetings(t);case 14:this.reset();case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"startConnectedMeetings",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.applyChanges());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reset",value:function(){this.meetingsList=[],this.emit("stateUpdate",{source:"reset"})}},{key:"init",value:function(){var e,t,n=this;this.clientSpecificIdToParticipantMap={},this.clientSpecificIdToMeetingIdMap={},this.meetingsList=structuredClone((null==(e=Qo(this,gT).list)?void 0:e.filter((function(e){return"ACTIVE"===e.status})))||[]);var r=Qo(this,kT).roomName,a=structuredClone(Qo(this,yT).active.toArray().map((function(e){return{clientSpecificId:e.clientSpecificId,id:e.userId,name:e.name,picture:e.picture}})));a.push({clientSpecificId:Qo(this,bT).clientSpecificId,id:Qo(this,bT).userId,name:Qo(this,bT).name,picture:Qo(this,bT).picture});var i=structuredClone(Qo(this,gT).list),o=structuredClone(null==(t=Qo(this,gT))?void 0:t.parentMeeting);null==o||o.participants.forEach((function(e){n.clientSpecificIdToParticipantMap[e.clientSpecificId]=e,n.clientSpecificIdToMeetingIdMap[e.clientSpecificId]=o.id})),i.forEach((function(e){var t;null==(t=e.participants)||t.forEach((function(t){n.clientSpecificIdToParticipantMap[t.clientSpecificId]=t,n.clientSpecificIdToMeetingIdMap[t.clientSpecificId]=e.id}))})),a.forEach((function(e){n.clientSpecificIdToParticipantMap[e.clientSpecificId]=e,n.clientSpecificIdToMeetingIdMap[e.clientSpecificId]=r})),this.emit("stateUpdate",{source:"init"})}}]),n}(yp);gT=new WeakMap,yT=new WeakMap,kT=new WeakMap,bT=new WeakMap;var ST,ET,TT,xT,ZT,CT,RT=Object.defineProperty,PT=Object.getOwnPropertyDescriptor,IT=(CT=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e,r,a){var i;return(0,y.Z)(this,n),i=t.call(this),Xo((0,v.Z)(i),xT),Xo((0,v.Z)(i),ST,void 0),Ko((0,v.Z)(i),"stateManager"),Xo((0,v.Z)(i),ET,void 0),Xo((0,v.Z)(i),TT,void 0),Ko((0,v.Z)(i),"list",[]),Ko((0,v.Z)(i),"parentMeeting",null),Yo((0,v.Z)(i),ST,e),Yo((0,v.Z)(i),ET,r),Yo((0,v.Z)(i),TT,a),i.stateManager=new _T((0,v.Z)(i),r,a,e),i}return(0,k.Z)(n,[{key:"supportsConnectedMeetings",get:function(){return""!==Qo(this,ST).id&&av.isV2AuthToken&&Vc.hasFeature(Sp.CONNECTED_MEETINGS)}},{key:"validateConnectedMeetingsAction",value:function(){if(!this.supportsConnectedMeetings)throw new Error("You are not allowed to perform this action.\n            Please connect with Dyte team to move you to V2 APIs & to enable connected meetings.")}},{key:"createConnectedMeetings",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.validateConnectedMeetingsAction(),Qo(this,xT,ZT).sendMessage({type:"createConnectedMeetings",payload:t})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getConnectedMeetings",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.validateConnectedMeetingsAction(),null==(t=Qo(this,xT,ZT))?void 0:t.sendMessage({type:"getConnectedMeetings"})));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateConnectedMeetings",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.validateConnectedMeetingsAction(),Qo(this,xT,ZT).sendMessage({type:"updateConnectedMeetings",payload:t})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteConnectedMeetings",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(this.validateConnectedMeetingsAction(),Qo(this,xT,ZT).sendMessage({type:"deleteConnectedMeetings",payload:{meetingIds:t}})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"moveParticipants",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.validateConnectedMeetingsAction(),e.next=3,Qo(this,xT,ZT).sendMessage({type:"moveConnectedMeeting",payload:t});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"canSwitchConnectedMeetings",value:function(){var e;return(null==(e=Qo(this,ST).permissions)?void 0:e.connectedMeetings).canSwitchConnectedMeetings}},{key:"canAlterConnectedMeetings",value:function(){var e;return(null==(e=Qo(this,ST).permissions)?void 0:e.connectedMeetings).canAlterConnectedMeetings}},{key:"canSwitchToParentMeeting",value:function(){var e;return(null==(e=Qo(this,ST).permissions)?void 0:e.connectedMeetings).canSwitchToParentMeeting}},{key:"hasActiveMeetings",value:function(){var e;return null==(e=this.list)?void 0:e.some((function(e){return"ACTIVE"===e.status}))}},{key:"switchMeeting",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s,c,u,d,p;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.validateConnectedMeetingsAction(),Qo(this,ST).cleanUpTracks(),n=(null!=t?t:{}).roomName,r=void 0===n?null==kp?void 0:kp.roomName:n,a=(null!=t?t:{}).authToken,i=(null!=t?t:{}).apiBase,o=void 0===i?null==kp?void 0:kp.apiBase:i,s=(null!=t?t:{}).defaults,c=void 0===s?null==kp?void 0:kp.defaults:s,u=(null!=t?t:{}).modules,d=void 0===u?null==kp?void 0:kp.modules:u,e.next=17,Zx.init({roomName:r,authToken:a,apiBase:o,defaults:c,modules:d});case 17:return p=e.sent,e.abrupt("return",(this.emit("movedToMeeting",{meeting:p}),p));case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createNConnectedMeetings",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=s.length>1&&void 0!==s[1]?s[1]:"Breakout Room",this.validateConnectedMeetingsAction(),a=(null==(r=this.list)?void 0:r.length)||0,i=[],o=0;o<t;o+=1)i.push({title:"".concat(n," ").concat(a+o+1)});return e.abrupt("return",this.createConnectedMeetings(i));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}],[{key:"init",value:function(e,t,n){return new IT(e,t,n)}}]),n}(yp),ST=new WeakMap,ET=new WeakMap,TT=new WeakMap,xT=new WeakSet,ZT=function(){return Lb()},CT),OT=IT;!function(e,t,n,r){for(var a,i=r>1?void 0:r?PT(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);r&&i&&RT(t,n,i)}([Gp.trace("DyteConnectedMeetings.switchMeeting")],OT.prototype,"switchMeeting",1);var DT=Object.defineProperty,MT=Object.getOwnPropertyDescriptor,AT=function(){function e(t,n,r){var a=this;(0,y.Z)(this,e),Ko(this,"connectedMeetings"),this.connectedMeetings=OT.init(t,n,r),av.isV2AuthToken&&Vc.hasFeature(Sp.CONNECTED_MEETINGS)&&this.connectedMeetings.getConnectedMeetings().then((function(e){var t,n;a.connectedMeetings.list=(null==(t=e.payload)?void 0:t.meetings)||[],a.connectedMeetings.parentMeeting=(null==(n=e.payload)?void 0:n.parentMeeting)||null,e.payload&&a.connectedMeetings.emit("connectedMeetingState",e.payload)})).catch((function(e){qp.error("MetaController:getConnectedMeetings",{ex:e})})),this.setupEvents()}return(0,k.Z)(e,[{key:"setupEvents",value:function(){var e=this;vf.on(ff.CONNECTED_MEETING_STATE,(function(t){e.connectedMeetings.list=t.meetings,e.connectedMeetings.parentMeeting=t.parentMeeting,e.connectedMeetings.emit("connectedMeetingState",t)})),vf.on(ff.MOVE_TO_CONNECTED_MEETING,(function(t){e.connectedMeetings.emit("moveToConnectedMeeting",t)}))}}]),e}();function NT(e){var t,n=0;if(!e)return n;for(t=0;t<e.length;t+=1)n=(n<<5)-n+e.charCodeAt(t),n|=0;return Math.abs(n)%100+1}!function(e,t,n,r){for(var a,i=r>1?void 0:r?MT(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);r&&i&&DT(t,n,i)}([Gp.trace("ConnectedMeetingsController.setupEvents")],AT.prototype,"setupEvents",1);var LT,jT=function(){function e(){(0,y.Z)(this,e)}return(0,k.Z)(e,null,[{key:"hasFeature",value:function(e){var t;return null!=(t=Vc.hasFeature(e))&&t}},{key:"getFeatureValue",value:function(e){return Vc.getValue(e)}},{key:"getAllFeatures",value:function(){return Vc.getAllFlags()}}]),e}(),FT=function(){function e(t,n){(0,y.Z)(this,e),Ko(this,"logger"),Ko(this,"features"),this.logger=t,this.features=n}return(0,k.Z)(e,null,[{key:"init",value:function(){return new e(qp,jT)}}]),e}(),UT=function(){function e(t){(0,y.Z)(this,e),Ko(this,"internals"),this.internals=t}return(0,k.Z)(e,null,[{key:"init",value:function(){var t=(0,d.Z)((0,l.Z)().mark((function t(){var n;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=FT.init(),t.abrupt("return",new e(n));case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}]),e}(),BT=Object.defineProperty,VT=Object.getOwnPropertyDescriptor,HT=function(e,t,n,r){for(var a,i=r>1?void 0:r?VT(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&BT(t,n,i),i},zT=function(e){(0,m.Z)(n,e);var t=(0,g.Z)(n);function n(e){var r;return(0,y.Z)(this,n),r=t.call(this),Xo((0,v.Z)(r),LT,void 0),Ko((0,v.Z)(r),"state","IDLE"),Ko((0,v.Z)(r),"playbackUrl"),Ko((0,v.Z)(r),"viewerCount"),Yo((0,v.Z)(r),LT,e),r.viewerCount=0,r}return(0,k.Z)(n,[{key:"setLivestreamState",value:function(e){var t=this.state;this.state=e,t!==e&&this.emitCurrentLivestreamState()}},{key:"emitCurrentLivestreamState",value:function(){this.emit("livestreamUpdate",this.state)}},{key:"start",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Qo(this,LT).permissions.canLivestream){e.next=2;break}throw qp.error("DyteLivestream::start::permission_denied"),new Jp("User does not have permission to start livestreaming");case 2:return this.setLivestreamState("STARTING"),e.prev=3,e.next=6,vg().startLivestreaming();case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(3),qp.error("DyteRecording::stop::livestream_failed_to_start",{error:e.t0}),this.setLivestreamState("IDLE"),new Jp("Error while starting livestream");case 11:case"end":return e.stop()}}),e,this,[[3,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Qo(this,LT).permissions.canLivestream){e.next=2;break}throw qp.error("DyteLivestream::stop::permission_denied"),new Jp("User does not have permission to stop livestreaming");case 2:if("LIVESTREAMING"===this.state){e.next=4;break}throw qp.error("DyteLivestream::stop::inconsistent_state"),new Jp("Livestream not started yet");case 4:return e.prev=4,this.setLivestreamState("STOPPING"),e.next=8,vg().stopLivestreaming();case 8:e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(4),qp.error("DyteLivestream::stop::livestream_failed_to_stop"),this.setLivestreamState("STOPPING"),new Jp("Error while stopping livestream");case 13:case"end":return e.stop()}}),e,this,[[4,10]])})));return function(){return e.apply(this,arguments)}}()}]),n}(yp);LT=new WeakMap,HT([Gp.trace("livestream.start")],zT.prototype,"start",1),HT([Gp.trace("livestream.stop")],zT.prototype,"stop",1);var WT,GT,qT=Object.defineProperty,$T=Object.getOwnPropertyDescriptor,KT=function(){function e(t,n){(0,y.Z)(this,e),Ko(this,"livestream"),Xo(this,WT,void 0),Xo(this,GT,void 0),this.livestream=new zT(t),Yo(this,GT,n),this.fetchInitialLivestreamingState(),this.setupEvents()}return(0,k.Z)(e,[{key:"fetchInitialLivestreamingState",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n,r,a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=vg(),e.next=3,t.getActiveLivestream();case 3:n=e.sent,r=n.status,a=n.playbackUrl,"LIVE"===r&&(this.livestream.playbackUrl=a,this.livestream.setLivestreamState("LIVESTREAMING"));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setupEvents",value:function(){var e=this;Qo(this,GT).on(gg.startedLivestream,(function(t){e.livestream.setLivestreamState("LIVESTREAMING"),e.livestream.playbackUrl=t.playbackUrl})),Qo(this,GT).on(gg.stoppedLivestream,(function(){e.livestream.setLivestreamState("IDLE"),e.livestream.playbackUrl=void 0})),Qo(this,GT).on(gg.erroredLivestream,(function(){e.livestream.setLivestreamState("IDLE"),e.livestream.playbackUrl=void 0})),Qo(this,GT).on(gg.roomPeerCount,(function(t){e.livestream.viewerCount=t.count,e.livestream.emit("viewerCountUpdate",t.count)})),vf.on(ff.PEER_JOINED,function(){var t=(0,d.Z)((0,l.Z)().mark((function t(n){var r;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:!0===(null==(r=n.flags)?void 0:r.hiddenParticipant)&&"LIVESTREAMER"===n.recorderType&&(Yo(e,WT,n.id),e.livestream.setLivestreamState("LIVESTREAMING"));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),vf.on(ff.PEER_CLOSED,(function(t){t.id===Qo(e,WT)&&(Yo(e,WT,void 0),e.livestream.setLivestreamState("IDLE"))})),vf.onAsync(ff.ROOM_JOINED,function(){var t=(0,d.Z)((0,l.Z)().mark((function t(n){var r,a,i;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:qp.debug("[ROOM_JOINED] resolved request to fetch livestream."),(i=null==(r=n.peers)?void 0:r.filter((function(e){var t;return!(null==(t=e.flags)||!t.hiddenParticipant)}))).length?(Yo(e,WT,i&&(null==(a=i[0])?void 0:a.id)),e.livestream.setLivestreamState("LIVESTREAMING")):(Yo(e,WT,void 0),e.livestream.setLivestreamState("IDLE"));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}]),e}();WT=new WeakMap,GT=new WeakMap,function(e,t,n,r){for(var a,i=r>1?void 0:r?$T(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);r&&i&&qT(t,n,i)}([Gp.trace("LivestreamController.setupEvents")],KT.prototype,"setupEvents",1);var JT,QT=Zf(gp().permissions),XT=function(){function e(t){if((0,y.Z)(this,e),Xo(this,JT,void 0),!t)throw qp.error("DytePermissionsPreset::load_preset_permissions_failed"),new Jp("Could not load preset permissions.");Yo(this,JT,t)}return(0,k.Z)(e,[{key:"acceptWaitingRequests",get:function(){var e,t;return null!=(t=null==(e=Qo(this,JT))?void 0:e.acceptWaitingRequests)?t:QT.acceptWaitingRequests}},{key:"requestProduceVideo",get:function(){var e,t,n;return(null==(n=null==(t=null==(e=Qo(this,JT))?void 0:e.media)?void 0:t.video)?void 0:n.canProduce)===cp.CanRequest}},{key:"requestProduceAudio",get:function(){var e,t,n;return(null==(n=null==(t=null==(e=Qo(this,JT))?void 0:e.media)?void 0:t.audio)?void 0:n.canProduce)===cp.CanRequest}},{key:"requestProduceScreenshare",get:function(){var e,t,n;return(null==(n=null==(t=null==(e=Qo(this,JT))?void 0:e.media)?void 0:t.screenshare)?void 0:n.canProduce)===cp.CanRequest}},{key:"canAllowParticipantAudio",get:function(){var e,t;return null!=(t=null==(e=Qo(this,JT))?void 0:e.canAcceptProductionRequests)?t:QT.canAcceptProductionRequests}},{key:"canAllowParticipantScreensharing",get:function(){var e,t;return null!=(t=null==(e=Qo(this,JT))?void 0:e.canAcceptProductionRequests)?t:QT.canAcceptProductionRequests}},{key:"canAllowParticipantVideo",get:function(){var e,t;return null!=(t=null==(e=Qo(this,JT))?void 0:e.canAcceptProductionRequests)?t:QT.canAcceptProductionRequests}},{key:"kickParticipant",get:function(){var e,t;return null!=(t=null==(e=Qo(this,JT))?void 0:e.kickParticipant)?t:QT.kickParticipant}},{key:"pinParticipant",get:function(){var e,t;return null!=(t=null==(e=Qo(this,JT))?void 0:e.pinParticipant)?t:QT.pinParticipant}},{key:"canRecord",get:function(){var e,t;return null!=(t=null==(e=Qo(this,JT))?void 0:e.canRecord)?t:QT.canRecord}},{key:"waitingRoomType",get:function(){var e,t;return null!=(t=null==(e=Qo(this,JT))?void 0:e.waitingRoomType)?t:QT.waitingRoomType}},{key:"waitingRoomBehaviour",get:function(){var e,t;return null!=(t=null==(e=Qo(this,JT))?void 0:e.waitingRoomType)?t:QT.waitingRoomType}},{key:"plugins",get:function(){var e,t;return null!=(t=null==(e=Qo(this,JT))?void 0:e.plugins)?t:QT.plugins}},{key:"polls",get:function(){var e,t;return null!=(t=null==(e=Qo(this,JT))?void 0:e.polls)?t:QT.polls}},{key:"produceVideo",get:function(){var e,t,n,r;return null!=(r=null==(n=null==(t=null==(e=Qo(this,JT))?void 0:e.media)?void 0:t.video)?void 0:n.canProduce)?r:QT.media.video.canProduce}},{key:"requestProduce",get:function(){return Qo(this,JT).media.audio.canProduce===cp.CanRequest||Qo(this,JT).media.video.canProduce===cp.CanRequest||Qo(this,JT).media.screenshare.canProduce===cp.CanRequest}},{key:"canProduceVideo",get:function(){var e,t,n,r;return null!=(r=null==(n=null==(t=null==(e=Qo(this,JT))?void 0:e.media)?void 0:t.video)?void 0:n.canProduce)?r:QT.media.video.canProduce}},{key:"produceScreenshare",get:function(){var e,t,n,r;return null!=(r=null==(n=null==(t=null==(e=Qo(this,JT))?void 0:e.media)?void 0:t.screenshare)?void 0:n.canProduce)?r:QT.media.screenshare.canProduce}},{key:"canProduceScreenshare",get:function(){var e,t,n,r;return null!=(r=null==(n=null==(t=null==(e=Qo(this,JT))?void 0:e.media)?void 0:t.screenshare)?void 0:n.canProduce)?r:QT.media.screenshare.canProduce}},{key:"produceAudio",get:function(){var e;return null!=(e=Qo(this,JT).media.audio.canProduce)?e:QT.media.audio.canProduce}},{key:"canProduceAudio",get:function(){var e;return null!=(e=Qo(this,JT).media.audio.canProduce)?e:QT.media.audio.canProduce}},{key:"chatPublic",get:function(){var e,t,n;return null!=(n=null==(t=null==(e=Qo(this,JT))?void 0:e.chat)?void 0:t.public)?n:QT.chat.public}},{key:"chatPrivate",get:function(){var e,t,n;return null!=(n=null==(t=null==(e=Qo(this,JT))?void 0:e.chat)?void 0:t.private)?n:QT.chat.private}},{key:"connectedMeetings",get:function(){var e,t;return null!=(t=null==(e=Qo(this,JT))?void 0:e.connectedMeetings)?t:null==QT?void 0:QT.connectedMeetings}},{key:"hiddenParticipant",get:function(){var e,t;return null!=(t=null==(e=Qo(this,JT))?void 0:e.hiddenParticipant)?t:QT.hiddenParticipant}},{key:"showParticipantList",get:function(){var e;return null!=(e=Qo(this,JT).showParticipantList)?e:QT.showParticipantList}},{key:"canChangeParticipantRole",get:function(){var e,t;return null!=(t=null==(e=Qo(this,JT))?void 0:e.canChangeParticipantPermissions)?t:QT.canChangeParticipantPermissions}},{key:"canChangeParticipantPermissions",get:function(){var e,t;return null!=(t=null==(e=Qo(this,JT))?void 0:e.canChangeParticipantPermissions)?t:QT.canChangeParticipantPermissions}},{key:"canChangeTheme",get:function(){return!1}},{key:"canPresent",get:function(){return Qo(this,JT).media.audio.canProduce===cp.Allowed||Qo(this,JT).media.video.canProduce===cp.Allowed||Qo(this,JT).media.screenshare.canProduce===cp.Allowed}},{key:"acceptPresentRequests",get:function(){return Qo(this,JT).canAcceptProductionRequests}},{key:"canEditDisplayName",get:function(){var e;return null!=(e=Qo(this,JT).canEditDisplayName)&&e}},{key:"maxScreenShareCount",get:function(){return 1}},{key:"isRecorder",get:function(){return Qo(this,JT).isRecorder}},{key:"canSpotlight",get:function(){return Qo(this,JT).canSpotlight}},{key:"canLivestream",get:function(){return Qo(this,JT).canLivestream}},{key:"isV2",get:function(){return!0}}],[{key:"fromResponse",value:function(t){return new e(t)}},{key:"default",value:function(){return new e(QT)}}]),e}(),YT=XT;JT=new WeakMap;var ex,tx,nx,rx=Zf(gp()),ax=function(){function e(t){if((0,y.Z)(this,e),Xo(this,ex,void 0),Xo(this,tx,void 0),Xo(this,nx,void 0),!t)throw new Jp("Could not load preset.");Yo(this,ex,t.config),Yo(this,tx,t.ui||Zf(gp().ui)),Yo(this,nx,t.permissions.plugins.config)}return(0,k.Z)(e,[{key:"setupScreen",get:function(){return{isEnabled:!0}}},{key:"waitingRoom",get:function(){return{isEnabled:!0}}},{key:"controlBar",get:function(){return{isEnabled:!0,elements:{chat:!0,fullscreen:!0,invite:!1,layout:!1,participants:!0,plugins:!0,polls:!0,reactions:!1,screenshare:!0}}}},{key:"header",get:function(){return{isEnabled:!0,elements:{logo:Qo(this,tx).designTokens.logo,timer:!0,title:!0,participantCount:!0,changeLayout:!1}}}},{key:"pipMode",get:function(){return!0}},{key:"viewType",get:function(){return Qo(this,ex).viewType}},{key:"maxVideoStreams",get:function(){return Qo(this,ex).maxVideoStreams}},{key:"maxScreenShareCount",get:function(){return Qo(this,ex).maxScreenshareCount}},{key:"plugins",get:function(){return[]}},{key:"disabledPlugins",get:function(){var e=this;return Object.keys(Qo(this,nx)).filter((function(t){return Qo(e,nx)[t].disabled}))}},{key:"designTokens",get:function(){return Qo(this,tx).designTokens}},{key:"configDiff",get:function(){return Qo(this,tx).configDiff}},{key:"mediaConstraints",get:function(){var e,t,n,r,a,i,o,s,c,u,l,d,p,f,h,v;return{video:{quality:null!=(r=null==(n=null==(t=null==(e=Qo(this,ex))?void 0:e.media)?void 0:t.video)?void 0:n.quality)?r:Pf.video.quality,frameRate:null!=(s=null==(o=null==(i=null==(a=Qo(this,ex))?void 0:a.media)?void 0:i.video)?void 0:o.frameRate)?s:Pf.video.frameRate},screenshare:{quality:null!=(d=null==(l=null==(u=null==(c=Qo(this,ex))?void 0:c.media)?void 0:u.screenshare)?void 0:l.quality)?d:Pf.screenshare.quality,frameRate:null!=(v=null==(h=null==(f=null==(p=Qo(this,ex))?void 0:p.media)?void 0:f.screenshare)?void 0:h.frameRate)?v:Pf.screenshare.frameRate}}}},{key:"isV2",get:function(){return!0}}],[{key:"fromResponse",value:function(t){return new e(t)}},{key:"default",value:function(){return new e(rx)}}]),e}(),ix=ax;ex=new WeakMap,tx=new WeakMap,nx=new WeakMap;var ox,sx,cx,ux,lx,dx,px=Zf({setup_screen:{is_enabled:!1},alone_here:{is_enabled:!1},waiting_room:{is_enabled:!1,enable_preview:!0},control_bar:{is_enabled:!0,elements:{plugins:!0,screenshare:!0,invite:!1,participants:!0,chat:!0,reactions:!1,polls:!0,fullscreen:!0,layout:!0}},header:{is_enabled:!0,elements:{logo:"",timer:!0,title:!0,participant_count:!0,change_layout:!0}},pip_mode:!0,auto_tune:!0,grid:{multi:{max_video_count:9,video_fit:"cover"},single:{max_video_count:6,video_fit:"cover"},default_view:"MULTI"},colors:{primary:"#2160FD",secondary:"#1A1A1A",text:"#EEEEEE",background:"#1A1A1A",text_primary:"#EEEEEE",video_background:"#1A1A1A"},controls:{pip_toggle:!1},plugins:[]}),fx=function(){function e(t){if((0,y.Z)(this,e),Xo(this,ox,void 0),Xo(this,sx,void 0),Xo(this,cx,void 0),Xo(this,ux,void 0),Xo(this,lx,[]),!t)throw new Jp("Could not load preset theme.");Yo(this,ox,t),Yo(this,sx,1),Yo(this,cx,op.GroupCall)}return(0,k.Z)(e,[{key:"configFromPermissions",value:function(e){var t,n,r,a,i,o,s,c,u,l,d,p;Yo(this,sx,e.maxScreenshareCount||1),Yo(this,cx,e.viewType),Yo(this,ux,{video:{quality:null!=(r=null==(n=null==(t=null==e?void 0:e.produce)?void 0:t.video)?void 0:n.quality)?r:Pf.video.quality,frameRate:null!=(o=null==(i=null==(a=null==e?void 0:e.produce)?void 0:a.video)?void 0:i.frameRate)?o:Pf.video.frameRate},screenshare:{quality:null!=(u=null==(c=null==(s=null==e?void 0:e.produce)?void 0:s.screenshare)?void 0:c.quality)?u:Pf.screenshare.quality,frameRate:null!=(p=null==(d=null==(l=null==e?void 0:e.produce)?void 0:l.screenshare)?void 0:d.frameRate)?p:Pf.screenshare.frameRate}})}},{key:"setDisabledPlugins",value:function(e){var t=Qo(this,ox).plugins;t&&t.length>0&&Yo(this,lx,e.filter((function(e){return!t.includes(e)})))}},{key:"setupScreen",get:function(){return Qo(this,ox).setupScreen}},{key:"aloneHere",get:function(){return Qo(this,ox).aloneHere}},{key:"waitingRoom",get:function(){return Qo(this,ox).waitingRoom}},{key:"controlBar",get:function(){return Qo(this,ox).controlBar}},{key:"header",get:function(){return Qo(this,ox).header}},{key:"pipMode",get:function(){var e;return(null==(e=Qo(this,ox).controls)?void 0:e.pipToggle)||Qo(this,ox).pipMode}},{key:"viewType",get:function(){return Qo(this,cx)}},{key:"autoTune",get:function(){return Qo(this,ox).autoTune}},{key:"grid",get:function(){return Qo(this,ox).grid}},{key:"maxVideoStreams",get:function(){return{mobile:this.grid.multi.maxVideoCount>6?6:this.grid.multi.maxVideoCount,desktop:this.grid.multi.maxVideoCount}}},{key:"maxScreenShareCount",get:function(){return Qo(this,sx)}},{key:"colors",get:function(){return Qo(this,ox).colors}},{key:"controls",get:function(){return Qo(this,ox).controls}},{key:"plugins",get:function(){return Qo(this,ox).plugins}},{key:"disabledPlugins",get:function(){return Qo(this,lx)}},{key:"mediaConstraints",get:function(){return Qo(this,ux)}},{key:"isV2",get:function(){return!1}}],[{key:"fromResponse",value:function(t){return new e(t)}},{key:"default",value:function(){return new e(px)}}]),e}(),hx=fx;ox=new WeakMap,sx=new WeakMap,cx=new WeakMap,ux=new WeakMap,lx=new WeakMap;var vx=function(){function e(t){(0,y.Z)(this,e),Xo(this,dx,void 0),Yo(this,dx,t)}return(0,k.Z)(e,[{key:"on",value:function(e,t){var n;n=e===gg.roomPeerCount?wm.fromBinary.bind(wm):qm.fromBinary.bind(qm),Qo(this,dx).on(e,(function(e){var r=e.payload,a=n(r);return t(a)}))}}]),e}();dx=new WeakMap;var mx=Object.defineProperty,gx=Object.getOwnPropertyDescriptor,yx=function(e,t,n,r){for(var a,i=r>1?void 0:r?gx(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&mx(t,n,i),i},kx=function(){function e(t,n,r,a,i,o,s,c,u,l,d,p,f){(0,y.Z)(this,e),Ko(this,"apiBase"),Ko(this,"chatController"),Ko(this,"metaController"),Ko(this,"participantController"),Ko(this,"pluginController"),Ko(this,"pollController"),Ko(this,"remoteController"),Ko(this,"selfController"),Ko(this,"recordingController"),Ko(this,"spotlightController"),Ko(this,"livestreamController"),Ko(this,"connectedMeetingsController"),Ko(this,"internalsController"),this.apiBase=t,this.metaController=n,this.selfController=r,this.pluginController=a,this.participantController=i,this.chatController=o,this.pollController=s,this.remoteController=c,this.recordingController=u,this.spotlightController=l,this.livestreamController=f,this.connectedMeetingsController=d,this.internalsController=p}return(0,k.Z)(e,[{key:"joinRoom",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.selfController.joinRoom());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"leaveRoom",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){var t,n=arguments;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:"left",e.abrupt("return",this.selfController.leaveRoom(t));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"init",value:function(){var t=(0,d.Z)((0,l.Z)().mark((function t(n,r){var a,i,o,c,p,f,h,v,m,g,y,k,b,w,_,S,E,T,x,Z,C,R,P,I,O,D,M,A,N,L,j,F,U,B,V,H,z,W,G,q,$,K,J,Q,X,Y,ee,te,ne,re,ae,ie,oe,se,ce,ue;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return S=n.apiBase,E=void 0===S?"https://api.cluster.dyte.in":S,T=n.defaults,x=void 0===T?{video:!0,audio:!0}:T,Z=n.authToken,C=(0,s.Z)({chat:!0,participant:!0,plugin:!0,poll:!0,self:!0,meta:!0,permissions:!0,theme:!0,spotlight:!0,tracing:!0,devTools:{logs:!1},internals:!0},null==n?void 0:n.modules),vf.removeAllListeners(),cv(null!=(o=n.overrides)?o:{}),(R=hg({authToken:Z,baseURL:E})).setHeader("dyte-tracing-id",r),R.setPeerId(r),R.setRoomName(n.roomName),P=n.roomName,I=av.isV2AuthToken?av.meetingId:P,t.next=8,Promise.all([R.getUserDetails(),R.getRoomNodeData({roomName:I,peerId:r})]);case 8:return O=t.sent,D=(0,u.Z)(O,2),M=D[0],A=D[1],N=A.roomNodeUrl,L=A.meetingTitle,j=A.useHiveMedia,F=av.isV2AuthToken?M.participant.organizationId:M.organizationId,bp((0,s.Z)((0,s.Z)({},n),{},{modules:C,apiBase:E,organizationId:F})),Gp.meetingMetadata.organizationId=F,U=NT(I),t.next=20,Vc.identify("".concat(_p.PEER,"_").concat(r),JSON.parse(JSON.stringify((0,s.Z)({entity:_p.PEER,clientId:F,isAnonUser:!F,sdkVersion:wp,meetingHash:U,roomName:I},zp.getDeviceInfo()))));case 20:if(zp.isElectron()&&window.dyteElectronGetDisplayMediaSource&&(navigator.mediaDevices.getDisplayMedia=function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.dyteElectronGetDisplayMediaSource({types:["window","screen"]});case 2:return n=e.sent,r=!1,t.video&&(a=t.video,r={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:n.id,maxWidth:a.width.max,maxHeight:a.height.max}}),i={audio:!1,video:r},e.next=8,navigator.mediaDevices.getUserMedia(i);case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),qp.info("flagsmith::allFlags",{flags:Vc.getAllFlags()},!0),B=av.isV2AuthToken?YT.default():rv.default(),V=av.isV2AuthToken?ix.default():hx.default(),!C.permissions&&!C.theme){t.next=33;break}if(!av.isV2AuthToken){t.next=28;break}t.t0=void 0,t.next=31;break;case 28:return t.next=30,R.getUserPreset(P);case 30:t.t0=t.sent;case 31:H=t.t0,C.permissions&&(B=av.isV2AuthToken?YT.fromResponse(M.preset.permissions):rv.fromResponse(H.permissions)),C.theme&&(V=av.isV2AuthToken?ix.fromResponse(M.preset):hx.fromResponse(H.theme),av.isV2AuthToken||V.configFromPermissions(H.permissions));case 33:return z=iy(B,V,Vc.hasFeature(Sp.LIVESTREAM)),qp.info("flagsmith::allFlags",{flags:JSON.stringify(Vc.getAllFlags())},!0),W=Vc.hasFeature(Sp.CUSTOM_PING_PONG),G=[],j&&G.push("HIVE"),W&&G.push("PING"),t.next=39,e.createSocketServiceAndRoomNodeClient((0,s.Z)((0,s.Z)({},n),{},{roomName:I,peerId:r,meetingTitle:L,roomNodeUrl:N,capabilities:G,initRoomNodeClient:z,viewType:V.viewType}));case 39:if(q=t.sent,$=Lb(),se=new Z_(q),ce=new qE(q),ue=new vx(q),null!=(c=C.self)&&!c){t.next=51;break}return t.next=45,Promise.all([ow.init(q,{defaults:x},M,B,V),$ instanceof Ob?$.setupTransports():null]);case 45:a=t.sent,i=(0,u.Z)(a,1),Y=i[0],R.setOrganizationId(Y.self.organizationId),t.next=55;break;case 51:if(t.t1=$ instanceof Ob,!t.t1){t.next=55;break}return t.next=55,$.setupTransports();case 55:if(null!=(p=C.participant)&&!p){t.next=59;break}if(Y){t.next=58;break}throw new Jp("The participant module cannot be initialized without the `self` module");case 58:J=new jw(Y.self);case 59:if(null!=(f=C.chat)&&!f){t.next=65;break}if(Y){t.next=62;break}throw new Jp("The chat module cannot be initialized without the `self` module");case 62:return t.next=64,q_.init(se,Y.self,J.participants);case 64:K=t.sent;case 65:if(null!=(h=C.plugin)&&!h){t.next=73;break}if(Y){t.next=68;break}throw new Jp("The plugin module cannot be initialized without the `self` module");case 68:if(J){t.next=70;break}throw new Jp("The plugin module cannot be initialized without the `participant` module");case 70:return t.next=72,rS.init(ce,se,null==K?void 0:K.chat,Y.self,J.participants);case 72:Q=t.sent;case 73:if(null!=(v=C.poll)&&!v){t.next=77;break}if(Y){t.next=76;break}throw new Jp("The poll cannot be initialized without the `self` module");case 76:X=new mS(Y.self);case 77:if(null!=(m=C.meta)&&!m){t.next=81;break}if(Y){t.next=80;break}throw new Jp("The meta module cannot be initialized without the `self` module");case 80:ee=new Kw(q,Y.self,L);case 81:if((null==(g=C.connectedMeetings)||g)&&(ie=new AT(Y.self,J.participants,ee.meta)),null!=(y=C.remoteControl)&&!y){t.next=85;break}if(Y){t.next=84;break}throw new Jp("The remote controller cannot be initialized without the `self` module");case 84:te=new ZS(Y.self,J.participants);case 85:if(null!=(k=C.recording)&&!k){t.next=89;break}if(Y){t.next=88;break}throw new Jp("The recording controller cannot be initialized without the `self` module");case 88:ne=new nT(Y.self);case 89:if(null!=(b=C.spotlight)&&!b){t.next=93;break}if(Y){t.next=92;break}throw new Jp("The spotlight controller cannot be initialized without the `self` module");case 92:re=new mT(Y.self);case 93:if(t.t2=null==(w=C.internals)||w,!t.t2){t.next=98;break}return t.next=97,UT.init();case 97:oe=t.sent;case 98:if(V.viewType!==op.Livestream||null!=(_=C.livestream)&&!_){t.next=102;break}if(Y){t.next=101;break}throw new Jp("The livestream controller cannot be initialized without the `self` module");case 101:Vc.hasFeature(Sp.LIVESTREAM)&&(ae=new KT(Y.self,ue));case 102:return t.abrupt("return",new e(E,ee,Y,Q,J,K,X,te,ne,re,ie,oe,ae));case 103:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"createSocketServiceAndRoomNodeClient",value:function(){var t=(0,d.Z)((0,l.Z)().mark((function t(n){var r,a;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.createSocketService(n),n.initRoomNodeClient){t.next=3;break}return t.abrupt("return",r);case 3:if(!n.capabilities.includes("HIVE")){t.next=10;break}return t.next=6,r;case 6:return a=t.sent,t.next=9,Db((0,s.Z)((0,s.Z)({},n),{},{roomName:n.roomName,peerId:n.peerId,socket:a}));case 9:return t.abrupt("return",a);case 10:return t.next=12,Promise.all([r,Ab((0,s.Z)((0,s.Z)({},n),{},{roomName:n.roomName,peerId:n.peerId}))]);case 12:return t.abrupt("return",t.sent[0]);case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"createSocketService",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,s;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.peerId,a=t.roomName,i=t.authToken,o=t.capabilities,s=new GE({peerId:r,roomName:a,authToken:i,capabilities:o}),!sv(t.viewType)&&"socket-service"!==(null==(n=t.overrides)?void 0:n.chat_socket_server)){e.next=10;break}return e.prev=2,e.next=5,s.connect();case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),qp.error("[Socket Service] Failed to connect to socket server:",e.t0);case 10:return e.abrupt("return",s);case 11:case"end":return e.stop()}}),e,null,[[2,7]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),bx=kx;yx([Gp.trace("Controller.joinRoom")],bx.prototype,"joinRoom",1),yx([Gp.trace("Controller.leaveRoom")],bx.prototype,"leaveRoom",1),yx([Gp.trace("Controller.init")],bx,"init",1),yx([Gp.trace("Controller.createSocketServiceAndRoomNodeClient")],bx,"createSocketServiceAndRoomNodeClient",1),yx([Gp.trace("Controller.createSocketService")],bx,"createSocketService",1);var wx,_x,Sx=Object.defineProperty,Ex=Object.getOwnPropertyDescriptor,Tx=function(e,t,n,r){for(var a,i=r>1?void 0:r?Ex(t,n):t,o=e.length-1;o>=0;o--)(a=e[o])&&(i=(r?a(t,n,i):a(i))||i);return r&&i&&Sx(t,n,i),i},xx=(_x=function(){function e(t){(0,y.Z)(this,e),Xo(this,wx,void 0),Yo(this,wx,t)}return(0,k.Z)(e,[{key:"joinRoom",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Qo(this,wx).joinRoom());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"leaveRoom",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Qo(this,wx).leaveRoom(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"participants",get:function(){var e;return null==(e=Qo(this,wx).participantController)?void 0:e.participants}},{key:"self",get:function(){var e;return null==(e=Qo(this,wx).selfController)?void 0:e.self}},{key:"meta",get:function(){var e;return null==(e=Qo(this,wx).metaController)?void 0:e.meta}},{key:"plugins",get:function(){var e;return null==(e=Qo(this,wx).pluginController)?void 0:e.plugins}},{key:"chat",get:function(){var e;return null==(e=Qo(this,wx).chatController)?void 0:e.chat}},{key:"polls",get:function(){var e;return null==(e=Qo(this,wx).pollController)?void 0:e.polls}},{key:"remote",get:function(){var e;return null==(e=Qo(this,wx).remoteController)?void 0:e.remote}},{key:"connectedMeetings",get:function(){var e;return null==(e=Qo(this,wx).connectedMeetingsController)?void 0:e.connectedMeetings}},{key:"recording",get:function(){var e;return null==(e=Qo(this,wx).recordingController)?void 0:e.recording}},{key:"spotlight",get:function(){var e;return null==(e=Qo(this,wx).spotlightController)?void 0:e.spotlight}},{key:"livestream",get:function(){var e;return null==(e=Qo(this,wx).livestreamController)?void 0:e.livestream}},{key:"__internals__",get:function(){var e;return null==(e=Qo(this,wx).internalsController)?void 0:e.internals}}],[{key:"init",value:function(){var e=(0,d.Z)((0,l.Z)().mark((function e(t){var r,a,i,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:zp.init(),i=Z();try{window.__zone_symbol__DISABLE_WRAPPING_UNCAUGHT_PROMISE_REJECTION=!0,void 0===window.Zone&&n(104)}catch(c){}return Gp.init(i,null==(a=null==(r=t.modules)?void 0:r.tracing)||a),!navigator.isReactNative&&"undefined"!=typeof window&&(window.addEventListener("error",(function(e){var t;(null==(t=e.filename)||!t.includes("localhost"))&&0!==e.lineno&&qp.error("window::error",{error:(0,s.Z)({},Tp(e.error))},!0)})),window.addEventListener("unhandledrejection",(function(e){var t,n;qp.error("window::unhandledrejection",{error:(0,s.Z)({},Tp(null==e?void 0:e.reason)),url:null==(n=null==(t=null==e?void 0:e.reason)?void 0:t.config)?void 0:n.url},!0)}))),ov(t.authToken,t.roomName),Gp.meetingMetadata.roomName=av.isV2AuthToken?av.meetingId:t.roomName,e.next=6,bx.init(t,i);case 6:return o=e.sent,e.abrupt("return",new xx(o));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),wx=new WeakMap,_x);Tx([Yp((function(e){throw new Jp(e.message,"0002")}))],xx.prototype,"joinRoom",1),Tx([Yp((function(e){throw new Jp(e.message,"0003")}))],xx.prototype,"leaveRoom",1),Tx([Yp((function(e){throw new Jp(e.message,"0001")})),function(e){var t=this;return function(n,r,a){var i=a.value,o=e?pp(i,e):pp(i);return a.value=function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];if(o.cache&&o.cache.has(e.apply(void 0,a))){console.warn('[Dyte] method "'.concat(r,'" is called twice. This may result in inconsistent behaviors'));try{Gp.addLogInCurrentSpan("warn","double-invoke",{method:r})}catch(s){}}return o.apply(t,a)},a}}((function(e){var t,n,r,a,i;return"".concat(null!=(t=e.roomName)?t:"","-").concat(e.authToken,"-").concat(null!=(n=e.apiBase)?n:"","-").concat(JSON.stringify(null!=(r=e.defaults)?r:{}),"-").concat(JSON.stringify(null!=(a=e.modules)?a:{}),"-").concat(JSON.stringify(null!=(i=e.overrides)?i:{}))}))],xx,"init",1),xx=Tx([Yp((function(e){throw new Jp(e.message,"0000")}))],xx);var Zx=xx},1836:function(e,t,n){"use strict";var r=n(6690).default,a=n(9728).default,i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=void 0;var o=i(n(8392)),s="awaitqueue",c=function(){function e(t){r(this,e),t?(this._debug=(0,o.default)("".concat(s,":").concat(t)),this._warn=(0,o.default)("".concat(s,":WARN:").concat(t)),this._error=(0,o.default)("".concat(s,":ERROR:").concat(t))):(this._debug=(0,o.default)(s),this._warn=(0,o.default)("".concat(s,":WARN")),this._error=(0,o.default)("".concat(s,":ERROR"))),this._debug.log=console.info.bind(console),this._warn.log=console.warn.bind(console),this._error.log=console.error.bind(console)}return a(e,[{key:"debug",get:function(){return this._debug}},{key:"warn",get:function(){return this._warn}},{key:"error",get:function(){return this._error}}]),e}();t.Logger=c},9647:function(e,t,n){"use strict";var r=n(4704).default,a=n(7061).default,i=n(7424).default,o=n(7156).default,s=n(9728).default,c=n(6690).default,u=n(6115).default,l=n(1655).default,d=n(6389).default,p=n(3496).default;t.Cg=void 0;var f=new(n(1836).Logger),h=function(e){l(n,e);var t=d(n);function n(e){var r;return c(this,n),(r=t.call(this,null!==e&&void 0!==e?e:"AwaitQueue stopped")).name="AwaitQueueStoppedError","function"===typeof Error.captureStackTrace&&Error.captureStackTrace(u(r),n),r}return s(n)}(p(Error));var v=function(e){l(n,e);var t=d(n);function n(e){var r;return c(this,n),(r=t.call(this,null!==e&&void 0!==e?e:"AwaitQueue task removed")).name="AwaitQueueRemovedTaskError","function"===typeof Error.captureStackTrace&&Error.captureStackTrace(u(r),n),r}return s(n)}(p(Error));var m=function(){function e(){c(this,e),this.pendingTasks=new Map,this.nextTaskId=0,this.stopping=!1}return s(e,[{key:"size",get:function(){return this.pendingTasks.size}},{key:"push",value:function(){var e=o(a().mark((function e(t,n){var r=this;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null!==n&&void 0!==n?n:t.name,f.debug("push() [name:".concat(n,"]")),"function"===typeof t){e.next=4;break}throw new TypeError("given task is not a function");case 4:if(n)try{Object.defineProperty(t,"name",{value:n})}catch(a){}return e.abrupt("return",new Promise((function(e,a){var o={id:r.nextTaskId++,task:t,name:n,enqueuedAt:Date.now(),executedAt:void 0,completed:!1,resolve:function(t){if(!o.completed){o.completed=!0,r.pendingTasks.delete(o.id),f.debug("resolving task [name:".concat(o.name,"]")),e(t);var n=r.pendingTasks.values(),a=i(n,1)[0];a&&!a.executedAt&&r.execute(a)}},reject:function(e){if(!o.completed&&(o.completed=!0,r.pendingTasks.delete(o.id),f.debug("rejecting task [name:".concat(o.name,"]: %s"),String(e)),a(e),!r.stopping)){var t=r.pendingTasks.values(),n=i(t,1)[0];n&&!n.executedAt&&r.execute(n)}}};r.pendingTasks.set(o.id,o),1===r.pendingTasks.size&&r.execute(o)})));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"stop",value:function(){f.debug("stop()"),this.stopping=!0;var e,t=r(this.pendingTasks.values());try{for(t.s();!(e=t.n()).done;){var n=e.value;f.debug("stop() | stopping task [name:".concat(n.name,"]")),n.reject(new h)}}catch(a){t.e(a)}finally{t.f()}this.stopping=!1}},{key:"remove",value:function(e){f.debug("remove() [taskIdx:".concat(e,"]"));var t=Array.from(this.pendingTasks.values())[e];t?t.reject(new v):f.debug("stop() | no task with given idx [taskIdx:".concat(e,"]"))}},{key:"dump",value:function(){var e=Date.now(),t=0;return Array.from(this.pendingTasks.values()).map((function(n){return{idx:t++,task:n.task,name:n.name,enqueuedTime:n.executedAt?n.executedAt-n.enqueuedAt:e-n.enqueuedAt,executionTime:n.executedAt?e-n.executedAt:0}}))}},{key:"execute",value:function(){var e=o(a().mark((function e(t){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f.debug("execute() [name:".concat(t.name,"]")),!t.executedAt){e.next=3;break}throw new Error("task already being executed");case 3:return t.executedAt=Date.now(),e.prev=4,e.next=7,t.task();case 7:n=e.sent,t.resolve(n),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),t.reject(e.t0);case 14:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(t){return e.apply(this,arguments)}}()}]),e}();t.Cg=m},4569:function(e,t,n){e.exports=n(8036)},3381:function(e,t,n){"use strict";var r=n(3589),a=n(7297),i=n(9301),o=n(9774),s=n(1804),c=n(9145),u=n(5411),l=n(6467),d=n(221),p=n(9346);e.exports=function(e){return new Promise((function(t,n){var f,h=e.data,v=e.headers,m=e.responseType;function g(){e.cancelToken&&e.cancelToken.unsubscribe(f),e.signal&&e.signal.removeEventListener("abort",f)}r.isFormData(h)&&delete v["Content-Type"];var y=new XMLHttpRequest;if(e.auth){var k=e.auth.username||"",b=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";v.Authorization="Basic "+btoa(k+":"+b)}var w=s(e.baseURL,e.url);function _(){if(y){var r="getAllResponseHeaders"in y?c(y.getAllResponseHeaders()):null,i={data:m&&"text"!==m&&"json"!==m?y.response:y.responseText,status:y.status,statusText:y.statusText,headers:r,config:e,request:y};a((function(e){t(e),g()}),(function(e){n(e),g()}),i),y=null}}if(y.open(e.method.toUpperCase(),o(w,e.params,e.paramsSerializer),!0),y.timeout=e.timeout,"onloadend"in y?y.onloadend=_:y.onreadystatechange=function(){y&&4===y.readyState&&(0!==y.status||y.responseURL&&0===y.responseURL.indexOf("file:"))&&setTimeout(_)},y.onabort=function(){y&&(n(l("Request aborted",e,"ECONNABORTED",y)),y=null)},y.onerror=function(){n(l("Network Error",e,null,y)),y=null},y.ontimeout=function(){var t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",r=e.transitional||d.transitional;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(l(t,e,r.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",y)),y=null},r.isStandardBrowserEnv()){var S=(e.withCredentials||u(w))&&e.xsrfCookieName?i.read(e.xsrfCookieName):void 0;S&&(v[e.xsrfHeaderName]=S)}"setRequestHeader"in y&&r.forEach(v,(function(e,t){"undefined"===typeof h&&"content-type"===t.toLowerCase()?delete v[t]:y.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(y.withCredentials=!!e.withCredentials),m&&"json"!==m&&(y.responseType=e.responseType),"function"===typeof e.onDownloadProgress&&y.addEventListener("progress",e.onDownloadProgress),"function"===typeof e.onUploadProgress&&y.upload&&y.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(f=function(e){y&&(n(!e||e&&e.type?new p("canceled"):e),y.abort(),y=null)},e.cancelToken&&e.cancelToken.subscribe(f),e.signal&&(e.signal.aborted?f():e.signal.addEventListener("abort",f))),h||(h=null),y.send(h)}))}},8036:function(e,t,n){"use strict";var r=n(3589),a=n(4049),i=n(3773),o=n(777);var s=function e(t){var n=new i(t),s=a(i.prototype.request,n);return r.extend(s,i.prototype,n),r.extend(s,n),s.create=function(n){return e(o(t,n))},s}(n(221));s.Axios=i,s.Cancel=n(9346),s.CancelToken=n(6857),s.isCancel=n(5517),s.VERSION=n(7600).version,s.all=function(e){return Promise.all(e)},s.spread=n(8089),s.isAxiosError=n(9580),e.exports=s,e.exports.default=s},9346:function(e){"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},6857:function(e,t,n){"use strict";var r=n(9346);function a(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;this.promise.then((function(e){if(n._listeners){var t,r=n._listeners.length;for(t=0;t<r;t++)n._listeners[t](e);n._listeners=null}})),this.promise.then=function(e){var t,r=new Promise((function(e){n.subscribe(e),t=e})).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}a.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},a.prototype.subscribe=function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]},a.prototype.unsubscribe=function(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}},a.source=function(){var e;return{token:new a((function(t){e=t})),cancel:e}},e.exports=a},5517:function(e){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},3773:function(e,t,n){"use strict";var r=n(3589),a=n(9774),i=n(7470),o=n(2733),s=n(777),c=n(7835),u=c.validators;function l(e){this.defaults=e,this.interceptors={request:new i,response:new i}}l.prototype.request=function(e,t){if("string"===typeof e?(t=t||{}).url=e:t=e||{},!t.url)throw new Error("Provided config url is not valid");(t=s(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var n=t.transitional;void 0!==n&&c.assertOptions(n,{silentJSONParsing:u.transitional(u.boolean),forcedJSONParsing:u.transitional(u.boolean),clarifyTimeoutError:u.transitional(u.boolean)},!1);var r=[],a=!0;this.interceptors.request.forEach((function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(a=a&&e.synchronous,r.unshift(e.fulfilled,e.rejected))}));var i,l=[];if(this.interceptors.response.forEach((function(e){l.push(e.fulfilled,e.rejected)})),!a){var d=[o,void 0];for(Array.prototype.unshift.apply(d,r),d=d.concat(l),i=Promise.resolve(t);d.length;)i=i.then(d.shift(),d.shift());return i}for(var p=t;r.length;){var f=r.shift(),h=r.shift();try{p=f(p)}catch(v){h(v);break}}try{i=o(p)}catch(v){return Promise.reject(v)}for(;l.length;)i=i.then(l.shift(),l.shift());return i},l.prototype.getUri=function(e){if(!e.url)throw new Error("Provided config url is not valid");return e=s(this.defaults,e),a(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){l.prototype[e]=function(t,n){return this.request(s(n||{},{method:e,url:t,data:(n||{}).data}))}})),r.forEach(["post","put","patch"],(function(e){l.prototype[e]=function(t,n,r){return this.request(s(r||{},{method:e,url:t,data:n}))}})),e.exports=l},7470:function(e,t,n){"use strict";var r=n(3589);function a(){this.handlers=[]}a.prototype.use=function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},a.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},a.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=a},1804:function(e,t,n){"use strict";var r=n(4044),a=n(9549);e.exports=function(e,t){return e&&!r(t)?a(e,t):t}},6467:function(e,t,n){"use strict";var r=n(6460);e.exports=function(e,t,n,a,i){var o=new Error(e);return r(o,t,n,a,i)}},2733:function(e,t,n){"use strict";var r=n(3589),a=n(2693),i=n(5517),o=n(221),s=n(9346);function c(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new s("canceled")}e.exports=function(e){return c(e),e.headers=e.headers||{},e.data=a.call(e,e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||o.adapter)(e).then((function(t){return c(e),t.data=a.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return i(t)||(c(e),t&&t.response&&(t.response.data=a.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},6460:function(e){"use strict";e.exports=function(e,t,n,r,a){return e.config=t,n&&(e.code=n),e.request=r,e.response=a,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},e}},777:function(e,t,n){"use strict";var r=n(3589);e.exports=function(e,t){t=t||{};var n={};function a(e,t){return r.isPlainObject(e)&&r.isPlainObject(t)?r.merge(e,t):r.isPlainObject(t)?r.merge({},t):r.isArray(t)?t.slice():t}function i(n){return r.isUndefined(t[n])?r.isUndefined(e[n])?void 0:a(void 0,e[n]):a(e[n],t[n])}function o(e){if(!r.isUndefined(t[e]))return a(void 0,t[e])}function s(n){return r.isUndefined(t[n])?r.isUndefined(e[n])?void 0:a(void 0,e[n]):a(void 0,t[n])}function c(n){return n in t?a(e[n],t[n]):n in e?a(void 0,e[n]):void 0}var u={url:o,method:o,data:o,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:c};return r.forEach(Object.keys(e).concat(Object.keys(t)),(function(e){var t=u[e]||i,a=t(e);r.isUndefined(a)&&t!==c||(n[e]=a)})),n}},7297:function(e,t,n){"use strict";var r=n(6467);e.exports=function(e,t,n){var a=n.config.validateStatus;n.status&&a&&!a(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},2693:function(e,t,n){"use strict";var r=n(3589),a=n(221);e.exports=function(e,t,n){var i=this||a;return r.forEach(n,(function(n){e=n.call(i,e,t)})),e}},221:function(e,t,n){"use strict";var r=n(3589),a=n(4341),i=n(6460),o={"Content-Type":"application/x-www-form-urlencoded"};function s(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var c={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:function(){var e;return("undefined"!==typeof XMLHttpRequest||"undefined"!==typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(e=n(3381)),e}(),transformRequest:[function(e,t){return a(t,"Accept"),a(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(s(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)||t&&"application/json"===t["Content-Type"]?(s(t,"application/json"),function(e,t,n){if(r.isString(e))try{return(t||JSON.parse)(e),r.trim(e)}catch(a){if("SyntaxError"!==a.name)throw a}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional||c.transitional,n=t&&t.silentJSONParsing,a=t&&t.forcedJSONParsing,o=!n&&"json"===this.responseType;if(o||a&&r.isString(e)&&e.length)try{return JSON.parse(e)}catch(s){if(o){if("SyntaxError"===s.name)throw i(s,this,"E_JSON_PARSE");throw s}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){c.headers[e]=r.merge(o)})),e.exports=c},7600:function(e){e.exports={version:"0.25.0"}},4049:function(e){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},9774:function(e,t,n){"use strict";var r=n(3589);function a(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var i;if(n)i=n(t);else if(r.isURLSearchParams(t))i=t.toString();else{var o=[];r.forEach(t,(function(e,t){null!==e&&"undefined"!==typeof e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),o.push(a(t)+"="+a(e))})))})),i=o.join("&")}if(i){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+i}return e}},9549:function(e){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},9301:function(e,t,n){"use strict";var r=n(3589);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,a,i,o){var s=[];s.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),r.isString(a)&&s.push("path="+a),r.isString(i)&&s.push("domain="+i),!0===o&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},4044:function(e){"use strict";e.exports=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}},9580:function(e,t,n){"use strict";var r=n(3589);e.exports=function(e){return r.isObject(e)&&!0===e.isAxiosError}},5411:function(e,t,n){"use strict";var r=n(3589);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function a(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=a(window.location.href),function(t){var n=r.isString(t)?a(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},4341:function(e,t,n){"use strict";var r=n(3589);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},9145:function(e,t,n){"use strict";var r=n(3589),a=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,i,o={};return e?(r.forEach(e.split("\n"),(function(e){if(i=e.indexOf(":"),t=r.trim(e.substr(0,i)).toLowerCase(),n=r.trim(e.substr(i+1)),t){if(o[t]&&a.indexOf(t)>=0)return;o[t]="set-cookie"===t?(o[t]?o[t]:[]).concat([n]):o[t]?o[t]+", "+n:n}})),o):o}},8089:function(e){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},7835:function(e,t,n){"use strict";var r=n(7600).version,a={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){a[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));var i={};a.transitional=function(e,t,n){function a(e,t){return"[Axios v"+r+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return function(n,r,o){if(!1===e)throw new Error(a(r," has been removed"+(t?" in "+t:"")));return t&&!i[r]&&(i[r]=!0,console.warn(a(r," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,r,o)}},e.exports={assertOptions:function(e,t,n){if("object"!==typeof e)throw new TypeError("options must be an object");for(var r=Object.keys(e),a=r.length;a-- >0;){var i=r[a],o=t[i];if(o){var s=e[i],c=void 0===s||o(s,i,e);if(!0!==c)throw new TypeError("option "+i+" must be "+c)}else if(!0!==n)throw Error("Unknown option "+i)}},validators:a}},3589:function(e,t,n){"use strict";var r=n(4049),a=Object.prototype.toString;function i(e){return Array.isArray(e)}function o(e){return"undefined"===typeof e}function s(e){return"[object ArrayBuffer]"===a.call(e)}function c(e){return null!==e&&"object"===typeof e}function u(e){if("[object Object]"!==a.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function l(e){return"[object Function]"===a.call(e)}function d(e,t){if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),i(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.call(null,e[a],a,e)}e.exports={isArray:i,isArrayBuffer:s,isBuffer:function(e){return null!==e&&!o(e)&&null!==e.constructor&&!o(e.constructor)&&"function"===typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"[object FormData]"===a.call(e)},isArrayBufferView:function(e){return"undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&s(e.buffer)},isString:function(e){return"string"===typeof e},isNumber:function(e){return"number"===typeof e},isObject:c,isPlainObject:u,isUndefined:o,isDate:function(e){return"[object Date]"===a.call(e)},isFile:function(e){return"[object File]"===a.call(e)},isBlob:function(e){return"[object Blob]"===a.call(e)},isFunction:l,isStream:function(e){return c(e)&&l(e.pipe)},isURLSearchParams:function(e){return"[object URLSearchParams]"===a.call(e)},isStandardBrowserEnv:function(){return("undefined"===typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!==typeof window&&"undefined"!==typeof document)},forEach:d,merge:function e(){var t={};function n(n,r){u(t[r])&&u(n)?t[r]=e(t[r],n):u(n)?t[r]=e({},n):i(n)?t[r]=n.slice():t[r]=n}for(var r=0,a=arguments.length;r<a;r++)d(arguments[r],n);return t},extend:function(e,t,n){return d(t,(function(t,a){e[a]=n&&"function"===typeof t?r(t,n):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},5524:function(e){e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=90)}({17:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=n(18),a=function(){function e(){}return e.getFirstMatch=function(e,t){var n=t.match(e);return n&&n.length>0&&n[1]||""},e.getSecondMatch=function(e,t){var n=t.match(e);return n&&n.length>1&&n[2]||""},e.matchAndReturnConst=function(e,t,n){if(e.test(t))return n},e.getWindowsVersionName=function(e){switch(e){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},e.getMacOSVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),10===t[0])switch(t[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},e.getAndroidVersionName=function(e){var t=e.split(".").splice(0,2).map((function(e){return parseInt(e,10)||0}));if(t.push(0),!(1===t[0]&&t[1]<5))return 1===t[0]&&t[1]<6?"Cupcake":1===t[0]&&t[1]>=6?"Donut":2===t[0]&&t[1]<2?"Eclair":2===t[0]&&2===t[1]?"Froyo":2===t[0]&&t[1]>2?"Gingerbread":3===t[0]?"Honeycomb":4===t[0]&&t[1]<1?"Ice Cream Sandwich":4===t[0]&&t[1]<4?"Jelly Bean":4===t[0]&&t[1]>=4?"KitKat":5===t[0]?"Lollipop":6===t[0]?"Marshmallow":7===t[0]?"Nougat":8===t[0]?"Oreo":9===t[0]?"Pie":void 0},e.getVersionPrecision=function(e){return e.split(".").length},e.compareVersions=function(t,n,r){void 0===r&&(r=!1);var a=e.getVersionPrecision(t),i=e.getVersionPrecision(n),o=Math.max(a,i),s=0,c=e.map([t,n],(function(t){var n=o-e.getVersionPrecision(t),r=t+new Array(n+1).join(".0");return e.map(r.split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));for(r&&(s=o-Math.min(a,i)),o-=1;o>=s;){if(c[0][o]>c[1][o])return 1;if(c[0][o]===c[1][o]){if(o===s)return 0;o-=1}else if(c[0][o]<c[1][o])return-1}},e.map=function(e,t){var n,r=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(n=0;n<e.length;n+=1)r.push(t(e[n]));return r},e.find=function(e,t){var n,r;if(Array.prototype.find)return Array.prototype.find.call(e,t);for(n=0,r=e.length;n<r;n+=1){var a=e[n];if(t(a,n))return a}},e.assign=function(e){for(var t,n,r=e,a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];if(Object.assign)return Object.assign.apply(Object,[e].concat(i));var s=function(){var e=i[t];"object"==typeof e&&null!==e&&Object.keys(e).forEach((function(t){r[t]=e[t]}))};for(t=0,n=i.length;t<n;t+=1)s();return e},e.getBrowserAlias=function(e){return r.BROWSER_ALIASES_MAP[e]},e.getBrowserTypeByAlias=function(e){return r.BROWSER_MAP[e]||""},e}();t.default=a,e.exports=t.default},18:function(e,t,n){"use strict";t.__esModule=!0,t.ENGINE_MAP=t.OS_MAP=t.PLATFORMS_MAP=t.BROWSER_MAP=t.BROWSER_ALIASES_MAP=void 0,t.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},t.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},t.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},t.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},t.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,a=(r=n(91))&&r.__esModule?r:{default:r},i=n(18);function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function e(){}var t,n,r;return e.getParser=function(e,t){if(void 0===t&&(t=!1),"string"!=typeof e)throw new Error("UserAgent should be a string");return new a.default(e,t)},e.parse=function(e){return new a.default(e).getResult()},t=e,r=[{key:"BROWSER_MAP",get:function(){return i.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return i.ENGINE_MAP}},{key:"OS_MAP",get:function(){return i.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return i.PLATFORMS_MAP}}],(n=null)&&o(t.prototype,n),r&&o(t,r),e}();t.default=s,e.exports=t.default},91:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r=c(n(92)),a=c(n(93)),i=c(n(94)),o=c(n(95)),s=c(n(17));function c(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(e,t){if(void 0===t&&(t=!1),null==e||""===e)throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},!0!==t&&this.parse()}var t=e.prototype;return t.getUA=function(){return this._ua},t.test=function(e){return e.test(this._ua)},t.parseBrowser=function(){var e=this;this.parsedResult.browser={};var t=s.default.find(r.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.browser=t.describe(this.getUA())),this.parsedResult.browser},t.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},t.getBrowserName=function(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},t.getBrowserVersion=function(){return this.getBrowser().version},t.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},t.parseOS=function(){var e=this;this.parsedResult.os={};var t=s.default.find(a.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.os=t.describe(this.getUA())),this.parsedResult.os},t.getOSName=function(e){var t=this.getOS().name;return e?String(t).toLowerCase()||"":t||""},t.getOSVersion=function(){return this.getOS().version},t.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},t.getPlatformType=function(e){void 0===e&&(e=!1);var t=this.getPlatform().type;return e?String(t).toLowerCase()||"":t||""},t.parsePlatform=function(){var e=this;this.parsedResult.platform={};var t=s.default.find(i.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.platform=t.describe(this.getUA())),this.parsedResult.platform},t.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},t.getEngineName=function(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},t.parseEngine=function(){var e=this;this.parsedResult.engine={};var t=s.default.find(o.default,(function(t){if("function"==typeof t.test)return t.test(e);if(t.test instanceof Array)return t.test.some((function(t){return e.test(t)}));throw new Error("Browser's test function is not valid")}));return t&&(this.parsedResult.engine=t.describe(this.getUA())),this.parsedResult.engine},t.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},t.getResult=function(){return s.default.assign({},this.parsedResult)},t.satisfies=function(e){var t=this,n={},r=0,a={},i=0;if(Object.keys(e).forEach((function(t){var o=e[t];"string"==typeof o?(a[t]=o,i+=1):"object"==typeof o&&(n[t]=o,r+=1)})),r>0){var o=Object.keys(n),c=s.default.find(o,(function(e){return t.isOS(e)}));if(c){var u=this.satisfies(n[c]);if(void 0!==u)return u}var l=s.default.find(o,(function(e){return t.isPlatform(e)}));if(l){var d=this.satisfies(n[l]);if(void 0!==d)return d}}if(i>0){var p=Object.keys(a),f=s.default.find(p,(function(e){return t.isBrowser(e,!0)}));if(void 0!==f)return this.compareVersion(a[f])}},t.isBrowser=function(e,t){void 0===t&&(t=!1);var n=this.getBrowserName().toLowerCase(),r=e.toLowerCase(),a=s.default.getBrowserTypeByAlias(r);return t&&a&&(r=a.toLowerCase()),r===n},t.compareVersion=function(e){var t=[0],n=e,r=!1,a=this.getBrowserVersion();if("string"==typeof a)return">"===e[0]||"<"===e[0]?(n=e.substr(1),"="===e[1]?(r=!0,n=e.substr(2)):t=[],">"===e[0]?t.push(1):t.push(-1)):"="===e[0]?n=e.substr(1):"~"===e[0]&&(r=!0,n=e.substr(1)),t.indexOf(s.default.compareVersions(a,n,r))>-1},t.isOS=function(e){return this.getOSName(!0)===String(e).toLowerCase()},t.isPlatform=function(e){return this.getPlatformType(!0)===String(e).toLowerCase()},t.isEngine=function(e){return this.getEngineName(!0)===String(e).toLowerCase()},t.is=function(e,t){return void 0===t&&(t=!1),this.isBrowser(e,t)||this.isOS(e)||this.isPlatform(e)},t.some=function(e){var t=this;return void 0===e&&(e=[]),e.some((function(e){return t.is(e)}))},e}();t.default=u,e.exports=t.default},92:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,a=(r=n(17))&&r.__esModule?r:{default:r},i=/version\/(\d+(\.?_?\d+)+)/i,o=[{test:[/googlebot/i],describe:function(e){var t={name:"Googlebot"},n=a.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/opera/i],describe:function(e){var t={name:"Opera"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opr\/|opios/i],describe:function(e){var t={name:"Opera"},n=a.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/SamsungBrowser/i],describe:function(e){var t={name:"Samsung Internet for Android"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Whale/i],describe:function(e){var t={name:"NAVER Whale Browser"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MZBrowser/i],describe:function(e){var t={name:"MZ Browser"},n=a.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/focus/i],describe:function(e){var t={name:"Focus"},n=a.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/swing/i],describe:function(e){var t={name:"Swing"},n=a.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/coast/i],describe:function(e){var t={name:"Opera Coast"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(e){var t={name:"Opera Touch"},n=a.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/yabrowser/i],describe:function(e){var t={name:"Yandex Browser"},n=a.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/ucbrowser/i],describe:function(e){var t={name:"UC Browser"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/Maxthon|mxios/i],describe:function(e){var t={name:"Maxthon"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/epiphany/i],describe:function(e){var t={name:"Epiphany"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/puffin/i],describe:function(e){var t={name:"Puffin"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sleipnir/i],describe:function(e){var t={name:"Sleipnir"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/k-meleon/i],describe:function(e){var t={name:"K-Meleon"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/micromessenger/i],describe:function(e){var t={name:"WeChat"},n=a.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/qqbrowser/i],describe:function(e){var t={name:/qqbrowserlite/i.test(e)?"QQ Browser Lite":"QQ Browser"},n=a.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/msie|trident/i],describe:function(e){var t={name:"Internet Explorer"},n=a.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/\sedg\//i],describe:function(e){var t={name:"Microsoft Edge"},n=a.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/edg([ea]|ios)/i],describe:function(e){var t={name:"Microsoft Edge"},n=a.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/vivaldi/i],describe:function(e){var t={name:"Vivaldi"},n=a.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/seamonkey/i],describe:function(e){var t={name:"SeaMonkey"},n=a.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/sailfish/i],describe:function(e){var t={name:"Sailfish"},n=a.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,e);return n&&(t.version=n),t}},{test:[/silk/i],describe:function(e){var t={name:"Amazon Silk"},n=a.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/phantom/i],describe:function(e){var t={name:"PhantomJS"},n=a.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/slimerjs/i],describe:function(e){var t={name:"SlimerJS"},n=a.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t={name:"BlackBerry"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t={name:"WebOS Browser"},n=a.default.getFirstMatch(i,e)||a.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/bada/i],describe:function(e){var t={name:"Bada"},n=a.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/tizen/i],describe:function(e){var t={name:"Tizen"},n=a.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/qupzilla/i],describe:function(e){var t={name:"QupZilla"},n=a.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/firefox|iceweasel|fxios/i],describe:function(e){var t={name:"Firefox"},n=a.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/electron/i],describe:function(e){var t={name:"Electron"},n=a.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/MiuiBrowser/i],describe:function(e){var t={name:"Miui"},n=a.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/chromium/i],describe:function(e){var t={name:"Chromium"},n=a.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,e)||a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/chrome|crios|crmo/i],describe:function(e){var t={name:"Chrome"},n=a.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/GSA/i],describe:function(e){var t={name:"Google Search"},n=a.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t={name:"Android Browser"},n=a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/playstation 4/i],describe:function(e){var t={name:"PlayStation 4"},n=a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/safari|applewebkit/i],describe:function(e){var t={name:"Safari"},n=a.default.getFirstMatch(i,e);return n&&(t.version=n),t}},{test:[/.*/i],describe:function(e){var t=-1!==e.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:a.default.getFirstMatch(t,e),version:a.default.getSecondMatch(t,e)}}}];t.default=o,e.exports=t.default},93:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,a=(r=n(17))&&r.__esModule?r:{default:r},i=n(18),o=[{test:[/Roku\/DVP/],describe:function(e){var t=a.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,e);return{name:i.OS_MAP.Roku,version:t}}},{test:[/windows phone/i],describe:function(e){var t=a.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.WindowsPhone,version:t}}},{test:[/windows /i],describe:function(e){var t=a.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,e),n=a.default.getWindowsVersionName(t);return{name:i.OS_MAP.Windows,version:t,versionName:n}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(e){var t={name:i.OS_MAP.iOS},n=a.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,e);return n&&(t.version=n),t}},{test:[/macintosh/i],describe:function(e){var t=a.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,e).replace(/[_\s]/g,"."),n=a.default.getMacOSVersionName(t),r={name:i.OS_MAP.MacOS,version:t};return n&&(r.versionName=n),r}},{test:[/(ipod|iphone|ipad)/i],describe:function(e){var t=a.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,e).replace(/[_\s]/g,".");return{name:i.OS_MAP.iOS,version:t}}},{test:function(e){var t=!e.test(/like android/i),n=e.test(/android/i);return t&&n},describe:function(e){var t=a.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,e),n=a.default.getAndroidVersionName(t),r={name:i.OS_MAP.Android,version:t};return n&&(r.versionName=n),r}},{test:[/(web|hpw)[o0]s/i],describe:function(e){var t=a.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,e),n={name:i.OS_MAP.WebOS};return t&&t.length&&(n.version=t),n}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(e){var t=a.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,e)||a.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,e)||a.default.getFirstMatch(/\bbb(\d+)/i,e);return{name:i.OS_MAP.BlackBerry,version:t}}},{test:[/bada/i],describe:function(e){var t=a.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.Bada,version:t}}},{test:[/tizen/i],describe:function(e){var t=a.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.Tizen,version:t}}},{test:[/linux/i],describe:function(){return{name:i.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:i.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(e){var t=a.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,e);return{name:i.OS_MAP.PlayStation4,version:t}}}];t.default=o,e.exports=t.default},94:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,a=(r=n(17))&&r.__esModule?r:{default:r},i=n(18),o=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(e){var t=a.default.getFirstMatch(/(can-l01)/i,e)&&"Nova",n={type:i.PLATFORMS_MAP.mobile,vendor:"Huawei"};return t&&(n.model=t),n}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:i.PLATFORMS_MAP.tablet}}},{test:function(e){var t=e.test(/ipod|iphone/i),n=e.test(/like (ipod|iphone)/i);return t&&!n},describe:function(e){var t=a.default.getFirstMatch(/(ipod|iphone)/i,e);return{type:i.PLATFORMS_MAP.mobile,vendor:"Apple",model:t}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"blackberry"===e.getBrowserName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(e){return"bada"===e.getBrowserName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"windows phone"===e.getBrowserName()},describe:function(){return{type:i.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(e){var t=Number(String(e.getOSVersion()).split(".")[0]);return"android"===e.getOSName(!0)&&t>=3},describe:function(){return{type:i.PLATFORMS_MAP.tablet}}},{test:function(e){return"android"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.mobile}}},{test:function(e){return"macos"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(e){return"windows"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop}}},{test:function(e){return"linux"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.desktop}}},{test:function(e){return"playstation 4"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.tv}}},{test:function(e){return"roku"===e.getOSName(!0)},describe:function(){return{type:i.PLATFORMS_MAP.tv}}}];t.default=o,e.exports=t.default},95:function(e,t,n){"use strict";t.__esModule=!0,t.default=void 0;var r,a=(r=n(17))&&r.__esModule?r:{default:r},i=n(18),o=[{test:function(e){return"microsoft edge"===e.getBrowserName(!0)},describe:function(e){if(/\sedg\//i.test(e))return{name:i.ENGINE_MAP.Blink};var t=a.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,e);return{name:i.ENGINE_MAP.EdgeHTML,version:t}}},{test:[/trident/i],describe:function(e){var t={name:i.ENGINE_MAP.Trident},n=a.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){return e.test(/presto/i)},describe:function(e){var t={name:i.ENGINE_MAP.Presto},n=a.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:function(e){var t=e.test(/gecko/i),n=e.test(/like gecko/i);return t&&!n},describe:function(e){var t={name:i.ENGINE_MAP.Gecko},n=a.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:i.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(e){var t={name:i.ENGINE_MAP.WebKit},n=a.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,e);return n&&(t.version=n),t}}];t.default=o,e.exports=t.default}})},8392:function(e,t,n){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var r=0,a=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(r++,"%c"===e&&(a=r))})),t.splice(a,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(n){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(n){}!e&&"undefined"!==typeof process&&"env"in process&&(e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.DEBUG);return e},t.useColors=function(){if("undefined"!==typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!==typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!==typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=function(){var e=!1;return function(){e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||function(){},e.exports=n(8472)(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},8472:function(e,t,n){var r=n(861).default;e.exports=function(e){function t(e){var n,r,i,o=null;function s(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];if(s.enabled){var i=s,o=Number(new Date),c=o-(n||o);i.diff=c,i.prev=n,i.curr=o,n=o,r[0]=t.coerce(r[0]),"string"!==typeof r[0]&&r.unshift("%O");var u=0;r[0]=r[0].replace(/%([a-zA-Z%])/g,(function(e,n){if("%%"===e)return"%";u++;var a=t.formatters[n];if("function"===typeof a){var o=r[u];e=a.call(i,o),r.splice(u,1),u--}return e})),t.formatArgs.call(i,r),(i.log||t.log).apply(i,r)}}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=a,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:function(){return null!==o?o:(r!==t.namespaces&&(r=t.namespaces,i=t.enabled(e)),i)},set:function(e){o=e}}),"function"===typeof t.init&&t.init(s),s}function a(e,n){var r=t(this.namespace+("undefined"===typeof n?":":n)+e);return r.log=this.log,r}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){var e=[].concat(r(t.names.map(i)),r(t.skips.map(i).map((function(e){return"-"+e})))).join(",");return t.enable(""),e},t.enable=function(e){var n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];var r=("string"===typeof e?e:"").split(/[\s,]+/),a=r.length;for(n=0;n<a;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(8193),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((function(n){t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){for(var n=0,r=0;r<e.length;r++)n=(n<<5)-n+e.charCodeAt(r),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},2389:function(e,t){!function(e){"use strict";var t=function(e){return function(t){var n=e(t);return t.add(n),n}},n=function(e){return function(t,n){return e.set(t,n),n}},r=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,a=536870912,i=2*a,o=function(e,t){return function(n){var o=t.get(n),s=void 0===o?n.size:o<i?o+1:0;if(!n.has(s))return e(n,s);if(n.size<a){for(;n.has(s);)s=Math.floor(Math.random()*i);return e(n,s)}if(n.size>r)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;n.has(s);)s=Math.floor(Math.random()*r);return e(n,s)}},s=new WeakMap,c=n(s),u=o(c,s),l=t(u);e.addUniqueNumber=l,e.generateUniqueNumber=u}(t)},8193:function(e){var t=1e3,n=60*t,r=60*n,a=24*r,i=7*a,o=365.25*a;function s(e,t,n,r){var a=t>=1.5*n;return Math.round(e/n)+" "+r+(a?"s":"")}e.exports=function(e,c){c=c||{};var u=typeof e;if("string"===u&&e.length>0)return function(e){if((e=String(e)).length>100)return;var s=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!s)return;var c=parseFloat(s[1]);switch((s[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*o;case"weeks":case"week":case"w":return c*i;case"days":case"day":case"d":return c*a;case"hours":case"hour":case"hrs":case"hr":case"h":return c*r;case"minutes":case"minute":case"mins":case"min":case"m":return c*n;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(e);if("number"===u&&isFinite(e))return c.long?function(e){var i=Math.abs(e);if(i>=a)return s(e,i,a,"day");if(i>=r)return s(e,i,r,"hour");if(i>=n)return s(e,i,n,"minute");if(i>=t)return s(e,i,t,"second");return e+" ms"}(e):function(e){var i=Math.abs(e);if(i>=a)return Math.round(e/a)+"d";if(i>=r)return Math.round(e/r)+"h";if(i>=n)return Math.round(e/n)+"m";if(i>=t)return Math.round(e/t)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},4463:function(e,t,n){"use strict";var r=n(2791),a=n(5296);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function c(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(s[e]=t,e=0;e<t.length;e++)o.add(t[e])}var l=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},h={};function v(e,t,n,r,a,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new v(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new v(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new v(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new v(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new v(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new v(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)}));var g=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function k(e,t,n,r){var a=m.hasOwnProperty(t)?m[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!d.call(h,e)||!d.call(f,e)&&(p.test(e)?h[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(g,y);m[t]=new v(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)}));var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),_=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),Z=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),O=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var M=Symbol.iterator;function A(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=M&&e[M]||e["@@iterator"])?e:null}var N,L=Object.assign;function j(e){if(void 0===N)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);N=t&&t[1]||""}return"\n"+N+e}var F=!1;function U(e,t){if(!e||F)return"";F=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&"string"===typeof u.stack){for(var a=u.stack.split("\n"),i=r.stack.split("\n"),o=a.length-1,s=i.length-1;1<=o&&0<=s&&a[o]!==i[s];)s--;for(;1<=o&&0<=s;o--,s--)if(a[o]!==i[s]){if(1!==o||1!==s)do{if(o--,0>--s||a[o]!==i[s]){var c="\n"+a[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}}while(1<=o&&0<=s);break}}}finally{F=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?j(e):""}function B(e){switch(e.tag){case 5:return j(e.type);case 16:return j("Lazy");case 13:return j("Suspense");case 19:return j("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case _:return"Portal";case T:return"Profiler";case E:return"StrictMode";case R:return"Suspense";case P:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case Z:return(e.displayName||"Context")+".Consumer";case x:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case I:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case O:t=e._payload,e=e._init;try{return V(e(t))}catch(n){}}return null}function H(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function z(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function q(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=W(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function $(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function K(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function J(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=z(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&k(e,"checked",t,!1)}function X(e,t){Q(e,t);var n=z(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,z(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Y(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&$(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+z(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:z(n)}}function ie(e,t){var n=z(t.value),r=z(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ce(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ue,le,de=(le=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ue=ue||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ue.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return le(e,t)}))}:le);function pe(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},he=["Webkit","ms","Moz","O"];function ve(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=ve(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(fe).forEach((function(e){he.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ge=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ge[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function ke(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var _e=null,Se=null,Ee=null;function Te(e){if(e=ka(e)){if("function"!==typeof _e)throw Error(i(280));var t=e.stateNode;t&&(t=wa(t),_e(e.stateNode,e.type,t))}}function xe(e){Se?Ee?Ee.push(e):Ee=[e]:Se=e}function Ze(){if(Se){var e=Se,t=Ee;if(Ee=Se=null,Te(e),t)for(e=0;e<t.length;e++)Te(t[e])}}function Ce(e,t){return e(t)}function Re(){}var Pe=!1;function Ie(e,t,n){if(Pe)return e(t,n);Pe=!0;try{return Ce(e,t,n)}finally{Pe=!1,(null!==Se||null!==Ee)&&(Re(),Ze())}}function Oe(e,t){var n=e.stateNode;if(null===n)return null;var r=wa(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var De=!1;if(l)try{var Me={};Object.defineProperty(Me,"passive",{get:function(){De=!0}}),window.addEventListener("test",Me,Me),window.removeEventListener("test",Me,Me)}catch(le){De=!1}function Ae(e,t,n,r,a,i,o,s,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(l){this.onError(l)}}var Ne=!1,Le=null,je=!1,Fe=null,Ue={onError:function(e){Ne=!0,Le=e}};function Be(e,t,n,r,a,i,o,s,c){Ne=!1,Le=null,Ae.apply(Ue,arguments)}function Ve(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function He(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function ze(e){if(Ve(e)!==e)throw Error(i(188))}function We(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(r=a.return)){n=r;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return ze(a),e;if(o===r)return ze(a),t;o=o.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=o;else{for(var s=!1,c=a.child;c;){if(c===n){s=!0,n=a,r=o;break}if(c===r){s=!0,r=a,n=o;break}c=c.sibling}if(!s){for(c=o.child;c;){if(c===n){s=!0,n=o,r=a;break}if(c===r){s=!0,r=o,n=a;break}c=c.sibling}if(!s)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var qe=a.unstable_scheduleCallback,$e=a.unstable_cancelCallback,Ke=a.unstable_shouldYield,Je=a.unstable_requestPaint,Qe=a.unstable_now,Xe=a.unstable_getCurrentPriorityLevel,Ye=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,it=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/ct|0)|0},st=Math.log,ct=Math.LN2;var ut=64,lt=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function pt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,o=268435455&n;if(0!==o){var s=o&~a;0!==s?r=dt(s):0!==(i&=o)&&(r=dt(i))}else 0!==(o=n&~a)?r=dt(o):0!==i&&(r=dt(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(i=t&-t)||16===a&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-ot(t)),r|=e[n],t&=~a;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ht(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function vt(){var e=ut;return 0===(4194240&(ut<<=1))&&(ut=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function gt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var kt=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,_t,St,Et,Tt,xt=!1,Zt=[],Ct=null,Rt=null,Pt=null,It=new Map,Ot=new Map,Dt=[],Mt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function At(e,t){switch(e){case"focusin":case"focusout":Ct=null;break;case"dragenter":case"dragleave":Rt=null;break;case"mouseover":case"mouseout":Pt=null;break;case"pointerover":case"pointerout":It.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ot.delete(t.pointerId)}}function Nt(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=ka(t))&&_t(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Lt(e){var t=ya(e.target);if(null!==t){var n=Ve(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=He(n)))return e.blockedOn=t,void Tt(e.priority,(function(){St(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function jt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Kt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ka(n))&&_t(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);be=r,n.target.dispatchEvent(r),be=null,t.shift()}return!0}function Ft(e,t,n){jt(e)&&n.delete(t)}function Ut(){xt=!1,null!==Ct&&jt(Ct)&&(Ct=null),null!==Rt&&jt(Rt)&&(Rt=null),null!==Pt&&jt(Pt)&&(Pt=null),It.forEach(Ft),Ot.forEach(Ft)}function Bt(e,t){e.blockedOn===t&&(e.blockedOn=null,xt||(xt=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Ut)))}function Vt(e){function t(t){return Bt(t,e)}if(0<Zt.length){Bt(Zt[0],e);for(var n=1;n<Zt.length;n++){var r=Zt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Ct&&Bt(Ct,e),null!==Rt&&Bt(Rt,e),null!==Pt&&Bt(Pt,e),It.forEach(t),Ot.forEach(t),n=0;n<Dt.length;n++)(r=Dt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Lt(n),null===n.blockedOn&&Dt.shift()}var Ht=b.ReactCurrentBatchConfig,zt=!0;function Wt(e,t,n,r){var a=kt,i=Ht.transition;Ht.transition=null;try{kt=1,qt(e,t,n,r)}finally{kt=a,Ht.transition=i}}function Gt(e,t,n,r){var a=kt,i=Ht.transition;Ht.transition=null;try{kt=4,qt(e,t,n,r)}finally{kt=a,Ht.transition=i}}function qt(e,t,n,r){if(zt){var a=Kt(e,t,n,r);if(null===a)zr(e,t,r,$t,n),At(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return Ct=Nt(Ct,e,t,n,r,a),!0;case"dragenter":return Rt=Nt(Rt,e,t,n,r,a),!0;case"mouseover":return Pt=Nt(Pt,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return It.set(i,Nt(It.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Ot.set(i,Nt(Ot.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(At(e,r),4&t&&-1<Mt.indexOf(e)){for(;null!==a;){var i=ka(a);if(null!==i&&wt(i),null===(i=Kt(e,t,n,r))&&zr(e,t,r,$t,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else zr(e,t,r,null,n)}}var $t=null;function Kt(e,t,n,r){if($t=null,null!==(e=ya(e=we(r))))if(null===(t=Ve(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=He(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return $t=e,null}function Jt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ye:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Qt=null,Xt=null,Yt=null;function en(){if(Yt)return Yt;var e,t,n=Xt,r=n.length,a="value"in Qt?Qt.value:Qt.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===a[i-t];t++);return Yt=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,a,i){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,sn,cn,un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ln=an(un),dn=L({},un,{view:0,detail:0}),pn=an(dn),fn=L({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==cn&&(cn&&"mousemove"===e.type?(on=e.screenX-cn.screenX,sn=e.screenY-cn.screenY):sn=on=0,cn=e),on)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),hn=an(fn),vn=an(L({},fn,{dataTransfer:0})),mn=an(L({},dn,{relatedTarget:0})),gn=an(L({},un,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=L({},un,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),kn=an(yn),bn=an(L({},un,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_n={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function En(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function Tn(){return En}var xn=L({},dn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?_n[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Zn=an(xn),Cn=an(L({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Rn=an(L({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tn})),Pn=an(L({},un,{propertyName:0,elapsedTime:0,pseudoElement:0})),In=L({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),On=an(In),Dn=[9,13,27,32],Mn=l&&"CompositionEvent"in window,An=null;l&&"documentMode"in document&&(An=document.documentMode);var Nn=l&&"TextEvent"in window&&!An,Ln=l&&(!Mn||An&&8<An&&11>=An),jn=String.fromCharCode(32),Fn=!1;function Un(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vn=!1;var Hn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hn[e.type]:"textarea"===t}function Wn(e,t,n,r){xe(r),0<(t=Gr(t,"onChange")).length&&(n=new ln("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Gn=null,qn=null;function $n(e){jr(e,0)}function Kn(e){if(q(ba(e)))return e}function Jn(e,t){if("change"===e)return t}var Qn=!1;if(l){var Xn;if(l){var Yn="oninput"in document;if(!Yn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Yn="function"===typeof er.oninput}Xn=Yn}else Xn=!1;Qn=Xn&&(!document.documentMode||9<document.documentMode)}function tr(){Gn&&(Gn.detachEvent("onpropertychange",nr),qn=Gn=null)}function nr(e){if("value"===e.propertyName&&Kn(qn)){var t=[];Wn(t,qn,e,we(e)),Ie($n,t)}}function rr(e,t,n){"focusin"===e?(tr(),qn=n,(Gn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Kn(qn)}function ir(e,t){if("click"===e)return Kn(t)}function or(e,t){if("input"===e||"change"===e)return Kn(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function cr(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!d.call(t,a)||!sr(e[a],t[a]))return!1}return!0}function ur(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lr(e,t){var n,r=ur(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=ur(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function pr(){for(var e=window,t=$();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=$((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function hr(e){var t=pr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=void 0===r.end?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=lr(n,i);var o=lr(n,r);a&&o&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vr=l&&"documentMode"in document&&11>=document.documentMode,mr=null,gr=null,yr=null,kr=!1;function br(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;kr||null==mr||mr!==$(r)||("selectionStart"in(r=mr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&cr(yr,r)||(yr=r,0<(r=Gr(gr,"onSelect")).length&&(t=new ln("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var _r={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},Sr={},Er={};function Tr(e){if(Sr[e])return Sr[e];if(!_r[e])return e;var t,n=_r[e];for(t in n)if(n.hasOwnProperty(t)&&t in Er)return Sr[e]=n[t];return e}l&&(Er=document.createElement("div").style,"AnimationEvent"in window||(delete _r.animationend.animation,delete _r.animationiteration.animation,delete _r.animationstart.animation),"TransitionEvent"in window||delete _r.transitionend.transition);var xr=Tr("animationend"),Zr=Tr("animationiteration"),Cr=Tr("animationstart"),Rr=Tr("transitionend"),Pr=new Map,Ir="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Or(e,t){Pr.set(e,t),c(t,[e])}for(var Dr=0;Dr<Ir.length;Dr++){var Mr=Ir[Dr];Or(Mr.toLowerCase(),"on"+(Mr[0].toUpperCase()+Mr.slice(1)))}Or(xr,"onAnimationEnd"),Or(Zr,"onAnimationIteration"),Or(Cr,"onAnimationStart"),Or("dblclick","onDoubleClick"),Or("focusin","onFocus"),Or("focusout","onBlur"),Or(Rr,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ar="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ar));function Lr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,o,s,c,u){if(Be.apply(this,arguments),Ne){if(!Ne)throw Error(i(198));var l=Le;Ne=!1,Le=null,je||(je=!0,Fe=l)}}(r,t,void 0,e),e.currentTarget=null}function jr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],c=s.instance,u=s.currentTarget;if(s=s.listener,c!==i&&a.isPropagationStopped())break e;Lr(a,s,u),i=c}else for(o=0;o<r.length;o++){if(c=(s=r[o]).instance,u=s.currentTarget,s=s.listener,c!==i&&a.isPropagationStopped())break e;Lr(a,s,u),i=c}}}if(je)throw e=Fe,je=!1,Fe=null,e}function Fr(e,t){var n=t[va];void 0===n&&(n=t[va]=new Set);var r=e+"__bubble";n.has(r)||(Hr(t,e,2,!1),n.add(r))}function Ur(e,t,n){var r=0;t&&(r|=4),Hr(n,e,r,t)}var Br="_reactListening"+Math.random().toString(36).slice(2);function Vr(e){if(!e[Br]){e[Br]=!0,o.forEach((function(t){"selectionchange"!==t&&(Nr.has(t)||Ur(t,!1,e),Ur(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Br]||(t[Br]=!0,Ur("selectionchange",!1,t))}}function Hr(e,t,n,r){switch(Jt(t)){case 1:var a=Wt;break;case 4:a=Gt;break;default:a=qt}n=a.bind(null,t,n,e),a=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function zr(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===a||8===s.nodeType&&s.parentNode===a)break;if(4===o)for(o=r.return;null!==o;){var c=o.tag;if((3===c||4===c)&&((c=o.stateNode.containerInfo)===a||8===c.nodeType&&c.parentNode===a))return;o=o.return}for(;null!==s;){if(null===(o=ya(s)))return;if(5===(c=o.tag)||6===c){r=i=o;continue e}s=s.parentNode}}r=r.return}Ie((function(){var r=i,a=we(n),o=[];e:{var s=Pr.get(e);if(void 0!==s){var c=ln,u=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":c=Zn;break;case"focusin":u="focus",c=mn;break;case"focusout":u="blur",c=mn;break;case"beforeblur":case"afterblur":c=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=hn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=vn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=Rn;break;case xr:case Zr:case Cr:c=gn;break;case Rr:c=Pn;break;case"scroll":c=pn;break;case"wheel":c=On;break;case"copy":case"cut":case"paste":c=kn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=Cn}var l=0!==(4&t),d=!l&&"scroll"===e,p=l?null!==s?s+"Capture":null:s;l=[];for(var f,h=r;null!==h;){var v=(f=h).stateNode;if(5===f.tag&&null!==v&&(f=v,null!==p&&(null!=(v=Oe(h,p))&&l.push(Wr(h,v,f)))),d)break;h=h.return}0<l.length&&(s=new c(s,u,null,n,a),o.push({event:s,listeners:l}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===be||!(u=n.relatedTarget||n.fromElement)||!ya(u)&&!u[ha])&&(c||s)&&(s=a.window===a?a:(s=a.ownerDocument)?s.defaultView||s.parentWindow:window,c?(c=r,null!==(u=(u=n.relatedTarget||n.toElement)?ya(u):null)&&(u!==(d=Ve(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(c=null,u=r),c!==u)){if(l=hn,v="onMouseLeave",p="onMouseEnter",h="mouse","pointerout"!==e&&"pointerover"!==e||(l=Cn,v="onPointerLeave",p="onPointerEnter",h="pointer"),d=null==c?s:ba(c),f=null==u?s:ba(u),(s=new l(v,h+"leave",c,n,a)).target=d,s.relatedTarget=f,v=null,ya(a)===r&&((l=new l(p,h+"enter",u,n,a)).target=f,l.relatedTarget=d,v=l),d=v,c&&u)e:{for(p=u,h=0,f=l=c;f;f=qr(f))h++;for(f=0,v=p;v;v=qr(v))f++;for(;0<h-f;)l=qr(l),h--;for(;0<f-h;)p=qr(p),f--;for(;h--;){if(l===p||null!==p&&l===p.alternate)break e;l=qr(l),p=qr(p)}l=null}else l=null;null!==c&&$r(o,s,c,l,!1),null!==u&&null!==d&&$r(o,d,u,l,!0)}if("select"===(c=(s=r?ba(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===c&&"file"===s.type)var m=Jn;else if(zn(s))if(Qn)m=or;else{m=ar;var g=rr}else(c=s.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(m=ir);switch(m&&(m=m(e,r))?Wn(o,m,n,a):(g&&g(e,s,r),"focusout"===e&&(g=s._wrapperState)&&g.controlled&&"number"===s.type&&ee(s,"number",s.value)),g=r?ba(r):window,e){case"focusin":(zn(g)||"true"===g.contentEditable)&&(mr=g,gr=r,yr=null);break;case"focusout":yr=gr=mr=null;break;case"mousedown":kr=!0;break;case"contextmenu":case"mouseup":case"dragend":kr=!1,br(o,n,a);break;case"selectionchange":if(vr)break;case"keydown":case"keyup":br(o,n,a)}var y;if(Mn)e:{switch(e){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Vn?Un(e,n)&&(k="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(k="onCompositionStart");k&&(Ln&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==k?"onCompositionEnd"===k&&Vn&&(y=en()):(Xt="value"in(Qt=a)?Qt.value:Qt.textContent,Vn=!0)),0<(g=Gr(r,k)).length&&(k=new bn(k,e,null,n,a),o.push({event:k,listeners:g}),y?k.data=y:null!==(y=Bn(n))&&(k.data=y))),(y=Nn?function(e,t){switch(e){case"compositionend":return Bn(t);case"keypress":return 32!==t.which?null:(Fn=!0,jn);case"textInput":return(e=t.data)===jn&&Fn?null:e;default:return null}}(e,n):function(e,t){if(Vn)return"compositionend"===e||!Mn&&Un(e,t)?(e=en(),Yt=Xt=Qt=null,Vn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Gr(r,"onBeforeInput")).length&&(a=new bn("onBeforeInput","beforeinput",null,n,a),o.push({event:a,listeners:r}),a.data=y))}jr(o,t)}))}function Wr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Gr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=Oe(e,n))&&r.unshift(Wr(e,i,a)),null!=(i=Oe(e,t))&&r.push(Wr(e,i,a))),e=e.return}return r}function qr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function $r(e,t,n,r,a){for(var i=t._reactName,o=[];null!==n&&n!==r;){var s=n,c=s.alternate,u=s.stateNode;if(null!==c&&c===r)break;5===s.tag&&null!==u&&(s=u,a?null!=(c=Oe(n,i))&&o.unshift(Wr(n,c,s)):a||null!=(c=Oe(n,i))&&o.push(Wr(n,c,s))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Kr=/\r\n?/g,Jr=/\u0000|\uFFFD/g;function Qr(e){return("string"===typeof e?e:""+e).replace(Kr,"\n").replace(Jr,"")}function Xr(e,t,n){if(t=Qr(t),Qr(e)!==t&&n)throw Error(i(425))}function Yr(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ia="function"===typeof Promise?Promise:void 0,oa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ia?function(e){return ia.resolve(null).then(e).catch(sa)}:ra;function sa(e){setTimeout((function(){throw e}))}function ca(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void Vt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);Vt(t)}function ua(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function la(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var da=Math.random().toString(36).slice(2),pa="__reactFiber$"+da,fa="__reactProps$"+da,ha="__reactContainer$"+da,va="__reactEvents$"+da,ma="__reactListeners$"+da,ga="__reactHandles$"+da;function ya(e){var t=e[pa];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ha]||n[pa]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=la(e);null!==e;){if(n=e[pa])return n;e=la(e)}return t}n=(e=n).parentNode}return null}function ka(e){return!(e=e[pa]||e[ha])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ba(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function wa(e){return e[fa]||null}var _a=[],Sa=-1;function Ea(e){return{current:e}}function Ta(e){0>Sa||(e.current=_a[Sa],_a[Sa]=null,Sa--)}function xa(e,t){Sa++,_a[Sa]=e.current,e.current=t}var Za={},Ca=Ea(Za),Ra=Ea(!1),Pa=Za;function Ia(e,t){var n=e.type.contextTypes;if(!n)return Za;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Oa(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Da(){Ta(Ra),Ta(Ca)}function Ma(e,t,n){if(Ca.current!==Za)throw Error(i(168));xa(Ca,t),xa(Ra,n)}function Aa(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(i(108,H(e)||"Unknown",a));return L({},n,r)}function Na(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Za,Pa=Ca.current,xa(Ca,e),xa(Ra,Ra.current),!0}function La(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=Aa(e,t,Pa),r.__reactInternalMemoizedMergedChildContext=e,Ta(Ra),Ta(Ca),xa(Ca,e)):Ta(Ra),xa(Ra,n)}var ja=null,Fa=!1,Ua=!1;function Ba(e){null===ja?ja=[e]:ja.push(e)}function Va(){if(!Ua&&null!==ja){Ua=!0;var e=0,t=kt;try{var n=ja;for(kt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}ja=null,Fa=!1}catch(a){throw null!==ja&&(ja=ja.slice(e+1)),qe(Ye,Va),a}finally{kt=t,Ua=!1}}return null}var Ha=[],za=0,Wa=null,Ga=0,qa=[],$a=0,Ka=null,Ja=1,Qa="";function Xa(e,t){Ha[za++]=Ga,Ha[za++]=Wa,Wa=e,Ga=t}function Ya(e,t,n){qa[$a++]=Ja,qa[$a++]=Qa,qa[$a++]=Ka,Ka=e;var r=Ja;e=Qa;var a=32-ot(r)-1;r&=~(1<<a),n+=1;var i=32-ot(t)+a;if(30<i){var o=a-a%5;i=(r&(1<<o)-1).toString(32),r>>=o,a-=o,Ja=1<<32-ot(t)+a|n<<a|r,Qa=i+e}else Ja=1<<i|n<<a|r,Qa=e}function ei(e){null!==e.return&&(Xa(e,1),Ya(e,1,0))}function ti(e){for(;e===Wa;)Wa=Ha[--za],Ha[za]=null,Ga=Ha[--za],Ha[za]=null;for(;e===Ka;)Ka=qa[--$a],qa[$a]=null,Qa=qa[--$a],qa[$a]=null,Ja=qa[--$a],qa[$a]=null}var ni=null,ri=null,ai=!1,ii=null;function oi(e,t){var n=Ou(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function si(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ni=e,ri=ua(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ni=e,ri=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Ka?{id:Ja,overflow:Qa}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ou(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ni=e,ri=null,!0);default:return!1}}function ci(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ui(e){if(ai){var t=ri;if(t){var n=t;if(!si(e,t)){if(ci(e))throw Error(i(418));t=ua(n.nextSibling);var r=ni;t&&si(e,t)?oi(r,n):(e.flags=-4097&e.flags|2,ai=!1,ni=e)}}else{if(ci(e))throw Error(i(418));e.flags=-4097&e.flags|2,ai=!1,ni=e}}}function li(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ni=e}function di(e){if(e!==ni)return!1;if(!ai)return li(e),ai=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=ri)){if(ci(e))throw pi(),Error(i(418));for(;t;)oi(e,t),t=ua(t.nextSibling)}if(li(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ri=ua(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ri=null}}else ri=ni?ua(e.stateNode.nextSibling):null;return!0}function pi(){for(var e=ri;e;)e=ua(e.nextSibling)}function fi(){ri=ni=null,ai=!1}function hi(e){null===ii?ii=[e]:ii.push(e)}var vi=b.ReactCurrentBatchConfig;function mi(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var gi=Ea(null),yi=null,ki=null,bi=null;function wi(){bi=ki=yi=null}function _i(e){var t=gi.current;Ta(gi),e._currentValue=t}function Si(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ei(e,t){yi=e,bi=ki=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bs=!0),e.firstContext=null)}function Ti(e){var t=e._currentValue;if(bi!==e)if(e={context:e,memoizedValue:t,next:null},null===ki){if(null===yi)throw Error(i(308));ki=e,yi.dependencies={lanes:0,firstContext:e}}else ki=ki.next=e;return t}var xi=null;function Zi(e){null===xi?xi=[e]:xi.push(e)}function Ci(e,t,n,r){var a=t.interleaved;return null===a?(n.next=n,Zi(t)):(n.next=a.next,a.next=n),t.interleaved=n,Ri(e,r)}function Ri(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Pi=!1;function Ii(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Oi(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Di(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Mi(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Rc)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,Ri(e,n)}return null===(a=r.interleaved)?(t.next=t,Zi(r)):(t.next=a.next,a.next=t),r.interleaved=t,Ri(e,n)}function Ai(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function Ni(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=o:i=i.next=o,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Li(e,t,n,r){var a=e.updateQueue;Pi=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,s=a.shared.pending;if(null!==s){a.shared.pending=null;var c=s,u=c.next;c.next=null,null===o?i=u:o.next=u,o=c;var l=e.alternate;null!==l&&((s=(l=l.updateQueue).lastBaseUpdate)!==o&&(null===s?l.firstBaseUpdate=u:s.next=u,l.lastBaseUpdate=c))}if(null!==i){var d=a.baseState;for(o=0,l=u=c=null,s=i;;){var p=s.lane,f=s.eventTime;if((r&p)===p){null!==l&&(l=l.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var h=e,v=s;switch(p=t,f=n,v.tag){case 1:if("function"===typeof(h=v.payload)){d=h.call(f,d,p);break e}d=h;break e;case 3:h.flags=-65537&h.flags|128;case 0:if(null===(p="function"===typeof(h=v.payload)?h.call(f,d,p):h)||void 0===p)break e;d=L({},d,p);break e;case 2:Pi=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(p=a.effects)?a.effects=[s]:p.push(s))}else f={eventTime:f,lane:p,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===l?(u=l=f,c=d):l=l.next=f,o|=p;if(null===(s=s.next)){if(null===(s=a.shared.pending))break;s=(p=s).next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}if(null===l&&(c=d),a.baseState=c,a.firstBaseUpdate=u,a.lastBaseUpdate=l,null!==(t=a.shared.interleaved)){a=t;do{o|=a.lane,a=a.next}while(a!==t)}else null===i&&(a.shared.lanes=0);Lc|=o,e.lanes=o,e.memoizedState=d}}function ji(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(i(191,a));a.call(r)}}}var Fi=(new r.Component).refs;function Ui(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Bi={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=tu(),a=nu(e),i=Di(r,a);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Mi(e,i,a))&&(ru(t,e,a,r),Ai(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=tu(),a=nu(e),i=Di(r,a);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Mi(e,i,a))&&(ru(t,e,a,r),Ai(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=tu(),r=nu(e),a=Di(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Mi(e,a,r))&&(ru(t,e,r,n),Ai(t,e,r))}};function Vi(e,t,n,r,a,i,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,o):!t.prototype||!t.prototype.isPureReactComponent||(!cr(n,r)||!cr(a,i))}function Hi(e,t,n){var r=!1,a=Za,i=t.contextType;return"object"===typeof i&&null!==i?i=Ti(i):(a=Oa(t)?Pa:Ca.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ia(e,a):Za),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Bi,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function zi(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Bi.enqueueReplaceState(t,t.state,null)}function Wi(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs=Fi,Ii(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=Ti(i):(i=Oa(t)?Pa:Ca.current,a.context=Ia(e,i)),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(Ui(e,t,i,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&Bi.enqueueReplaceState(a,a.state,null),Li(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function Gi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var a=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=a.refs;t===Fi&&(t=a.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function qi(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function $i(e){return(0,e._init)(e._payload)}function Ki(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Mu(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function c(e,t,n,r){return null===t||6!==t.tag?((t=ju(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function u(e,t,n,r){var i=n.type;return i===S?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===O&&$i(i)===t.type)?((r=a(t,n.props)).ref=Gi(e,t,n),r.return=e,r):((r=Au(n.type,n.key,n.props,null,e.mode,r)).ref=Gi(e,t,n),r.return=e,r)}function l(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fu(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function d(e,t,n,r,i){return null===t||7!==t.tag?((t=Nu(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function p(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=ju(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Au(t.type,t.key,t.props,null,e.mode,n)).ref=Gi(e,null,t),n.return=e,n;case _:return(t=Fu(t,e.mode,n)).return=e,t;case O:return p(e,(0,t._init)(t._payload),n)}if(te(t)||A(t))return(t=Nu(t,e.mode,n,null)).return=e,t;qi(e,t)}return null}function f(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:c(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===a?u(e,t,n,r):null;case _:return n.key===a?l(e,t,n,r):null;case O:return f(e,t,(a=n._init)(n._payload),r)}if(te(n)||A(n))return null!==a?null:d(e,t,n,r,null);qi(e,n)}return null}function h(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return c(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return u(t,e=e.get(null===r.key?n:r.key)||null,r,a);case _:return l(t,e=e.get(null===r.key?n:r.key)||null,r,a);case O:return h(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||A(r))return d(t,e=e.get(n)||null,r,a,null);qi(t,r)}return null}function v(a,i,s,c){for(var u=null,l=null,d=i,v=i=0,m=null;null!==d&&v<s.length;v++){d.index>v?(m=d,d=null):m=d.sibling;var g=f(a,d,s[v],c);if(null===g){null===d&&(d=m);break}e&&d&&null===g.alternate&&t(a,d),i=o(g,i,v),null===l?u=g:l.sibling=g,l=g,d=m}if(v===s.length)return n(a,d),ai&&Xa(a,v),u;if(null===d){for(;v<s.length;v++)null!==(d=p(a,s[v],c))&&(i=o(d,i,v),null===l?u=d:l.sibling=d,l=d);return ai&&Xa(a,v),u}for(d=r(a,d);v<s.length;v++)null!==(m=h(d,a,v,s[v],c))&&(e&&null!==m.alternate&&d.delete(null===m.key?v:m.key),i=o(m,i,v),null===l?u=m:l.sibling=m,l=m);return e&&d.forEach((function(e){return t(a,e)})),ai&&Xa(a,v),u}function m(a,s,c,u){var l=A(c);if("function"!==typeof l)throw Error(i(150));if(null==(c=l.call(c)))throw Error(i(151));for(var d=l=null,v=s,m=s=0,g=null,y=c.next();null!==v&&!y.done;m++,y=c.next()){v.index>m?(g=v,v=null):g=v.sibling;var k=f(a,v,y.value,u);if(null===k){null===v&&(v=g);break}e&&v&&null===k.alternate&&t(a,v),s=o(k,s,m),null===d?l=k:d.sibling=k,d=k,v=g}if(y.done)return n(a,v),ai&&Xa(a,m),l;if(null===v){for(;!y.done;m++,y=c.next())null!==(y=p(a,y.value,u))&&(s=o(y,s,m),null===d?l=y:d.sibling=y,d=y);return ai&&Xa(a,m),l}for(v=r(a,v);!y.done;m++,y=c.next())null!==(y=h(v,a,m,y.value,u))&&(e&&null!==y.alternate&&v.delete(null===y.key?m:y.key),s=o(y,s,m),null===d?l=y:d.sibling=y,d=y);return e&&v.forEach((function(e){return t(a,e)})),ai&&Xa(a,m),l}return function e(r,i,o,c){if("object"===typeof o&&null!==o&&o.type===S&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case w:e:{for(var u=o.key,l=i;null!==l;){if(l.key===u){if((u=o.type)===S){if(7===l.tag){n(r,l.sibling),(i=a(l,o.props.children)).return=r,r=i;break e}}else if(l.elementType===u||"object"===typeof u&&null!==u&&u.$$typeof===O&&$i(u)===l.type){n(r,l.sibling),(i=a(l,o.props)).ref=Gi(r,l,o),i.return=r,r=i;break e}n(r,l);break}t(r,l),l=l.sibling}o.type===S?((i=Nu(o.props.children,r.mode,c,o.key)).return=r,r=i):((c=Au(o.type,o.key,o.props,null,r.mode,c)).ref=Gi(r,i,o),c.return=r,r=c)}return s(r);case _:e:{for(l=o.key;null!==i;){if(i.key===l){if(4===i.tag&&i.stateNode.containerInfo===o.containerInfo&&i.stateNode.implementation===o.implementation){n(r,i.sibling),(i=a(i,o.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=Fu(o,r.mode,c)).return=r,r=i}return s(r);case O:return e(r,i,(l=o._init)(o._payload),c)}if(te(o))return v(r,i,o,c);if(A(o))return m(r,i,o,c);qi(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==i&&6===i.tag?(n(r,i.sibling),(i=a(i,o)).return=r,r=i):(n(r,i),(i=ju(o,r.mode,c)).return=r,r=i),s(r)):n(r,i)}}var Ji=Ki(!0),Qi=Ki(!1),Xi={},Yi=Ea(Xi),eo=Ea(Xi),to=Ea(Xi);function no(e){if(e===Xi)throw Error(i(174));return e}function ro(e,t){switch(xa(to,t),xa(eo,e),xa(Yi,Xi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ce(null,"");break;default:t=ce(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ta(Yi),xa(Yi,t)}function ao(){Ta(Yi),Ta(eo),Ta(to)}function io(e){no(to.current);var t=no(Yi.current),n=ce(t,e.type);t!==n&&(xa(eo,e),xa(Yi,n))}function oo(e){eo.current===e&&(Ta(Yi),Ta(eo))}var so=Ea(0);function co(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var uo=[];function lo(){for(var e=0;e<uo.length;e++)uo[e]._workInProgressVersionPrimary=null;uo.length=0}var po=b.ReactCurrentDispatcher,fo=b.ReactCurrentBatchConfig,ho=0,vo=null,mo=null,go=null,yo=!1,ko=!1,bo=0,wo=0;function _o(){throw Error(i(321))}function So(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function Eo(e,t,n,r,a,o){if(ho=o,vo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,po.current=null===e||null===e.memoizedState?ss:cs,e=n(r,a),ko){o=0;do{if(ko=!1,bo=0,25<=o)throw Error(i(301));o+=1,go=mo=null,t.updateQueue=null,po.current=us,e=n(r,a)}while(ko)}if(po.current=os,t=null!==mo&&null!==mo.next,ho=0,go=mo=vo=null,yo=!1,t)throw Error(i(300));return e}function To(){var e=0!==bo;return bo=0,e}function xo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===go?vo.memoizedState=go=e:go=go.next=e,go}function Zo(){if(null===mo){var e=vo.alternate;e=null!==e?e.memoizedState:null}else e=mo.next;var t=null===go?vo.memoizedState:go.next;if(null!==t)go=t,mo=e;else{if(null===e)throw Error(i(310));e={memoizedState:(mo=e).memoizedState,baseState:mo.baseState,baseQueue:mo.baseQueue,queue:mo.queue,next:null},null===go?vo.memoizedState=go=e:go=go.next=e}return go}function Co(e,t){return"function"===typeof t?t(e):t}function Ro(e){var t=Zo(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=mo,a=r.baseQueue,o=n.pending;if(null!==o){if(null!==a){var s=a.next;a.next=o.next,o.next=s}r.baseQueue=a=o,n.pending=null}if(null!==a){o=a.next,r=r.baseState;var c=s=null,u=null,l=o;do{var d=l.lane;if((ho&d)===d)null!==u&&(u=u.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var p={lane:d,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};null===u?(c=u=p,s=r):u=u.next=p,vo.lanes|=d,Lc|=d}l=l.next}while(null!==l&&l!==o);null===u?s=r:u.next=c,sr(r,t.memoizedState)||(bs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=u,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{o=a.lane,vo.lanes|=o,Lc|=o,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Po(e){var t=Zo(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,o=t.memoizedState;if(null!==a){n.pending=null;var s=a=a.next;do{o=e(o,s.action),s=s.next}while(s!==a);sr(o,t.memoizedState)||(bs=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Io(){}function Oo(e,t){var n=vo,r=Zo(),a=t(),o=!sr(r.memoizedState,a);if(o&&(r.memoizedState=a,bs=!0),r=r.queue,zo(Ao.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==go&&1&go.memoizedState.tag){if(n.flags|=2048,Fo(9,Mo.bind(null,n,r,a,t),void 0,null),null===Pc)throw Error(i(349));0!==(30&ho)||Do(n,t,a)}return a}function Do(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=vo.updateQueue)?(t={lastEffect:null,stores:null},vo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Mo(e,t,n,r){t.value=n,t.getSnapshot=r,No(t)&&Lo(e)}function Ao(e,t,n){return n((function(){No(t)&&Lo(e)}))}function No(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function Lo(e){var t=Ri(e,1);null!==t&&ru(t,e,1,-1)}function jo(e){var t=xo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Co,lastRenderedState:e},t.queue=e,e=e.dispatch=ns.bind(null,vo,e),[t.memoizedState,e]}function Fo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=vo.updateQueue)?(t={lastEffect:null,stores:null},vo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Uo(){return Zo().memoizedState}function Bo(e,t,n,r){var a=xo();vo.flags|=e,a.memoizedState=Fo(1|t,n,void 0,void 0===r?null:r)}function Vo(e,t,n,r){var a=Zo();r=void 0===r?null:r;var i=void 0;if(null!==mo){var o=mo.memoizedState;if(i=o.destroy,null!==r&&So(r,o.deps))return void(a.memoizedState=Fo(t,n,i,r))}vo.flags|=e,a.memoizedState=Fo(1|t,n,i,r)}function Ho(e,t){return Bo(8390656,8,e,t)}function zo(e,t){return Vo(2048,8,e,t)}function Wo(e,t){return Vo(4,2,e,t)}function Go(e,t){return Vo(4,4,e,t)}function qo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function $o(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Vo(4,4,qo.bind(null,t,e),n)}function Ko(){}function Jo(e,t){var n=Zo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&So(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Qo(e,t){var n=Zo();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&So(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Xo(e,t,n){return 0===(21&ho)?(e.baseState&&(e.baseState=!1,bs=!0),e.memoizedState=n):(sr(n,t)||(n=vt(),vo.lanes|=n,Lc|=n,e.baseState=!0),t)}function Yo(e,t){var n=kt;kt=0!==n&&4>n?n:4,e(!0);var r=fo.transition;fo.transition={};try{e(!1),t()}finally{kt=n,fo.transition=r}}function es(){return Zo().memoizedState}function ts(e,t,n){var r=nu(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},rs(e))as(t,n);else if(null!==(n=Ci(e,t,n,r))){ru(n,e,r,tu()),is(n,t,r)}}function ns(e,t,n){var r=nu(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(rs(e))as(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=i(o,n);if(a.hasEagerState=!0,a.eagerState=s,sr(s,o)){var c=t.interleaved;return null===c?(a.next=a,Zi(t)):(a.next=c.next,c.next=a),void(t.interleaved=a)}}catch(u){}null!==(n=Ci(e,t,a,r))&&(ru(n,e,r,a=tu()),is(n,t,r))}}function rs(e){var t=e.alternate;return e===vo||null!==t&&t===vo}function as(e,t){ko=yo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function is(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var os={readContext:Ti,useCallback:_o,useContext:_o,useEffect:_o,useImperativeHandle:_o,useInsertionEffect:_o,useLayoutEffect:_o,useMemo:_o,useReducer:_o,useRef:_o,useState:_o,useDebugValue:_o,useDeferredValue:_o,useTransition:_o,useMutableSource:_o,useSyncExternalStore:_o,useId:_o,unstable_isNewReconciler:!1},ss={readContext:Ti,useCallback:function(e,t){return xo().memoizedState=[e,void 0===t?null:t],e},useContext:Ti,useEffect:Ho,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Bo(4194308,4,qo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Bo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Bo(4,2,e,t)},useMemo:function(e,t){var n=xo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=xo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=ts.bind(null,vo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},xo().memoizedState=e},useState:jo,useDebugValue:Ko,useDeferredValue:function(e){return xo().memoizedState=e},useTransition:function(){var e=jo(!1),t=e[0];return e=Yo.bind(null,e[1]),xo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=vo,a=xo();if(ai){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===Pc)throw Error(i(349));0!==(30&ho)||Do(r,t,n)}a.memoizedState=n;var o={value:n,getSnapshot:t};return a.queue=o,Ho(Ao.bind(null,r,o,e),[e]),r.flags|=2048,Fo(9,Mo.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=xo(),t=Pc.identifierPrefix;if(ai){var n=Qa;t=":"+t+"R"+(n=(Ja&~(1<<32-ot(Ja)-1)).toString(32)+n),0<(n=bo++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=wo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},cs={readContext:Ti,useCallback:Jo,useContext:Ti,useEffect:zo,useImperativeHandle:$o,useInsertionEffect:Wo,useLayoutEffect:Go,useMemo:Qo,useReducer:Ro,useRef:Uo,useState:function(){return Ro(Co)},useDebugValue:Ko,useDeferredValue:function(e){return Xo(Zo(),mo.memoizedState,e)},useTransition:function(){return[Ro(Co)[0],Zo().memoizedState]},useMutableSource:Io,useSyncExternalStore:Oo,useId:es,unstable_isNewReconciler:!1},us={readContext:Ti,useCallback:Jo,useContext:Ti,useEffect:zo,useImperativeHandle:$o,useInsertionEffect:Wo,useLayoutEffect:Go,useMemo:Qo,useReducer:Po,useRef:Uo,useState:function(){return Po(Co)},useDebugValue:Ko,useDeferredValue:function(e){var t=Zo();return null===mo?t.memoizedState=e:Xo(t,mo.memoizedState,e)},useTransition:function(){return[Po(Co)[0],Zo().memoizedState]},useMutableSource:Io,useSyncExternalStore:Oo,useId:es,unstable_isNewReconciler:!1};function ls(e,t){try{var n="",r=t;do{n+=B(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a,digest:null}}function ds(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function ps(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var fs="function"===typeof WeakMap?WeakMap:Map;function hs(e,t,n){(n=Di(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Wc||(Wc=!0,Gc=r),ps(0,t)},n}function vs(e,t,n){(n=Di(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){ps(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){ps(0,t),"function"!==typeof r&&(null===qc?qc=new Set([this]):qc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ms(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new fs;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=xu.bind(null,e,t,n),t.then(e,e))}function gs(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ys(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Di(-1,1)).tag=2,Mi(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var ks=b.ReactCurrentOwner,bs=!1;function ws(e,t,n,r){t.child=null===e?Qi(t,null,n,r):Ji(t,e.child,n,r)}function _s(e,t,n,r,a){n=n.render;var i=t.ref;return Ei(t,a),r=Eo(e,t,n,r,i,a),n=To(),null===e||bs?(ai&&n&&ei(t),t.flags|=1,ws(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Ws(e,t,a))}function Ss(e,t,n,r,a){if(null===e){var i=n.type;return"function"!==typeof i||Du(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Au(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Es(e,t,i,r,a))}if(i=e.child,0===(e.lanes&a)){var o=i.memoizedProps;if((n=null!==(n=n.compare)?n:cr)(o,r)&&e.ref===t.ref)return Ws(e,t,a)}return t.flags|=1,(e=Mu(i,r)).ref=t.ref,e.return=t,t.child=e}function Es(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(cr(i,r)&&e.ref===t.ref){if(bs=!1,t.pendingProps=r=i,0===(e.lanes&a))return t.lanes=e.lanes,Ws(e,t,a);0!==(131072&e.flags)&&(bs=!0)}}return Zs(e,t,n,r,a)}function Ts(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},xa(Mc,Dc),Dc|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,xa(Mc,Dc),Dc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,xa(Mc,Dc),Dc|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,xa(Mc,Dc),Dc|=r;return ws(e,t,a,n),t.child}function xs(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Zs(e,t,n,r,a){var i=Oa(n)?Pa:Ca.current;return i=Ia(t,i),Ei(t,a),n=Eo(e,t,n,r,i,a),r=To(),null===e||bs?(ai&&r&&ei(t),t.flags|=1,ws(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Ws(e,t,a))}function Cs(e,t,n,r,a){if(Oa(n)){var i=!0;Na(t)}else i=!1;if(Ei(t,a),null===t.stateNode)zs(e,t),Hi(t,n,r),Wi(t,n,r,a),r=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var c=o.context,u=n.contextType;"object"===typeof u&&null!==u?u=Ti(u):u=Ia(t,u=Oa(n)?Pa:Ca.current);var l=n.getDerivedStateFromProps,d="function"===typeof l||"function"===typeof o.getSnapshotBeforeUpdate;d||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||c!==u)&&zi(t,o,r,u),Pi=!1;var p=t.memoizedState;o.state=p,Li(t,r,o,a),c=t.memoizedState,s!==r||p!==c||Ra.current||Pi?("function"===typeof l&&(Ui(t,n,l,r),c=t.memoizedState),(s=Pi||Vi(t,n,s,r,p,c,u))?(d||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=u,r=s):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Oi(e,t),s=t.memoizedProps,u=t.type===t.elementType?s:mi(t.type,s),o.props=u,d=t.pendingProps,p=o.context,"object"===typeof(c=n.contextType)&&null!==c?c=Ti(c):c=Ia(t,c=Oa(n)?Pa:Ca.current);var f=n.getDerivedStateFromProps;(l="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==d||p!==c)&&zi(t,o,r,c),Pi=!1,p=t.memoizedState,o.state=p,Li(t,r,o,a);var h=t.memoizedState;s!==d||p!==h||Ra.current||Pi?("function"===typeof f&&(Ui(t,n,f,r),h=t.memoizedState),(u=Pi||Vi(t,n,u,r,p,h,c)||!1)?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,h,c),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,h,c)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=h),o.props=r,o.state=h,o.context=c,r=u):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return Rs(e,t,n,r,i,a)}function Rs(e,t,n,r,a,i){xs(e,t);var o=0!==(128&t.flags);if(!r&&!o)return a&&La(t,n,!1),Ws(e,t,i);r=t.stateNode,ks.current=t;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=Ji(t,e.child,null,i),t.child=Ji(t,null,s,i)):ws(e,t,s,i),t.memoizedState=r.state,a&&La(t,n,!0),t.child}function Ps(e){var t=e.stateNode;t.pendingContext?Ma(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ma(0,t.context,!1),ro(e,t.containerInfo)}function Is(e,t,n,r,a){return fi(),hi(a),t.flags|=256,ws(e,t,n,r),t.child}var Os,Ds,Ms,As,Ns={dehydrated:null,treeContext:null,retryLane:0};function Ls(e){return{baseLanes:e,cachePool:null,transitions:null}}function js(e,t,n){var r,a=t.pendingProps,o=so.current,s=!1,c=0!==(128&t.flags);if((r=c)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),xa(so,1&o),null===e)return ui(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(c=a.children,e=a.fallback,s?(a=t.mode,s=t.child,c={mode:"hidden",children:c},0===(1&a)&&null!==s?(s.childLanes=0,s.pendingProps=c):s=Lu(c,a,0,null),e=Nu(e,a,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ls(n),t.memoizedState=Ns,e):Fs(t,c));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,a,o,s){if(n)return 256&t.flags?(t.flags&=-257,Us(e,t,s,r=ds(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,a=t.mode,r=Lu({mode:"visible",children:r.children},a,0,null),(o=Nu(o,a,s,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&Ji(t,e.child,null,s),t.child.memoizedState=Ls(s),t.memoizedState=Ns,o);if(0===(1&t.mode))return Us(e,t,s,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var c=r.dgst;return r=c,Us(e,t,s,r=ds(o=Error(i(419)),r,void 0))}if(c=0!==(s&e.childLanes),bs||c){if(null!==(r=Pc)){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|s))?0:a)&&a!==o.retryLane&&(o.retryLane=a,Ri(e,a),ru(r,e,a,-1))}return mu(),Us(e,t,s,r=ds(Error(i(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Cu.bind(null,e),a._reactRetry=t,null):(e=o.treeContext,ri=ua(a.nextSibling),ni=t,ai=!0,ii=null,null!==e&&(qa[$a++]=Ja,qa[$a++]=Qa,qa[$a++]=Ka,Ja=e.id,Qa=e.overflow,Ka=t),t=Fs(t,r.children),t.flags|=4096,t)}(e,t,c,a,r,o,n);if(s){s=a.fallback,c=t.mode,r=(o=e.child).sibling;var u={mode:"hidden",children:a.children};return 0===(1&c)&&t.child!==o?((a=t.child).childLanes=0,a.pendingProps=u,t.deletions=null):(a=Mu(o,u)).subtreeFlags=14680064&o.subtreeFlags,null!==r?s=Mu(r,s):(s=Nu(s,c,n,null)).flags|=2,s.return=t,a.return=t,a.sibling=s,t.child=a,a=s,s=t.child,c=null===(c=e.child.memoizedState)?Ls(n):{baseLanes:c.baseLanes|n,cachePool:null,transitions:c.transitions},s.memoizedState=c,s.childLanes=e.childLanes&~n,t.memoizedState=Ns,a}return e=(s=e.child).sibling,a=Mu(s,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function Fs(e,t){return(t=Lu({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Us(e,t,n,r){return null!==r&&hi(r),Ji(t,e.child,null,n),(e=Fs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Bs(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Si(e.return,t,n)}function Vs(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Hs(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(ws(e,t,r.children,n),0!==(2&(r=so.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Bs(e,n,t);else if(19===e.tag)Bs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(xa(so,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===co(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Vs(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===co(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Vs(t,!0,n,null,i);break;case"together":Vs(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function zs(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ws(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Lc|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Mu(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Mu(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Gs(e,t){if(!ai)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function qs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function $s(e,t,n){var r=t.pendingProps;switch(ti(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qs(t),null;case 1:case 17:return Oa(t.type)&&Da(),qs(t),null;case 3:return r=t.stateNode,ao(),Ta(Ra),Ta(Ca),lo(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(di(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ii&&(su(ii),ii=null))),Ds(e,t),qs(t),null;case 5:oo(t);var a=no(to.current);if(n=t.type,null!==e&&null!=t.stateNode)Ms(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return qs(t),null}if(e=no(Yi.current),di(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[pa]=t,r[fa]=o,e=0!==(1&t.mode),n){case"dialog":Fr("cancel",r),Fr("close",r);break;case"iframe":case"object":case"embed":Fr("load",r);break;case"video":case"audio":for(a=0;a<Ar.length;a++)Fr(Ar[a],r);break;case"source":Fr("error",r);break;case"img":case"image":case"link":Fr("error",r),Fr("load",r);break;case"details":Fr("toggle",r);break;case"input":J(r,o),Fr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Fr("invalid",r);break;case"textarea":ae(r,o),Fr("invalid",r)}for(var c in ye(n,o),a=null,o)if(o.hasOwnProperty(c)){var u=o[c];"children"===c?"string"===typeof u?r.textContent!==u&&(!0!==o.suppressHydrationWarning&&Xr(r.textContent,u,e),a=["children",u]):"number"===typeof u&&r.textContent!==""+u&&(!0!==o.suppressHydrationWarning&&Xr(r.textContent,u,e),a=["children",""+u]):s.hasOwnProperty(c)&&null!=u&&"onScroll"===c&&Fr("scroll",r)}switch(n){case"input":G(r),Y(r,o,!0);break;case"textarea":G(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Yr)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{c=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=c.createElement(n,{is:r.is}):(e=c.createElement(n),"select"===n&&(c=e,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):e=c.createElementNS(e,n),e[pa]=t,e[fa]=r,Os(e,t,!1,!1),t.stateNode=e;e:{switch(c=ke(n,r),n){case"dialog":Fr("cancel",e),Fr("close",e),a=r;break;case"iframe":case"object":case"embed":Fr("load",e),a=r;break;case"video":case"audio":for(a=0;a<Ar.length;a++)Fr(Ar[a],e);a=r;break;case"source":Fr("error",e),a=r;break;case"img":case"image":case"link":Fr("error",e),Fr("load",e),a=r;break;case"details":Fr("toggle",e),a=r;break;case"input":J(e,r),a=K(e,r),Fr("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=L({},r,{value:void 0}),Fr("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),Fr("invalid",e)}for(o in ye(n,a),u=a)if(u.hasOwnProperty(o)){var l=u[o];"style"===o?me(e,l):"dangerouslySetInnerHTML"===o?null!=(l=l?l.__html:void 0)&&de(e,l):"children"===o?"string"===typeof l?("textarea"!==n||""!==l)&&pe(e,l):"number"===typeof l&&pe(e,""+l):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=l&&"onScroll"===o&&Fr("scroll",e):null!=l&&k(e,o,l,c))}switch(n){case"input":G(e),Y(e,r,!1);break;case"textarea":G(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+z(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Yr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return qs(t),null;case 6:if(e&&null!=t.stateNode)As(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=no(to.current),no(Yi.current),di(t)){if(r=t.stateNode,n=t.memoizedProps,r[pa]=t,(o=r.nodeValue!==n)&&null!==(e=ni))switch(e.tag){case 3:Xr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[pa]=t,t.stateNode=r}return qs(t),null;case 13:if(Ta(so),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ai&&null!==ri&&0!==(1&t.mode)&&0===(128&t.flags))pi(),fi(),t.flags|=98560,o=!1;else if(o=di(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(i(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(i(317));o[pa]=t}else fi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qs(t),o=!1}else null!==ii&&(su(ii),ii=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&so.current)?0===Ac&&(Ac=3):mu())),null!==t.updateQueue&&(t.flags|=4),qs(t),null);case 4:return ao(),Ds(e,t),null===e&&Vr(t.stateNode.containerInfo),qs(t),null;case 10:return _i(t.type._context),qs(t),null;case 19:if(Ta(so),null===(o=t.memoizedState))return qs(t),null;if(r=0!==(128&t.flags),null===(c=o.rendering))if(r)Gs(o,!1);else{if(0!==Ac||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(c=co(e))){for(t.flags|=128,Gs(o,!1),null!==(r=c.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(c=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=c.childLanes,o.lanes=c.lanes,o.child=c.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=c.memoizedProps,o.memoizedState=c.memoizedState,o.updateQueue=c.updateQueue,o.type=c.type,e=c.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return xa(so,1&so.current|2),t.child}e=e.sibling}null!==o.tail&&Qe()>Hc&&(t.flags|=128,r=!0,Gs(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=co(c))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Gs(o,!0),null===o.tail&&"hidden"===o.tailMode&&!c.alternate&&!ai)return qs(t),null}else 2*Qe()-o.renderingStartTime>Hc&&1073741824!==n&&(t.flags|=128,r=!0,Gs(o,!1),t.lanes=4194304);o.isBackwards?(c.sibling=t.child,t.child=c):(null!==(n=o.last)?n.sibling=c:t.child=c,o.last=c)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Qe(),t.sibling=null,n=so.current,xa(so,r?1&n|2:1&n),t):(qs(t),null);case 22:case 23:return pu(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Dc)&&(qs(t),6&t.subtreeFlags&&(t.flags|=8192)):qs(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Ks(e,t){switch(ti(t),t.tag){case 1:return Oa(t.type)&&Da(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ao(),Ta(Ra),Ta(Ca),lo(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return oo(t),null;case 13:if(Ta(so),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));fi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ta(so),null;case 4:return ao(),null;case 10:return _i(t.type._context),null;case 22:case 23:return pu(),null;default:return null}}Os=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ds=function(){},Ms=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,no(Yi.current);var i,o=null;switch(n){case"input":a=K(e,a),r=K(e,r),o=[];break;case"select":a=L({},a,{value:void 0}),r=L({},r,{value:void 0}),o=[];break;case"textarea":a=re(e,a),r=re(e,r),o=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=Yr)}for(l in ye(n,r),n=null,a)if(!r.hasOwnProperty(l)&&a.hasOwnProperty(l)&&null!=a[l])if("style"===l){var c=a[l];for(i in c)c.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(s.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var u=r[l];if(c=null!=a?a[l]:void 0,r.hasOwnProperty(l)&&u!==c&&(null!=u||null!=c))if("style"===l)if(c){for(i in c)!c.hasOwnProperty(i)||u&&u.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in u)u.hasOwnProperty(i)&&c[i]!==u[i]&&(n||(n={}),n[i]=u[i])}else n||(o||(o=[]),o.push(l,n)),n=u;else"dangerouslySetInnerHTML"===l?(u=u?u.__html:void 0,c=c?c.__html:void 0,null!=u&&c!==u&&(o=o||[]).push(l,u)):"children"===l?"string"!==typeof u&&"number"!==typeof u||(o=o||[]).push(l,""+u):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(s.hasOwnProperty(l)?(null!=u&&"onScroll"===l&&Fr("scroll",e),o||c===u||(o=[])):(o=o||[]).push(l,u))}n&&(o=o||[]).push("style",n);var l=o;(t.updateQueue=l)&&(t.flags|=4)}},As=function(e,t,n,r){n!==r&&(t.flags|=4)};var Js=!1,Qs=!1,Xs="function"===typeof WeakSet?WeakSet:Set,Ys=null;function ec(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Tu(e,t,r)}else n.current=null}function tc(e,t,n){try{n()}catch(r){Tu(e,t,r)}}var nc=!1;function rc(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,void 0!==i&&tc(t,n,i)}a=a.next}while(a!==r)}}function ac(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ic(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function oc(e){var t=e.alternate;null!==t&&(e.alternate=null,oc(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[pa],delete t[fa],delete t[va],delete t[ma],delete t[ga])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function sc(e){return 5===e.tag||3===e.tag||4===e.tag}function cc(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||sc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function uc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Yr));else if(4!==r&&null!==(e=e.child))for(uc(e,t,n),e=e.sibling;null!==e;)uc(e,t,n),e=e.sibling}function lc(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(lc(e,t,n),e=e.sibling;null!==e;)lc(e,t,n),e=e.sibling}var dc=null,pc=!1;function fc(e,t,n){for(n=n.child;null!==n;)hc(e,t,n),n=n.sibling}function hc(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(at,n)}catch(s){}switch(n.tag){case 5:Qs||ec(n,t);case 6:var r=dc,a=pc;dc=null,fc(e,t,n),pc=a,null!==(dc=r)&&(pc?(e=dc,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dc.removeChild(n.stateNode));break;case 18:null!==dc&&(pc?(e=dc,n=n.stateNode,8===e.nodeType?ca(e.parentNode,n):1===e.nodeType&&ca(e,n),Vt(e)):ca(dc,n.stateNode));break;case 4:r=dc,a=pc,dc=n.stateNode.containerInfo,pc=!0,fc(e,t,n),dc=r,pc=a;break;case 0:case 11:case 14:case 15:if(!Qs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var i=a,o=i.destroy;i=i.tag,void 0!==o&&(0!==(2&i)||0!==(4&i))&&tc(n,t,o),a=a.next}while(a!==r)}fc(e,t,n);break;case 1:if(!Qs&&(ec(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Tu(n,t,s)}fc(e,t,n);break;case 21:fc(e,t,n);break;case 22:1&n.mode?(Qs=(r=Qs)||null!==n.memoizedState,fc(e,t,n),Qs=r):fc(e,t,n);break;default:fc(e,t,n)}}function vc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Xs),t.forEach((function(t){var r=Ru.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function mc(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var o=e,s=t,c=s;e:for(;null!==c;){switch(c.tag){case 5:dc=c.stateNode,pc=!1;break e;case 3:case 4:dc=c.stateNode.containerInfo,pc=!0;break e}c=c.return}if(null===dc)throw Error(i(160));hc(o,s,a),dc=null,pc=!1;var u=a.alternate;null!==u&&(u.return=null),a.return=null}catch(l){Tu(a,t,l)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gc(t,e),t=t.sibling}function gc(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(mc(t,e),yc(e),4&r){try{rc(3,e,e.return),ac(3,e)}catch(m){Tu(e,e.return,m)}try{rc(5,e,e.return)}catch(m){Tu(e,e.return,m)}}break;case 1:mc(t,e),yc(e),512&r&&null!==n&&ec(n,n.return);break;case 5:if(mc(t,e),yc(e),512&r&&null!==n&&ec(n,n.return),32&e.flags){var a=e.stateNode;try{pe(a,"")}catch(m){Tu(e,e.return,m)}}if(4&r&&null!=(a=e.stateNode)){var o=e.memoizedProps,s=null!==n?n.memoizedProps:o,c=e.type,u=e.updateQueue;if(e.updateQueue=null,null!==u)try{"input"===c&&"radio"===o.type&&null!=o.name&&Q(a,o),ke(c,s);var l=ke(c,o);for(s=0;s<u.length;s+=2){var d=u[s],p=u[s+1];"style"===d?me(a,p):"dangerouslySetInnerHTML"===d?de(a,p):"children"===d?pe(a,p):k(a,d,p,l)}switch(c){case"input":X(a,o);break;case"textarea":ie(a,o);break;case"select":var f=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var h=o.value;null!=h?ne(a,!!o.multiple,h,!1):f!==!!o.multiple&&(null!=o.defaultValue?ne(a,!!o.multiple,o.defaultValue,!0):ne(a,!!o.multiple,o.multiple?[]:"",!1))}a[fa]=o}catch(m){Tu(e,e.return,m)}}break;case 6:if(mc(t,e),yc(e),4&r){if(null===e.stateNode)throw Error(i(162));a=e.stateNode,o=e.memoizedProps;try{a.nodeValue=o}catch(m){Tu(e,e.return,m)}}break;case 3:if(mc(t,e),yc(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(m){Tu(e,e.return,m)}break;case 4:default:mc(t,e),yc(e);break;case 13:mc(t,e),yc(e),8192&(a=e.child).flags&&(o=null!==a.memoizedState,a.stateNode.isHidden=o,!o||null!==a.alternate&&null!==a.alternate.memoizedState||(Vc=Qe())),4&r&&vc(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Qs=(l=Qs)||d,mc(t,e),Qs=l):mc(t,e),yc(e),8192&r){if(l=null!==e.memoizedState,(e.stateNode.isHidden=l)&&!d&&0!==(1&e.mode))for(Ys=e,d=e.child;null!==d;){for(p=Ys=d;null!==Ys;){switch(h=(f=Ys).child,f.tag){case 0:case 11:case 14:case 15:rc(4,f,f.return);break;case 1:ec(f,f.return);var v=f.stateNode;if("function"===typeof v.componentWillUnmount){r=f,n=f.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(m){Tu(r,n,m)}}break;case 5:ec(f,f.return);break;case 22:if(null!==f.memoizedState){_c(p);continue}}null!==h?(h.return=f,Ys=h):_c(p)}d=d.sibling}e:for(d=null,p=e;;){if(5===p.tag){if(null===d){d=p;try{a=p.stateNode,l?"function"===typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none":(c=p.stateNode,s=void 0!==(u=p.memoizedProps.style)&&null!==u&&u.hasOwnProperty("display")?u.display:null,c.style.display=ve("display",s))}catch(m){Tu(e,e.return,m)}}}else if(6===p.tag){if(null===d)try{p.stateNode.nodeValue=l?"":p.memoizedProps}catch(m){Tu(e,e.return,m)}}else if((22!==p.tag&&23!==p.tag||null===p.memoizedState||p===e)&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;null===p.sibling;){if(null===p.return||p.return===e)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:mc(t,e),yc(e),4&r&&vc(e);case 21:}}function yc(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(sc(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(pe(a,""),r.flags&=-33),lc(e,cc(e),a);break;case 3:case 4:var o=r.stateNode.containerInfo;uc(e,cc(e),o);break;default:throw Error(i(161))}}catch(s){Tu(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function kc(e,t,n){Ys=e,bc(e,t,n)}function bc(e,t,n){for(var r=0!==(1&e.mode);null!==Ys;){var a=Ys,i=a.child;if(22===a.tag&&r){var o=null!==a.memoizedState||Js;if(!o){var s=a.alternate,c=null!==s&&null!==s.memoizedState||Qs;s=Js;var u=Qs;if(Js=o,(Qs=c)&&!u)for(Ys=a;null!==Ys;)c=(o=Ys).child,22===o.tag&&null!==o.memoizedState?Sc(a):null!==c?(c.return=o,Ys=c):Sc(a);for(;null!==i;)Ys=i,bc(i,t,n),i=i.sibling;Ys=a,Js=s,Qs=u}wc(e)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,Ys=i):wc(e)}}function wc(e){for(;null!==Ys;){var t=Ys;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Qs||ac(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Qs)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:mi(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&ji(t,o,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}ji(t,s,n)}break;case 5:var c=t.stateNode;if(null===n&&4&t.flags){n=c;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var l=t.alternate;if(null!==l){var d=l.memoizedState;if(null!==d){var p=d.dehydrated;null!==p&&Vt(p)}}}break;default:throw Error(i(163))}Qs||512&t.flags&&ic(t)}catch(f){Tu(t,t.return,f)}}if(t===e){Ys=null;break}if(null!==(n=t.sibling)){n.return=t.return,Ys=n;break}Ys=t.return}}function _c(e){for(;null!==Ys;){var t=Ys;if(t===e){Ys=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Ys=n;break}Ys=t.return}}function Sc(e){for(;null!==Ys;){var t=Ys;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ac(4,t)}catch(c){Tu(t,n,c)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(c){Tu(t,a,c)}}var i=t.return;try{ic(t)}catch(c){Tu(t,i,c)}break;case 5:var o=t.return;try{ic(t)}catch(c){Tu(t,o,c)}}}catch(c){Tu(t,t.return,c)}if(t===e){Ys=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Ys=s;break}Ys=t.return}}var Ec,Tc=Math.ceil,xc=b.ReactCurrentDispatcher,Zc=b.ReactCurrentOwner,Cc=b.ReactCurrentBatchConfig,Rc=0,Pc=null,Ic=null,Oc=0,Dc=0,Mc=Ea(0),Ac=0,Nc=null,Lc=0,jc=0,Fc=0,Uc=null,Bc=null,Vc=0,Hc=1/0,zc=null,Wc=!1,Gc=null,qc=null,$c=!1,Kc=null,Jc=0,Qc=0,Xc=null,Yc=-1,eu=0;function tu(){return 0!==(6&Rc)?Qe():-1!==Yc?Yc:Yc=Qe()}function nu(e){return 0===(1&e.mode)?1:0!==(2&Rc)&&0!==Oc?Oc&-Oc:null!==vi.transition?(0===eu&&(eu=vt()),eu):0!==(e=kt)?e:e=void 0===(e=window.event)?16:Jt(e.type)}function ru(e,t,n,r){if(50<Qc)throw Qc=0,Xc=null,Error(i(185));gt(e,n,r),0!==(2&Rc)&&e===Pc||(e===Pc&&(0===(2&Rc)&&(jc|=n),4===Ac&&cu(e,Oc)),au(e,r),1===n&&0===Rc&&0===(1&t.mode)&&(Hc=Qe()+500,Fa&&Va()))}function au(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-ot(i),s=1<<o,c=a[o];-1===c?0!==(s&n)&&0===(s&r)||(a[o]=ft(s,t)):c<=t&&(e.expiredLanes|=s),i&=~s}}(e,t);var r=pt(e,e===Pc?Oc:0);if(0===r)null!==n&&$e(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&$e(n),1===t)0===e.tag?function(e){Fa=!0,Ba(e)}(uu.bind(null,e)):Ba(uu.bind(null,e)),oa((function(){0===(6&Rc)&&Va()})),n=null;else{switch(bt(r)){case 1:n=Ye;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Pu(n,iu.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function iu(e,t){if(Yc=-1,eu=0,0!==(6&Rc))throw Error(i(327));var n=e.callbackNode;if(Su()&&e.callbackNode!==n)return null;var r=pt(e,e===Pc?Oc:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gu(e,r);else{t=r;var a=Rc;Rc|=2;var o=vu();for(Pc===e&&Oc===t||(zc=null,Hc=Qe()+500,fu(e,t));;)try{ku();break}catch(c){hu(e,c)}wi(),xc.current=o,Rc=a,null!==Ic?t=0:(Pc=null,Oc=0,t=Ac)}if(0!==t){if(2===t&&(0!==(a=ht(e))&&(r=a,t=ou(e,a))),1===t)throw n=Nc,fu(e,0),cu(e,r),au(e,Qe()),n;if(6===t)cu(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!sr(i(),a))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=gu(e,r))&&(0!==(o=ht(e))&&(r=o,t=ou(e,o))),1===t))throw n=Nc,fu(e,0),cu(e,r),au(e,Qe()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:_u(e,Bc,zc);break;case 3:if(cu(e,r),(130023424&r)===r&&10<(t=Vc+500-Qe())){if(0!==pt(e,0))break;if(((a=e.suspendedLanes)&r)!==r){tu(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(_u.bind(null,e,Bc,zc),t);break}_u(e,Bc,zc);break;case 4:if(cu(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var s=31-ot(r);o=1<<s,(s=t[s])>a&&(a=s),r&=~o}if(r=a,10<(r=(120>(r=Qe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Tc(r/1960))-r)){e.timeoutHandle=ra(_u.bind(null,e,Bc,zc),r);break}_u(e,Bc,zc);break;default:throw Error(i(329))}}}return au(e,Qe()),e.callbackNode===n?iu.bind(null,e):null}function ou(e,t){var n=Uc;return e.current.memoizedState.isDehydrated&&(fu(e,t).flags|=256),2!==(e=gu(e,t))&&(t=Bc,Bc=n,null!==t&&su(t)),e}function su(e){null===Bc?Bc=e:Bc.push.apply(Bc,e)}function cu(e,t){for(t&=~Fc,t&=~jc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function uu(e){if(0!==(6&Rc))throw Error(i(327));Su();var t=pt(e,0);if(0===(1&t))return au(e,Qe()),null;var n=gu(e,t);if(0!==e.tag&&2===n){var r=ht(e);0!==r&&(t=r,n=ou(e,r))}if(1===n)throw n=Nc,fu(e,0),cu(e,t),au(e,Qe()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,_u(e,Bc,zc),au(e,Qe()),null}function lu(e,t){var n=Rc;Rc|=1;try{return e(t)}finally{0===(Rc=n)&&(Hc=Qe()+500,Fa&&Va())}}function du(e){null!==Kc&&0===Kc.tag&&0===(6&Rc)&&Su();var t=Rc;Rc|=1;var n=Cc.transition,r=kt;try{if(Cc.transition=null,kt=1,e)return e()}finally{kt=r,Cc.transition=n,0===(6&(Rc=t))&&Va()}}function pu(){Dc=Mc.current,Ta(Mc)}function fu(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==Ic)for(n=Ic.return;null!==n;){var r=n;switch(ti(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Da();break;case 3:ao(),Ta(Ra),Ta(Ca),lo();break;case 5:oo(r);break;case 4:ao();break;case 13:case 19:Ta(so);break;case 10:_i(r.type._context);break;case 22:case 23:pu()}n=n.return}if(Pc=e,Ic=e=Mu(e.current,null),Oc=Dc=t,Ac=0,Nc=null,Fc=jc=Lc=0,Bc=Uc=null,null!==xi){for(t=0;t<xi.length;t++)if(null!==(r=(n=xi[t]).interleaved)){n.interleaved=null;var a=r.next,i=n.pending;if(null!==i){var o=i.next;i.next=a,r.next=o}n.pending=r}xi=null}return e}function hu(e,t){for(;;){var n=Ic;try{if(wi(),po.current=os,yo){for(var r=vo.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}yo=!1}if(ho=0,go=mo=vo=null,ko=!1,bo=0,Zc.current=null,null===n||null===n.return){Ac=1,Nc=t,Ic=null;break}e:{var o=e,s=n.return,c=n,u=t;if(t=Oc,c.flags|=32768,null!==u&&"object"===typeof u&&"function"===typeof u.then){var l=u,d=c,p=d.tag;if(0===(1&d.mode)&&(0===p||11===p||15===p)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=gs(s);if(null!==h){h.flags&=-257,ys(h,s,c,0,t),1&h.mode&&ms(o,l,t),u=l;var v=(t=h).updateQueue;if(null===v){var m=new Set;m.add(u),t.updateQueue=m}else v.add(u);break e}if(0===(1&t)){ms(o,l,t),mu();break e}u=Error(i(426))}else if(ai&&1&c.mode){var g=gs(s);if(null!==g){0===(65536&g.flags)&&(g.flags|=256),ys(g,s,c,0,t),hi(ls(u,c));break e}}o=u=ls(u,c),4!==Ac&&(Ac=2),null===Uc?Uc=[o]:Uc.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Ni(o,hs(0,u,t));break e;case 1:c=u;var y=o.type,k=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==k&&"function"===typeof k.componentDidCatch&&(null===qc||!qc.has(k)))){o.flags|=65536,t&=-t,o.lanes|=t,Ni(o,vs(o,c,t));break e}}o=o.return}while(null!==o)}wu(n)}catch(b){t=b,Ic===n&&null!==n&&(Ic=n=n.return);continue}break}}function vu(){var e=xc.current;return xc.current=os,null===e?os:e}function mu(){0!==Ac&&3!==Ac&&2!==Ac||(Ac=4),null===Pc||0===(268435455&Lc)&&0===(268435455&jc)||cu(Pc,Oc)}function gu(e,t){var n=Rc;Rc|=2;var r=vu();for(Pc===e&&Oc===t||(zc=null,fu(e,t));;)try{yu();break}catch(a){hu(e,a)}if(wi(),Rc=n,xc.current=r,null!==Ic)throw Error(i(261));return Pc=null,Oc=0,Ac}function yu(){for(;null!==Ic;)bu(Ic)}function ku(){for(;null!==Ic&&!Ke();)bu(Ic)}function bu(e){var t=Ec(e.alternate,e,Dc);e.memoizedProps=e.pendingProps,null===t?wu(e):Ic=t,Zc.current=null}function wu(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=$s(n,t,Dc)))return void(Ic=n)}else{if(null!==(n=Ks(n,t)))return n.flags&=32767,void(Ic=n);if(null===e)return Ac=6,void(Ic=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ic=t);Ic=t=e}while(null!==t);0===Ac&&(Ac=5)}function _u(e,t,n){var r=kt,a=Cc.transition;try{Cc.transition=null,kt=1,function(e,t,n,r){do{Su()}while(null!==Kc);if(0!==(6&Rc))throw Error(i(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-ot(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}(e,o),e===Pc&&(Ic=Pc=null,Oc=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||$c||($c=!0,Pu(tt,(function(){return Su(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Cc.transition,Cc.transition=null;var s=kt;kt=1;var c=Rc;Rc|=4,Zc.current=null,function(e,t){if(ea=zt,fr(e=pr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(w){n=null;break e}var s=0,c=-1,u=-1,l=0,d=0,p=e,f=null;t:for(;;){for(var h;p!==n||0!==a&&3!==p.nodeType||(c=s+a),p!==o||0!==r&&3!==p.nodeType||(u=s+r),3===p.nodeType&&(s+=p.nodeValue.length),null!==(h=p.firstChild);)f=p,p=h;for(;;){if(p===e)break t;if(f===n&&++l===a&&(c=s),f===o&&++d===r&&(u=s),null!==(h=p.nextSibling))break;f=(p=f).parentNode}p=h}n=-1===c||-1===u?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},zt=!1,Ys=t;null!==Ys;)if(e=(t=Ys).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ys=e;else for(;null!==Ys;){t=Ys;try{var v=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==v){var m=v.memoizedProps,g=v.memoizedState,y=t.stateNode,k=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:mi(t.type,m),g);y.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(i(163))}}catch(w){Tu(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Ys=e;break}Ys=t.return}v=nc,nc=!1}(e,n),gc(n,e),hr(ta),zt=!!ea,ta=ea=null,e.current=n,kc(n,e,a),Je(),Rc=c,kt=s,Cc.transition=o}else e.current=n;if($c&&($c=!1,Kc=e,Jc=a),o=e.pendingLanes,0===o&&(qc=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),au(e,Qe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Wc)throw Wc=!1,e=Gc,Gc=null,e;0!==(1&Jc)&&0!==e.tag&&Su(),o=e.pendingLanes,0!==(1&o)?e===Xc?Qc++:(Qc=0,Xc=e):Qc=0,Va()}(e,t,n,r)}finally{Cc.transition=a,kt=r}return null}function Su(){if(null!==Kc){var e=bt(Jc),t=Cc.transition,n=kt;try{if(Cc.transition=null,kt=16>e?16:e,null===Kc)var r=!1;else{if(e=Kc,Kc=null,Jc=0,0!==(6&Rc))throw Error(i(331));var a=Rc;for(Rc|=4,Ys=e.current;null!==Ys;){var o=Ys,s=o.child;if(0!==(16&Ys.flags)){var c=o.deletions;if(null!==c){for(var u=0;u<c.length;u++){var l=c[u];for(Ys=l;null!==Ys;){var d=Ys;switch(d.tag){case 0:case 11:case 15:rc(8,d,o)}var p=d.child;if(null!==p)p.return=d,Ys=p;else for(;null!==Ys;){var f=(d=Ys).sibling,h=d.return;if(oc(d),d===l){Ys=null;break}if(null!==f){f.return=h,Ys=f;break}Ys=h}}}var v=o.alternate;if(null!==v){var m=v.child;if(null!==m){v.child=null;do{var g=m.sibling;m.sibling=null,m=g}while(null!==m)}}Ys=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,Ys=s;else e:for(;null!==Ys;){if(0!==(2048&(o=Ys).flags))switch(o.tag){case 0:case 11:case 15:rc(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,Ys=y;break e}Ys=o.return}}var k=e.current;for(Ys=k;null!==Ys;){var b=(s=Ys).child;if(0!==(2064&s.subtreeFlags)&&null!==b)b.return=s,Ys=b;else e:for(s=k;null!==Ys;){if(0!==(2048&(c=Ys).flags))try{switch(c.tag){case 0:case 11:case 15:ac(9,c)}}catch(_){Tu(c,c.return,_)}if(c===s){Ys=null;break e}var w=c.sibling;if(null!==w){w.return=c.return,Ys=w;break e}Ys=c.return}}if(Rc=a,Va(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(at,e)}catch(_){}r=!0}return r}finally{kt=n,Cc.transition=t}}return!1}function Eu(e,t,n){e=Mi(e,t=hs(0,t=ls(n,t),1),1),t=tu(),null!==e&&(gt(e,1,t),au(e,t))}function Tu(e,t,n){if(3===e.tag)Eu(e,e,n);else for(;null!==t;){if(3===t.tag){Eu(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===qc||!qc.has(r))){t=Mi(t,e=vs(t,e=ls(n,e),1),1),e=tu(),null!==t&&(gt(t,1,e),au(t,e));break}}t=t.return}}function xu(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=tu(),e.pingedLanes|=e.suspendedLanes&n,Pc===e&&(Oc&n)===n&&(4===Ac||3===Ac&&(130023424&Oc)===Oc&&500>Qe()-Vc?fu(e,0):Fc|=n),au(e,t)}function Zu(e,t){0===t&&(0===(1&e.mode)?t=1:(t=lt,0===(130023424&(lt<<=1))&&(lt=4194304)));var n=tu();null!==(e=Ri(e,t))&&(gt(e,t,n),au(e,n))}function Cu(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Zu(e,n)}function Ru(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),Zu(e,n)}function Pu(e,t){return qe(e,t)}function Iu(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ou(e,t,n,r){return new Iu(e,t,n,r)}function Du(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Mu(e,t){var n=e.alternate;return null===n?((n=Ou(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Au(e,t,n,r,a,o){var s=2;if(r=e,"function"===typeof e)Du(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case S:return Nu(n.children,a,o,t);case E:s=8,a|=8;break;case T:return(e=Ou(12,n,t,2|a)).elementType=T,e.lanes=o,e;case R:return(e=Ou(13,n,t,a)).elementType=R,e.lanes=o,e;case P:return(e=Ou(19,n,t,a)).elementType=P,e.lanes=o,e;case D:return Lu(n,a,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case x:s=10;break e;case Z:s=9;break e;case C:s=11;break e;case I:s=14;break e;case O:s=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Ou(s,n,t,a)).elementType=e,t.type=r,t.lanes=o,t}function Nu(e,t,n,r){return(e=Ou(7,e,r,t)).lanes=n,e}function Lu(e,t,n,r){return(e=Ou(22,e,r,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function ju(e,t,n){return(e=Ou(6,e,null,t)).lanes=n,e}function Fu(e,t,n){return(t=Ou(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uu(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Bu(e,t,n,r,a,i,o,s,c){return e=new Uu(e,t,n,s,c),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Ou(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ii(i),e}function Vu(e){if(!e)return Za;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Oa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Oa(n))return Aa(e,n,t)}return t}function Hu(e,t,n,r,a,i,o,s,c){return(e=Bu(n,r,!0,e,0,i,0,s,c)).context=Vu(null),n=e.current,(i=Di(r=tu(),a=nu(n))).callback=void 0!==t&&null!==t?t:null,Mi(n,i,a),e.current.lanes=a,gt(e,a,r),au(e,r),e}function zu(e,t,n,r){var a=t.current,i=tu(),o=nu(a);return n=Vu(n),null===t.context?t.context=n:t.pendingContext=n,(t=Di(i,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Mi(a,t,o))&&(ru(e,a,o,i),Ai(e,a,o)),o}function Wu(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gu(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function qu(e,t){Gu(e,t),(e=e.alternate)&&Gu(e,t)}Ec=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ra.current)bs=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bs=!1,function(e,t,n){switch(t.tag){case 3:Ps(t),fi();break;case 5:io(t);break;case 1:Oa(t.type)&&Na(t);break;case 4:ro(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;xa(gi,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(xa(so,1&so.current),t.flags|=128,null):0!==(n&t.child.childLanes)?js(e,t,n):(xa(so,1&so.current),null!==(e=Ws(e,t,n))?e.sibling:null);xa(so,1&so.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Hs(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),xa(so,so.current),r)break;return null;case 22:case 23:return t.lanes=0,Ts(e,t,n)}return Ws(e,t,n)}(e,t,n);bs=0!==(131072&e.flags)}else bs=!1,ai&&0!==(1048576&t.flags)&&Ya(t,Ga,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;zs(e,t),e=t.pendingProps;var a=Ia(t,Ca.current);Ei(t,n),a=Eo(null,t,r,e,a,n);var o=To();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Oa(r)?(o=!0,Na(t)):o=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Ii(t),a.updater=Bi,t.stateNode=a,a._reactInternals=t,Wi(t,r,e,n),t=Rs(null,t,r,!0,o,n)):(t.tag=0,ai&&o&&ei(t),ws(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(zs(e,t),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return Du(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===I)return 14}return 2}(r),e=mi(r,e),a){case 0:t=Zs(null,t,r,e,n);break e;case 1:t=Cs(null,t,r,e,n);break e;case 11:t=_s(null,t,r,e,n);break e;case 14:t=Ss(null,t,r,mi(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,Zs(e,t,r,a=t.elementType===r?a:mi(r,a),n);case 1:return r=t.type,a=t.pendingProps,Cs(e,t,r,a=t.elementType===r?a:mi(r,a),n);case 3:e:{if(Ps(t),null===e)throw Error(i(387));r=t.pendingProps,a=(o=t.memoizedState).element,Oi(e,t),Li(t,r,null,n);var s=t.memoizedState;if(r=s.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Is(e,t,r,n,a=ls(Error(i(423)),t));break e}if(r!==a){t=Is(e,t,r,n,a=ls(Error(i(424)),t));break e}for(ri=ua(t.stateNode.containerInfo.firstChild),ni=t,ai=!0,ii=null,n=Qi(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fi(),r===a){t=Ws(e,t,n);break e}ws(e,t,r,n)}t=t.child}return t;case 5:return io(t),null===e&&ui(t),r=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,s=a.children,na(r,a)?s=null:null!==o&&na(r,o)&&(t.flags|=32),xs(e,t),ws(e,t,s,n),t.child;case 6:return null===e&&ui(t),null;case 13:return js(e,t,n);case 4:return ro(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Ji(t,null,r,n):ws(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,_s(e,t,r,a=t.elementType===r?a:mi(r,a),n);case 7:return ws(e,t,t.pendingProps,n),t.child;case 8:case 12:return ws(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,o=t.memoizedProps,s=a.value,xa(gi,r._currentValue),r._currentValue=s,null!==o)if(sr(o.value,s)){if(o.children===a.children&&!Ra.current){t=Ws(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var c=o.dependencies;if(null!==c){s=o.child;for(var u=c.firstContext;null!==u;){if(u.context===r){if(1===o.tag){(u=Di(-1,n&-n)).tag=2;var l=o.updateQueue;if(null!==l){var d=(l=l.shared).pending;null===d?u.next=u:(u.next=d.next,d.next=u),l.pending=u}}o.lanes|=n,null!==(u=o.alternate)&&(u.lanes|=n),Si(o.return,n,t),c.lanes|=n;break}u=u.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(i(341));s.lanes|=n,null!==(c=s.alternate)&&(c.lanes|=n),Si(s,n,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}ws(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Ei(t,n),r=r(a=Ti(a)),t.flags|=1,ws(e,t,r,n),t.child;case 14:return a=mi(r=t.type,t.pendingProps),Ss(e,t,r,a=mi(r.type,a),n);case 15:return Es(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:mi(r,a),zs(e,t),t.tag=1,Oa(r)?(e=!0,Na(t)):e=!1,Ei(t,n),Hi(t,r,a),Wi(t,r,a,n),Rs(null,t,r,!0,e,n);case 19:return Hs(e,t,n);case 22:return Ts(e,t,n)}throw Error(i(156,t.tag))};var $u="function"===typeof reportError?reportError:function(e){console.error(e)};function Ku(e){this._internalRoot=e}function Ju(e){this._internalRoot=e}function Qu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Xu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Yu(){}function el(e,t,n,r,a){var i=n._reactRootContainer;if(i){var o=i;if("function"===typeof a){var s=a;a=function(){var e=Wu(o);s.call(e)}}zu(t,o,e,a)}else o=function(e,t,n,r,a){if(a){if("function"===typeof r){var i=r;r=function(){var e=Wu(o);i.call(e)}}var o=Hu(t,r,e,0,null,!1,0,"",Yu);return e._reactRootContainer=o,e[ha]=o.current,Vr(8===e.nodeType?e.parentNode:e),du(),o}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var s=r;r=function(){var e=Wu(c);s.call(e)}}var c=Bu(e,0,!1,null,0,!1,0,"",Yu);return e._reactRootContainer=c,e[ha]=c.current,Vr(8===e.nodeType?e.parentNode:e),du((function(){zu(t,c,n,r)})),c}(n,t,e,a,r);return Wu(o)}Ju.prototype.render=Ku.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));zu(e,t,null,null)},Ju.prototype.unmount=Ku.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;du((function(){zu(null,e,null,null)})),t[ha]=null}},Ju.prototype.unstable_scheduleHydration=function(e){if(e){var t=Et();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Lt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(yt(t,1|n),au(t,Qe()),0===(6&Rc)&&(Hc=Qe()+500,Va()))}break;case 13:du((function(){var t=Ri(e,1);if(null!==t){var n=tu();ru(t,e,1,n)}})),qu(e,1)}},_t=function(e){if(13===e.tag){var t=Ri(e,134217728);if(null!==t)ru(t,e,134217728,tu());qu(e,134217728)}},St=function(e){if(13===e.tag){var t=nu(e),n=Ri(e,t);if(null!==n)ru(n,e,t,tu());qu(e,t)}},Et=function(){return kt},Tt=function(e,t){var n=kt;try{return kt=e,t()}finally{kt=n}},_e=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=wa(r);if(!a)throw Error(i(90));q(r),X(r,a)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ce=lu,Re=du;var tl={usingClientEntryPoint:!1,Events:[ka,ba,wa,xe,Ze,lu]},nl={findFiberByHostInstance:ya,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rl={bundleType:nl.bundleType,version:nl.version,rendererPackageName:nl.rendererPackageName,rendererConfig:nl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:nl.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var al=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!al.isDisabled&&al.supportsFiber)try{at=al.inject(rl),it=al}catch(le){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Qu(t))throw Error(i(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:_,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Qu(e))throw Error(i(299));var n=!1,r="",a=$u;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=Bu(e,1,!1,null,0,n,0,r,a),e[ha]=t.current,Vr(8===e.nodeType?e.parentNode:e),new Ku(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return du(e)},t.hydrate=function(e,t,n){if(!Xu(t))throw Error(i(200));return el(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Qu(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,a=!1,o="",s=$u;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=Hu(t,null,e,1,null!=n?n:null,a,0,o,s),e[ha]=t.current,Vr(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Ju(t)},t.render=function(e,t,n){if(!Xu(t))throw Error(i(200));return el(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Xu(e))throw Error(i(40));return!!e._reactRootContainer&&(du((function(){el(null,null,e,!1,(function(){e._reactRootContainer=null,e[ha]=null}))})),!0)},t.unstable_batchedUpdates=lu,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Xu(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return el(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},1250:function(e,t,n){"use strict";var r=n(4164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},4164:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4463)},6374:function(e,t,n){"use strict";var r=n(2791),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,n){var r,i={},u=null,l=null;for(r in void 0!==n&&(u=""+n),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(l=t.ref),t)o.call(t,r)&&!c.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:a,type:e,key:u,ref:l,props:i,_owner:s.current}}t.Fragment=i,t.jsx=u,t.jsxs=u},9117:function(e,t){"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),f=Symbol.iterator;var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,m={};function g(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||h}function y(){}function k(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||h}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=g.prototype;var b=k.prototype=new y;b.constructor=k,v(b,g.prototype),b.isPureReactComponent=!0;var w=Array.isArray,_=Object.prototype.hasOwnProperty,S={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function T(e,t,r){var a,i={},o=null,s=null;if(null!=t)for(a in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)_.call(t,a)&&!E.hasOwnProperty(a)&&(i[a]=t[a]);var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){for(var u=Array(c),l=0;l<c;l++)u[l]=arguments[l+2];i.children=u}if(e&&e.defaultProps)for(a in c=e.defaultProps)void 0===i[a]&&(i[a]=c[a]);return{$$typeof:n,type:e,key:o,ref:s,props:i,_owner:S.current}}function x(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var Z=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function R(e,t,a,i,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var c=!1;if(null===e)c=!0;else switch(s){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case n:case r:c=!0}}if(c)return o=o(c=e),e=""===i?"."+C(c,0):i,w(o)?(a="",null!=e&&(a=e.replace(Z,"$&/")+"/"),R(o,t,a,"",(function(e){return e}))):null!=o&&(x(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,a+(!o.key||c&&c.key===o.key?"":(""+o.key).replace(Z,"$&/")+"/")+e)),t.push(o)),1;if(c=0,i=""===i?".":i+":",w(e))for(var u=0;u<e.length;u++){var l=i+C(s=e[u],u);c+=R(s,t,a,l,o)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),u=0;!(s=e.next()).done;)c+=R(s=s.value,t,a,l=i+C(s,u++),o);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return c}function P(e,t,n){if(null==e)return e;var r=[],a=0;return R(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function I(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var O={current:null},D={transition:null},M={ReactCurrentDispatcher:O,ReactCurrentBatchConfig:D,ReactCurrentOwner:S};t.Children={map:P,forEach:function(e,t,n){P(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return P(e,(function(){t++})),t},toArray:function(e){return P(e,(function(e){return e}))||[]},only:function(e){if(!x(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=g,t.Fragment=a,t.Profiler=o,t.PureComponent=k,t.StrictMode=i,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=v({},e.props),i=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=S.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(u in t)_.call(t,u)&&!E.hasOwnProperty(u)&&(a[u]=void 0===t[u]&&void 0!==c?c[u]:t[u])}var u=arguments.length-2;if(1===u)a.children=r;else if(1<u){c=Array(u);for(var l=0;l<u;l++)c[l]=arguments[l+2];a.children=c}return{$$typeof:n,type:e.type,key:i,ref:o,props:a,_owner:s}},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=T,t.createFactory=function(e){var t=T.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:u,render:e}},t.isValidElement=x,t.lazy=function(e){return{$$typeof:p,_payload:{_status:-1,_result:e},_init:I}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return O.current.useCallback(e,t)},t.useContext=function(e){return O.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return O.current.useDeferredValue(e)},t.useEffect=function(e,t){return O.current.useEffect(e,t)},t.useId=function(){return O.current.useId()},t.useImperativeHandle=function(e,t,n){return O.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return O.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return O.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return O.current.useMemo(e,t)},t.useReducer=function(e,t,n){return O.current.useReducer(e,t,n)},t.useRef=function(e){return O.current.useRef(e)},t.useState=function(e){return O.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return O.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return O.current.useTransition()},t.version="18.2.0"},2791:function(e,t,n){"use strict";e.exports=n(9117)},184:function(e,t,n){"use strict";e.exports=n(6374)},6813:function(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,o=a>>>1;r<o;){var s=2*(r+1)-1,c=e[s],u=s+1,l=e[u];if(0>i(c,n))u<a&&0>i(l,c)?(e[r]=l,e[u]=n,r=u):(e[r]=c,e[s]=n,r=s);else{if(!(u<a&&0>i(l,n)))break e;e[r]=l,e[u]=n,r=u}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,c=s.now();t.unstable_now=function(){return s.now()-c}}var u=[],l=[],d=1,p=null,f=3,h=!1,v=!1,m=!1,g="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,k="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(l);null!==t;){if(null===t.callback)a(l);else{if(!(t.startTime<=e))break;a(l),t.sortIndex=t.expirationTime,n(u,t)}t=r(l)}}function w(e){if(m=!1,b(e),!v)if(null!==r(u))v=!0,D(_);else{var t=r(l);null!==t&&M(w,t.startTime-e)}}function _(e,n){v=!1,m&&(m=!1,y(x),x=-1),h=!0;var i=f;try{for(b(n),p=r(u);null!==p&&(!(p.expirationTime>n)||e&&!R());){var o=p.callback;if("function"===typeof o){p.callback=null,f=p.priorityLevel;var s=o(p.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?p.callback=s:p===r(u)&&a(u),b(n)}else a(u);p=r(u)}if(null!==p)var c=!0;else{var d=r(l);null!==d&&M(w,d.startTime-n),c=!1}return c}finally{p=null,f=i,h=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,E=!1,T=null,x=-1,Z=5,C=-1;function R(){return!(t.unstable_now()-C<Z)}function P(){if(null!==T){var e=t.unstable_now();C=e;var n=!0;try{n=T(!0,e)}finally{n?S():(E=!1,T=null)}}else E=!1}if("function"===typeof k)S=function(){k(P)};else if("undefined"!==typeof MessageChannel){var I=new MessageChannel,O=I.port2;I.port1.onmessage=P,S=function(){O.postMessage(null)}}else S=function(){g(P,0)};function D(e){T=e,E||(E=!0,S())}function M(e,n){x=g((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){v||h||(v=!0,D(_))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Z=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,a,i){var o=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?o+i:o:i=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:a,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>o?(e.sortIndex=i,n(l,e),null===r(u)&&e===r(l)&&(m?(y(x),x=-1):m=!0,M(w,i-o))):(e.sortIndex=s,n(u,e),v||h||(v=!0,D(_))),e},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},5296:function(e,t,n){"use strict";e.exports=n(6813)},6712:function(e){var t=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",t+=null!=e.rateNumerator?" rate=%s":"",t+=null!=e.rateDenominator?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(t).forEach((function(e){t[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))}))},7724:function(e,t,n){var r=n(1775),a=n(2921);t.cW=a,t.Qc=r.parse,t.rz=r.parseParams,r.parseFmtpConfig,r.parsePayloads,r.parseRemoteCandidates,r.parseImageAttributes,t.fj=r.parseSimulcastStreamList},1775:function(e,t,n){var r=function(e){return String(Number(e))===e?Number(e):e},a=function(e,t,n){var a=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:a&&!t[e.name]&&(t[e.name]={});var i=e.push?{}:a?t[e.name]:t;!function(e,t,n,a){if(a&&!n)t[a]=r(e[1]);else for(var i=0;i<n.length;i+=1)null!=e[i+1]&&(t[n[i]]=r(e[i+1]))}(n.match(e.reg),i,e.names,e.name),e.push&&t[e.push].push(i)},i=n(6712),o=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},n=[],r=t;return e.split(/(\r\n|\r|\n)/).filter(o).forEach((function(e){var t=e[0],o=e.slice(2);"m"===t&&(n.push({rtp:[],fmtp:[]}),r=n[n.length-1]);for(var s=0;s<(i[t]||[]).length;s+=1){var c=i[t][s];if(c.reg.test(o))return a(c,r,o)}})),t.media=n,t};var s=function(e,t){var n=t.split(/=(.+)/,2);return 2===n.length?e[n[0]]=r(n[1]):1===n.length&&t.length>1&&(e[n[0]]=void 0),e};t.parseParams=function(e){return e.split(/;\s?/).reduce(s,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(e){return e.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(e){for(var t=[],n=e.split(" ").map(r),a=0;a<n.length;a+=3)t.push({component:n[a],ip:n[a+1],port:n[a+2]});return t},t.parseImageAttributes=function(e){return e.split(" ").map((function(e){return e.substring(1,e.length-1).split(",").reduce(s,{})}))},t.parseSimulcastStreamList=function(e){return e.split(";").map((function(e){return e.split(",").map((function(e){var t,n=!1;return"~"!==e[0]?t=r(e):(t=r(e.substring(1,e.length)),n=!0),{scid:t,paused:n}}))}))}},2921:function(e,t,n){var r=n(6712),a=/%[sdv%]/g,i=function(e){var t=1,n=arguments,r=n.length;return e.replace(a,(function(e){if(t>=r)return e;var a=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(a);case"%d":return Number(a);case"%v":return""}}))},o=function(e,t,n){var r=[e+"="+(t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format)];if(t.names)for(var a=0;a<t.names.length;a+=1){var o=t.names[a];t.name?r.push(n[t.name][o]):r.push(n[t.names[a]])}else r.push(n[t.name]);return i.apply(null,r)},s=["v","o","s","i","u","e","p","c","b","t","r","z","a"],c=["i","c","b","a"];e.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var n=t.outerOrder||s,a=t.innerOrder||c,i=[];return n.forEach((function(t){r[t].forEach((function(n){n.name in e&&null!=e[n.name]?i.push(o(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){i.push(o(t,n,e))}))}))})),e.media.forEach((function(e){i.push(o("m",r.m[0],e)),a.forEach((function(t){r[t].forEach((function(n){n.name in e&&null!=e[n.name]?i.push(o(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){i.push(o(t,n,e))}))}))}))})),i.join("\r\n")+"\r\n"}},104:function(e,t,n){"use strict";var r=n(4704).default,a=n(6690).default,i=n(9728).default;!function(e){var t=e.performance;function n(e){t&&t.mark&&t.mark(e)}function r(e,n){t&&t.measure&&t.measure(e,n)}n("Zone");var o=e.__Zone_symbol_prefix||"__zone_symbol__";function s(e){return o+e}var c=!0===e[s("forceDuplicateZoneCheck")];if(e.Zone){if(c||"function"!==typeof e.Zone.__symbol__)throw new Error("Zone already loaded.");return e.Zone}var u=function(){function t(e,n){a(this,t),this._parent=e,this._name=n?n.name||"unnamed":"<root>",this._properties=n&&n.properties||{},this._zoneDelegate=new p(this,this._parent&&this._parent._zoneDelegate,n)}return i(t,[{key:"parent",get:function(){return this._parent}},{key:"name",get:function(){return this._name}},{key:"get",value:function(e){var t=this.getZoneWith(e);if(t)return t._properties[e]}},{key:"getZoneWith",value:function(e){for(var t=this;t;){if(t._properties.hasOwnProperty(e))return t;t=t._parent}return null}},{key:"fork",value:function(e){if(!e)throw new Error("ZoneSpec required!");return this._zoneDelegate.fork(this,e)}},{key:"wrap",value:function(e,t){if("function"!==typeof e)throw new Error("Expecting function got: "+e);var n=this._zoneDelegate.intercept(this,e,t),r=this;return function(){return r.runGuarded(n,this,arguments,t)}}},{key:"run",value:function(e,t,n,r){M={parent:M,zone:this};try{return this._zoneDelegate.invoke(this,e,t,n,r)}finally{M=M.parent}}},{key:"runGuarded",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;M={parent:M,zone:this};try{try{return this._zoneDelegate.invoke(this,e,t,n,r)}catch(a){if(this._zoneDelegate.handleError(this,a))throw a}}finally{M=M.parent}}},{key:"runTask",value:function(e,t,n){if(e.zone!=this)throw new Error("A task can only be run in the zone of creation! (Creation: "+(e.zone||_).name+"; Execution: "+this.name+")");if(e.state!==S||e.type!==I&&e.type!==P){var r=e.state!=x;r&&e._transitionTo(x,T),e.runCount++;var a=A;A=e,M={parent:M,zone:this};try{e.type==P&&e.data&&!e.data.isPeriodic&&(e.cancelFn=void 0);try{return this._zoneDelegate.invokeTask(this,e,t,n)}catch(i){if(this._zoneDelegate.handleError(this,i))throw i}}finally{e.state!==S&&e.state!==C&&(e.type==I||e.data&&e.data.isPeriodic?r&&e._transitionTo(T,x):(e.runCount=0,this._updateTaskCount(e,-1),r&&e._transitionTo(S,x,S))),M=M.parent,A=a}}}},{key:"scheduleTask",value:function(e){if(e.zone&&e.zone!==this)for(var t=this;t;){if(t===e.zone)throw Error("can not reschedule task to ".concat(this.name," which is descendants of the original zone ").concat(e.zone.name));t=t.parent}e._transitionTo(E,S);var n=[];e._zoneDelegates=n,e._zone=this;try{e=this._zoneDelegate.scheduleTask(this,e)}catch(r){throw e._transitionTo(C,E,S),this._zoneDelegate.handleError(this,r),r}return e._zoneDelegates===n&&this._updateTaskCount(e,1),e.state==E&&e._transitionTo(T,E),e}},{key:"scheduleMicroTask",value:function(e,t,n,r){return this.scheduleTask(new f(R,e,t,n,r,void 0))}},{key:"scheduleMacroTask",value:function(e,t,n,r,a){return this.scheduleTask(new f(P,e,t,n,r,a))}},{key:"scheduleEventTask",value:function(e,t,n,r,a){return this.scheduleTask(new f(I,e,t,n,r,a))}},{key:"cancelTask",value:function(e){if(e.zone!=this)throw new Error("A task can only be cancelled in the zone of creation! (Creation: "+(e.zone||_).name+"; Execution: "+this.name+")");e._transitionTo(Z,T,x);try{this._zoneDelegate.cancelTask(this,e)}catch(t){throw e._transitionTo(C,Z),this._zoneDelegate.handleError(this,t),t}return this._updateTaskCount(e,-1),e._transitionTo(S,Z),e.runCount=0,e}},{key:"_updateTaskCount",value:function(e,t){var n=e._zoneDelegates;-1==t&&(e._zoneDelegates=null);for(var r=0;r<n.length;r++)n[r]._updateTaskCount(e.type,t)}}],[{key:"assertZonePatched",value:function(){if(e.Promise!==O.ZoneAwarePromise)throw new Error("Zone.js has detected that ZoneAwarePromise `(window|global).Promise` has been overwritten.\nMost likely cause is that a Promise polyfill has been loaded after Zone.js (Polyfilling Promise api is not necessary when zone.js is loaded. If you must load one, do so before loading zone.js.)")}},{key:"root",get:function(){for(var e=t.current;e.parent;)e=e.parent;return e}},{key:"current",get:function(){return M.zone}},{key:"currentTask",get:function(){return A}},{key:"__load_patch",value:function(a,i){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(O.hasOwnProperty(a)){if(!o&&c)throw Error("Already loaded patch: "+a)}else if(!e["__Zone_disable_"+a]){var s="Zone:"+a;n(s),O[a]=i(e,t,D),r(s,s)}}}]),t}();u.__symbol__=s;var l,d={name:"",onHasTask:function(e,t,n,r){return e.hasTask(n,r)},onScheduleTask:function(e,t,n,r){return e.scheduleTask(n,r)},onInvokeTask:function(e,t,n,r,a,i){return e.invokeTask(n,r,a,i)},onCancelTask:function(e,t,n,r){return e.cancelTask(n,r)}},p=function(){function e(t,n,r){a(this,e),this._taskCounts={microTask:0,macroTask:0,eventTask:0},this.zone=t,this._parentDelegate=n,this._forkZS=r&&(r&&r.onFork?r:n._forkZS),this._forkDlgt=r&&(r.onFork?n:n._forkDlgt),this._forkCurrZone=r&&(r.onFork?this.zone:n._forkCurrZone),this._interceptZS=r&&(r.onIntercept?r:n._interceptZS),this._interceptDlgt=r&&(r.onIntercept?n:n._interceptDlgt),this._interceptCurrZone=r&&(r.onIntercept?this.zone:n._interceptCurrZone),this._invokeZS=r&&(r.onInvoke?r:n._invokeZS),this._invokeDlgt=r&&(r.onInvoke?n:n._invokeDlgt),this._invokeCurrZone=r&&(r.onInvoke?this.zone:n._invokeCurrZone),this._handleErrorZS=r&&(r.onHandleError?r:n._handleErrorZS),this._handleErrorDlgt=r&&(r.onHandleError?n:n._handleErrorDlgt),this._handleErrorCurrZone=r&&(r.onHandleError?this.zone:n._handleErrorCurrZone),this._scheduleTaskZS=r&&(r.onScheduleTask?r:n._scheduleTaskZS),this._scheduleTaskDlgt=r&&(r.onScheduleTask?n:n._scheduleTaskDlgt),this._scheduleTaskCurrZone=r&&(r.onScheduleTask?this.zone:n._scheduleTaskCurrZone),this._invokeTaskZS=r&&(r.onInvokeTask?r:n._invokeTaskZS),this._invokeTaskDlgt=r&&(r.onInvokeTask?n:n._invokeTaskDlgt),this._invokeTaskCurrZone=r&&(r.onInvokeTask?this.zone:n._invokeTaskCurrZone),this._cancelTaskZS=r&&(r.onCancelTask?r:n._cancelTaskZS),this._cancelTaskDlgt=r&&(r.onCancelTask?n:n._cancelTaskDlgt),this._cancelTaskCurrZone=r&&(r.onCancelTask?this.zone:n._cancelTaskCurrZone),this._hasTaskZS=null,this._hasTaskDlgt=null,this._hasTaskDlgtOwner=null,this._hasTaskCurrZone=null;var i=r&&r.onHasTask,o=n&&n._hasTaskZS;(i||o)&&(this._hasTaskZS=i?r:d,this._hasTaskDlgt=n,this._hasTaskDlgtOwner=this,this._hasTaskCurrZone=t,r.onScheduleTask||(this._scheduleTaskZS=d,this._scheduleTaskDlgt=n,this._scheduleTaskCurrZone=this.zone),r.onInvokeTask||(this._invokeTaskZS=d,this._invokeTaskDlgt=n,this._invokeTaskCurrZone=this.zone),r.onCancelTask||(this._cancelTaskZS=d,this._cancelTaskDlgt=n,this._cancelTaskCurrZone=this.zone))}return i(e,[{key:"fork",value:function(e,t){return this._forkZS?this._forkZS.onFork(this._forkDlgt,this.zone,e,t):new u(e,t)}},{key:"intercept",value:function(e,t,n){return this._interceptZS?this._interceptZS.onIntercept(this._interceptDlgt,this._interceptCurrZone,e,t,n):t}},{key:"invoke",value:function(e,t,n,r,a){return this._invokeZS?this._invokeZS.onInvoke(this._invokeDlgt,this._invokeCurrZone,e,t,n,r,a):t.apply(n,r)}},{key:"handleError",value:function(e,t){return!this._handleErrorZS||this._handleErrorZS.onHandleError(this._handleErrorDlgt,this._handleErrorCurrZone,e,t)}},{key:"scheduleTask",value:function(e,t){var n=t;if(this._scheduleTaskZS)this._hasTaskZS&&n._zoneDelegates.push(this._hasTaskDlgtOwner),(n=this._scheduleTaskZS.onScheduleTask(this._scheduleTaskDlgt,this._scheduleTaskCurrZone,e,t))||(n=t);else if(t.scheduleFn)t.scheduleFn(t);else{if(t.type!=R)throw new Error("Task is missing scheduleFn.");b(t)}return n}},{key:"invokeTask",value:function(e,t,n,r){return this._invokeTaskZS?this._invokeTaskZS.onInvokeTask(this._invokeTaskDlgt,this._invokeTaskCurrZone,e,t,n,r):t.callback.apply(n,r)}},{key:"cancelTask",value:function(e,t){var n;if(this._cancelTaskZS)n=this._cancelTaskZS.onCancelTask(this._cancelTaskDlgt,this._cancelTaskCurrZone,e,t);else{if(!t.cancelFn)throw Error("Task is not cancelable");n=t.cancelFn(t)}return n}},{key:"hasTask",value:function(e,t){try{this._hasTaskZS&&this._hasTaskZS.onHasTask(this._hasTaskDlgt,this._hasTaskCurrZone,e,t)}catch(n){this.handleError(e,n)}}},{key:"_updateTaskCount",value:function(e,t){var n=this._taskCounts,r=n[e],a=n[e]=r+t;if(a<0)throw new Error("More tasks executed then were scheduled.");if(0==r||0==a){var i={microTask:n.microTask>0,macroTask:n.macroTask>0,eventTask:n.eventTask>0,change:e};this.hasTask(this.zone,i)}}}]),e}(),f=function(){function t(n,r,i,o,s,c){if(a(this,t),this._zone=null,this.runCount=0,this._zoneDelegates=null,this._state="notScheduled",this.type=n,this.source=r,this.data=o,this.scheduleFn=s,this.cancelFn=c,!i)throw new Error("callback is not defined");this.callback=i;var u=this;n===I&&o&&o.useG?this.invoke=t.invokeTask:this.invoke=function(){return t.invokeTask.call(e,u,this,arguments)}}return i(t,[{key:"zone",get:function(){return this._zone}},{key:"state",get:function(){return this._state}},{key:"cancelScheduleRequest",value:function(){this._transitionTo(S,E)}},{key:"_transitionTo",value:function(e,t,n){if(this._state!==t&&this._state!==n)throw new Error("".concat(this.type," '").concat(this.source,"': can not transition to '").concat(e,"', expecting state '").concat(t,"'").concat(n?" or '"+n+"'":"",", was '").concat(this._state,"'."));this._state=e,e==S&&(this._zoneDelegates=null)}},{key:"toString",value:function(){return this.data&&"undefined"!==typeof this.data.handleId?this.data.handleId.toString():Object.prototype.toString.call(this)}},{key:"toJSON",value:function(){return{type:this.type,state:this.state,source:this.source,zone:this.zone.name,runCount:this.runCount}}}],[{key:"invokeTask",value:function(e,t,n){e||(e=this),N++;try{return e.runCount++,e.zone.runTask(e,t,n)}finally{1==N&&w(),N--}}}]),t}(),h=s("setTimeout"),v=s("Promise"),m=s("then"),g=[],y=!1;function k(t){if(l||e[v]&&(l=e[v].resolve(0)),l){var n=l[m];n||(n=l.then),n.call(l,t)}else e[h](t,0)}function b(e){0===N&&0===g.length&&k(w),e&&g.push(e)}function w(){if(!y){for(y=!0;g.length;){var e=g;g=[];for(var t=0;t<e.length;t++){var n=e[t];try{n.zone.runTask(n,null,null)}catch(r){D.onUnhandledError(r)}}}D.microtaskDrainDone(),y=!1}}var _={name:"NO ZONE"},S="notScheduled",E="scheduling",T="scheduled",x="running",Z="canceling",C="unknown",R="microTask",P="macroTask",I="eventTask",O={},D={symbol:s,currentZoneFrame:function(){return M},onUnhandledError:L,microtaskDrainDone:L,scheduleMicroTask:b,showUncaughtError:function(){return!u[s("ignoreConsoleErrorUncaughtError")]},patchEventTarget:function(){return[]},patchOnProperties:L,patchMethod:function(){return L},bindArguments:function(){return[]},patchThen:function(){return L},patchMacroTask:function(){return L},patchEventPrototype:function(){return L},isIEOrEdge:function(){return!1},getGlobalObjects:function(){},ObjectDefineProperty:function(){return L},ObjectGetOwnPropertyDescriptor:function(){},ObjectCreate:function(){},ArraySlice:function(){return[]},patchClass:function(){return L},wrapWithCurrentZone:function(){return L},filterProperties:function(){return[]},attachOriginToPatched:function(){return L},_redefineProperty:function(){return L},patchCallbacks:function(){return L},nativeScheduleMicroTask:k},M={parent:null,zone:new u(null,null)},A=null,N=0;function L(){}r("Zone","Zone"),e.Zone=u}("undefined"!==typeof window&&window||"undefined"!==typeof self&&self||n.g);var o=Object.getOwnPropertyDescriptor,s=Object.defineProperty,c=Object.getPrototypeOf,u=Object.create,l=Array.prototype.slice,d="addEventListener",p="removeEventListener",f=Zone.__symbol__(d),h=Zone.__symbol__(p),v="true",m="false",g=Zone.__symbol__("");function y(e,t){return Zone.current.wrap(e,t)}function k(e,t,n,r,a){return Zone.current.scheduleMacroTask(e,t,n,r,a)}var b=Zone.__symbol__,w="undefined"!==typeof window,_=w?window:void 0,S=w&&_||"object"===typeof self&&self||n.g,E="removeAttribute";function T(e,t){for(var n=e.length-1;n>=0;n--)"function"===typeof e[n]&&(e[n]=y(e[n],t+"_"+n));return e}function x(e){return!e||!1!==e.writable&&!("function"===typeof e.get&&"undefined"===typeof e.set)}var Z="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,C=!("nw"in S)&&"undefined"!==typeof S.process&&"[object process]"==={}.toString.call(S.process),R=!C&&!Z&&!(!w||!_.HTMLElement),P="undefined"!==typeof S.process&&"[object process]"==={}.toString.call(S.process)&&!Z&&!(!w||!_.HTMLElement),I={},O=function(e){if(e=e||S.event){var t=I[e.type];t||(t=I[e.type]=b("ON_PROPERTY"+e.type));var n,r=this||e.target||S,a=r[t];if(R&&r===_&&"error"===e.type){var i=e;!0===(n=a&&a.call(this,i.message,i.filename,i.lineno,i.colno,i.error))&&e.preventDefault()}else void 0==(n=a&&a.apply(this,arguments))||n||e.preventDefault();return n}};function D(e,t,n){var r=o(e,t);!r&&n&&(o(n,t)&&(r={enumerable:!0,configurable:!0}));if(r&&r.configurable){var a=b("on"+t+"patched");if(!e.hasOwnProperty(a)||!e[a]){delete r.writable,delete r.value;var i=r.get,c=r.set,u=t.slice(2),l=I[u];l||(l=I[u]=b("ON_PROPERTY"+u)),r.set=function(t){var n=this;(n||e!==S||(n=S),n)&&("function"===typeof n[l]&&n.removeEventListener(u,O),c&&c.call(n,null),n[l]=t,"function"===typeof t&&n.addEventListener(u,O,!1))},r.get=function(){var n=this;if(n||e!==S||(n=S),!n)return null;var a=n[l];if(a)return a;if(i){var o=i.call(this);if(o)return r.set.call(this,o),"function"===typeof n[E]&&n.removeAttribute(t),o}return null},s(e,t,r),e[a]=!0}}}function M(e,t,n){if(t)for(var r=0;r<t.length;r++)D(e,"on"+t[r],n);else{var a=[];for(var i in e)"on"==i.slice(0,2)&&a.push(i);for(var o=0;o<a.length;o++)D(e,a[o],n)}}var A=b("originalInstance");function N(e){var t=S[e];if(t){S[b(e)]=t,S[e]=function(){var n=T(arguments,e);switch(n.length){case 0:this[A]=new t;break;case 1:this[A]=new t(n[0]);break;case 2:this[A]=new t(n[0],n[1]);break;case 3:this[A]=new t(n[0],n[1],n[2]);break;case 4:this[A]=new t(n[0],n[1],n[2],n[3]);break;default:throw new Error("Arg list too long.")}},F(S[e],t);var n,r=new t((function(){}));for(n in r)"XMLHttpRequest"===e&&"responseBlob"===n||function(t){"function"===typeof r[t]?S[e].prototype[t]=function(){return this[A][t].apply(this[A],arguments)}:s(S[e].prototype,t,{set:function(n){"function"===typeof n?(this[A][t]=y(n,e+"."+t),F(this[A][t],n)):this[A][t]=n},get:function(){return this[A][t]}})}(n);for(n in t)"prototype"!==n&&t.hasOwnProperty(n)&&(S[e][n]=t[n])}}function L(e,t,n){for(var r=e;r&&!r.hasOwnProperty(t);)r=c(r);!r&&e[t]&&(r=e);var a=b(t),i=null;if(r&&(!(i=r[a])||!r.hasOwnProperty(a))&&(i=r[a]=r[t],x(r&&o(r,t)))){var s=n(i,a,t);r[t]=function(){return s(this,arguments)},F(r[t],i)}return i}function j(e,t,n){var r=null;function a(e){var t=e.data;return t.args[t.cbIdx]=function(){e.invoke.apply(this,arguments)},r.apply(t.target,t.args),e}r=L(e,t,(function(e){return function(t,r){var i=n(t,r);return i.cbIdx>=0&&"function"===typeof r[i.cbIdx]?k(i.name,r[i.cbIdx],i,a):e.apply(t,r)}}))}function F(e,t){e[b("OriginalDelegate")]=t}var U=!1,B=!1;function V(){if(U)return B;U=!0;try{var e=_.navigator.userAgent;-1===e.indexOf("MSIE ")&&-1===e.indexOf("Trident/")&&-1===e.indexOf("Edge/")||(B=!0)}catch(t){}return B}Zone.__load_patch("ZoneAwarePromise",(function(e,t,n){var o=Object.getOwnPropertyDescriptor,s=Object.defineProperty;var c=n.symbol,u=[],l=!0===e[c("DISABLE_WRAPPING_UNCAUGHT_PROMISE_REJECTION")],d=c("Promise"),p=c("then"),f="__creationTrace__";n.onUnhandledError=function(e){if(n.showUncaughtError()){var t=e&&e.rejection;t?console.error("Unhandled Promise rejection:",t instanceof Error?t.message:t,"; Zone:",e.zone.name,"; Task:",e.task&&e.task.source,"; Value:",t,t instanceof Error?t.stack:void 0):console.error(e)}},n.microtaskDrainDone=function(){for(var e=function(){var e=u.shift();try{e.zone.runGuarded((function(){if(e.throwOriginal)throw e.rejection;throw e}))}catch(r){!function(e){n.onUnhandledError(e);try{var r=t[h];"function"===typeof r&&r.call(this,e)}catch(a){}}(r)}};u.length;)e()};var h=c("unhandledPromiseRejectionHandler");function v(e){return e&&e.then}function m(e){return e}function g(e){return F.reject(e)}var y=c("state"),k=c("value"),b=c("finally"),w=c("parentPromiseValue"),_=c("parentPromiseState"),S="Promise.then",E=null,T=!0,x=!1,Z=0;function C(e,t){return function(n){try{O(e,t,n)}catch(r){O(e,!1,r)}}}var R=function(){var e=!1;return function(t){return function(){e||(e=!0,t.apply(null,arguments))}}},P="Promise resolved with itself",I=c("currentTaskTrace");function O(e,r,a){var i=R();if(e===a)throw new TypeError(P);if(e[y]===E){var o=null;try{"object"!==typeof a&&"function"!==typeof a||(o=a&&a.then)}catch(v){return i((function(){O(e,!1,v)}))(),e}if(r!==x&&a instanceof F&&a.hasOwnProperty(y)&&a.hasOwnProperty(k)&&a[y]!==E)M(a),O(e,a[y],a[k]);else if(r!==x&&"function"===typeof o)try{o.call(a,i(C(e,r)),i(C(e,!1)))}catch(v){i((function(){O(e,!1,v)}))()}else{e[y]=r;var c=e[k];if(e[k]=a,e[b]===b&&r===T&&(e[y]=e[_],e[k]=e[w]),r===x&&a instanceof Error){var d=t.currentTask&&t.currentTask.data&&t.currentTask.data[f];d&&s(a,I,{configurable:!0,enumerable:!1,writable:!0,value:d})}for(var p=0;p<c.length;)A(e,c[p++],c[p++],c[p++],c[p++]);if(0==c.length&&r==x){e[y]=Z;var h=a;try{throw new Error("Uncaught (in promise): "+function(e){if(e&&e.toString===Object.prototype.toString){return(e.constructor&&e.constructor.name||"")+": "+JSON.stringify(e)}return e?e.toString():Object.prototype.toString.call(e)}(a)+(a&&a.stack?"\n"+a.stack:""))}catch(v){h=v}l&&(h.throwOriginal=!0),h.rejection=a,h.promise=e,h.zone=t.current,h.task=t.currentTask,u.push(h),n.scheduleMicroTask()}}}return e}var D=c("rejectionHandledHandler");function M(e){if(e[y]===Z){try{var n=t[D];n&&"function"===typeof n&&n.call(this,{rejection:e[k],promise:e})}catch(a){}e[y]=x;for(var r=0;r<u.length;r++)e===u[r].promise&&u.splice(r,1)}}function A(e,t,n,r,a){M(e);var i=e[y],o=i?"function"===typeof r?r:m:"function"===typeof a?a:g;t.scheduleMicroTask(S,(function(){try{var r=e[k],a=!!n&&b===n[b];a&&(n[w]=r,n[_]=i);var s=t.run(o,void 0,a&&o!==g&&o!==m?[]:[r]);O(n,!0,s)}catch(c){O(n,!1,c)}}),n)}var N=function(){},j=e.AggregateError,F=function(e,n){function o(e){a(this,o);var t=this;if(!(t instanceof o))throw new Error("Must be an instanceof Promise.");t[y]=E,t[k]=[];try{var n=R();e&&e(n(C(t,T)),n(C(t,x)))}catch(r){O(t,!1,r)}}return i(o,[{key:e,get:function(){return"Promise"}},{key:n,get:function(){return o}},{key:"then",value:function(e,n){var r,a=null===(r=this.constructor)||void 0===r?void 0:r[Symbol.species];a&&"function"===typeof a||(a=this.constructor||o);var i=new a(N),s=t.current;return this[y]==E?this[k].push(s,i,e,n):A(this,s,i,e,n),i}},{key:"catch",value:function(e){return this.then(null,e)}},{key:"finally",value:function(e){var n,r=null===(n=this.constructor)||void 0===n?void 0:n[Symbol.species];r&&"function"===typeof r||(r=o);var a=new r(N);a[b]=b;var i=t.current;return this[y]==E?this[k].push(i,a,e,e):A(this,i,a,e,e),a}}],[{key:"toString",value:function(){return"function ZoneAwarePromise() { [native code] }"}},{key:"resolve",value:function(e){return O(new this(null),T,e)}},{key:"reject",value:function(e){return O(new this(null),x,e)}},{key:"any",value:function(e){if(!e||"function"!==typeof e[Symbol.iterator])return Promise.reject(new j([],"All promises were rejected"));var t=[],n=0;try{var a,i=r(e);try{for(i.s();!(a=i.n()).done;){var s=a.value;n++,t.push(o.resolve(s))}}catch(l){i.e(l)}finally{i.f()}}catch(l){return Promise.reject(new j([],"All promises were rejected"))}if(0===n)return Promise.reject(new j([],"All promises were rejected"));var c=!1,u=[];return new o((function(e,r){for(var a=0;a<t.length;a++)t[a].then((function(t){c||(c=!0,e(t))}),(function(e){u.push(e),0===--n&&(c=!0,r(new j(u,"All promises were rejected")))}))}))}},{key:"race",value:function(e){var t,n,a=new this((function(e,r){t=e,n=r}));function i(e){t(e)}function o(e){n(e)}var s,c=r(e);try{for(c.s();!(s=c.n()).done;){var u=s.value;v(u)||(u=this.resolve(u)),u.then(i,o)}}catch(l){c.e(l)}finally{c.f()}return a}},{key:"all",value:function(e){return o.allWithCallback(e)}},{key:"allSettled",value:function(e){return(this&&this.prototype instanceof o?this:o).allWithCallback(e,{thenCallback:function(e){return{status:"fulfilled",value:e}},errorCallback:function(e){return{status:"rejected",reason:e}}})}},{key:"allWithCallback",value:function(e,t){var n,a,i,o=this,s=new this((function(e,t){n=e,a=t})),c=2,u=0,l=[],d=r(e);try{var p=function(){var e=i.value;v(e)||(e=o.resolve(e));var r=u;try{e.then((function(e){l[r]=t?t.thenCallback(e):e,0===--c&&n(l)}),(function(e){t?(l[r]=t.errorCallback(e),0===--c&&n(l)):a(e)}))}catch(s){a(s)}c++,u++};for(d.s();!(i=d.n()).done;)p()}catch(f){d.e(f)}finally{d.f()}return 0===(c-=2)&&n(l),s}}]),o}(Symbol.toStringTag,Symbol.species);F.resolve=F.resolve,F.reject=F.reject,F.race=F.race,F.all=F.all;var U=e[d]=e.Promise;e.Promise=F;var B=c("thenPatched");function V(e){var t=e.prototype,n=o(t,"then");if(!n||!1!==n.writable&&n.configurable){var r=t.then;t[p]=r,e.prototype.then=function(e,t){var n=this;return new F((function(e,t){r.call(n,e,t)})).then(e,t)},e[B]=!0}}return n.patchThen=V,U&&(V(U),L(e,"fetch",(function(e){return t=e,function(e,n){var r=t.apply(e,n);if(r instanceof F)return r;var a=r.constructor;return a[B]||V(a),r};var t}))),Promise[t.__symbol__("uncaughtPromiseErrors")]=u,F})),Zone.__load_patch("toString",(function(e){var t=Function.prototype.toString,n=b("OriginalDelegate"),r=b("Promise"),a=b("Error"),i=function(){if("function"===typeof this){var i=this[n];if(i)return"function"===typeof i?t.call(i):Object.prototype.toString.call(i);if(this===Promise){var o=e[r];if(o)return t.call(o)}if(this===Error){var s=e[a];if(s)return t.call(s)}}return t.call(this)};i[n]=t,Function.prototype.toString=i;var o=Object.prototype.toString;Object.prototype.toString=function(){return"function"===typeof Promise&&this instanceof Promise?"[object Promise]":o.call(this)}}));var H=!1;if("undefined"!==typeof window)try{var z=Object.defineProperty({},"passive",{get:function(){H=!0}});window.addEventListener("test",z,z),window.removeEventListener("test",z,z)}catch(ce){H=!1}var W={useG:!0},G={},q={},$=new RegExp("^"+g+"(\\w+)(true|false)$"),K=b("propagationStopped");function J(e,t){var n=(t?t(e):e)+m,r=(t?t(e):e)+v,a=g+n,i=g+r;G[e]={},G[e][m]=a,G[e][v]=i}function Q(e,t,n,r){var a=r&&r.add||d,i=r&&r.rm||p,o=r&&r.listeners||"eventListeners",s=r&&r.rmAll||"removeAllListeners",u=b(a),l="."+a+":",f="prependListener",h="."+f+":",y=function(e,t,n){if(!e.isRemoved){var r,a=e.callback;"object"===typeof a&&a.handleEvent&&(e.callback=function(e){return a.handleEvent(e)},e.originalDelegate=a);try{e.invoke(e,t,[n])}catch(ce){r=ce}var o=e.options;if(o&&"object"===typeof o&&o.once){var s=e.originalDelegate?e.originalDelegate:e.callback;t[i].call(t,n.type,s,o)}return r}};function k(n,r,a){if(r=r||e.event){var i=n||r.target||e,o=i[G[r.type][a?v:m]];if(o){var s=[];if(1===o.length){var c=y(o[0],i,r);c&&s.push(c)}else for(var u=o.slice(),l=0;l<u.length&&(!r||!0!==r[K]);l++){var d=y(u[l],i,r);d&&s.push(d)}if(1===s.length)throw s[0];for(var p=function(){var e=s[f];t.nativeScheduleMicroTask((function(){throw e}))},f=0;f<s.length;f++)p()}}}var w=function(e){return k(this,e,!1)},_=function(e){return k(this,e,!0)};function S(t,n){if(!t)return!1;var r=!0;n&&void 0!==n.useG&&(r=n.useG);var d=n&&n.vh,p=!0;n&&void 0!==n.chkDup&&(p=n.chkDup);var y=!1;n&&void 0!==n.rt&&(y=n.rt);for(var k=t;k&&!k.hasOwnProperty(a);)k=c(k);if(!k&&t[a]&&(k=t),!k)return!1;if(k[u])return!1;var S,E=n&&n.eventNameToString,T={},x=k[u]=k[a],Z=k[b(i)]=k[i],R=k[b(o)]=k[o],P=k[b(s)]=k[s];n&&n.prepend&&(S=k[b(n.prepend)]=k[n.prepend]);var I=r?function(e){if(!T.isExisting)return x.call(T.target,T.eventName,T.capture?_:w,T.options)}:function(e){return x.call(T.target,T.eventName,e.invoke,T.options)},O=r?function(e){if(!e.isRemoved){var t,n=G[e.eventName];n&&(t=n[e.capture?v:m]);var r=t&&e.target[t];if(r)for(var a=0;a<r.length;a++){if(r[a]===e){r.splice(a,1),e.isRemoved=!0,0===r.length&&(e.allRemoved=!0,e.target[t]=null);break}}}if(e.allRemoved)return Z.call(e.target,e.eventName,e.capture?_:w,e.options)}:function(e){return Z.call(e.target,e.eventName,e.invoke,e.options)},D=n&&n.diff?n.diff:function(e,t){var n=typeof t;return"function"===n&&e.callback===t||"object"===n&&e.originalDelegate===t},M=Zone[b("UNPATCHED_EVENTS")],A=e[b("PASSIVE_EVENTS")],N=function(t,a,i,o){var s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return function(){var u=this||e,l=arguments[0];n&&n.transferEventName&&(l=n.transferEventName(l));var f=arguments[1];if(!f)return t.apply(this,arguments);if(C&&"uncaughtException"===l)return t.apply(this,arguments);var h=!1;if("function"!==typeof f){if(!f.handleEvent)return t.apply(this,arguments);h=!0}if(!d||d(t,f,u,arguments)){var g=H&&!!A&&-1!==A.indexOf(l),y=function(e,t){return!H&&"object"===typeof e&&e?!!e.capture:H&&t?"boolean"===typeof e?{capture:e,passive:!0}:e?"object"===typeof e&&!1!==e.passive?Object.assign(Object.assign({},e),{passive:!0}):e:{passive:!0}:e}(arguments[2],g);if(M)for(var k=0;k<M.length;k++)if(l===M[k])return g?t.call(u,l,f,y):t.apply(this,arguments);var b=!!y&&("boolean"===typeof y||y.capture),w=!(!y||"object"!==typeof y)&&y.once,_=Zone.current,S=G[l];S||(J(l,E),S=G[l]);var x,Z=S[b?v:m],R=u[Z],P=!1;if(R){if(P=!0,p)for(var I=0;I<R.length;I++)if(D(R[I],f))return}else R=u[Z]=[];var O=u.constructor.name,N=q[O];N&&(x=N[l]),x||(x=O+a+(E?E(l):l)),T.options=y,w&&(T.options.once=!1),T.target=u,T.capture=b,T.eventName=l,T.isExisting=P;var L=r?W:void 0;L&&(L.taskData=T);var j=_.scheduleEventTask(x,f,L,i,o);return T.target=null,L&&(L.taskData=null),w&&(y.once=!0),(H||"boolean"!==typeof j.options)&&(j.options=y),j.target=u,j.capture=b,j.eventName=l,h&&(j.originalDelegate=f),c?R.unshift(j):R.push(j),s?u:void 0}}};return k[a]=N(x,l,I,O,y),S&&(k[f]=N(S,h,(function(e){return S.call(T.target,T.eventName,e.invoke,T.options)}),O,y,!0)),k[i]=function(){var t=this||e,r=arguments[0];n&&n.transferEventName&&(r=n.transferEventName(r));var a=arguments[2],i=!!a&&("boolean"===typeof a||a.capture),o=arguments[1];if(!o)return Z.apply(this,arguments);if(!d||d(Z,o,t,arguments)){var s,c=G[r];c&&(s=c[i?v:m]);var u=s&&t[s];if(u)for(var l=0;l<u.length;l++){var p=u[l];if(D(p,o)){if(u.splice(l,1),p.isRemoved=!0,0===u.length)if(p.allRemoved=!0,t[s]=null,"string"===typeof r)t[g+"ON_PROPERTY"+r]=null;return p.zone.cancelTask(p),y?t:void 0}}return Z.apply(this,arguments)}},k[o]=function(){var t=this||e,r=arguments[0];n&&n.transferEventName&&(r=n.transferEventName(r));for(var a=[],i=X(t,E?E(r):r),o=0;o<i.length;o++){var s=i[o],c=s.originalDelegate?s.originalDelegate:s.callback;a.push(c)}return a},k[s]=function(){var t=this||e,r=arguments[0];if(r){n&&n.transferEventName&&(r=n.transferEventName(r));var a=G[r];if(a){var o=a[m],c=a[v],u=t[o],l=t[c];if(u)for(var d=u.slice(),p=0;p<d.length;p++){var f=d[p],h=f.originalDelegate?f.originalDelegate:f.callback;this[i].call(this,r,h,f.options)}if(l)for(var g=l.slice(),k=0;k<g.length;k++){var b=g[k],w=b.originalDelegate?b.originalDelegate:b.callback;this[i].call(this,r,w,b.options)}}}else{for(var _=Object.keys(t),S=0;S<_.length;S++){var E=_[S],T=$.exec(E),x=T&&T[1];x&&"removeListener"!==x&&this[s].call(this,x)}this[s].call(this,"removeListener")}if(y)return this},F(k[a],x),F(k[i],Z),P&&F(k[s],P),R&&F(k[o],R),!0}for(var E=[],T=0;T<n.length;T++)E[T]=S(n[T],r);return E}function X(e,t){if(!t){var n=[];for(var r in e){var a=$.exec(r),i=a&&a[1];if(i&&(!t||i===t)){var o=e[r];if(o)for(var s=0;s<o.length;s++)n.push(o[s])}}return n}var c=G[t];c||(J(t),c=G[t]);var u=e[c[m]],l=e[c[v]];return u?l?u.concat(l):u.slice():l?l.slice():[]}function Y(e,t){var n=e.Event;n&&n.prototype&&t.patchMethod(n.prototype,"stopImmediatePropagation",(function(e){return function(t,n){t[K]=!0,e&&e.apply(t,n)}}))}function ee(e,t,n,r,a){var i=Zone.__symbol__(r);if(!t[i]){var o=t[i]=t[r];t[r]=function(i,s,c){return s&&s.prototype&&a.forEach((function(t){var a="".concat(n,".").concat(r,"::")+t,i=s.prototype;try{if(i.hasOwnProperty(t)){var o=e.ObjectGetOwnPropertyDescriptor(i,t);o&&o.value?(o.value=e.wrapWithCurrentZone(o.value,a),e._redefineProperty(s.prototype,t,o)):i[t]&&(i[t]=e.wrapWithCurrentZone(i[t],a))}else i[t]&&(i[t]=e.wrapWithCurrentZone(i[t],a))}catch(c){}})),o.call(t,i,s,c)},e.attachOriginToPatched(t[r],o)}}function te(e,t,n){if(!n||0===n.length)return t;var r=n.filter((function(t){return t.target===e}));if(!r||0===r.length)return t;var a=r[0].ignoreProperties;return t.filter((function(e){return-1===a.indexOf(e)}))}function ne(e,t,n,r){e&&M(e,te(e,t,n),r)}function re(e){return Object.getOwnPropertyNames(e).filter((function(e){return e.startsWith("on")&&e.length>2})).map((function(e){return e.substring(2)}))}function ae(e,t){if((!C||P)&&!Zone[e.symbol("patchEvents")]){var n=t.__Zone_ignore_on_properties,r=[];if(R){var a=window;r=r.concat(["Document","SVGElement","Element","HTMLElement","HTMLBodyElement","HTMLMediaElement","HTMLFrameSetElement","HTMLFrameElement","HTMLIFrameElement","HTMLMarqueeElement","Worker"]);var i=function(){try{var e=_.navigator.userAgent;if(-1!==e.indexOf("MSIE ")||-1!==e.indexOf("Trident/"))return!0}catch(t){}return!1}()?[{target:a,ignoreProperties:["error"]}]:[];ne(a,re(a),n?n.concat(i):n,c(a))}r=r.concat(["XMLHttpRequest","XMLHttpRequestEventTarget","IDBIndex","IDBRequest","IDBOpenDBRequest","IDBDatabase","IDBTransaction","IDBCursor","WebSocket"]);for(var o=0;o<r.length;o++){var s=t[r[o]];s&&s.prototype&&ne(s.prototype,re(s.prototype),n)}}}Zone.__load_patch("util",(function(e,t,n){var r=re(e);n.patchOnProperties=M,n.patchMethod=L,n.bindArguments=T,n.patchMacroTask=j;var a=t.__symbol__("BLACK_LISTED_EVENTS"),i=t.__symbol__("UNPATCHED_EVENTS");e[i]&&(e[a]=e[i]),e[a]&&(t[a]=t[i]=e[a]),n.patchEventPrototype=Y,n.patchEventTarget=Q,n.isIEOrEdge=V,n.ObjectDefineProperty=s,n.ObjectGetOwnPropertyDescriptor=o,n.ObjectCreate=u,n.ArraySlice=l,n.patchClass=N,n.wrapWithCurrentZone=y,n.filterProperties=te,n.attachOriginToPatched=F,n._redefineProperty=Object.defineProperty,n.patchCallbacks=ee,n.getGlobalObjects=function(){return{globalSources:q,zoneSymbolEventNames:G,eventNames:r,isBrowser:R,isMix:P,isNode:C,TRUE_STR:v,FALSE_STR:m,ZONE_SYMBOL_PREFIX:g,ADD_EVENT_LISTENER_STR:d,REMOVE_EVENT_LISTENER_STR:p}}}));var ie=b("zoneTask");function oe(e,t,n,r){var a=null,i=null;n+=r;var o={};function s(t){var n=t.data;return n.args[0]=function(){return t.invoke.apply(this,arguments)},n.handleId=a.apply(e,n.args),t}function c(t){return i.call(e,t.data.handleId)}a=L(e,t+=r,(function(n){return function(a,i){if("function"===typeof i[0]){var u={isPeriodic:"Interval"===r,delay:"Timeout"===r||"Interval"===r?i[1]||0:void 0,args:i},l=i[0];i[0]=function(){try{return l.apply(this,arguments)}finally{u.isPeriodic||("number"===typeof u.handleId?delete o[u.handleId]:u.handleId&&(u.handleId[ie]=null))}};var d=k(t,i[0],u,s,c);if(!d)return d;var p=d.data.handleId;return"number"===typeof p?o[p]=d:p&&(p[ie]=d),p&&p.ref&&p.unref&&"function"===typeof p.ref&&"function"===typeof p.unref&&(d.ref=p.ref.bind(p),d.unref=p.unref.bind(p)),"number"===typeof p||p?p:d}return n.apply(e,i)}})),i=L(e,n,(function(t){return function(n,r){var a,i=r[0];"number"===typeof i?a=o[i]:(a=i&&i[ie])||(a=i),a&&"string"===typeof a.type?"notScheduled"!==a.state&&(a.cancelFn&&a.data.isPeriodic||0===a.runCount)&&("number"===typeof i?delete o[i]:i&&(i[ie]=null),a.zone.cancelTask(a)):t.apply(e,r)}}))}function se(e,t){if(!Zone[t.symbol("patchEventTarget")]){for(var n=t.getGlobalObjects(),r=n.eventNames,a=n.zoneSymbolEventNames,i=n.TRUE_STR,o=n.FALSE_STR,s=n.ZONE_SYMBOL_PREFIX,c=0;c<r.length;c++){var u=r[c],l=s+(u+o),d=s+(u+i);a[u]={},a[u][o]=l,a[u][i]=d}var p=e.EventTarget;if(p&&p.prototype)return t.patchEventTarget(e,t,[p&&p.prototype]),!0}}Zone.__load_patch("legacy",(function(e){var t=e[Zone.__symbol__("legacyPatch")];t&&t()})),Zone.__load_patch("queueMicrotask",(function(e,t,n){n.patchMethod(e,"queueMicrotask",(function(e){return function(e,n){t.current.scheduleMicroTask("queueMicrotask",n[0])}}))})),Zone.__load_patch("timers",(function(e){var t="set",n="clear";oe(e,t,n,"Timeout"),oe(e,t,n,"Interval"),oe(e,t,n,"Immediate")})),Zone.__load_patch("requestAnimationFrame",(function(e){oe(e,"request","cancel","AnimationFrame"),oe(e,"mozRequest","mozCancel","AnimationFrame"),oe(e,"webkitRequest","webkitCancel","AnimationFrame")})),Zone.__load_patch("blocking",(function(e,t){for(var n=["alert","prompt","confirm"],r=0;r<n.length;r++){L(e,n[r],(function(n,r,a){return function(r,i){return t.current.run(n,e,i,a)}}))}})),Zone.__load_patch("EventTarget",(function(e,t,n){!function(e,t){t.patchEventPrototype(e,t)}(e,n),se(e,n);var r=e.XMLHttpRequestEventTarget;r&&r.prototype&&n.patchEventTarget(e,n,[r.prototype])})),Zone.__load_patch("MutationObserver",(function(e,t,n){N("MutationObserver"),N("WebKitMutationObserver")})),Zone.__load_patch("IntersectionObserver",(function(e,t,n){N("IntersectionObserver")})),Zone.__load_patch("FileReader",(function(e,t,n){N("FileReader")})),Zone.__load_patch("on_property",(function(e,t,n){ae(n,e)})),Zone.__load_patch("customElements",(function(e,t,n){!function(e,t){var n=t.getGlobalObjects(),r=n.isBrowser,a=n.isMix;(r||a)&&e.customElements&&"customElements"in e&&t.patchCallbacks(t,e.customElements,"customElements","define",["connectedCallback","disconnectedCallback","adoptedCallback","attributeChangedCallback"])}(e,n)})),Zone.__load_patch("XHR",(function(e,t){!function(e){var c=e.XMLHttpRequest;if(!c)return;var u=c.prototype;var l=u[f],d=u[h];if(!l){var p=e.XMLHttpRequestEventTarget;if(p){var v=p.prototype;l=v[f],d=v[h]}}var m="readystatechange",g="scheduled";function y(e){var r=e.data,o=r.target;o[i]=!1,o[s]=!1;var c=o[a];l||(l=o[f],d=o[h]),c&&d.call(o,m,c);var u=o[a]=function(){if(o.readyState===o.DONE)if(!r.aborted&&o[i]&&e.state===g){var n=o[t.__symbol__("loadfalse")];if(0!==o.status&&n&&n.length>0){var a=e.invoke;e.invoke=function(){for(var n=o[t.__symbol__("loadfalse")],i=0;i<n.length;i++)n[i]===e&&n.splice(i,1);r.aborted||e.state!==g||a.call(e)},n.push(e)}else e.invoke()}else r.aborted||!1!==o[i]||(o[s]=!0)};return l.call(o,m,u),o[n]||(o[n]=e),x.apply(o,r.args),o[i]=!0,e}function w(){}function _(e){var t=e.data;return t.aborted=!0,Z.apply(t.target,t.args)}var S=L(u,"open",(function(){return function(e,t){return e[r]=0==t[2],e[o]=t[1],S.apply(e,t)}})),E=b("fetchTaskAborting"),T=b("fetchTaskScheduling"),x=L(u,"send",(function(){return function(e,n){if(!0===t.current[T])return x.apply(e,n);if(e[r])return x.apply(e,n);var a={target:e,url:e[o],isPeriodic:!1,args:n,aborted:!1},i=k("XMLHttpRequest.send",w,a,y,_);e&&!0===e[s]&&!a.aborted&&i.state===g&&i.invoke()}})),Z=L(u,"abort",(function(){return function(e,r){var a=e[n];if(a&&"string"==typeof a.type){if(null==a.cancelFn||a.data&&a.data.aborted)return;a.zone.cancelTask(a)}else if(!0===t.current[E])return Z.apply(e,r)}}))}(e);var n=b("xhrTask"),r=b("xhrSync"),a=b("xhrListener"),i=b("xhrScheduled"),o=b("xhrURL"),s=b("xhrErrorBeforeScheduled")})),Zone.__load_patch("geolocation",(function(e){e.navigator&&e.navigator.geolocation&&function(e,t){for(var n=e.constructor.name,r=function(){var r=t[a],i=e[r];if(i){if(!x(o(e,r)))return"continue";e[r]=function(e){var t=function(){return e.apply(this,T(arguments,n+"."+r))};return F(t,e),t}(i)}},a=0;a<t.length;a++)r()}(e.navigator.geolocation,["getCurrentPosition","watchPosition"])})),Zone.__load_patch("PromiseRejectionEvent",(function(e,t){function n(t){return function(n){X(e,t).forEach((function(r){var a=e.PromiseRejectionEvent;if(a){var i=new a(t,{promise:n.promise,reason:n.rejection});r.invoke(i)}}))}}e.PromiseRejectionEvent&&(t[b("unhandledPromiseRejectionHandler")]=n("unhandledrejection"),t[b("rejectionHandledHandler")]=n("rejectionhandled"))}))},3897:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.__esModule=!0,e.exports.default=e.exports},5372:function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},3405:function(e,t,n){var r=n(3897);e.exports=function(e){if(Array.isArray(e))return r(e)},e.exports.__esModule=!0,e.exports.default=e.exports},6115:function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},7156:function(e){function t(e,t,n,r,a,i,o){try{var s=e[i](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,a)}e.exports=function(e){return function(){var n=this,r=arguments;return new Promise((function(a,i){var o=e.apply(n,r);function s(e){t(o,a,i,s,c,"next",e)}function c(e){t(o,a,i,s,c,"throw",e)}s(void 0)}))}},e.exports.__esModule=!0,e.exports.default=e.exports},6690:function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},3515:function(e,t,n){var r=n(6015),a=n(9617);function i(t,n,o){return a()?(e.exports=i=Reflect.construct.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=i=function(e,t,n){var a=[null];a.push.apply(a,t);var i=new(Function.bind.apply(e,a));return n&&r(i,n.prototype),i},e.exports.__esModule=!0,e.exports.default=e.exports),i.apply(null,arguments)}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},9728:function(e,t,n){var r=n(4062);function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,r(a.key),a)}}e.exports=function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},4704:function(e,t,n){var r=n(6116);e.exports=function(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw o}}}},e.exports.__esModule=!0,e.exports.default=e.exports},6389:function(e,t,n){var r=n(3808),a=n(9617),i=n(4993);e.exports=function(e){var t=a();return function(){var n,a=r(e);if(t){var o=r(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return i(this,n)}},e.exports.__esModule=!0,e.exports.default=e.exports},3808:function(e){function t(n){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},1655:function(e,t,n){var r=n(6015);e.exports=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},6035:function(e){e.exports=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")},e.exports.__esModule=!0,e.exports.default=e.exports},9617:function(e){e.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.__esModule=!0,e.exports.default=e.exports},9498:function(e){e.exports=function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},8872:function(e){e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,s=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(l){u=!0,a=l}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}},e.exports.__esModule=!0,e.exports.default=e.exports},2218:function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},2281:function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},4993:function(e,t,n){var r=n(8698).default,a=n(6115);e.exports=function(e,t){if(t&&("object"===r(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return a(e)},e.exports.__esModule=!0,e.exports.default=e.exports},7061:function(e,t,n){var r=n(8698).default;function a(){"use strict";e.exports=a=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},n=Object.prototype,i=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(I){d=function(e,t,n){return e[t]=n}}function p(e,t,n,r){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),s=new C(r||[]);return o(i,"_invoke",{value:E(e,n,s)}),i}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(I){return{type:"throw",arg:I}}}t.wrap=p;var h={};function v(){}function m(){}function g(){}var y={};d(y,c,(function(){return this}));var k=Object.getPrototypeOf,b=k&&k(k(R([])));b&&b!==n&&i.call(b,c)&&(y=b);var w=g.prototype=v.prototype=Object.create(y);function _(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function n(a,o,s,c){var u=f(e[a],e,o);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==r(d)&&i.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,s,c)}),(function(e){n("throw",e,s,c)})):t.resolve(d).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,a){n(e,r,t,a)}))}return a=a?a.then(i,i):i()}})}function E(e,t,n){var r="suspendedStart";return function(a,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw i;return P()}for(n.method=a,n.arg=i;;){var o=n.delegate;if(o){var s=T(o,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=f(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function T(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,T(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var a=f(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,h;var i=a.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function Z(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function R(e){if(e){var t=e[c];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(i.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:P}}function P(){return{value:void 0,done:!0}}return m.prototype=g,o(w,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=d(g,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,d(e,l,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},_(S.prototype),d(S.prototype,u,(function(){return this})),t.AsyncIterator=S,t.async=function(e,n,r,a,i){void 0===i&&(i=Promise);var o=new S(p(e,n,r,a),i);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},_(w),d(w,l,"Generator"),d(w,c,(function(){return this})),d(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=R,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(Z),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],o=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),Z(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;Z(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:R(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports},6015:function(e){function t(n,r){return e.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n,r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},7424:function(e,t,n){var r=n(5372),a=n(8872),i=n(6116),o=n(2218);e.exports=function(e,t){return r(e)||a(e,t)||i(e,t)||o()},e.exports.__esModule=!0,e.exports.default=e.exports},861:function(e,t,n){var r=n(3405),a=n(9498),i=n(6116),o=n(2281);e.exports=function(e){return r(e)||a(e)||i(e)||o()},e.exports.__esModule=!0,e.exports.default=e.exports},5036:function(e,t,n){var r=n(8698).default;e.exports=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!==r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},4062:function(e,t,n){var r=n(8698).default,a=n(5036);e.exports=function(e){var t=a(e,"string");return"symbol"===r(t)?t:String(t)},e.exports.__esModule=!0,e.exports.default=e.exports},8698:function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},6116:function(e,t,n){var r=n(3897);e.exports=function(e,t){if(e){if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},3496:function(e,t,n){var r=n(3808),a=n(6015),i=n(6035),o=n(3515);function s(t){var n="function"===typeof Map?new Map:void 0;return e.exports=s=function(e){if(null===e||!i(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return o(e,arguments,r(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),a(t,e)},e.exports.__esModule=!0,e.exports.default=e.exports,s(t)}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports},907:function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{Z:function(){return r}})},7326:function(e,t,n){"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,{Z:function(){return r}})},5861:function(e,t,n){"use strict";function r(e,t,n,r,a,i,o){try{var s=e[i](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,a)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var o=e.apply(t,n);function s(e){r(o,a,i,s,c,"next",e)}function c(e){r(o,a,i,s,c,"throw",e)}s(void 0)}))}}n.d(t,{Z:function(){return a}})},5671:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,{Z:function(){return r}})},5647:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(9611),a=n(8814);function i(e,t,n){return i=(0,a.Z)()?Reflect.construct.bind():function(e,t,n){var a=[null];a.push.apply(a,t);var i=new(Function.bind.apply(e,a));return n&&(0,r.Z)(i,n.prototype),i},i.apply(null,arguments)}},3144:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(9142);function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(0,r.Z)(a.key),a)}}function i(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}},7762:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(181);function a(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=(0,r.Z)(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw o}}}}},7277:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(1120),a=n(8814),i=n(1002),o=n(7326);function s(e){var t=(0,a.Z)();return function(){var n,a=(0,r.Z)(e);if(t){var s=(0,r.Z)(this).constructor;n=Reflect.construct(a,arguments,s)}else n=a.apply(this,arguments);return function(e,t){if(t&&("object"===(0,i.Z)(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,o.Z)(e)}(this,n)}}},4942:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(9142);function a(e,t,n){return(t=(0,r.Z)(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},1120:function(e,t,n){"use strict";function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}n.d(t,{Z:function(){return r}})},136:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(9611);function a(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(0,r.Z)(e,t)}},8814:function(e,t,n){"use strict";function r(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}n.d(t,{Z:function(){return r}})},1413:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(4942);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}},4165:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(1002);function a(){a=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(P){l=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var a=t&&t.prototype instanceof h?t:h,o=Object.create(a.prototype),s=new Z(r||[]);return i(o,"_invoke",{value:S(e,n,s)}),o}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(P){return{type:"throw",arg:P}}}e.wrap=d;var f={};function h(){}function v(){}function m(){}var g={};l(g,s,(function(){return this}));var y=Object.getPrototypeOf,k=y&&y(y(C([])));k&&k!==t&&n.call(k,s)&&(g=k);var b=m.prototype=h.prototype=Object.create(g);function w(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function _(e,t){function a(i,o,s,c){var u=p(e[i],e,o);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==(0,r.Z)(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){a("next",e,s,c)}),(function(e){a("throw",e,s,c)})):t.resolve(d).then((function(e){l.value=e,s(l)}),(function(e){return a("throw",e,s,c)}))}c(u.arg)}var o;i(this,"_invoke",{value:function(e,n){function r(){return new t((function(t,r){a(e,n,t,r)}))}return o=o?o.then(r,r):r()}})}function S(e,t,n){var r="suspendedStart";return function(a,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw i;return R()}for(n.method=a,n.arg=i;;){var o=n.delegate;if(o){var s=E(o,n);if(s){if(s===f)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=p(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),f;var a=p(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,f;var i=a.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,f):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Z(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function C(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:R}}function R(){return{value:void 0,done:!0}}return v.prototype=m,i(b,"constructor",{value:m,configurable:!0}),i(m,"constructor",{value:v,configurable:!0}),v.displayName=l(m,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,l(e,u,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},w(_.prototype),l(_.prototype,c,(function(){return this})),e.AsyncIterator=_,e.async=function(t,n,r,a,i){void 0===i&&(i=Promise);var o=new _(d(t,n,r,a),i);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},w(b),l(b,u,"Generator"),l(b,s,(function(){return this})),l(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=C,Z.prototype={constructor:Z,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),c=n.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),x(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;x(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:C(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},e}},9611:function(e,t,n){"use strict";function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}n.d(t,{Z:function(){return r}})},885:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(181);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,s=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(l){u=!0,a=l}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw a}}return s}}(e,t)||(0,r.Z)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},2982:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(907);var a=n(181);function i(e){return function(e){if(Array.isArray(e))return(0,r.Z)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||(0,a.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},9142:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(1002);function a(e){var t=function(e,t){if("object"!==(0,r.Z)(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!==(0,r.Z)(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===(0,r.Z)(t)?t:String(t)}},1002:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.d(t,{Z:function(){return r}})},181:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(907);function a(e,t){if(e){if("string"===typeof e)return(0,r.Z)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,r.Z)(e,t):void 0}}},8664:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(1120),a=n(9611);var i=n(5647);function o(e){var t="function"===typeof Map?new Map:void 0;return o=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,o)}function o(){return(0,i.Z)(e,arguments,(0,r.Z)(this).constructor)}return o.prototype=Object.create(e.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),(0,a.Z)(o,e)},o(e)}}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}n.m=e,n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,r){return n.f[r](e,t),t}),[]))},n.u=function(e){return"static/js/"+e+"."+{35:"664f79cc",290:"3fdf61dc",296:"14b01d06",424:"022c9906",475:"07eb21da",874:"ca1753c4",937:"6052140a",1068:"930f5825",1076:"67f9af63",1376:"e4f7ebed",1408:"35ff6531",1421:"3ecf9d8d",1485:"c1e4870b",1678:"e4ba74cc",1771:"31f89ce3",1817:"9ae49ba5",1862:"9e03cda7",1901:"a4d50f41",1941:"b355d0ea",2027:"d42642ed",2046:"0e3aa9d2",2072:"66e7bce4",2249:"1cc4559f",2332:"3b2c3527",2401:"d725726e",2427:"f1c5ac3a",2793:"0c1bce8f",2858:"f5d95cbf",2946:"52311bc8",2996:"ce15eb30",3012:"fb76b76c",3353:"0a68f05c",3555:"08c2b453",3642:"6e240fe9",3718:"10edc70d",4307:"66101fd1",4673:"880f1e5a",4701:"5897af8b",4815:"f66cab5d",5134:"9a5ec8ef",5181:"b13a10e9",5196:"8044bb98",5288:"9e765e30",5677:"a5a100e2",5729:"1d1d904f",6200:"00d455a0",6275:"4151690f",6301:"12ace618",6324:"b78b5950",6588:"aecb9da5",6769:"78e6a4ae",6967:"7dc0f676",7133:"d150fa55",7181:"a9b6d029",7205:"473a0347",7298:"5caaa2d3",7403:"8988967e",7766:"d316f4be",7770:"8027177e",7999:"03a75046",8053:"c7f52d15",8212:"0c5de9b3",8521:"d3ab13e7",8555:"26cd8b00",8675:"3ed8bf12",8684:"f726e6d3",8719:"a9a5f4e5",8785:"4772c13a",8967:"8dae4d8b",9091:"eaa950e1",9139:"6752ef85",9244:"bf207fa2",9281:"937a0000",9361:"377c6141",9434:"ee8ea28c",9546:"c0a927e4",9716:"10355d81",9808:"ea789867"}[e]+".chunk.js"},n.miniCssF=function(e){},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.hmd=function(e){return(e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="client:";n.l=function(r,a,i,o){if(e[r])e[r].push(a);else{var s,c;if(void 0!==i)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var d=u[l];if(d.getAttribute("src")==r||d.getAttribute("data-webpack")==t+i){s=d;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+i),s.src=r),e[r]=[a];var p=function(t,n){s.onerror=s.onload=null,clearTimeout(f);var a=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),a&&a.forEach((function(e){return e(n)})),t)return t(n)},f=setTimeout(p.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=p.bind(null,s.onerror),s.onload=p.bind(null,s.onload),c&&document.head.appendChild(s)}}}(),n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",function(){var e={179:0};n.f.j=function(t,r){var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)r.push(a[2]);else{var i=new Promise((function(n,r){a=e[t]=[n,r]}));r.push(a[2]=i);var o=n.p+n.u(t),s=new Error;n.l(o,(function(r){if(n.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",s.name="ChunkLoadError",s.type=i,s.request=o,a[1](s)}}),"chunk-"+t,t)}};var t=function(t,r){var a,i,o=r[0],s=r[1],c=r[2],u=0;if(o.some((function(t){return 0!==e[t]}))){for(a in s)n.o(s,a)&&(n.m[a]=s[a]);if(c)c(n)}for(t&&t(r);u<o.length;u++)i=o[u],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0},r=self.webpackChunkclient=self.webpackChunkclient||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}(),function(){"use strict";var e,t=n(1250),r=n(4165),a=n(5861),i=n(885),o=n(2791),s=n(5671),c=n(3144),u=n(136),l=n(7277),d=function(e){return e.replace(/([A-Z])/g,(function(e){return"-".concat(e[0].toLowerCase())}))},p=function(e,t,n){var r=t.className||t.class,a=n.className||n.class,i=v(e),o=v(r?r.split(" "):[]),s=v(a?a.split(" "):[]),c=[];return i.forEach((function(e){o.has(e)?(c.push(e),o.delete(e)):s.has(e)||c.push(e)})),o.forEach((function(e){return c.push(e)})),c.join(" ")},f=function(e){if("undefined"===typeof document)return!0;var t="on"+e,n=t in document;if(!n){var r=document.createElement("div");r.setAttribute(t,"return;"),n="function"===typeof r[t]}return n},h=function(e,t,n){var r=e.__events||(e.__events={}),a=r[t];a&&e.removeEventListener(t,a),e.addEventListener(t,r[t]=function(e){n&&n.call(this,e)})},v=function(e){var t=new Map;return e.forEach((function(e){return t.set(e,e)})),t},m=function(e,t){"function"===typeof e?e(t):null!=e&&(e.current=t)},g=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){t.forEach((function(t){m(t,e)}))}},y=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},k=function(e,t,n,r){void 0!==r&&r();var a=e.toLowerCase().split("-").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(""),i=function(t){(0,u.Z)(i,t);var r=(0,l.Z)(i);function i(e){var t;return(0,s.Z)(this,i),(t=r.call(this,e)).setComponentElRef=function(e){t.componentEl=e},t}return(0,c.Z)(i,[{key:"componentDidMount",value:function(){this.componentDidUpdate(this.props)}},{key:"componentDidUpdate",value:function(e){!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e instanceof Element){var r=p(e.classList,t,n);""!==r&&(e.className=r),Object.keys(t).forEach((function(n){if("children"!==n&&"style"!==n&&"ref"!==n&&"class"!==n&&"className"!==n&&"forwardedRef"!==n)if(0===n.indexOf("on")&&n[2]===n[2].toUpperCase()){var r=n.substring(2),a=r[0].toLowerCase()+r.substring(1);f(a)||h(e,a,t[n])}else e[n]=t[n],"string"===typeof t[n]&&e.setAttribute(d(n),t[n])}))}}(this.componentEl,this.props,e)}},{key:"render",value:function(){var t=this.props,r=t.children,a=t.forwardedRef,i=t.style,s=(t.className,t.ref,y(t,["children","forwardedRef","style","className","ref"])),c=Object.keys(s).reduce((function(e,t){var n=s[t];if(0===t.indexOf("on")&&t[2]===t[2].toUpperCase()){var r=t.substring(2).toLowerCase();"undefined"!==typeof document&&f(r)&&(e[t]=n)}else{var a=typeof n;"string"!==a&&"boolean"!==a&&"number"!==a||(e[d(t)]=n)}return e}),{});n&&(c=n(this.props,c));var u=Object.assign(Object.assign({},c),{ref:g(a,this.setComponentElRef),style:i});return(0,o.createElement)(e,u,r)}}],[{key:"displayName",get:function(){return a}}]),i}(o.Component);return t&&(i.contextType=t),function(e,t){var n=function(t,n){return o.createElement(e,Object.assign({},t,{forwardedRef:n}))};return n.displayName=t,o.forwardRef(n)}(i,a)},b=(n(4164),n(325));!function(){if("undefined"!==typeof window&&void 0!==window.Reflect&&void 0!==window.customElements){var e=HTMLElement;window.HTMLElement=function(){return Reflect.construct(e,[],this.constructor)},HTMLElement.prototype=e.prototype,HTMLElement.prototype.constructor=HTMLElement,Object.setPrototypeOf(HTMLElement,e)}}(),"undefined"===typeof window?Promise.resolve():(0,b.p)().then((function(){return(0,b.b)(JSON.parse('[["dyte-breakout-rooms-manager",[[1,"dyte-breakout-rooms-manager",{"meeting":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16],"roomConfig":[32],"connectedRooms":[32],"unassignedParticipants":[32],"deletedRooms":[32],"assigningParticipants":[32],"selectedParticipants":[32]}]]],["dyte-chat",[[1,"dyte-chat",{"meeting":[16],"config":[16],"size":[513],"iconPack":[16],"t":[16],"disablePrivateChat":[4,"disable-private-chat"],"privatePresetFilter":[16],"unreadCountGroups":[32],"chatGroups":[32],"selectedGroup":[32],"now":[32],"dropzoneActivated":[32],"showLatestMessageButton":[32],"canSend":[32],"canSendTextMessage":[32],"canSendFiles":[32],"canPrivateMessage":[32],"canSendPrivateTexts":[32],"canSendPrivateFiles":[32],"emojiPickerEnabled":[32],"chatRecipientId":[32],"participants":[32],"selectedParticipant":[32]}]]],["dyte-breakout-room-grid",[[1,"dyte-breakout-room-grid",{"meeting":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16]}]]],["dyte-settings",[[1,"dyte-settings",{"meeting":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16],"activeTab":[32],"isMobileMainVisible":[32],"networkStatus":[32],"canProduceAudio":[32],"canProduceVideo":[32]}]]],["dyte-screenshare-view",[[1,"dyte-screenshare-view",{"hideFullScreenButton":[4,"hide-full-screen-button"],"nameTagPosition":[513,"name-tag-position"],"participant":[16],"meeting":[16],"variant":[513],"size":[513],"iconPack":[16],"t":[16],"videoExpanded":[32],"screenShareEnabled":[32],"isFullScreen":[32],"remoteControlInfo":[32]}]]],["dyte-polls",[[1,"dyte-polls",{"meeting":[16],"config":[16],"size":[513],"iconPack":[16],"t":[16],"create":[32],"polls":[32]}]]],["dyte-camera-toggle",[[1,"dyte-camera-toggle",{"variant":[513],"meeting":[16],"size":[513],"iconPack":[16],"t":[16],"videoEnabled":[32],"canProduceVideo":[32],"cameraPermission":[32]}]]],["dyte-dialog-manager",[[1,"dyte-dialog-manager",{"meeting":[16],"config":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16]}]]],["dyte-mic-toggle",[[1,"dyte-mic-toggle",{"variant":[513],"meeting":[16],"size":[513],"iconPack":[16],"t":[16],"audioEnabled":[32],"canProduceAudio":[32],"micPermission":[32]}]]],["dyte-mixed-grid",[[1,"dyte-mixed-grid",{"layout":[513],"participants":[16],"pinnedParticipants":[16],"screenShareParticipants":[16],"plugins":[16],"aspectRatio":[1,"aspect-ratio"],"gap":[2],"size":[513],"meeting":[16],"states":[16],"config":[16],"iconPack":[16],"t":[16],"activeTab":[32],"initialised":[32]}]]],["dyte-mute-all-button",[[1,"dyte-mute-all-button",{"variant":[513],"meeting":[16],"size":[513],"iconPack":[16],"t":[16]}]]],["dyte-remote-access-manager",[[1,"dyte-remote-access-manager",{"meeting":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16],"acceptedRequestId":[32]}]]],["dyte-screen-share-toggle",[[1,"dyte-screen-share-toggle",{"states":[16],"variant":[513],"meeting":[16],"size":[513],"iconPack":[16],"t":[16],"maxScreenShareCount":[32],"screenShareCount":[32],"screenShareEnabled":[32],"canScreenShare":[32],"shareScreenPermission":[32]}]]],["dyte-webinar-stage-toggle",[[1,"dyte-webinar-stage-toggle",{"variant":[513],"meeting":[16],"size":[513],"iconPack":[16],"t":[16],"stageStatus":[32],"canPresent":[32],"requestProduce":[32]}]]],["dyte-breakout-rooms-toggle",[[1,"dyte-breakout-rooms-toggle",{"variant":[513],"meeting":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16]}]]],["dyte-chat-toggle",[[1,"dyte-chat-toggle",{"variant":[513],"meeting":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16],"unreadMessageCount":[32],"chatActive":[32]}]]],["dyte-fullscreen-toggle",[[1,"dyte-fullscreen-toggle",{"states":[16],"variant":[513],"size":[513],"iconPack":[16],"t":[16],"fullScreenActive":[32],"isFullScreenSupported":[32]}]]],["dyte-grid-pagination",[[1,"dyte-grid-pagination",{"meeting":[16],"states":[16],"size":[513],"variant":[513],"iconPack":[16],"t":[16],"page":[32],"pageCount":[32],"activeCount":[32],"activeComputedCount":[32],"showPagination":[32]}]]],["dyte-idle-screen",[[1,"dyte-idle-screen",{"config":[16],"iconPack":[16],"t":[16]}]]],["dyte-leave-button",[[1,"dyte-leave-button",{"variant":[513],"size":[513],"iconPack":[16],"t":[16]}]]],["dyte-more-toggle",[[1,"dyte-more-toggle",{"states":[16],"size":[513],"iconPack":[16],"t":[16]}]]],["dyte-notifications",[[1,"dyte-notifications",{"meeting":[16],"states":[16],"config":[16],"t":[16],"size":[513],"iconPack":[16],"notifications":[32]}]]],["dyte-participants-audio",[[1,"dyte-participants-audio",{"meeting":[16],"iconPack":[16],"t":[16],"showPlayDialog":[32]}]]],["dyte-participants-toggle",[[1,"dyte-participants-toggle",{"variant":[513],"meeting":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16],"participantsActive":[32],"waitlistedParticipants":[32],"stageRequestedParticipants":[32]}]]],["dyte-pip-toggle",[[1,"dyte-pip-toggle",{"variant":[513],"meeting":[16],"states":[16],"config":[16],"iconPack":[16],"size":[513],"t":[16],"pipEnabled":[32],"pipSupported":[32]}]]],["dyte-plugins-toggle",[[1,"dyte-plugins-toggle",{"variant":[513],"meeting":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16],"pluginsActive":[32]}]]],["dyte-polls-toggle",[[1,"dyte-polls-toggle",{"variant":[513],"meeting":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16],"pollsActive":[32],"unreadPollsCount":[32]}]]],["dyte-recording-toggle",[[1,"dyte-recording-toggle",{"variant":[513],"meeting":[16],"t":[16],"iconPack":[16],"size":[513],"recordingState":[32],"canRecord":[32]}]]],["dyte-settings-toggle",[[1,"dyte-settings-toggle",{"variant":[513],"states":[16],"size":[513],"iconPack":[16],"t":[16]}]]],["dyte-setup-screen",[[1,"dyte-setup-screen",{"meeting":[16],"size":[513],"config":[16],"states":[16],"iconPack":[16],"t":[16],"displayName":[32],"isJoining":[32],"canEditName":[32]}]]],["dyte-broadcast-message-modal",[[1,"dyte-broadcast-message-modal",{"meeting":[16],"states":[16],"iconPack":[16],"t":[16],"messagePayload":[32],"successMessage":[32]}]]],["dyte-image-viewer",[[1,"dyte-image-viewer",{"image":[16],"size":[513],"t":[16],"iconPack":[16]}]]],["dyte-permissions-message",[[1,"dyte-permissions-message",{"meeting":[16],"t":[16],"iconPack":[16],"device":[32]}]]],["dyte-plugin-main",[[1,"dyte-plugin-main",{"meeting":[16],"plugin":[16],"iconPack":[16],"t":[16],"canClosePlugin":[32],"canControl":[32],"viewModeEnabled":[32]}]]],["dyte-plugins",[[1,"dyte-plugins",{"meeting":[16],"config":[16],"size":[513],"iconPack":[16],"t":[16],"plugins":[32],"canStartPlugins":[32],"canClosePlugin":[32],"activatedPluginsId":[32]}]]],["dyte-sidebar",[[1,"dyte-sidebar",{"enabledSections":[16],"defaultSection":[1,"default-section"],"meeting":[16],"states":[16],"config":[16],"iconPack":[16],"t":[16],"size":[513],"view":[513],"tab":[32]}]]],["dyte-clock",[[1,"dyte-clock",{"meeting":[16],"iconPack":[16],"t":[16],"startedTime":[32],"timeDiff":[32]}]]],["dyte-confirmation-modal",[[1,"dyte-confirmation-modal",{"meeting":[16],"states":[16],"iconPack":[16],"t":[16]}]]],["dyte-ended-screen",[[1,"dyte-ended-screen",{"config":[16],"size":[513],"states":[16],"t":[16],"iconPack":[16],"meeting":[16],"icon":[32],"message":[32]}]]],["dyte-join-stage",[[1,"dyte-join-stage",{"meeting":[16],"config":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16]}]]],["dyte-leave-meeting",[[1,"dyte-leave-meeting",{"meeting":[16],"states":[16],"iconPack":[16],"t":[16],"canEndMeeting":[32]}]]],["dyte-meeting-title",[[1,"dyte-meeting-title",{"meeting":[16],"iconPack":[16],"t":[16]}]]],["dyte-mute-all-confirmation",[[1,"dyte-mute-all-confirmation",{"meeting":[16],"states":[16],"iconPack":[16],"t":[16],"allowUnmute":[32]}]]],["dyte-participant-count",[[1,"dyte-participant-count",{"meeting":[16],"iconPack":[16],"t":[16],"participantCount":[32]}]]],["dyte-participant-setup",[[1,"dyte-participant-setup",{"nameTagPosition":[513,"name-tag-position"],"isPreview":[4,"is-preview"],"participant":[16],"states":[16],"config":[16],"variant":[513],"size":[513],"iconPack":[16],"t":[16],"videoState":[32],"isPinned":[32]}]]],["dyte-recording-indicator",[[1,"dyte-recording-indicator",{"meeting":[16],"size":[513],"t":[16],"iconPack":[16],"isRecording":[32]}]]],["dyte-waiting-screen",[[1,"dyte-waiting-screen",{"config":[16],"iconPack":[16],"t":[16]}]]],["dyte-controlbar",[[1,"dyte-controlbar",{"variant":[513],"disableRender":[4,"disable-render"],"meeting":[16],"config":[16],"states":[16],"iconPack":[16],"t":[16],"size":[513]}]]],["dyte-grid",[[1,"dyte-grid",{"layout":[513],"aspectRatio":[513,"aspect-ratio"],"meeting":[16],"gap":[514],"size":[513],"states":[16],"config":[16],"iconPack":[16],"t":[16],"participants":[32],"pinnedParticipants":[32],"screenShareParticipants":[32],"plugins":[32],"showWebinarStage":[32],"canCurrentPeerHost":[32],"connected":[32],"pipSupported":[32]}]]],["dyte-header",[[1,"dyte-header",{"variant":[513],"disableRender":[4,"disable-render"],"meeting":[16],"config":[16],"states":[16],"iconPack":[16],"t":[16],"size":[513]}]]],["dyte-meeting",[[1,"dyte-meeting",{"loadConfigFromPreset":[4,"load-config-from-preset"],"applyDesignSystem":[4,"apply-design-system"],"mode":[513],"leaveOnUnmount":[4,"leave-on-unmount"],"meeting":[16],"showSetupScreen":[1028,"show-setup-screen"],"language":[513],"config":[1040],"iconPackUrl":[513,"icon-pack-url"],"size":[1537],"gridLayout":[1,"grid-layout"],"states":[32],"newMeeting":[32],"iconPack":[32],"t":[32]},[[0,"dyteStateUpdate","listenState"]]]]],["dyte-name-tag",[[1,"dyte-name-tag",{"participant":[16],"meeting":[16],"size":[513],"maxLength":[2,"max-length"],"isScreenShare":[4,"is-screen-share"],"iconPack":[16],"t":[16],"length":[32]}]]],["dyte-simple-grid",[[1,"dyte-simple-grid",{"participants":[16],"aspectRatio":[1,"aspect-ratio"],"gap":[2],"size":[513],"meeting":[16],"states":[16],"config":[16],"iconPack":[16],"t":[16],"dimensions":[32]}]]],["dyte-spotlight-grid",[[1,"dyte-spotlight-grid",{"layout":[513],"participants":[16],"pinnedParticipants":[16],"aspectRatio":[1,"aspect-ratio"],"gap":[2],"size":[513],"meeting":[16],"states":[16],"config":[16],"iconPack":[16],"t":[16]}]]],["dyte-stage",[[1,"dyte-stage",{"iconPack":[16],"t":[16]}]]],["dyte-text-field",[[1,"dyte-text-field",{"type":[1],"placeholder":[1],"disabled":[4],"iconPack":[16],"t":[16]}]]],["dyte-button",[[1,"dyte-button",{"size":[513],"variant":[513],"kind":[513],"reverse":[516],"disabled":[516],"iconPack":[16],"t":[16]}]]],["dyte-icon",[[1,"dyte-icon",{"icon":[1],"iconPack":[16],"t":[16]}]]],["dyte-breakout-room-tile",[[1,"dyte-breakout-room-tile",{"meeting":[16],"states":[16],"iconPack":[16],"t":[16],"isParent":[4,"is-parent"],"isCurrent":[4,"is-current"],"room":[16],"meetingId":[32]}]]],["dyte-notification",[[1,"dyte-notification",{"notification":[16],"size":[513],"iconPack":[16],"t":[16],"imageState":[32]}]]],["dyte-spotlight-indicator",[[1,"dyte-spotlight-indicator",{"meeting":[16],"iconPack":[16],"t":[16],"canSpotlight":[32],"isSpotlighted":[32]}]]],["dyte-overlay-modal",[[1,"dyte-overlay-modal",{"meeting":[16],"states":[16],"iconPack":[16],"t":[16]}]]],["dyte-settings-audio_2",[[1,"dyte-settings-audio",{"meeting":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16],"audioDevices":[32],"speakerDevices":[32]}],[1,"dyte-settings-video",{"meeting":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16],"videoDevices":[32],"currentDevice":[32],"videoEnabled":[32]}]]],["dyte-poll_2",[[1,"dyte-poll-form",{"iconPack":[16],"t":[16],"options":[32],"anonymous":[32],"hideVotes":[32],"error":[32]}],[1,"dyte-poll",{"poll":[16],"self":[1],"permissions":[16],"iconPack":[16],"t":[16]}]]],["dyte-emoji-picker",[[1,"dyte-emoji-picker",{"iconPack":[16],"t":[16],"emojiList":[32],"filterVal":[32],"filteredEmojis":[32]}]]],["dyte-dialog",[[1,"dyte-dialog",{"hideCloseButton":[4,"hide-close-button"],"meeting":[16],"config":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16],"open":[1540]}]]],["dyte-participant-tile",[[1,"dyte-participant-tile",{"nameTagPosition":[513,"name-tag-position"],"isPreview":[4,"is-preview"],"participant":[16],"meeting":[16],"states":[16],"config":[16],"variant":[513],"size":[513],"iconPack":[16],"t":[16],"videoState":[32],"isPinned":[32]}]]],["dyte-breakout-room-manager_3",[[1,"dyte-breakout-room-manager",{"meeting":[16],"assigningParticipants":[516,"assigning-participants"],"mode":[1],"states":[16],"size":[513],"iconPack":[16],"t":[16],"room":[16]}],[1,"dyte-participants",{"meeting":[16],"config":[16],"size":[513],"iconPack":[16],"view":[1],"t":[16],"mode":[1],"unassignedParticipants":[16],"search":[32],"participants":[32],"webinarViewers":[32],"waitlistedParticipants":[32],"stageRequestedParticipants":[32]}],[1,"dyte-counter",{"size":[513],"value":[2],"iconPack":[16],"t":[16],"input":[32]}]]],["dyte-chat-composer-ui_3",[[1,"dyte-chat-messages-ui",{"selectedGroup":[1,"selected-group"],"messages":[16],"selfUserId":[1,"self-user-id"],"size":[513],"iconPack":[16],"t":[16],"now":[32],"showLatestMessageButton":[32]}],[1,"dyte-chat-composer-ui",{"canSendTextMessage":[4,"can-send-text-message"],"canSendFiles":[4,"can-send-files"],"size":[513],"iconPack":[16],"t":[16],"disableEmojiPicker":[4,"disable-emoji-picker"],"emojiPickerActive":[32]}],[1,"dyte-chat-selector-ui",{"selfUserId":[1,"self-user-id"],"selectedGroupId":[1,"selected-group-id"],"unreadCounts":[16],"groups":[16],"iconPack":[16],"t":[16],"showParticipantsPanel":[32],"query":[32]}]]],["dyte-logo",[[1,"dyte-logo",{"logoUrl":[1025,"logo-url"],"config":[16],"meeting":[16],"iconPack":[16],"t":[16]}]]],["dyte-audio-visualizer_2",[[1,"dyte-audio-visualizer",{"variant":[513],"participant":[16],"size":[513],"iconPack":[16],"t":[16],"isScreenShare":[4,"is-screen-share"],"audioEnabled":[32],"volume":[32]}],[1,"dyte-switch",{"checked":[1028],"readonly":[4],"disabled":[516],"iconPack":[16],"t":[16]}]]],["dyte-spinner",[[1,"dyte-spinner",{"iconPack":[16],"t":[16]}]]],["dyte-file-message_3",[[0,"dyte-image-message",{"message":[16],"now":[16],"isContinued":[516,"is-continued"],"iconPack":[16],"t":[16],"status":[32]}],[0,"dyte-file-message",{"message":[16],"now":[16],"isContinued":[516,"is-continued"],"iconPack":[16],"t":[16]}],[0,"dyte-text-message",{"message":[16],"now":[16],"isContinued":[516,"is-continued"],"iconPack":[16],"t":[16]}]]],["dyte-controlbar-button",[[1,"dyte-controlbar-button",{"variant":[513],"showWarning":[4,"show-warning"],"size":[513],"label":[1],"icon":[1],"isLoading":[4,"is-loading"],"disabled":[516],"iconPack":[16],"t":[16]}]]],["dyte-tooltip",[[1,"dyte-tooltip",{"label":[1],"variant":[513],"disabled":[516],"open":[516],"kind":[513],"size":[513],"placement":[1],"delay":[2],"iconPack":[16],"t":[16],"isInFocus":[32]}]]],["dyte-avatar_5",[[1,"dyte-participant",{"meeting":[16],"view":[1],"participant":[16],"iconPack":[16],"t":[16],"audioEnabled":[32],"videoEnabled":[32],"isPinned":[32],"isOnStage":[32],"canDisableParticipantAudio":[32],"canDisableParticipantVideo":[32],"canKickParticipant":[32],"canPinParticipant":[32],"selected":[32],"canAllowParticipantOnStage":[32]}],[1,"dyte-avatar",{"participant":[16],"variant":[513],"size":[513],"iconPack":[16],"t":[16],"imageState":[32]}],[1,"dyte-menu",{"size":[513],"placement":[1],"iconPack":[16],"t":[16]}],[1,"dyte-menu-item",{"size":[513],"iconPack":[16],"t":[16]}],[1,"dyte-menu-list",{"iconPack":[16],"t":[16]}]]]]'),e)}));var w=k("dyte-meeting"),_=n(9442),S=(n(1654),n(7239),n(6758),n(9666),n(4402),n(4153),n(4130),n(3360)),E=(Object.defineProperty,{exports:{}}),T={};Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;!function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(a){return!1}}()||Object.assign;var x=o,Z=60103;if(T.Fragment=60107,"function"===typeof Symbol&&Symbol.for){var C=Symbol.for;Z=C("react.element"),T.Fragment=C("react.fragment")}var R=x.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,P=Object.prototype.hasOwnProperty,I={key:!0,ref:!0,__self:!0,__source:!0};function O(e,t,n){var r,a={},i=null,o=null;for(r in void 0!==n&&(i=""+n),void 0!==t.key&&(i=""+t.key),void 0!==t.ref&&(o=t.ref),t)P.call(t,r)&&!I.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:Z,type:e,key:i,ref:o,props:a,_owner:R.current}}T.jsx=O,T.jsxs=O,E.exports=T;E.exports.jsx,(0,o.createContext)({meeting:void 0,updates:void 0});var D=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t,n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/meetings",{method:"POST",body:JSON.stringify({title:"New Code pair"}),headers:{"Content-Type":"application/json"}});case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,console.log(n),e.abrupt("return",n.data.id);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/meetings/".concat(t,"/participants"),{method:"POST",body:JSON.stringify({name:"new user",preset_name:"group_call_host"}),headers:{"Content-Type":"application/json"}});case 2:return n=e.sent,e.next=5,n.json();case 5:return a=e.sent,console.log(a),e.abrupt("return",a.data.token);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=n(184),N=function(){var e=(0,o.useRef)(),t=function(){var e=(0,o.useState)(),t=(0,i.Z)(e,2),n=t[0],s=t[1],c=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.Z.init(t);case 2:return n=e.sent,s(n),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return[n,c]}(),n=(0,i.Z)(t,2),s=n[0],c=n[1],u=(0,o.useState)(),l=(0,i.Z)(u,2),d=l[0],p=l[1],f=(0,o.useState)(),h=(0,i.Z)(f,2),v=h[0],m=h[1],g=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D();case 2:t=e.sent,m(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();(0,o.useEffect)((function(){var e=window.location.pathname.split("/")[2];e?m(e):g()}),[]);var y=function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!v){e.next=7;break}return e.next=3,M(v);case 3:return t=e.sent,e.next=6,c({authToken:t});case 6:p(t);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,o.useEffect)((function(){v&&!d&&y()}),[v]),(0,o.useEffect)((function(){d&&(0,_.p)(e.current,{theme:"dark"})}),[d]),(0,A.jsx)(A.Fragment,{children:d&&v?(0,A.jsx)(w,{mode:"fill",meeting:s,ref:e}):(0,A.jsx)("div",{children:"Loading..."})})},L=function(){return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)("div",{style:{padding:"30px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,A.jsx)("img",{alt:"logo",src:"https://dyte.io/blog/content/images/2021/09/Dyte-Logo.svg",height:"70px"}),(0,A.jsx)("span",{style:{fontSize:"30px",color:"#3e75fd"},children:"Collaborative Code Editor"}),(0,A.jsx)("img",{alt:"logo",style:{opacity:"0"},src:"https://dyte.io/blog/content/images/2021/09/Dyte-Logo.svg",height:"80px"})]}),(0,A.jsx)("div",{style:{height:"88vh"},children:(0,A.jsx)(N,{})})]})};var j=function(){return(0,A.jsx)(L,{})};(0,_.p)(document.body,{theme:"light",googleFont:"Inter",colors:{"video-bg":"#ebebeb"}}),t.createRoot(document.getElementById("root")).render((0,A.jsx)(j,{}))}()}();
//# sourceMappingURL=main.9e63d8b2.js.map