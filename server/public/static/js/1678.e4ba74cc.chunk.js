"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[1678],{1678:function(e,t,n){n.r(t),n.d(t,{dyte_camera_toggle:function(){return c}});var i=n(5671),r=n(3144),s=n(325),o=n(7239),a=n(859),u=n(5100),c=function(){function e(t){var n=this;(0,i.Z)(this,e),(0,s.r)(this,t),this.stateUpdate=(0,s.c)(this,"dyteStateUpdate",7),this.videoUpdateListener=function(e){var t=e.videoEnabled;n.videoEnabled=t},this.selfJoinStateListener=function(){n.updateCanProduce(n.meeting)},this.selfStateLeftListener=function(){n.canProduceVideo=!1},this.mediaPermissionErrorListener=function(e){var t=e.kind,i=e.message;"video"===t&&(n.cameraPermission=i)},this.toggleCamera=function(){var e,t,i,r,s;if(null===(e=n.meeting)||void 0===e||e.__internals__.logger.info("dyteCameraToggle::toggleCamera",{cameraPermission:n.cameraPermission,hasPermissionError:n.hasPermissionError(),canProduceVideo:n.canProduceVideo,selfExists:Boolean(null===(t=n.meeting)||void 0===t?void 0:t.self),videoEnabled:Boolean(null===(r=null===(i=n.meeting)||void 0===i?void 0:i.self)||void 0===r?void 0:r.videoEnabled)}),n.hasPermissionError())return n.stateUpdate.emit({activePermissionsMessage:!0}),u.s.activePermissionsMessage=!0,!1;var o=null===(s=n.meeting)||void 0===s?void 0:s.self;null!=o&&n.canProduceVideo&&(o.videoEnabled?o.disableVideo():o.enableVideo())},this.variant="button",this.meeting=void 0,this.size=void 0,this.iconPack=o.d,this.t=(0,a.u)(),this.videoEnabled=!1,this.canProduceVideo=!1,this.cameraPermission="NOT_REQUESTED"}return(0,r.Z)(e,[{key:"connectedCallback",value:function(){this.meetingChanged(this.meeting)}},{key:"disconnectedCallback",value:function(){var e,t,n,i,r,s,o;null===(e=this.meeting)||void 0===e||e.self.removeListener("videoUpdate",this.videoUpdateListener),null===(t=this.meeting)||void 0===t||t.self.removeListener("mediaPermissionError",this.mediaPermissionErrorListener),null===(n=this.meeting)||void 0===n||n.self.removeListener("joinStageRequestAccepted",this.selfJoinStateListener),null===(i=this.meeting)||void 0===i||i.self.removeListener("joinStageRequestRejected",this.selfJoinStateListener),null===(r=this.meeting)||void 0===r||r.self.removeListener("stageJoined",this.selfJoinStateListener),null===(s=this.meeting)||void 0===s||s.self.removeListener("stageLeft",this.selfStateLeftListener),null===(o=this.meeting)||void 0===o||o.self.removeListener("removedFromStage",this.selfJoinStateListener)}},{key:"meetingChanged",value:function(e){if(null!=e){var t=e.self;this.updateCanProduce(e),this.cameraPermission=t.mediaPermissions.video||"NOT_REQUESTED",this.videoEnabled=t.videoEnabled,t.addListener("videoUpdate",this.videoUpdateListener),t.addListener("mediaPermissionError",this.mediaPermissionErrorListener),t.addListener("joinStageRequestAccepted",this.selfJoinStateListener),t.addListener("joinStageRequestRejected",this.selfJoinStateListener),t.addListener("stageJoined",this.selfJoinStateListener),t.addListener("stageLeft",this.selfStateLeftListener),t.addListener("removedFromStage",this.selfJoinStateListener)}}},{key:"updateCanProduce",value:function(e){var t=e.self,n=e.meta,i="ALLOWED"===t.permissions.canProduceVideo,r="WEBINAR"===n.viewType;if(this.canProduceVideo=!1,i)this.canProduceVideo=!0;else if(r){!("CAN_REQUEST"===t.permissions.canProduceVideo)||"ON_STAGE"!==t.webinarStageStatus&&"ACCEPTED_TO_JOIN_STAGE"!==t.webinarStageStatus||(this.canProduceVideo=!0)}}},{key:"hasPermissionError",value:function(){return"NOT_REQUESTED"!==this.cameraPermission&&"ACCEPTED"!==this.cameraPermission}},{key:"getState",value:function(){var e="",t="",n={},i=this.hasPermissionError();return this.videoEnabled&&!i?(e=this.t("video_on"),t=this.iconPack.video_on):(e=this.t("video_off"),t=this.iconPack.video_off,n["red-icon"]=!0),{tooltipLabel:"COULD_NOT_START"===this.cameraPermission?this.t("Unable to start camera"):"SYSTEM_DENIED"===this.cameraPermission?this.t("perm_sys_denied"):"DENIED"===this.cameraPermission?this.t("perm_browser_denied"):this.videoEnabled?this.t("Disable Camera"):this.t("Enable Camera"),label:e,icon:t,classList:n,showWarning:i}}},{key:"render",value:function(){if(!this.canProduceVideo)return null;var e=this.getState(),t=e.tooltipLabel,n=e.label,i=e.icon,r=e.classList,o=e.showWarning;return(0,s.h)(s.H,{title:n},(0,s.h)("dyte-tooltip",{kind:"block",label:t,part:"tooltip",iconPack:this.iconPack,t:this.t},(0,s.h)("dyte-controlbar-button",{part:"controlbar-button",size:this.size,iconPack:this.iconPack,t:this.t,class:r,variant:this.variant,label:n,icon:i,onClick:this.toggleCamera,showWarning:o,disabled:o})))}}],[{key:"watchers",get:function(){return{meeting:["meetingChanged"]}}}]),e}();c.style=":host{display:block;font-family:var(--dyte-font-family, sans-serif)}"},859:function(e,t,n){n.d(t,{g:function(){return o},u:function(){return a}});var i=n(4165),r=n(5861),s=n(7239),o=function(){var e=(0,r.Z)((0,i.Z)().mark((function e(t){var n;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=t&&"en"!==t&&""!==t.trim()){e.next=2;break}return e.abrupt("return",s.a);case 2:return e.prev=2,e.next=5,fetch("".concat("http://localhost:5000","/").concat(t,".json"));case 5:if((n=e.sent).ok){e.next=8;break}return e.abrupt("return",s.a);case 8:return e.t0=Object,e.t1={},e.t2=s.a,e.next=13,n.json();case 13:return e.t3=e.sent,e.abrupt("return",e.t0.assign.call(e.t0,e.t1,e.t2,e.t3));case 17:return e.prev=17,e.t4=e.catch(2),e.abrupt("return",s.a);case 20:case"end":return e.stop()}}),e,null,[[2,17]])})));return function(t){return e.apply(this,arguments)}}(),a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.a;return function(t){var n;return null!==(n=e[t])&&void 0!==n?n:t}}},5100:function(e,t,n){n.d(t,{o:function(){return l},s:function(){return d}});var i=n(7762),r=n(325),s=function(e){return!("isConnected"in e)||e.isConnected},o=function(e,t){var n;return function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];n&&clearTimeout(n),n=setTimeout((function(){n=0,e.apply(void 0,r)}),t)}}((function(e){var t,n=(0,i.Z)(e.keys());try{for(n.s();!(t=n.n()).done;){var r=t.value;e.set(r,e.get(r).filter(s))}}catch(o){n.e(o)}finally{n.f()}}),2e3),a=function(e){return"function"===typeof e?e():e},u=function(e,t){var n=e.indexOf(t);n>=0&&(e[n]=e[e.length-1],e.length--)},c=function(e,t){var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e,t){return e!==t},n=a(e),i=new Map(Object.entries(null!==n&&void 0!==n?n:{})),r={dispose:[],get:[],set:[],reset:[]},s=function(){var t;i=new Map(Object.entries(null!==(t=a(e))&&void 0!==t?t:{})),r.reset.forEach((function(e){return e()}))},o=function(e){return r.get.forEach((function(t){return t(e)})),i.get(e)},c=function(e,n){var s=i.get(e);t(n,s,e)&&(i.set(e,n),r.set.forEach((function(t){return t(e,n,s)})))},d="undefined"===typeof Proxy?{}:new Proxy(n,{get:function(e,t){return o(t)},ownKeys:function(e){return Array.from(i.keys())},getOwnPropertyDescriptor:function(){return{enumerable:!0,configurable:!0}},has:function(e,t){return i.has(t)},set:function(e,t,n){return c(t,n),!0}}),l=function(e,t){return r[e].push(t),function(){u(r[e],t)}};return{state:d,get:o,set:c,on:l,onChange:function(t,n){var i=l("set",(function(e,i){e===t&&n(i)})),r=l("reset",(function(){return n(a(e)[t])}));return function(){i(),r()}},use:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t.reduce((function(e,t){return t.set&&e.push(l("set",t.set)),t.get&&e.push(l("get",t.get)),t.reset&&e.push(l("reset",t.reset)),t.dispose&&e.push(l("dispose",t.dispose)),e}),[]);return function(){return i.forEach((function(e){return e()}))}},dispose:function(){r.dispose.forEach((function(e){return e()})),s()},reset:s,forceUpdate:function(e){var t=i.get(e);r.set.forEach((function(n){return n(e,t,t)}))}}}(e,t);return n.use(function(){if("function"!==typeof r.a)return{};var e=new Map;return{dispose:function(){return e.clear()},get:function(t){var n=(0,r.a)();n&&function(e,t,n){var i=e.get(t);i?i.includes(n)||i.push(n):e.set(t,[n])}(e,t,n)},set:function(t){var n=e.get(t);n&&e.set(t,n.filter(r.f)),o(e)},reset:function(){e.forEach((function(e){return e.forEach(r.f)})),o(e)}}}()),n}({}),d=c.state,l=c.onChange}}]);
//# sourceMappingURL=1678.e4ba74cc.chunk.js.map